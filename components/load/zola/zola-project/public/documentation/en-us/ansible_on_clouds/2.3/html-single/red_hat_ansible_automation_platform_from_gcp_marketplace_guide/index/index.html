<!DOCTYPE html>
<html>
    <head>
        
        <link rel="stylesheet" type="text/css" media="screen" href="/mimir/styles/mimir.min.css">
        




    <link rel="stylesheet" type="text/css" media="screen" href="/sites/dxp-docs/files/css/css_87GMcmxT1ib8ziQiU2KUAnTDFtZQV6iP-KGslA9LigM.css" />

    <link rel="stylesheet" type="text/css" media="screen" href="/sites/dxp-docs/files/css/css_Bwzy34i9pSdDlzGALvqVwG4fpgGp08KLMAkClGNY9M4.css" />



<link rel="stylesheet" type="text/css" media="screen" href="/mimir/styles/mimir-doc-toc.min.css" />



        
        <!--#include virtual="/includes/head/index.html" -->

        
        <title>
Red Hat Ansible Automation Platform from GCP Marketplace Guide - Ansible on Clouds 2.3
</title>
        
<meta name="product" content="Ansible on Clouds" />
<meta name="documentation_version" content="2.3" />
<meta name="documentKind" content="documentation" />
<meta name="portal_content_subtype" content="title" />
<meta name="lastModifiedDate" content="2023-11-14T14:47:06.000Z" />


        
            
        
        
            
                
                
                <!-- mimir_solr_yesindex -->
                <meta name="mimir_solr_yesindex" content="true" />
            
        
    </head>

    <body class="mimir-body">

        
        

        
        <div id="page-wrap" class="page-wrap">
            <div id="pers-top-page-wrap" class="top-page-wrap pers-loader-bg">
                <div id="hero-bg-top-left" class="summit-bg-shapes"></div>
                <div id="hero-bg-top-right" class="summit-bg-shapes"></div>

                <header class="masthead" id="masthead">

                    
                    <!--#include virtual="/includes/header/index.html" -->

                    
                    
                    
                        
                    
                    
                        <div class="breadcrumbs">
                            <div id="breadcrumbs" class="container">
                                
                                <a href="/">Home</a>
                                
                                <a href="/products/">Product Documentation</a>
                                
                                <a href="/documentation/en-us/ansible_on_clouds/2.4/">Ansible on Clouds</a>
                                
                                <a href="/documentation/en-us/ansible_on_clouds/2.3/">2.3</a>
                                
                                
                                Red Hat Ansible Automation Platform from GCP Marketplace Guide
                                
                            </div>
                        </div>
                    
                </header>

                <main id="cp-main" class="portal-content-area">
                    <div id="cp-content" class="main-content">
                        
                        <main class="container mimir-docs">
                            
                            <bdo>
                                

<script type="module" src="/mimir/scripts/mimir-doc-toc.min.js"></script>






<div class="docs-grid">

    <nav id="mimir-doc-toc" class="mimir-doc-toc">
      <div class="mimir-doc-toc-inner">
          <!-- single-page -->
        
            
              <ol>
                <li>
                        
                        <a href="#">Red Hat Ansible Automation Platform from GCP Marketplace Guide</a>
                    </li><li>
                        <a href="#making-open-source-more-inclusive">
                            Making open source more inclusive
                        </a>
                    </li><li>
                        <a href="#providing-feedback">
                            Providing feedback on Red Hat documentation
                        </a>
                    </li><li>
                        <a href="#assembly-intro-to-aap-on-gcp">
                            1. Introduction to Ansible Automation Platform from GCP Marketplace
                        </a><ol>
                <li>
                        <a href="#con-gcp-application-architecture">
                            1.1. Application architecture
                        </a><ol>
                <li>
                        <a href="#gcp_infrastructure">
                            1.1.1. GCP infrastructure
                        </a>
                    </li><li>
                        <a href="#architecture_description">
                            1.1.2. Architecture Description
                        </a>
                    </li><li>
                        <a href="#service_descriptions">
                            1.1.3. Service descriptions
                        </a>
                    </li>
            </ol>
                    </li>
            </ol>
                    </li><li>
                        <a href="#assembly-gcp-install">
                            2. Installing Red Hat Ansible Automation Platform from GCP Marketplace
                        </a><ol>
                <li>
                        <a href="#ref-gcp-install-prerequisites">
                            2.1. Prerequisites
                        </a>
                    </li><li>
                        <a href="#ref-gcp-install-permissions">
                            2.2. Permissions
                        </a>
                    </li><li>
                        <a href="#con-gcp-create-project">
                            2.3. Create a project
                        </a><ol>
                <li>
                        <a href="#con-gcp-required-apis">
                            2.3.1. Required APIs
                        </a>
                    </li><li>
                        <a href="#con-gcp-service-account">
                            2.3.2. Your service account
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#con-gcp-application-deploy">
                            2.4. Application deployment
                        </a><ol>
                <li>
                        <a href="#proc-gcp-deploy-with-new-vpc">
                            2.4.1. Deploying an application with a new VPC
                        </a>
                    </li><li>
                        <a href="#proc-gcp-deploy-with-existing-vpc">
                            2.4.2. Deploying an application with an existing VPC
                        </a>
                    </li><li>
                        <a href="#proc-gcp-retrieve-admin-password">
                            2.4.3. Retrieving the administration password
                        </a>
                    </li><li>
                        <a href="#retrieving_the_controller_and_hub_load_balancer_ip_address">
                            2.4.4. Retrieving the controller and hub load balancer IP address
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#proc-gcp-deploying-extension-nodes">
                            2.5. Deploying an extension node
                        </a>
                    </li><li>
                        <a href="#ref-gcp-networking-options">
                            2.6. Networking options
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#assembly-gcp-networking-access">
                            3. Networking and application access
                        </a><ol>
                <li>
                        <a href="#con-gcp-network-peering-options">
                            3.1. Network peering options
                        </a>
                    </li><li>
                        <a href="#proc-gcp-vpc-peering">
                            3.2. VPC peering
                        </a>
                    </li><li>
                        <a href="#proc-gcp-external-load-balancer">
                            3.3. Using an external load balancer
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#assembly-gcp-additional-configs">
                            4. Additional configurations
                        </a><ol>
                <li>
                        <a href="#proc-gcp-additional-configs-update-admin-password">
                            4.1. Changing the default Ansible Automation Platform administrator password
                        </a>
                    </li><li>
                        <a href="#proc-gcp-secure-communication-SSL">
                            4.2. Securing internal communication with SSL
                        </a>
                    </li><li>
                        <a href="#ref-gcp-security-considerations">
                            4.3. Security considerations
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#aap-command-generator">
                            5. Using the Command Generator
                        </a><ol>
                <li>
                        <a href="#proc-aap-pull-command-container-image">
                            5.1. Pulling the ansible-on-clouds-ops container image
                        </a>
                    </li><li>
                        <a href="#proc-aap-list-available-playbooks">
                            5.2. Listing the available playbooks
                        </a>
                    </li><li>
                        <a href="#proc-aap-generate-command-data-file">
                            5.3. Generating the data file
                        </a>
                    </li><li>
                        <a href="#proc-aap-populate-command-data-file">
                            5.4. Populating the data file
                        </a>
                    </li><li>
                        <a href="#proc-aa-run-generated-command">
                            5.5. Running the generated command
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#assembly-gcp-automation-workloads">
                            6. Automation workloads
                        </a><ol>
                <li>
                        <a href="#ref-gcp-automation-performance">
                            6.1. Automation performance
                        </a>
                    </li><li>
                        <a href="#ref-gcp-deployment-scaling">
                            6.2. Deployment scaling
                        </a>
                    </li><li>
                        <a href="#proc-gcp-extension-nodes">
                            6.3. Purchasing an extension node
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#assembly-gcp-monitoring-logging">
                            7. Monitoring and logging
                        </a><ol>
                <li>
                        <a href="#con-gcp-setup-at-deployment-time">
                            7.1. Setting up monitoring and logging at deployment time
                        </a>
                    </li><li>
                        <a href="#con-gcp-setup-after-deployment">
                            7.2. Setting up monitoring and logging after deployment
                        </a><ol>
                <li>
                        <a href="#con-gcp-use-container-image">
                            7.2.1. Pulling the ansible-on-clouds-ops container image
                        </a>
                    </li><li>
                        <a href="#proc-gcp-generate-variables">
                            7.2.2. Generating data files by running the ansible-on-clouds-ops container
                        </a>
                    </li><li>
                        <a href="#proc-gcp-set-monitoring-logging-yml">
                            7.2.3. Updating the data file
                        </a>
                    </li><li>
                        <a href="#proc-gcp-generate-playbook">
                            7.2.4. Generating the playbook
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#con-gcp-customize-monitoring-logging">
                            7.3. Customizing monitoring and logging
                        </a><ol>
                <li>
                        <a href="#ref-gcp-ansible-podman-config">
                            7.3.1. Ansible and podman configuration
                        </a>
                    </li><li>
                        <a href="#ref-gcp-configure-google-cloud-ops-agent">
                            7.3.2. Google cloud ops agent configuration
                        </a>
                    </li>
            </ol>
                    </li>
            </ol>
                    </li><li>
                        <a href="#assembly-gcp-uninstall">
                            8. Uninstalling Red Hat Ansible Automation Platform from GCP Marketplace
                        </a><ol>
                <li>
                        <a href="#proc-gcp-uninstall-application-uninstall">
                            8.1. Uninstalling the application
                        </a>
                    </li><li>
                        <a href="#proc-gcp-delete-extension-nodes">
                            8.2. Deleting Extension Nodes
                        </a>
                    </li><li>
                        <a href="#proc-gcp-delete-administration-secret">
                            8.3. Deleting the administration secret
                        </a>
                    </li><li>
                        <a href="#proc-gcp-delete-service-account">
                            8.4. Deleting the service account
                        </a>
                    </li><li>
                        <a href="#proc-gcp-delete-upgrade-secrets">
                            8.5. Deleting secrets left over after upgrade, backup and restore
                        </a>
                    </li><li>
                        <a href="#proc-gcp-delete-backup-leftovers">
                            8.6. Deleting the filestore after backup
                        </a>
                    </li><li>
                        <a href="#proc-gcp-delete-object-storage">
                            8.7. Deleting the object storage bucket after backup
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#assembly-aap-gcp-backup-and-recovery">
                            9. Backup and Restore for Ansible Automation Platform from GCP Marketplace
                        </a><ol>
                <li>
                        <a href="#con-gcp-backup-process">
                            9.1. The Backup Process
                        </a><ol>
                <li>
                        <a href="#proc-gcp-upgrade-pull-container-image_backup">
                            9.1.1. Pulling the ansible-on-clouds-ops 2.3 container image
                        </a>
                    </li><li>
                        <a href="#proc-gcp-setup-environment_backup">
                            9.1.2. Setting up the environment
                        </a>
                    </li><li>
                        <a href="#proc-gcp-create-data-file">
                            9.1.3. Creating the backup data file
                        </a>
                    </li><li>
                        <a href="#ref-gcp-populate-backup-file">
                            9.1.4. Parameters in the backup.yml file
                        </a>
                    </li><li>
                        <a href="#proc-gcp-run-backup-playbook">
                            9.1.5. Running the backup playbook
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#con-gcp-restore-process">
                            9.2. Restore Process
                        </a><ol>
                <li>
                        <a href="#proc-gcp-upgrade-pull-container-image_restore">
                            9.2.1. Pulling the ansible-on-clouds-ops 2.3 container image
                        </a>
                    </li><li>
                        <a href="#proc-gcp-setup-environment_restore">
                            9.2.2. Setting up the environment
                        </a>
                    </li><li>
                        <a href="#proc-gcp-generate-restore-yml-file">
                            9.2.3. Generating the restore.yml file
                        </a>
                    </li><li>
                        <a href="#ref-gcp-populate-restore-file">
                            9.2.4. Parameters of the restore.yml file
                        </a>
                    </li><li>
                        <a href="#ref-gcp-run-restore-command">
                            9.2.5. Running the restore command
                        </a>
                    </li>
            </ol>
                    </li>
            </ol>
                    </li><li>
                        <a href="#assembly-gcp-upgrade">
                            10. Upgrading your deployment
                        </a><ol>
                <li>
                        <a href="#con-gcp-upgrade-backup-process">
                            10.1. Backing up before the upgrade
                        </a><ol>
                <li>
                        <a href="#proc-gcp-pull-backup-container-image">
                            10.1.1. Pulling the ansible-on-clouds-ops 2.2 container image
                        </a>
                    </li><li>
                        <a href="#proc-gcp-prepare-backup-environment_backup">
                            10.1.2. Preparing the backup environment
                        </a>
                    </li><li>
                        <a href="#proc-gcp-backup-platform-stack">
                            10.1.3. Backing up your Ansible Automation Platform stack
                        </a>
                    </li><li>
                        <a href="#proc-gcp-run-backup-playbook-as-container">
                            10.1.4. Running the backup playbook as a container
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#con-gcp-upgrade-upgrading">
                            10.2. Upgrading Ansible Automation Platform
                        </a><ol>
                <li>
                        <a href="#proc-gcp-upgrade-pull-container-image">
                            10.2.1. Pulling the ansible-on-clouds-ops 2.3 container image
                        </a>
                    </li><li>
                        <a href="#proc-gcp-generate-upgrade-data-file">
                            10.2.2. Generating the data file
                        </a>
                    </li><li>
                        <a href="#ref-gcp-update-upgrade-data-file">
                            10.2.3. Updating the data file
                        </a>
                    </li><li>
                        <a href="#proc-gcp-running-upgrade">
                            10.2.4. Running the upgrade playbook
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#con-gcp-upgrade-restore-from-stack">
                            10.3. Restoring the stack from backups
                        </a><ol>
                <li>
                        <a href="#proc-gcp-from-stack-pull-container-image">
                            10.3.1. Pulling the ansible-on-clouds-ops 2.2 container image to restore the stack
                        </a>
                    </li><li>
                        <a href="#proc-gcp-prepare-backup-environment_restore">
                            10.3.2. Preparing the backup environment
                        </a>
                    </li><li>
                        <a href="#proc-gcp-run-restore-playbook-as-container">
                            10.3.3. Running the restore playbook as a container
                        </a>
                    </li>
            </ol>
                    </li>
            </ol>
                    </li><li>
                        <a href="#assembly-gcp-tech-notes">
                            11. Technical Notes
                        </a><ol>
                <li>
                        <a href="#tech-note-aws-vm-limitations">
                            11.1. Virtual Machine Limitations
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#assembly-gcp-support">
                            12. Support
                        </a><ol>
                <li>
                        <a href="#ref-gcp-vm-image-packages">
                            12.1. VM Image packages
                        </a>
                    </li><li>
                        <a href="#ref-gcp-supported-changes">
                            12.2. Supported infrastructure configuration changes
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#idm140278426147472">
                            Legal Notice
                        </a>
                    </li>
            </ol>
            
        
      </div>
    </nav>

    
    <div class="pvof-doc__wrapper" id="doc-wrapper">
        <section class="mimir-doc-title" id="mimir-doc--red_hat_ansible_automation_platform_from_gcp_marketplace_guide">
            <h1 class="title">Red Hat Ansible Automation Platform from GCP Marketplace Guide</h1>
        </section>
        <body><div xml:lang="en-US" class="book" id="idm140691881099264"><div class="titlepage"><div><div class="producttitle"><span class="productname">Ansible on Clouds</span> <span class="productnumber">2.3</span></div><div><h2 class="subtitle">Install and configure Red Hat Ansible Automation Platform from GCP Marketplace</h2></div><div><div xml:lang="en-US" class="authorgroup"><span class="orgname">Red Hat Customer Content Services </span></div></div><div><a href="#idm140691889446160">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p>
			Thank you for your interest in Red Hat Ansible Automation Platform from GCP Marketplace. Ansible Automation Platform is a commercial offering that helps teams manage complex multi-tier deployments by adding control, knowledge, and delegation to Ansible-powered environments. This guide helps you to understand the installation and use of Ansible Automation Platform from GCP Marketplace.
		</div></div></div><hr/></div><section class="preface Role ARG Spec" id="making-open-source-more-inclusive"><div class="titlepage"><div><div><h1 class="title">Making open source more inclusive</h1></div></div></div><p class="Role ARG Spec Role ARG Spec">
			Red Hat is committed to replacing problematic language in our code, documentation, and web properties. We are beginning with these four terms: master, slave, blacklist, and whitelist. Because of the enormity of this endeavor, these changes will be implemented gradually over several upcoming releases. For more details, see <a class="link mimir-link-warn" href="https://www.redhat.com/en/blog/making-open-source-more-inclusive-eradicating-problematic-language" title="Mimir does not include content from: www.redhat.com">our CTO Chris Wright’s message</a>.
		</p></section><section class="preface Role ARG Spec" id="providing-feedback"><div class="titlepage"><div><div><h1 class="title">Providing feedback on Red Hat documentation</h1></div></div></div><p class="Role ARG Spec Role ARG Spec">
			If you have a suggestion to improve this documentation, or find an error, please contact technical support at <a class="link" href="/">https://access.redhat.com</a> to create an issue on the Ansible Automation Platform Jira project using the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">docs-product</span></strong></span> component.
		</p><div class="admonition important Role ARG Spec"><div class="admonition_header">Important</div><div><p class="Role ARG Spec Role ARG Spec">
				<span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Disclaimer</span></strong></span>: Links contained in this document to external website(s) are provided for convenience only. Red Hat has not reviewed the links and is not responsible for the content or its availability. The inclusion of any link to an external website does not imply endorsement by Red Hat of the website or their entities, products or services. You agree that Red Hat is not responsible or liable for any loss or expenses that may result due to your use of (or reliance on) the external site or content.
			</p></div></div></section><section class="chapter Role ARG Spec" id="assembly-intro-to-aap-on-gcp"><div class="titlepage"><div><div><h1 class="title">Chapter 1. Introduction to Ansible Automation Platform from GCP Marketplace</h1></div></div></div><p class="Role ARG Spec Role ARG Spec">
			Ansible Automation Platform from GCP Marketplace is an offering that you can deploy from the <a class="link mimir-link-warn" href="https://console.cloud.google.com/marketplace" title="Mimir does not include content from: console.cloud.google.com">GCP Marketplace</a> portal. Ansible Automation Platform from GCP Marketplace provides access to a library of Ansible content collections, and is integrated with key GCP services, so you can start automating the deployment, configuration, and management of infrastructure and applications quickly.
		</p><p class="Role ARG Spec Role ARG Spec">
			The following Red Hat Ansible Automation Platform components are available on Ansible Automation Platform from GCP Marketplace:
		</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem">
					<a class="link mimir-link-warn" href="https://www.ansible.com/products/controller" title="Mimir does not include content from: www.ansible.com">Automation controller</a>
				</li><li class="listitem">
					<a class="link mimir-link-warn" href="https://access.redhat.com/documentation/en-us/red_hat_ansible_automation_platform/2.2/html/getting_started_with_automation_hub/pr01" title="This content is not included in Mimir.">Ansible automation hub</a>
				</li><li class="listitem">
					<a class="link mimir-link-warn" href="https://access.redhat.com/documentation/en-us/red_hat_ansible_automation_platform/2.1/html-single/managing_containers_in_private_automation_hub/index" title="This content is not included in Mimir.">Private automation hub</a>
				</li><li class="listitem">
					<a class="link mimir-link-warn" href="https://access.redhat.com/documentation/en-us/red_hat_ansible_automation_platform/2.2/html-single/publishing_proprietary_content_collections_in_automation_hub/index" title="This content is not included in Mimir.">Ansible Content Collections</a>
				</li><li class="listitem">
					<a class="link mimir-link-warn" href="https://access.redhat.com/documentation/en-us/red_hat_ansible_automation_platform/2.2/html-single/creating_and_consuming_execution_environments/index" title="This content is not included in Mimir.">Automation execution environments</a>
				</li><li class="listitem">
					<a class="link mimir-link-warn" href="https://www.ansible.com/products/automation-platform" title="Mimir does not include content from: www.ansible.com">Ansible content tools, including access to Red Hat Insights for Red Hat Ansible Automation Platform</a>
				</li></ul></div><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
				Automation mesh is not available on Ansible Automation Platform from GCP Marketplace at this time.
			</p></div></div><section class="section Role ARG Spec" id="con-gcp-application-architecture"><div class="titlepage"><div><div><h2 class="title">1.1. Application architecture</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				Red Hat Ansible Automation Platform from GCP Marketplace is installed into infrastructure resources running within your GCP account.
			</p><p class="Role ARG Spec Role ARG Spec">
				There are four virtual machines included in this product listing. Three n2-standard-2 virtual machines make up the permanent compute components of the solution. Additionally, a single ephemeral e2-medium instance is used to run Red Hat Ansible Automation Platform and Google Cloud deployment workloads. This virtual machine is only used during deployment and then is permanently removed from the solution. The infrastructure cost for the ephemeral VM is charged at the hourly rate during the period that the VM exists, usually less than an hour.
			</p><section class="section Role ARG Spec" id="gcp_infrastructure"><div class="titlepage"><div><div><h3 class="title">1.1.1. GCP infrastructure</h3></div></div></div><div class="informalfigure"><div class="mediaobject"><img src="/webassets/avalon/d/Ansible_on_Clouds-2.3-Red_Hat_Ansible_Automation_Platform_from_GCP_Marketplace_Guide-en-US/images/76d3e4160cf2ac5abcf9d4af964f9705/aap-on-gcp-architecture.png" alt="GCP application architecture" /></div></div></section><section class="section Role ARG Spec" id="architecture_description"><div class="titlepage"><div><div><h3 class="title">1.1.2. Architecture Description</h3></div></div></div><p class="Role ARG Spec Role ARG Spec">
					Ansible Automation Platform from GCP Marketplace was designed to be private, with no public ingress enabled by default. This requires customers to connect existing GCP infrastructure to Ansible Automation Platform infrastructure manually. Ansible Automation Platform components that are deployed are isolated into their own VPC. Applications then run on instances managed by an instance group, which run on RHEL-based Google Compute machine images. These machine images are preloaded with required container images to run Ansible Automation Platform including automation hub, automation controller, and receptor rpm/container components. A shared Google Filestore volume is mounted into each instance deployed by the instance group manager.
				</p><p class="Role ARG Spec Role ARG Spec">
					All GCP Compute instances have private IP addresses by default. The Ansible Automation Platform applications are run in containers managed through podman on the instances. This podman configuration is itself managed by systemd. SELinux is enabled on GCP Compute instances and is supported down to the container level. Each automation controller instance is configured as an Ansible Automation Platform hybrid node by default to simplify the scale up and out procedures.
				</p><p class="Role ARG Spec Role ARG Spec">
					You cannot restart virtual machines, instead virtual machines must be replaced. You cannot configure on virtual machines, because any configuration is lost when virtual machines are replaced. This always happens on upgrade.
				</p></section><section class="section Role ARG Spec" id="service_descriptions"><div class="titlepage"><div><div><h3 class="title">1.1.3. Service descriptions</h3></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows Role ARG Spec"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140691889487888" scope="col">Service Name</th><th align="left" valign="top" id="idm140691889486800" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140691889487888"> <p>
									Compute Engine
								</p>
								 </td><td align="left" valign="top" headers="idm140691889486800"> <p>
									GCP VM compute platform
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140691889487888"> <p>
									Cloud SQL
								</p>
								 </td><td align="left" valign="top" headers="idm140691889486800"> <p>
									GCP database service
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140691889487888"> <p>
									Filestore
								</p>
								 </td><td align="left" valign="top" headers="idm140691889486800"> <p>
									GCP file storage service
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140691889487888"> <p>
									Virtual Private Cloud (VPC)
								</p>
								 </td><td align="left" valign="top" headers="idm140691889486800"> <p>
									GCP networking service
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140691889487888"> <p>
									Cloud Monitoring
								</p>
								 </td><td align="left" valign="top" headers="idm140691889486800"> <p>
									GCP metrics collector
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140691889487888"> <p>
									Cloud Logging
								</p>
								 </td><td align="left" valign="top" headers="idm140691889486800"> <p>
									GCP log management Service
								</p>
								 </td></tr></tbody></table></div></section></section></section><section class="chapter Role ARG Spec" id="assembly-gcp-install"><div class="titlepage"><div><div><h1 class="title">Chapter 2. Installing Red Hat Ansible Automation Platform from GCP Marketplace</h1></div></div></div><section class="section Role ARG Spec" id="ref-gcp-install-prerequisites"><div class="titlepage"><div><div><h2 class="title">2.1. Prerequisites</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				Before you can install and register Ansible Automation Platform, you must be familiar with GCP including how services operate, how data is stored, and any privacy implications that may exist by using these services. You must also set up an account with <span class="emphasis"><em><span class="Role ARG Spec Role ARG Spec">Google Cloud Platform</span></em></span> (GCP).
			</p><p class="Role ARG Spec Role ARG Spec">
				You must have a working knowledge of the following aspects of Google Cloud Platform:
			</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem">
						Deploying solutions from the GCP Marketplace
					</li><li class="listitem">
						Compute engine <span class="emphasis"><em><span class="Role ARG Spec Role ARG Spec">Virtual machine</span></em></span> (VM) instances
					</li><li class="listitem">
						Cloud SQL for PostgreSQL
					</li><li class="listitem">
						Filestore
					</li><li class="listitem"><p class="simpara">
						GPC <span class="emphasis"><em><span class="Role ARG Spec Role ARG Spec">Virtual Private Clouds</span></em></span> (VPCs)
					</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="circle"><li class="listitem">
								Subnets
							</li><li class="listitem">
								Route Tables
							</li><li class="listitem">
								Load Balancers
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Network Design
					</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="circle"><li class="listitem">
								Hub-and-spoke networking designs
							</li><li class="listitem">
								VPC Peering
							</li><li class="listitem">
								<span class="emphasis"><em><span class="Role ARG Spec Role ARG Spec">Class Inter-Domain Routing</span></em></span> (CIDR) blocks
							</li><li class="listitem">
								Transit routing
							</li></ul></div></li><li class="listitem"><p class="simpara">
						GCP Cloud monitoring
					</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="circle"><li class="listitem">
								GCP Ops agent
							</li></ul></div></li><li class="listitem">
						SSH
					</li></ul></div><p class="Role ARG Spec Role ARG Spec">
				For more information about Google Cloud Platform and terminology, see the <a class="link mimir-link-warn" href="https://cloud.google.com//" title="Mimir does not include content from: cloud.google.com">GCP product documentation</a>.
			</p></section><section class="section Role ARG Spec" id="ref-gcp-install-permissions"><div class="titlepage"><div><div><h2 class="title">2.2. Permissions</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				Your GCP account must have the following permissions to successfully create an Ansible Automation Platform deployment on <span class="emphasis"><em><span class="Role ARG Spec Role ARG Spec">Google Cloud Platform</span></em></span>.
			</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem"><p class="simpara">
						Cloud SQL Permissions
					</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="circle"><li class="listitem">
								cloudsql.databases.create
							</li><li class="listitem">
								cloudsql.databases.delete
							</li><li class="listitem">
								cloudsql.databases.get
							</li><li class="listitem">
								cloudsql.databases.list
							</li><li class="listitem">
								cloudsql.instances.connect
							</li><li class="listitem">
								cloudsql.instances.create
							</li><li class="listitem">
								cloudsql.instances.delete
							</li><li class="listitem">
								cloudsql.instances.get
							</li><li class="listitem">
								cloudsql.instances.list
							</li><li class="listitem">
								cloudsql.instances.login
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Compute Permissions
					</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="circle"><li class="listitem">
								compute.addresses.create
							</li><li class="listitem">
								compute.addresses.get
							</li><li class="listitem">
								compute.addresses.list
							</li><li class="listitem">
								compute.addresses.use
							</li><li class="listitem">
								compute.forwardingRules.create
							</li><li class="listitem">
								compute.forwardingRules.get
							</li><li class="listitem">
								compute.globalAddresses.get
							</li><li class="listitem">
								compute.globalOperations.get
							</li><li class="listitem">
								compute.instances.delete
							</li><li class="listitem">
								compute.instances.get
							</li><li class="listitem">
								compute.instances.getGuestAttributes
							</li><li class="listitem">
								compute.instances.list
							</li><li class="listitem">
								compute.projects.get
							</li><li class="listitem">
								compute.projects.setCommonInstanceMetadata
							</li><li class="listitem">
								compute.regionBackendServices.create
							</li><li class="listitem">
								compute.regionBackendServices.get
							</li><li class="listitem">
								compute.regionBackendServices.update
							</li><li class="listitem">
								compute.regionBackendServices.use
							</li><li class="listitem">
								compute.regionHealthChecks.create
							</li><li class="listitem">
								compute.regionHealthChecks.get
							</li><li class="listitem">
								compute.regionHealthChecks.useReadOnly
							</li><li class="listitem">
								compute.regionOperations.get
							</li><li class="listitem">
								compute.regionTargetHttpProxies.create
							</li><li class="listitem">
								compute.regionTargetHttpProxies.get
							</li><li class="listitem">
								compute.regionTargetHttpProxies.use
							</li><li class="listitem">
								compute.regionUrlMaps.create
							</li><li class="listitem">
								compute.regionUrlMaps.get
							</li><li class="listitem">
								compute.regionUrlMaps.use
							</li><li class="listitem">
								compute.regions.list
							</li><li class="listitem">
								compute.zoneOperations.get
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Deployment Manager Permissions
					</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="circle"><li class="listitem">
								deploymentmanager.deployments.create
							</li><li class="listitem">
								deploymentmanager.deployments.delete
							</li><li class="listitem">
								deploymentmanager.deployments.get
							</li><li class="listitem">
								deploymentmanager.deployments.list
							</li><li class="listitem">
								deploymentmanager.manifests.get
							</li><li class="listitem">
								deploymentmanager.operations.get
							</li><li class="listitem">
								deploymentmanager.resources.list
							</li></ul></div></li><li class="listitem"><p class="simpara">
						IAM Permissions
					</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="circle"><li class="listitem">
								iam.serviceAccounts.actAs
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Logging Permissions:
					</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="circle"><li class="listitem">
								logging.logEntries.create
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Monitoring Permissions:
					</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="circle"><li class="listitem">
								monitoring.metricDescriptors.get
							</li><li class="listitem">
								monitoring.timeSeries.create
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Resource Manager Permissions
					</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="circle"><li class="listitem">
								resourcemanager.projects.get
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Runtime Configurator Permissions
					</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="circle"><li class="listitem">
								runtimeconfig.configs.list
							</li><li class="listitem">
								runtimeconfig.variables.create
							</li><li class="listitem">
								runtimeconfig.variables.get
							</li><li class="listitem">
								runtimeconfig.variables.list
							</li><li class="listitem">
								runtimeconfig.variables.update
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Secret Manager Permissions
					</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="circle"><li class="listitem">
								secretmanager.secrets.create
							</li><li class="listitem">
								secretmanager.secrets.delete
							</li><li class="listitem">
								secretmanager.secrets.get
							</li><li class="listitem">
								secretmanager.secrets.list
							</li><li class="listitem">
								secretmanager.versions.access
							</li><li class="listitem">
								secretmanager.versions.add
							</li><li class="listitem">
								secretmanager.versions.destroy
							</li><li class="listitem">
								secretmanager.versions.disable
							</li><li class="listitem">
								secretmanager.versions.get
							</li><li class="listitem">
								secretmanager.versions.list
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Service Networking Permissions
					</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="circle"><li class="listitem">
								servicenetworking.operations.get
							</li><li class="listitem">
								servicenetworking.services.addPeering
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Service Usage Permissions
					</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="circle"><li class="listitem">
								serviceusage.services.list
							</li></ul></div></li></ul></div></section><section class="section Role ARG Spec" id="con-gcp-create-project"><div class="titlepage"><div><div><h2 class="title">2.3. Create a project</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				To install Ansible Automation Platform, you must create a project in your Google Cloud Platform account to host the application if you do not already have one. See <a class="link mimir-link-warn" href="https://cloud.google.com/resource-manager/docs/creating-managing-projects" title="Mimir does not include content from: cloud.google.com">Creating and managing projects</a> in the GCP documentation.
			</p><section class="section Role ARG Spec" id="con-gcp-required-apis"><div class="titlepage"><div><div><h3 class="title">2.3.1. Required APIs</h3></div></div></div><p class="Role ARG Spec Role ARG Spec">
					Your Google Cloud Platform (GCP) project requires access to several API services to complete Ansible Automation Platform installation. On marketplace deployment, the process automatically attempts to enable the following APIs.
				</p><p class="Role ARG Spec Role ARG Spec">
					If you prefer, you can enable the APIs ahead of time to ensure they are permitted by your organization.
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows Role ARG Spec"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140691889452240" scope="col">API Service</th><th align="left" valign="top" id="idm140691889451152" scope="col">Console service name</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140691889452240"> <p>
									Compute Engine API
								</p>
								 </td><td align="left" valign="top" headers="idm140691889451152"> <p>
									<code class="literal Role ARG Spec">compute.googleapis.com</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140691889452240"> <p>
									Google Cloud APIs
								</p>
								 </td><td align="left" valign="top" headers="idm140691889451152"> <p>
									<code class="literal Role ARG Spec">cloudapis.googleapis.com</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140691889452240"> <p>
									Identity and Access Management (IAM) API
								</p>
								 </td><td align="left" valign="top" headers="idm140691889451152"> <p>
									<code class="literal Role ARG Spec">iam.googleapis.com</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140691889452240"> <p>
									Cloud SQL Admin API
								</p>
								 </td><td align="left" valign="top" headers="idm140691889451152"> <p>
									<code class="literal Role ARG Spec">sql-component.googleapis.com</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140691889452240"> <p>
									Cloud Logging API
								</p>
								 </td><td align="left" valign="top" headers="idm140691889451152"> <p>
									<code class="literal Role ARG Spec">logging.googleapis.com</code>
								</p>
								 <p>
									See <a class="link" href="#assembly-gcp-monitoring-logging" title="Chapter 7. Monitoring and logging">Monitoring and logging</a>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140691889452240"> <p>
									Cloud Monitoring API
								</p>
								 </td><td align="left" valign="top" headers="idm140691889451152"> <p>
									<code class="literal Role ARG Spec">monitoring.googleapis.com</code>
								</p>
								 <p>
									See <a class="link" href="#assembly-gcp-monitoring-logging" title="Chapter 7. Monitoring and logging">Monitoring and logging</a>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140691889452240"> <p>
									Cloud Resource Manager API
								</p>
								 </td><td align="left" valign="top" headers="idm140691889451152"> <p>
									<code class="literal Role ARG Spec">cloudresourcemanager.googleapis.com</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140691889452240"> <p>
									Cloud Identity-Aware Proxy API
								</p>
								 </td><td align="left" valign="top" headers="idm140691889451152"> <p>
									<code class="literal Role ARG Spec">iap.googleapis.com</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140691889452240"> <p>
									Secret Manager API
								</p>
								 </td><td align="left" valign="top" headers="idm140691889451152"> <p>
									<code class="literal Role ARG Spec">secretmanager.googleapis.com</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140691889452240"> <p>
									Service Networking API
								</p>
								 </td><td align="left" valign="top" headers="idm140691889451152"> <p>
									<code class="literal Role ARG Spec">servicenetworking.googleapis.com</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140691889452240"> <p>
									Service Usage API
								</p>
								 </td><td align="left" valign="top" headers="idm140691889451152"> <p>
									<code class="literal Role ARG Spec">serviceusage.googleapis.com</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140691889452240"> <p>
									OS Config API
								</p>
								 </td><td align="left" valign="top" headers="idm140691889451152"> <p>
									<code class="literal Role ARG Spec">osconfig.googleapis.com</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140691889452240"> <p>
									Cloud Runtime Configuration API
								</p>
								 </td><td align="left" valign="top" headers="idm140691889451152"> <p>
									<code class="literal Role ARG Spec">runtimeconfig.googleapis.com</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140691889452240"> <p>
									Cloud Filestore API
								</p>
								 </td><td align="left" valign="top" headers="idm140691889451152"> <p>
									<code class="literal Role ARG Spec">file.googleapis.com</code>
								</p>
								 </td></tr></tbody></table></div></section><section class="section Role ARG Spec" id="con-gcp-service-account"><div class="titlepage"><div><div><h3 class="title">2.3.2. Your service account</h3></div></div></div><p class="Role ARG Spec Role ARG Spec">
					You must have a service account to set up Ansible Automation Platform from GCP Marketplace. This account is used to install and configure the application and remains associated with the Ansible Automation Platform virtual machines. You can use an existing service account with the required roles, or the Ansible Automation Platform deployment can create one with the required roles on your behalf. If you use an existing account, or <a class="link mimir-link-warn" href="https://cloud.google.com/iam/docs/creating-managing-service-accounts#creating" title="Mimir does not include content from: cloud.google.com">create a service account</a> in advance, it must have the following roles:
				</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem">
							Editor
						</li><li class="listitem">
							Logs Writer
						</li><li class="listitem">
							Cloud SQL Client
						</li><li class="listitem">
							Cloud SQL Instance User
						</li><li class="listitem">
							Secret Manager Secret Accessor
						</li><li class="listitem">
							Compute Network Admin
						</li></ul></div><p class="Role ARG Spec Role ARG Spec">
					See <a class="link mimir-link-warn" href="https://cloud.google.com/iam/docs/granting-changing-revoking-access#single-role" title="Mimir does not include content from: cloud.google.com">Grant a single role</a> for steps to add the required roles to your existing service account.
				</p><p class="Role ARG Spec Role ARG Spec">
					The Compute Network Administrator role is only required at the time of deployment to configure the application properly. When installation and configuration are complete, this role can be removed from the service account, which remains configured on the Ansible Automation Platform Virtual Machines.
				</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
						The secrets created during the deployment must be able to use the automatic replication policy. The user specified replication policy is not supported and must be disabled during deployment, backup or upgrade.
					</p></div></div></section></section><section class="section Role ARG Spec" id="con-gcp-application-deploy"><div class="titlepage"><div><div><h2 class="title">2.4. Application deployment</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				To launch your offer on the Google Cloud Console, navigate to the marketplace and search for <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Red Hat Ansible Automation Platform 2 - Up to 100 Managed Nodes</span></strong></span>. After selecting this offer click <span class="guibutton">Launch</span>.
			</p><p class="Role ARG Spec Role ARG Spec">
				There are four virtual machines included in this product listing. Three n2-standard-2 virtual machines make up the permanent compute components of the solution. Additionally, a single ephemeral e2-medium instance is used to run Red Hat Ansible Automation Platform and Google Cloud deployment workloads. This virtual machine is only used during deployment and then is permanently removed from the solution. The infrastructure cost for the ephemeral VM is charged at the hourly rate during the period that the VM exists, usually less than an hour.
			</p><div class="admonition important Role ARG Spec"><div class="admonition_header">Important</div><div><p class="Role ARG Spec Role ARG Spec">
					A temporary yet necessary constraint has been placed on the length of deployment names. This is due to GCP’s naming scheme for internal components that make up an Ansible Automation Platform deployment. Component names based on this naming scheme can get too long and often break naming constraints imposed by other services, creating deployment errors.
				</p><p class="Role ARG Spec Role ARG Spec">
					The length of the name of your deployment, plus the length of your GCP project name must be less than 35 characters and the length of the deployment name must be less than 30 characters.
				</p><p class="Role ARG Spec Role ARG Spec">
					The calculation below will help you find the maximum length of the name of an Ansible Automation Platform deployment in your project.
				</p><p class="Role ARG Spec Role ARG Spec">
					length of deployment name &lt; = (minimum between 30 and 35) - length(gcp project name)
				</p></div></div><p class="Role ARG Spec Role ARG Spec">
				There are two methods for deploying the application:
			</p><section class="section Role ARG Spec" id="proc-gcp-deploy-with-new-vpc"><div class="titlepage"><div><div><h3 class="title">2.4.1. Deploying an application with a new VPC</h3></div></div></div><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
						The process of deploying the application using a new VPC has been deprecated, and the functionality will be removed from Ansible Automation Platform from GCP Marketplace in a future release.
					</p></div></div><p class="Role ARG Spec Role ARG Spec">
					This procedure creates a new VPC network and deploys the application in the created VPC.
				</p><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem">
							In the Deployment page, select the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Service Usage API</span></strong></span> link below the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Confirm Service Usage API is enabled</span></strong></span> checkbox.
						</li><li class="listitem">
							In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">API/Service Details</span></strong></span> tab, ensure that the API is enabled, then return to the Deployment page.
						</li><li class="listitem">
							Check the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Confirm Service Usage API</span></strong></span> is enabled checkbox.
						</li><li class="listitem">
							Select or create a <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Service Account</span></strong></span>. For further information see <a class="link" href="/documentation/en-us/ansible_on_clouds/2.x/html-single/red_hat_ansible_automation_platform_from_gcp_marketplace_guide/index/#con-gcp-service-account">Your service account</a>.
						</li><li class="listitem">
							In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Region</span></strong></span> field, select the region where you want the application deployed.
						</li><li class="listitem">
							In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Zone</span></strong></span> field, select the zone where you want the Filestore deployed. The zone must be in the Region you selected.
						</li><li class="listitem">
							In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Observability</span></strong></span> section, you can enable logging and metrics to be sent to Cloud Logging and Cloud Monitoring. See <a class="link mimir-link-warn" href="https://cloud.google.com/stackdriver/pricing" title="Mimir does not include content from: cloud.google.com">Operations Suite Pricing</a> for the financial cost of enabling these services. See See <a class="link" href="#assembly-gcp-monitoring-logging" title="Chapter 7. Monitoring and logging">Monitoring and logging</a> for more information on configuring this feature.
						</li><li class="listitem">
							In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Network Selection</span></strong></span> section, select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">New network</span></strong></span>. The Networking section provides defaults for all of the network ranges used in the deployment. If you want to modify these values, see <a class="link" href="#ref-gcp-networking-options" title="2.6. Networking options">Networking Options</a>.
						</li><li class="listitem">
							Click <span class="guibutton">DEPLOY</span>.
						</li><li class="listitem">
							The Deployment Manager displays the running deployment.
						</li><li class="listitem">
							The application begins provisioning. It can take some time for the infrastructure and application to fully provision.
						</li></ol></div><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
						You will see a warning on the deployment
					</p><pre class="screen Role ARG Spec Role ARG Spec">This deployment has resources from the Runtime Configurator service, which is in Beta</pre><p class="Role ARG Spec Role ARG Spec">
						This warning is expected and is not a cause for concern.
					</p></div></div></section><section class="section Role ARG Spec" id="proc-gcp-deploy-with-existing-vpc"><div class="titlepage"><div><div><h3 class="title">2.4.2. Deploying an application with an existing VPC</h3></div></div></div><p class="Role ARG Spec Role ARG Spec">
					The following procedure uses an existing VPC network to deploy an application.
				</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
						The existing proxy subnet must be of type <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Regional Managed Proxy</span></strong></span>, which is the reserved proxy-only subnet for load balancing.
					</p></div></div><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem">
							In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Deployment</span></strong></span> page, select the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Service Usage API</span></strong></span> link below the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Confirm Service Usage API is enabled</span></strong></span> checkbox.
						</li><li class="listitem">
							In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">API/Service Details</span></strong></span> tab, ensure that the API is enabled, then return to the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Deployment</span></strong></span> page.
						</li><li class="listitem">
							Check the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Confirm Service Usage API</span></strong></span> is enabled checkbox.
						</li><li class="listitem">
							Select or create a <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Service Account</span></strong></span>. For further information, see <a class="link" href="#con-gcp-service-account" title="2.3.2. Your service account">Your service account</a>.
						</li><li class="listitem">
							In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Region</span></strong></span> field, select the region where you want the application deployed.
						</li><li class="listitem">
							In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Zone</span></strong></span> field, select the zone where you want the Filestore deployed. The zone must be in the Region you selected.
						</li><li class="listitem">
							In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Observability</span></strong></span> section, you can enable logging and metrics to be sent to Cloud Logging and Cloud Monitoring. See <a class="link mimir-link-warn" href="https://cloud.google.com/stackdriver/pricing" title="Mimir does not include content from: cloud.google.com">Operations Suite Pricing</a> for the financial cost of enabling these services. See <a class="link" href="#assembly-gcp-monitoring-logging" title="Chapter 7. Monitoring and logging">Monitoring and logging</a> for more information on configuring this feature.
						</li><li class="listitem">
							In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Network Selection</span></strong></span> section, select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Existing network</span></strong></span>.
						</li><li class="listitem">
							In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Existing Network</span></strong></span> section, provide your existing VPC network name, existing subnet name and existing proxy subnet name. Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">cloud NAT router</span></strong></span> to create a <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">NAT router</span></strong></span> in your VPC network.
						</li><li class="listitem">
							The <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Networking section</span></strong></span> provides defaults for all of the network ranges used in the deployment. Provide these values based on your existing network configuration. If you want to modify these values, see <a class="link" href="#ref-gcp-networking-options" title="2.6. Networking options">Networking Options</a>
						</li><li class="listitem">
							Click <span class="guibutton">DEPLOY</span>.
						</li><li class="listitem">
							The <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Deployment Manager</span></strong></span> displays the running deployment.
						</li><li class="listitem"><p class="simpara">
							The application begins provisioning. It can take some time for the infrastructure and application to fully provision.
						</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
								You will see a warning on the deployment.
							</p><pre class="screen Role ARG Spec Role ARG Spec">This deployment has resources from the Runtime Configurator service, which is in Beta.</pre><p class="Role ARG Spec Role ARG Spec">
								This warning is expected and is not a cause for concern.
							</p></div></div></li></ol></div></section><section class="section Role ARG Spec" id="proc-gcp-retrieve-admin-password"><div class="titlepage"><div><div><h3 class="title">2.4.3. Retrieving the administration password</h3></div></div></div><p class="Role ARG Spec Role ARG Spec">
					Use the following procedure to retrieve the administration password.
				</p><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem">
							In the GCP UI, select the main menu from the top left.
						</li><li class="listitem">
							Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Security</span></strong></span>. If you do not see <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Security</span></strong></span>, select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">View All Products</span></strong></span>.
						</li><li class="listitem">
							Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Secret Manager</span></strong></span>.
						</li><li class="listitem">
							Filter with the name of the deployment. The secret name format is <code class="literal Role ARG Spec">&lt;DeploymentName&gt;-aap-admin</code>.
						</li><li class="listitem">
							Click on the secret name of the deployment
						</li><li class="listitem">
							Click the <span class="guibutton">More Actions</span> icon *⋮ on the line of the deployment.
						</li><li class="listitem">
							Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">View secret value</span></strong></span>. The administration password is displayed
						</li></ol></div></section><section class="section Role ARG Spec" id="retrieving_the_controller_and_hub_load_balancer_ip_address"><div class="titlepage"><div><div><h3 class="title">2.4.4. Retrieving the controller and hub load balancer IP address</h3></div></div></div><p class="Role ARG Spec Role ARG Spec">
					Use the following procedure to retrieve the controller and hub IP address.
				</p><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem">
							In the GCP UI, select the main menu from the top left.
						</li><li class="listitem">
							Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Deployment Manager</span></strong></span>.
						</li><li class="listitem">
							Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Deployment</span></strong></span>.
						</li><li class="listitem">
							Select the deployment name.
						</li><li class="listitem">
							Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">View Details</span></strong></span>.
						</li><li class="listitem">
							In the right pane, under <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Deployment properties</span></strong></span>, find the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Layout</span></strong></span> line
						</li><li class="listitem">
							Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">View</span></strong></span>. The <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">outputs:</span></strong></span> section shows the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">finalValue</span></strong></span> for the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">name</span></strong></span> controllerIp and hubIp.
						</li></ol></div></section></section><section class="section Role ARG Spec" id="proc-gcp-deploying-extension-nodes"><div class="titlepage"><div><div><h2 class="title">2.5. Deploying an extension node</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				You configure extension nodes after you have purchased and launched an extension from the public or private offer.
			</p><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem">
						In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Deployment name</span></strong></span> field, enter a sufficiently short name as described in <a class="link" href="#con-gcp-application-deploy" title="2.4. Application deployment">Application deployment</a>.
					</li><li class="listitem">
						For the Service Account, select the service account used with your Red Hat Ansible Automation Platform with up to 100 Managed Nodes deployment.
					</li><li class="listitem">
						In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Region</span></strong></span> field, select the region where you want the application deployed.
					</li><li class="listitem">
						In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Zone</span></strong></span> field, select a zone in the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Region</span></strong></span> you selected when deploying your foundational offer. This field is only used to filter the Network list.
					</li><li class="listitem">
						In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Main Deployment Name</span></strong></span> field, enter the foundation deployment name for which you are deploying an extension.
					</li><li class="listitem">
						In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Networking</span></strong></span> section, expand the default option.
					</li><li class="listitem">
						In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Network</span></strong></span> field, select the existing foundation network ending with <code class="literal Role ARG Spec">-aap-net</code>.
					</li><li class="listitem"><p class="simpara">
						In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Subnetwork</span></strong></span> field, select the existing foundation subnetwork ending with <code class="literal Role ARG Spec">-aap-subnet</code>.
					</p><div class="admonition important Role ARG Spec"><div class="admonition_header">Important</div><div><p class="Role ARG Spec Role ARG Spec">
							Do not select the subnet ending with <code class="literal Role ARG Spec">-aap-prxy-subnet</code>.
						</p></div></div></li><li class="listitem">
						Ensure <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Extend Ansible Automation Platform deployment in selected VPC</span></strong></span> is checked.
					</li><li class="listitem">
						Click <span class="guibutton">DEPLOY</span>.
					</li><li class="listitem">
						The Deployment Manager displays the running deployment.
					</li></ol></div><p class="Role ARG Spec Role ARG Spec">
				The extension begins provisioning.
			</p><p class="Role ARG Spec Role ARG Spec">
				It can take some time for the infrastructure and extension to fully provision.
			</p></section><section class="section Role ARG Spec" id="ref-gcp-networking-options"><div class="titlepage"><div><div><h2 class="title">2.6. Networking options</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				The network topology of Ansible Automation Platform from GCP Marketplace includes several configurable network segments that can be changed to fit into your organization’s network requirements.
			</p><p class="Role ARG Spec Role ARG Spec">
				The deployment creates a new VPC and subnet that are not accessible from the public internet, or by using an existing VPC network. You must provide access to the application as described in <a class="link" href="#assembly-gcp-networking-access" title="Chapter 3. Networking and application access">Networking and Application Access</a>.
			</p><p class="Role ARG Spec Role ARG Spec">
				Consider your existing network configurations when specifying the following network ranges below. Ensure that each range does not overlap with any other specified here, and does not overlap with existing ranges in your network. Each range should exist within a private network class.
			</p><div class="Role ARG Spec Role ARG Spec"><p class="title"><strong><span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Application Subnet Range</span></strong></span></strong></p><p>
					The network CIDR defining the subnet range used by the custom VPC deployed by the offering. Must be a minimum <code class="literal Role ARG Spec">/24</code> segment and must be in the private network range (192.168 or 10.0).
				</p></div><p class="Role ARG Spec Role ARG Spec">
				Default: 192.168.240.0/24
			</p><div class="Role ARG Spec Role ARG Spec"><p class="title"><strong><span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Cloud SQL Peering Network Range</span></strong></span></strong></p><p>
					The network CIDR defines the network segment used to peer the GCP CloudSQL network with the application subnet deployed by the offering. Must be a <code class="literal Role ARG Spec">/24</code> segment. The <code class="literal Role ARG Spec">/24</code> segment range is a requirement of GCP CloudSQL network peering configuration.
				</p></div><p class="Role ARG Spec Role ARG Spec">
				Default: 192.168.241.0/24
			</p><div class="Role ARG Spec Role ARG Spec"><p class="title"><strong><span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Filestore Peering Network Range</span></strong></span></strong></p><p>
					Ansible Automation Platform from GCP Marketplace uses GCP Filestore service to share configuration files between multiple automation controller and automation hub VMs provisioned as part of the deployment. This network CIDR range defines the peer network that is used by the offering to peer between the GCP Filestore network and the custom VPC application subnet of the offering. Must be a minimum <code class="literal Role ARG Spec">/29</code> segment.
				</p></div><p class="Role ARG Spec Role ARG Spec">
				Default: 192.168.243.0/29
			</p><div class="Role ARG Spec Role ARG Spec"><p class="title"><strong><span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Load Balancer Proxy Subnet Range</span></strong></span></strong></p><p>
					Ansible Automation Platform from GCP Marketplace is deployed using GCP’s native cloud capabilities to provide a scalable and reliable installation. As part of the Ansible Automation Platform from GCP Marketplace deployment topology two load balancers are deployed in front of the automation hub and automation controller VMs. All traffic is directed at these load balancers and is proxied to the available backend VMs. The deployment takes advantage of GCP’s native load balancing support enabling the customer to add additional ports (https) to the load balancers to capture and forward requests onto the backend VMs. This also provides request balancing and session tracking for better reliability. As part of the load balancer deployment, GCP requires creation of a special proxy network where GCP natively handles the redirection of requests to the backend VMs. This special proxy network is not used within Ansible Automation Platform from GCP Marketplace for any other purpose than GCP’s load balancer’s proxy network requirement. A <code class="literal Role ARG Spec">/24</code> segment is required.
				</p></div><p class="Role ARG Spec Role ARG Spec">
				Default: 192.168.242.0/24
			</p><div class="Role ARG Spec Role ARG Spec"><p class="title"><strong><span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Controller Internal Load Balancer IP Address</span></strong></span></strong></p><p>
					This is the static IP Address assigned to the automation controller Load Balancer. This address must be within the Application Subnet Range segment.
				</p></div><p class="Role ARG Spec Role ARG Spec">
				Default: 192.168.240.20
			</p><div class="Role ARG Spec Role ARG Spec"><p class="title"><strong><span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Hub Internal Load Balancer IP Address</span></strong></span></strong></p><p>
					This is the static IP Address assigned to the automation hub Load Balancer. This address must be within the Application Subnet Range segment.
				</p></div><p class="Role ARG Spec Role ARG Spec">
				Default: 192.168.240.21
			</p></section></section><section class="chapter Role ARG Spec" id="assembly-gcp-networking-access"><div class="titlepage"><div><div><h1 class="title">Chapter 3. Networking and application access</h1></div></div></div><p class="Role ARG Spec Role ARG Spec">
			When Ansible Automation Platform from GCP Marketplace is deployed, it is installed into an isolated VPC and cannot be accessed. The following instructions describe how to connect the VPC used by Ansible Automation Platform from GCP Marketplace to your existing GCP network. When connected, you must determine how your users connect to Ansible Automation Platform.
		</p><p class="Role ARG Spec Role ARG Spec">
			There are many ways to enable this connectivity such as VPNs, Google Cloud Interconnect, or bastion servers for private network access. You can also expose the platform with public internet access using GCP services such as a Load Balancer.
		</p><p class="Role ARG Spec Role ARG Spec">
			How your organization configures application access on GCP is outside the scope of Red Hat’s guidelines and support for Ansible Automation Platform from GCP Marketplace. For further information, see <a class="link mimir-link-warn" href="https://cloud.google.com/solutions/connecting-securely#external" title="Mimir does not include content from: cloud.google.com">Securely connecting to VMs</a> for guidelines on these topics.
		</p><section class="section Role ARG Spec" id="con-gcp-network-peering-options"><div class="titlepage"><div><div><h2 class="title">3.1. Network peering options</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				Many networking configurations to access the platform are possible, but the following configurations have been validated to work with Ansible Automation Platform from GCP Marketplace.
			</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
					While every effort has been made to align with Google Cloud Platform’s documentation for this content, there may be a drift in accuracy over time. Use <a class="link mimir-link-warn" href="https://cloud.google.com/vpc/docs/vpc-peering" title="Mimir does not include content from: cloud.google.com">GCP documentation</a> as the source of information regarding networking topics for GCP.
				</p></div></div></section><section class="section Role ARG Spec" id="proc-gcp-vpc-peering"><div class="titlepage"><div><div><h2 class="title">3.2. VPC peering</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				<a class="link mimir-link-warn" href="https://cloud.google.com/vpc/docs/vpc-peering" title="Mimir does not include content from: cloud.google.com">VPC Peering</a> is required for Ansible Automation Platform to access resources that reside on private VPCs or where transit routing between Google Cloud Platform and your on-premises network(s) exists. It offers the ability to directly connect different networks within your GCP infrastructure. VPCs are individually connected to one another with no other routing hops between them. VPC deployments omit access from the public internet by default.
			</p><p class="Role ARG Spec Role ARG Spec">
				This is also the deployment model for the GCP architecture used by Ansible Automation Platform from GCP Marketplace.
			</p><p class="Role ARG Spec Role ARG Spec">
				This is a simple peering model and is useful when connecting several networks.
			</p><p class="Role ARG Spec Role ARG Spec">
				Complex peering can be configured, but routing can become more complex over time.
			</p><p class="Role ARG Spec Role ARG Spec">
				When VPC peering and routing are configured, you can access Ansible Automation Platform through a VM on a connected VPC subnet, or directly if your organization has a transit routing setup between GCP and your local networks.
			</p><p class="Role ARG Spec Role ARG Spec">
				When two or more networks are peered, <a class="link mimir-link-warn" href="https://cloud.google.com/vpc/docs/vpc-peering#key_properties" title="Mimir does not include content from: cloud.google.com">Google performs automated actions</a> to assist with routing, but can perform routable updates to enable taffic flow within your GCP infrastructure.
			</p><div class="Role ARG Spec Role ARG Spec"><p class="title"><strong>Prerequisites</strong></p><p>
					Before using VPC peering to connect any VPC, you must ensure that there is no network address space overlap between the networks that you intend to route traffic between your VPCs and Ansible Automation Platform from GCP Marketplace’s VPC address space. The GCP Portal should prevent peering if this is attempted.
				</p></div><p class="Role ARG Spec Role ARG Spec">
				Configure VPC peering with Ansible Automation Platform with the following procedure.
			</p><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem">
						In the GCP Portal, navigate to <span class="guimenu">VPC Network</span>.
					</li><li class="listitem">
						In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">VPC menu</span></strong></span>, select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">VPC Network Peering</span></strong></span>.
					</li><li class="listitem">
						Click <span class="guibutton">Create peering connection</span>.
					</li><li class="listitem">
						In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Name</span></strong></span> field, enter the name of the peering connection that you need.
					</li><li class="listitem">
						In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Your VPC Network</span></strong></span> field, select the first VPC that you plan to peer.
					</li><li class="listitem"><p class="simpara">
						In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Peered VPC Network</span></strong></span> field, select the second VPC to peer. This must be the Ansible Automation Platform from GCP Marketplace VPC.
					</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem">
								Subnet routes between these two networks are created by default. Therefore, access to Ansible Automation Platform can occur from VMs that reside on the peered VPC. However, if you have more complex routing, such as a hub-and-spoke network model, then other routes must be created.
							</li><li class="listitem">
								Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Exchange custom routes</span></strong></span> and <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Exchange subnet routes with public IP</span></strong></span> carefully. Google provides explanations what each fields does. Your selection affects how traffic flows through your VPCs. Normally, these checkboxes configure routing between the newly peered networks and other networks through the route table exchange and enable network traffic to traverse multiple networks (transit routing).
							</li></ul></div></li><li class="listitem">
						Click <span class="guibutton">Create</span>.
					</li></ol></div><p class="Role ARG Spec Role ARG Spec">
				For additional information on routing tables, firewalls and other networking components regarding VPC Peering, see the <a class="link mimir-link-warn" href="https://cloud.google.com/vpc/docs" title="Mimir does not include content from: cloud.google.com">GCP documentation</a>.
			</p></section><section class="section Role ARG Spec" id="proc-gcp-external-load-balancer"><div class="titlepage"><div><div><h2 class="title">3.3. Using an external load balancer</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				It is possible to expose Ansible automation controller and Ansible private automation hub to the public internet if you want users to have access to the platform from any internet connected machine.
			</p><p class="Role ARG Spec Role ARG Spec">
				This is not recommended as a best practice for security reasons.
			</p><p class="Role ARG Spec Role ARG Spec">
				However this implementation can be secured with different GCP tools. This section describes how to connect a load balancer that faces the public internet, but it does not include steps to harden access through Google’s security products. Only use this approach if you intend to protect the public endpoints with <a class="link mimir-link-warn" href="https://cloud.google.com/armor/" title="Mimir does not include content from: cloud.google.com">Google Cloud Armor</a> or similar product(s).
			</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
					Ansible Automation Platform from GCP Marketplace is deployed with two <span class="emphasis"><em><span class="Role ARG Spec Role ARG Spec">internal</span></em></span> application load balancers. These load balancers direct traffic within local VPCs and must remain part of the deployment even if you configure public load balancers.
				</p></div></div><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem">
						Select the main menu from the top left.
					</li><li class="listitem">
						Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Network Services</span></strong></span>. If you do not see <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Network Services</span></strong></span>, then select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">View All Products</span></strong></span>.
					</li><li class="listitem">
						Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Load Balancing</span></strong></span>.
					</li><li class="listitem">
						In the top menu, select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">CREATE LOAD BALANCER</span></strong></span>.
					</li><li class="listitem">
						Select the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">HTTP(S) Load Balancing</span></strong></span> tile and click <span class="guibutton">START CONFIGURATION</span>.
					</li><li class="listitem">
						Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">From Internet to my VMs or serverless services</span></strong></span> and <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Global HTTP(s) Load Balancer</span></strong></span>.
					</li><li class="listitem">
						Click <span class="guibutton">CONTINUE</span>.
					</li><li class="listitem">
						Give your load balancer a name, for example, <code class="literal Role ARG Spec">&lt;DeploymentName&gt;-aap-&lt;cntrlr/hub&gt;-ext-lb</code>
					</li><li class="listitem">
						Ensure that <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Frontend</span></strong></span> configuration is selected at the left of the screen.
					</li><li class="listitem"><p class="simpara">
						On the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Frontend</span></strong></span> configuration page, complete the following fields:
					</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem">
								<span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Protocol</span></strong></span>: HTTPS.
							</li><li class="listitem">
								<span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Port</span></strong></span>: 443.
							</li><li class="listitem">
								<span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">IP Address</span></strong></span>: Select an existing IP address or create a new one.
							</li><li class="listitem">
								<span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Certificate</span></strong></span>: You can use your own SSL Certificate or use a Google managed certificate.
							</li><li class="listitem">
								<span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">SSL Policy</span></strong></span>: GCP default, or another configured policy.
							</li></ul></div></li><li class="listitem">
						Click <span class="guibutton">DONE</span>.
					</li><li class="listitem">
						Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Backend configuration</span></strong></span> from the menu on the left.
					</li><li class="listitem">
						Click the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Backend services &amp; backend buckets</span></strong></span> drop-down.
					</li><li class="listitem"><p class="simpara">
						Click <span class="guibutton">CREATE A BACKEND SERVICE</span>.
					</p><div class="orderedlist Role ARG Spec"><ol class="orderedlist Role ARG Spec" type="a"><li class="listitem">
								Give your backend service a name, for example, <code class="literal Role ARG Spec">&lt;DeploymentName&gt;-aap-&lt;cntrlr/hub&gt;-ext-lb-bknd-svc</code>
							</li><li class="listitem">
								Set <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Backend type</span></strong></span> to <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Instance group</span></strong></span>.
							</li><li class="listitem">
								Set <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Protocol</span></strong></span> to <code class="literal Role ARG Spec">HTTP</code> and <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Named Port</span></strong></span> to <code class="literal Role ARG Spec">http</code>.
							</li><li class="listitem">
								Change <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Timeout</span></strong></span> to <code class="literal Role ARG Spec">300</code>.
							</li><li class="listitem"><p class="simpara">
								Scroll down to the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Backends</span></strong></span> section and in the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">New backend</span></strong></span> field, select the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Instance group</span></strong></span> drop-down. Select the correct instance group.
							</p><p class="Role ARG Spec Role ARG Spec">
								For the automation controller load balancer, the correct instance group has the suffix <code class="literal Role ARG Spec">-aap-cntrlr-igm</code>.
							</p><p class="Role ARG Spec Role ARG Spec">
								For the automation hub load balancer, the correct instance group has the suffix <code class="literal Role ARG Spec">-aap-hub-igm</code>.
							</p></li><li class="listitem">
								In the resulting dialog box, select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">USE EXISTING PORT NAME</span></strong></span>.
							</li><li class="listitem">
								Set <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Balancing mode</span></strong></span> to <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Rate</span></strong></span>.
							</li><li class="listitem">
								Set <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Maximum RPS</span></strong></span> to 300.
							</li><li class="listitem">
								Scroll down until you see a text box showing <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Health check</span></strong></span>.
							</li><li class="listitem">
								Select the drop-down menu and click <span class="guibutton">CREATE A HEALTH CHECK</span>.
							</li><li class="listitem">
								Enter a name for your health check, for example, <code class="literal Role ARG Spec">&lt;DeploymentName&gt;-aap-&lt;cntrlr/hub&gt;-ext-lb-hc</code>
							</li><li class="listitem"><p class="simpara">
								For automation controller, use the following health check settings
							</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem">
										In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Health Check</span></strong></span> dialog box, set <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Protocol</span></strong></span> to <code class="literal Role ARG Spec">TCP</code>, and <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Port</span></strong></span> to <code class="literal Role ARG Spec">8052</code>.
									</li><li class="listitem">
										Set <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Request</span></strong></span> to <code class="literal Role ARG Spec">/api/v2/ping/</code>.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								For automation hub, use the following health check settings
							</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem">
										In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Health Check</span></strong></span> dialog box, set <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Protocol</span></strong></span> to <code class="literal Role ARG Spec">TCP</code>, and <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Port</span></strong></span> to <code class="literal Role ARG Spec">8080</code>.
									</li><li class="listitem">
										Set <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Request</span></strong></span> to <code class="literal Role ARG Spec">/api/galaxy/pulp/api/v3/status/</code>.
									</li><li class="listitem">
										Keep all other default settings.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								Click <span class="guibutton">SAVE</span>.
							</p><p class="Role ARG Spec Role ARG Spec">
								This returns you to the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Backend services &amp; backend buckets</span></strong></span> window.
							</p></li><li class="listitem"><p class="simpara">
								Click <span class="guibutton">CREATE</span>.
							</p><p class="Role ARG Spec Role ARG Spec">
								This returns you to <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Backend configuration</span></strong></span> section.
							</p></li><li class="listitem">
								Click <span class="guibutton">OK</span>.
							</li><li class="listitem">
								Click <span class="guibutton">CREATE</span> to create the load balancer for the automation controller or automation hub UI. This will take a few minutes to complete.
							</li></ol></div></li><li class="listitem">
						A load balancer has now been created.
					</li><li class="listitem">
						Configure the DNS record for the domain that you used in your SSL certificate to point to the IP address of the load balancer.
					</li></ol></div><p class="Role ARG Spec Role ARG Spec">
				At this point you should have accesss to the Ansible Automation Platform automation controller UI. You can log in after you retrieve the administration password.
			</p><p class="Role ARG Spec Role ARG Spec">
				Repeat the same process for private automation hub. The process is identical except for selecting the instance group <code class="literal Role ARG Spec">-aap-hub-igm</code> during backend configuration.
			</p></section></section><section class="chapter Role ARG Spec" id="assembly-gcp-additional-configs"><div class="titlepage"><div><div><h1 class="title">Chapter 4. Additional configurations</h1></div></div></div><p class="Role ARG Spec Role ARG Spec">
			The following chapter describes Ansible Automation Platform configuration steps that you can perform once your deployment is complete on GCP.
		</p><section class="section Role ARG Spec" id="proc-gcp-additional-configs-update-admin-password"><div class="titlepage"><div><div><h2 class="title">4.1. Changing the default Ansible Automation Platform administrator password</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				The default administrator password for Ansible Automation Platform is generated randomly when Ansible Automation Platform from GCP Marketplace is deployed. Follow these steps to change the administrator password for both automation controller and automation hub.
			</p><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem">
						Locate the correct secret for the Ansible Automation Platform deployment by opening the GCP Secrets Manager console and selecting the secret with the name <span class="emphasis"><em><span class="Role ARG Spec Role ARG Spec">&lt;deployment_name&gt;-aap-admin</span></em></span>.
					</li><li class="listitem">
						Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">NEW VERSION</span></strong></span> to add a new version.
					</li><li class="listitem">
						Enter a password secret value.
					</li><li class="listitem">
						Check <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Disable all past versions</span></strong></span>.
					</li><li class="listitem">
						Click <span class="guibutton">ADD NEW VERSION</span>.
					</li><li class="listitem"><p class="simpara">
						Replace the running Ansible Automation Platform VM instances to use the new administrator password.
					</p><div class="orderedlist Role ARG Spec"><ol class="orderedlist Role ARG Spec" type="a"><li class="listitem">
								Navigate to the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">GCP VM Instances</span></strong></span> console.
							</li><li class="listitem">
								Identify and delete one automation controller VM instance and one automation hub VM instance for the Ansible Automation Platform deployment.
							</li><li class="listitem">
								Wait for the automation controller Auto Scale group and the automation hub Auto Scaling group to create new VM instances.
							</li></ol></div></li><li class="listitem">
						The new administrator password can be used when the new automation controller and automation hub VM instances reach a <span class="emphasis"><em><span class="Role ARG Spec Role ARG Spec">Running</span></em></span> Instance State.
					</li></ol></div></section><section class="section Role ARG Spec" id="proc-gcp-secure-communication-SSL"><div class="titlepage"><div><div><h2 class="title">4.2. Securing internal communication with SSL</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				Ansible Automation Platform from GCP Marketplace is deployed with two <span class="emphasis"><em><span class="Role ARG Spec Role ARG Spec">internal</span></em></span> application load balancers, one each in front of the hub and controller instances. These internal load balancers must be configured with SSL certificates after deployment completes.
			</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
					Securing traffic through these internal load balancers is different than securing traffic through external load balancers in previous steps. This process ensures HTTP traffic is encrypted even when the traffic is localized to private GCP VPCs. The same procedure can be followed for both the automation controller and automation hub load balancers.
				</p></div></div><p class="Role ARG Spec Role ARG Spec">
				To modify both the automation controller and automation hub load balancers, which have the name format <code class="literal Role ARG Spec">&lt;DEPLOYMENT_NAME&gt;-aap-&lt;cntrlr/hub&gt;-int-lb</code>.
			</p><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem">
						In the GCP console, navigate to the <a class="link mimir-link-warn" href="https://console.cloud.google.com/net-services/loadbalancing/list/loadBalancers" title="Mimir does not include content from: console.cloud.google.com"><span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Load Balancing</span></strong></span></a> page.
					</li><li class="listitem">
						In the search bar, enter the name of your deployed image name to filter down to your load balancers.
					</li><li class="listitem">
						Click <span class="guibutton">Edit</span>.
					</li><li class="listitem">
						Click <span class="guibutton">Frontend configuration</span>.
					</li><li class="listitem"><p class="simpara">
						Click <span class="guibutton">ADD FRONTEND IP AND PORT</span>. Use the following values:
					</p><div class="orderedlist Role ARG Spec"><ol class="orderedlist Role ARG Spec" type="a"><li class="listitem">
								<span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Protocol</span></strong></span>: HTTPS (includes HTTP/2).
							</li><li class="listitem">
								<span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Subnetwork</span></strong></span>: Select the available aap-subnet.
							</li><li class="listitem">
								<span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Port</span></strong></span>: 443
							</li><li class="listitem">
								<span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">IP Address</span></strong></span>: <code class="literal Role ARG Spec">&lt;DEPLOYMENT_NAME&gt;-aap&lt;cntrlr/hub&gt;-intl-lb-ip</code>
							</li></ol></div></li><li class="listitem"><p class="simpara">
						If you have already added your certificate, select it.
					</p><div class="orderedlist Role ARG Spec"><ol class="orderedlist Role ARG Spec" type="a"><li class="listitem">
								If you have not added your certificate, click <span class="guibutton">CREATE A NEW CERTIFICATE</span>.
							</li><li class="listitem">
								Provide a name for your certificate.
							</li><li class="listitem">
								Using your previously generated certificate, copy its contents and paste it under <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Certificate</span></strong></span>.
							</li><li class="listitem">
								Using your previously generated certificate key, copy its contents and paste it under <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Private Key</span></strong></span>.
							</li><li class="listitem">
								Click <span class="guibutton">Create</span>.
							</li></ol></div></li><li class="listitem">
						Click <span class="guibutton">Done</span>.
					</li><li class="listitem"><p class="simpara">
						Optional: To delete the HTTP Frontend configuration.
					</p><div class="orderedlist Role ARG Spec"><ol class="orderedlist Role ARG Spec" type="a"><li class="listitem">
								Open the Load balancer instance.
							</li><li class="listitem">
								Click <span class="guibutton">Frontend Configuration</span> The configurations appear on the left side of the UI.
							</li><li class="listitem">
								Scroll to the configuration you want to delete.
							</li><li class="listitem">
								Click the trashcan icon to delete the configuration.
							</li></ol></div></li><li class="listitem">
						Click <span class="guibutton">Update</span>, and confirm the update.
					</li></ol></div></section><section class="section Role ARG Spec" id="ref-gcp-security-considerations"><div class="titlepage"><div><div><h2 class="title">4.3. Security considerations</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				To configure Red Hat Single Sign-On with an identity provider that can enable <span class="emphasis"><em><span class="Role ARG Spec Role ARG Spec">Multi factor Authentication</span></em></span> (MFA), follow the steps <a class="link mimir-link-warn" href="https://docs.ansible.com/automation-controller/latest/html/administration/ent_auth.html" title="Mimir does not include content from: docs.ansible.com">here</a> for connecting enterprise authentication to Ansible Automation Platform.
			</p><p class="Role ARG Spec Role ARG Spec">
				Securing infrastructure services is an important step in any cloud deployment. Follow the implementation and security suggestions from <a class="link mimir-link-warn" href="https://cloud.google.com/docs" title="Mimir does not include content from: cloud.google.com">GCP documentation</a> for services used as part of an Ansible Automation Platform from GCP Marketplace deployment.
			</p></section></section><section class="chapter Role ARG Spec" id="aap-command-generator"><div class="titlepage"><div><div><h1 class="title">Chapter 5. Using the Command Generator</h1></div></div></div><p class="Role ARG Spec Role ARG Spec">
			The Command Generator is used to generate commands for launching operational playbooks provided by the Ansible-on-clouds operational playbook collection.
		</p><p class="Role ARG Spec Role ARG Spec">
			The process involves five steps:
		</p><div class="orderedlist Role ARG Spec"><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem">
					Pull the <code class="literal Role ARG Spec">ansible-on-clouds-ops</code> container image.
				</li><li class="listitem">
					List the available playbooks.
				</li><li class="listitem">
					Use a command generator to generate a data file and the next command to run. <code class="literal Role ARG Spec">command_generator_vars</code> and the command_generator are implemented using a docker container and are run using the docker command line interface.
				</li><li class="listitem"><p class="simpara">
					Populate the data file and run the previous generated command. This generates the final command with all parameters.
				</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
						When this step is complete, you can save the generated command and run the playbook when it is required.
					</p></div></div></li><li class="listitem">
					Run the final command.
				</li></ol></div><div class="itemizedlist Role ARG Spec"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem">
					Docker
				</li><li class="listitem">
					A GCP credentials file
				</li><li class="listitem">
					An internet connection to Google Cloud
				</li></ul></div><section class="section Role ARG Spec" id="proc-aap-pull-command-container-image"><div class="titlepage"><div><div><h2 class="title">5.1. Pulling the ansible-on-clouds-ops container image</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				Pull the Docker image for the Ansible on Clouds operational container with the same tag version as your deployment.
			</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
					Before Pulling the docker image, make sure you are logged in to registry.redhat.com using docker. Use the following command to login to registry.redhat.com.
				</p><pre class="literallayout Role ARG Spec">$ docker login registry.redhat.io</pre><p class="Role ARG Spec Role ARG Spec">
					For more information about registry login, see <a class="link mimir-link-warn" href="https://access.redhat.com/RegistryAuthentication" title="This content is not included in Mimir.">Registry Authentication</a>
				</p></div></div><p class="Role ARG Spec Role ARG Spec">
				For example, if your foundation deployment version is 2.3.20230221-00, you must pull the operational image with tag 2.3.20230221.
			</p><p class="Role ARG Spec Role ARG Spec">
				Use the following commands:
			</p><pre class="literallayout Role ARG Spec">$ export IMAGE=registry.redhat.io/ansible-on-clouds/ansible-on-clouds-ops-rhel8:2.3.20230221
$ docker pull $IMAGE --platform=linux/amd64</pre><p class="Role ARG Spec Role ARG Spec">
				For EMEA regions (Europe, Middle East, Africa) run the following command instead:
			</p><pre class="literallayout Role ARG Spec">$ export IMAGE=registry.redhat.io/ansible-on-clouds/ansible-on-clouds-ops-emea-rhel8:2.3.20230221
$ docker pull $IMAGE --platform=linux/amd64</pre></section><section class="section Role ARG Spec" id="proc-aap-list-available-playbooks"><div class="titlepage"><div><div><h2 class="title">5.2. Listing the available playbooks</h2></div></div></div><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem"><p class="simpara">
						For the list of available playbooks without details, use the following command.
					</p><pre class="literallayout Role ARG Spec">$ docker run --rm $IMAGE command_generator_vars | grep Playbook

The current version of the operational playbooks collection contains the following playbooks:

Playbook: aws_add_extension_nodes
Playbook: aws_backup_stack
Playbook: aws_deployment_inventory
Playbook: aws_remove_extension_nodes
Playbook: aws_restore_stack
Playbook: aws_upgrade
Playbook: gcp_aap_health_check
Playbook: gcp_backup_deployment
Playbook: gcp_create_external_load_balancer
Playbook: gcp_delete_external_load_balancer
Playbook: gcp_deployment_inventory
Playbook: gcp_health_check
Playbook: gcp_list_deployments
Playbook: gcp_nodes_health_check
Playbook: gcp_restore_deployment
Playbook: gcp_setup_logging_monitoring
Playbook: gcp_upgrade</pre></li><li class="listitem"><p class="simpara">
						To provide a list of all available playbooks, and to use the command generator, use the following command.
					</p><pre class="literallayout Role ARG Spec">$ docker run --rm $IMAGE command_generator_vars</pre><p class="Role ARG Spec Role ARG Spec">
						This provides a list of playbooks and a command similar to the following:
					</p><pre class="literallayout Role ARG Spec">===============================================
Playbook: gcp_upgrade
Description: Performs the upgrade of the Ansible Automation Platform from GCP Marketplace components to the latest version.
-----------------------------------------------
Performs the upgrade of the Ansible Automation Platform from GCP Marketplace components to the latest version.

-----------------------------------------------
Command generator template:

docker run --rm $IMAGE command_generator gcp_upgrade [--ansible-config ansible_config_path&gt;] \
-d &lt;deployment_name&gt; -c &lt;cloud_credentials_path&gt; --extra-vars 'gcp_compute_region=&lt;gcp_compute_region&gt; gcp_compute_zone=&lt;gcp_compute_zone&gt; gcp_backup_taken=&lt;true|false&gt;'
===============================================</pre></li></ol></div></section><section class="section Role ARG Spec" id="proc-aap-generate-command-data-file"><div class="titlepage"><div><div><h2 class="title">5.3. Generating the data file</h2></div></div></div><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem"><p class="simpara">
						Run the command generator.
					</p><pre class="literallayout Role ARG Spec">$ docker run --rm -v &lt;local_directory_data_file&gt;:/data $IMAGE command_generator_vars &lt;playbook_name&gt; --output-data-file /data/&lt;data-file&gt;.yml</pre><p class="Role ARG Spec Role ARG Spec">
						The outputs of this command are the command to run and the data file template. The data file is also saved in your <code class="literal Role ARG Spec">&lt;local_data_file_directory&gt;</code>. This is the template which you populate with your data.
					</p><p class="Role ARG Spec Role ARG Spec">
						The following example uses the <code class="literal Role ARG Spec">gcp_backup_deployment</code> playbook.
					</p><pre class="literallayout Role ARG Spec">$ docker run --rm -v &lt;local_data_file_directory&gt;:/data $IMAGE command_generator_vars gcp_backup_deployment \
--output-data-file /data/backup.yml</pre></li><li class="listitem"><p class="simpara">
						Producing the following output.
					</p><pre class="literallayout Role ARG Spec">===============================================
Playbook: gcp_backup_deployment
Description: This playbook is used to backup the AoC Self-managed GCP environment.
-----------------------------------------------
This playbook is used to backup the AoC Self-managed GCP environment.
For more information regarding backup and restore, visit our official documentation -

-----------------------------------------------
Command generator template:

docker run --rm -v /tmp:/data $IMAGE command_generator gcp_backup_deployment --data-file /data/backup.yml

Data template:

gcp_backup_deployment:
  cloud_credentials_path:
  deployment_name:
  extra_vars:
    gcp_bucket_backup_name:
    gcp_compute_region:
    gcp_compute_zone:

===============================================</pre></li></ol></div></section><section class="section Role ARG Spec" id="proc-aap-populate-command-data-file"><div class="titlepage"><div><div><h2 class="title">5.4. Populating the data file</h2></div></div></div><div class="itemizedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem"><p class="simpara">
						Edit the data-file generated in <a class="link" href="#proc-aap-generate-command-data-file" title="5.3. Generating the data file">Generating the data file</a>.
					</p><p class="Role ARG Spec Role ARG Spec">
						Any attribute that represents a path must be an absolute path. The command_generator automatically mounts a volume for it in the final command.
					</p><p class="Role ARG Spec Role ARG Spec">
						For example, in the case of the <code class="literal Role ARG Spec">gcp_backup_deployment</code> playbook, the file becomes:
					</p><pre class="literallayout Role ARG Spec">gcp_backup_deployment
  cloud_credentials_path: /path/to/credentials
  deployment_name: my-deployment
  extra_vars:
    cp_bucket_backup_name: my-bucket
    gcp_compute_region: us-east1
    gcp_compute_zone: us-east1-b</pre></li></ul></div></section><section class="section Role ARG Spec" id="proc-aa-run-generated-command"><div class="titlepage"><div><div><h2 class="title">5.5. Running the generated command</h2></div></div></div><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem"><p class="simpara">
						Ensure that the mounted volume points to the directory where the data file is.
					</p><p class="Role ARG Spec Role ARG Spec">
						For the <code class="literal Role ARG Spec">gcp_backup_deployment</code> playbook example, this is:
					</p><pre class="literallayout Role ARG Spec">$ docker run --rm -v /tmp:/data $IMAGE command_generator gcp_backup_deployment --data-file /data/backup.yml</pre><p class="Role ARG Spec Role ARG Spec">
						Which generates the following output:
					</p><pre class="literallayout Role ARG Spec">Command to run playbook:

$ docker run --rm --env PLATFORM=GCP -v /path/to/credentials:/home/runner/.gcp/credentials:ro \
--env ANSIBLE_CONFIG=../gcp-ansible.cfg  $IMAGE\ redhat.ansible_on_clouds.gcp_backup_deployment \
-e 'gcp_service_account_credentials_json_path=/home/runner/.gcp/credentials  \
gcp_deployment_name=my-deployment gcp_compute_region=us-east1 gcp_compute_zone=us-east1-b'</pre><p class="Role ARG Spec Role ARG Spec">
						This new command has the required parameters, environment variables and mounted volumes to run the playbook.
					</p></li><li class="listitem">
						Run the generated command. You can save this command to rerun it later if required.
					</li></ol></div></section></section><section class="chapter Role ARG Spec" id="assembly-gcp-automation-workloads"><div class="titlepage"><div><div><h1 class="title">Chapter 6. Automation workloads</h1></div></div></div><p class="Role ARG Spec Role ARG Spec">
			The default Ansible Automation Platform from GCP Marketplace deployment is designed and licensed to automate 100 managed nodes.
		</p><section class="section Role ARG Spec" id="ref-gcp-automation-performance"><div class="titlepage"><div><div><h2 class="title">6.1. Automation performance</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				Automating against your licensed managed node allocation in the offer is provided with the following operational expectations. Automating outside of the boundaries of these criteria is not supported, but can still function depending on your automation.
			</p><div class="informaltable"><table class="lt-4-cols lt-7-rows Role ARG Spec"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140691884576624" scope="col">Metric</th><th align="left" valign="top" id="idm140691884575536" scope="col">Threshold</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140691884576624"> <p>
								Concurrent Jobs
							</p>
							 </td><td align="left" valign="top" headers="idm140691884575536"> <p>
								10
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140691884576624"> <p>
								Forks per job
							</p>
							 </td><td align="left" valign="top" headers="idm140691884575536"> <p>
								10
							</p>
							 </td></tr></tbody></table></div><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
					Ansible Automation Platform from GCP Marketplace is driven using three n2-standard-2 instances, two of which run automation controller and one which runs automation hub. The automation controller instances collectively support a standard workload for 100 managed active nodes. Red Hat has tested this and proved that there is support for up to 10 forks each. This operating criteria has been set and tested using output-intensive, “chatty” workloads that produce 2 messages 7 seconds apart on both automation controller nodes. Workloads that are more I/O intensive might not work inside the boundaries of these conditions and can require the use of extension nodes to scale the deployment to support such automation. For further information, see <a class="link" href="#proc-gcp-extension-nodes" title="6.3. Purchasing an extension node">Purchasing an extension node</a>.
				</p></div></div></section><section class="section Role ARG Spec" id="ref-gcp-deployment-scaling"><div class="titlepage"><div><div><h2 class="title">6.2. Deployment scaling</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				If you want to scale your deployment beyond the initial number of supported managed nodes, Ansible Automation Platform from GCP Marketplace can be manually scaled using separately sold extension nodes.
			</p><p class="Role ARG Spec Role ARG Spec">
				Extension nodes are additional compute instances that can be deployed to scale-up or scale-out depending on the immediate scaling requirements. If your requirements are for higher parallel automation operations you can select compute shapes that scale-up, while if you have a requirement to automate more nodes over time you can select compute shapes that scale out.
			</p><p class="Role ARG Spec Role ARG Spec">
				Extension nodes are the supported way of extending the capabilities of Ansible Automation Platform from GCP Marketplace.
			</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
					Environments that are extended through customer design and implementation are not supported by Red Hat.
				</p></div></div></section><section class="section Role ARG Spec" id="proc-gcp-extension-nodes"><div class="titlepage"><div><div><h2 class="title">6.3. Purchasing an extension node</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				The extension node offering enables you to add additional Ansible managed node licenses and additional compute VMs into your Ansible Automation Platform from GCP Marketplace deployment.
			</p><p class="Role ARG Spec Role ARG Spec">
				Extension nodes for Red Hat Ansible Automation Platform from GCP Marketplace can be obtained directly from the Google Marketplace. Follow these steps to purchase and deploy the public offer.
			</p><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem">
						In the Google Cloud Console, navigate to the <a class="link mimir-link-warn" href="https://console.cloud.google.com/marketplace" title="Mimir does not include content from: console.cloud.google.com">Marketplace</a>.
					</li><li class="listitem">
						In the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Search Marketplace</span></strong></span> text box, search for <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Ansible Automation Platform</span></strong></span>.
					</li><li class="listitem">
						Click one of the listings for <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Extension Node - Ansible Automation Platform</span></strong></span>. Depending on your needs, select 100, 200 or 400 Managed Nodes.
					</li><li class="listitem">
						Ensure that you have selected the offer where Red Hat is the publisher.
					</li><li class="listitem">
						Review the details, and click <span class="guibutton">LAUNCH</span>.
					</li></ol></div><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
					You can purchase private offers for extension nodes through your Red Hat account executive.
				</p></div></div></section></section><section class="chapter Role ARG Spec" id="assembly-gcp-monitoring-logging"><div class="titlepage"><div><div><h1 class="title">Chapter 7. Monitoring and logging</h1></div></div></div><p class="Role ARG Spec Role ARG Spec">
			You can send metrics to the Google Cloud Platform monitoring system to be visualized in the Google Cloud Platform UI. Ansible Automation Platform from GCP Marketplace metrics and logging are disabled by default as there is a cost to send these metrics to GCP. Refer to <a class="link mimir-link-warn" href="https://cloud.google.com/stackdriver/pricing#monitoring-costs" title="Mimir does not include content from: cloud.google.com">Cloud Monitoring</a> and <a class="link mimir-link-warn" href="https://cloud.google.com/stackdriver/pricing" title="Mimir does not include content from: cloud.google.com">Cloud Logging</a> respectively for more information.
		</p><p class="Role ARG Spec Role ARG Spec">
			You can set up GCP monitoring and logging either:
		</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem">
					At deployment time, or
				</li><li class="listitem">
					After the deployment
				</li></ul></div><section class="section Role ARG Spec" id="con-gcp-setup-at-deployment-time"><div class="titlepage"><div><div><h2 class="title">7.1. Setting up monitoring and logging at deployment time</h2></div></div></div><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem">
						In the GCP UI, navigate to <span class="guimenu">Observability</span>.
					</li><li class="listitem"><p class="simpara">
						Check the <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Connect Logging</span></strong></span> and <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Connect Metrics</span></strong></span> checkboxes.
					</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
							These checkboxes are only available in the foundation deployment.
						</p></div></div></li></ol></div></section><section class="section Role ARG Spec" id="con-gcp-setup-after-deployment"><div class="titlepage"><div><div><h2 class="title">7.2. Setting up monitoring and logging after deployment</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				You can start or stop the logging and monitoring after the deployment by using the <code class="literal Role ARG Spec">gcp_setup_logging_monitoring</code> playbook available from registry.redhat.com.
			</p><section class="section Role ARG Spec" id="con-gcp-use-container-image"><div class="titlepage"><div><div><h3 class="title">7.2.1. Pulling the ansible-on-clouds-ops container image</h3></div></div></div><p class="Role ARG Spec Role ARG Spec">
					Pull the Docker image for the Ansible on Clouds operational container which aligns with the version of your foundation deployment.
				</p><p class="Role ARG Spec Role ARG Spec">
					For example, if your foundation deployment version is 2.3.20230221-00, you must pull the operational image with tag 2.3.20230221.
				</p><p class="Role ARG Spec Role ARG Spec">
					Use the following commands:
				</p><pre class="literallayout Role ARG Spec">$ export IMAGE=registry.redhat.io/ansible-on-clouds/ansible-on-clouds-ops-rhel8:2.3.20230221
$ docker pull $IMAGE --platform=linux/amd64</pre><p class="Role ARG Spec Role ARG Spec">
					For EMEA regions (Europe, Middle East, Africa) run the following command instead:
				</p><pre class="literallayout Role ARG Spec">$ export IMAGE=registry.redhat.io/ansible-on-clouds/ansible-on-clouds-ops-emea-rhel8:2.3.20230221
$ docker pull $IMAGE --platform=linux/amd64</pre></section><section class="section Role ARG Spec" id="proc-gcp-generate-variables"><div class="titlepage"><div><div><h3 class="title">7.2.2. Generating data files by running the ansible-on-clouds-ops container</h3></div></div></div><p class="Role ARG Spec Role ARG Spec">
					The following commands generate the required data file. These commands create a directory, and an empty data template that, when populated, is used to generate the playbook.
				</p><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem"><p class="simpara">
							Create a folder to hold the configuration files.
						</p><pre class="screen Role ARG Spec Role ARG Spec">$ mkdir command_generator_data</pre></li><li class="listitem"><p class="simpara">
							Populate the <code class="literal Role ARG Spec">command_generator_data</code> folder with the configuration file template.
						</p><pre class="screen Role ARG Spec Role ARG Spec">$ docker run --rm -v $(pwd)/command_generator_data:/data $IMAGE \
command_generator_vars gcp_setup_logging_monitoring \
--output-data-file /data/logging-monitoring.yml</pre><p class="Role ARG Spec Role ARG Spec">
							Creates the following command file:
						</p><pre class="literallayout Role ARG Spec">===============================================
Playbook: gcp_setup_logging_monitoring
Description: This playbook setup the logging and monitoring.
-----------------------------------------------
Install monitoring tools and configure them to send data to the Google Cloud Monitoring service.
-----------------------------------------------
Command generator template:

docker run --rm -v &lt;local_data_file_directory&gt;:/data $IMAGE command_generator \
gcp_setup_logging_monitoring --data-file /data/logging-monitoring.yml</pre></li><li class="listitem"><p class="simpara">
							When you have run these commands, a <code class="literal Role ARG Spec">command_generator_data/logging-monitoring.yml</code> template file is created.
						</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
								In the following example file, <code class="literal Role ARG Spec">ansible_config_path</code> is optional.
							</p></div></div><p class="Role ARG Spec Role ARG Spec">
							This template file resembles the following:-
						</p><pre class="literallayout Role ARG Spec">gcp_setup_logging_monitoring:
  ansible_config_path:
  cloud_credentials_path:
  deployment_name:
  extra_vars:
    components:
    default_collector_interval:
    logging_enabled:
    monitoring_enabled:</pre></li></ol></div></section><section class="section Role ARG Spec" id="proc-gcp-set-monitoring-logging-yml"><div class="titlepage"><div><div><h3 class="title">7.2.3. Updating the data file</h3></div></div></div><p class="Role ARG Spec Role ARG Spec">
					If you do not require a parameter, remove that parameter from the configuration file.
				</p><div class="itemizedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem">
							Edit the <code class="literal Role ARG Spec">command_generator_data/logging-monitoring.yml</code> file and set the following parameters:
						</li><li class="listitem">
							<code class="literal Role ARG Spec">ansible_config_path</code> is used by default as the standard configuration for the <code class="literal Role ARG Spec">ansible-on-cloud offering</code> but if you have extra requirements in your environment you can specify your own.
						</li><li class="listitem">
							<code class="literal Role ARG Spec">cloud_credentials_path</code> is the absolute path toward your credentials. This must be an absolute path.
						</li><li class="listitem">
							<code class="literal Role ARG Spec">deployment_name</code> is the name of the deployment.
						</li><li class="listitem">
							<code class="literal Role ARG Spec">components</code> is an array containing the type of component where you want to do the setup. The default is [ “controller”, “hub” ] which means that the logging monitoring will be enabled on both automation controller and automation hub.
						</li><li class="listitem">
							<code class="literal Role ARG Spec">monitoring_enabled</code> is set to <code class="literal Role ARG Spec">true</code> to enable the monitoring, <code class="literal Role ARG Spec">false</code> otherwise. Default = <code class="literal Role ARG Spec">false</code>.
						</li><li class="listitem">
							<code class="literal Role ARG Spec">logging_enabled</code> is set to <code class="literal Role ARG Spec">true</code> to enable the logging, <code class="literal Role ARG Spec">false</code> otherwise. Default = <code class="literal Role ARG Spec">false</code>.
						</li><li class="listitem"><p class="simpara">
							<code class="literal Role ARG Spec">default_collector_interval</code> is the periodicity at which the monitoring data must be send to the Google Cloud. Default = 59s.
						</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
								The Google cost of this service depends on that periodicity and so the higher the value of the collector interval, the less it will cost.
							</p></div></div><p class="Role ARG Spec Role ARG Spec">
							Do not set values less than 59 seconds.
						</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
								If monitoring and logging is disabled, the value of 'default_collector_interval' is automatically set to <code class="literal Role ARG Spec">0</code>.
							</p></div></div></li></ul></div></section><section class="section Role ARG Spec" id="proc-gcp-generate-playbook"><div class="titlepage"><div><div><h3 class="title">7.2.4. Generating the playbook</h3></div></div></div><p class="Role ARG Spec Role ARG Spec">
					To generate the playbook, run the command generator to generate the CLI command.
				</p><pre class="literallayout Role ARG Spec">docker run --rm -v $(pwd)/command_generator_data:/data $IMAGE command_generator gcp_setup_logging_monitoring \
--data-file /data/logging-monitoring.yml</pre><p class="Role ARG Spec Role ARG Spec">
					Provides the following command:
				</p><pre class="literallayout Role ARG Spec">docker run --rm --env PLATFORM=GCP -v &lt;/path/to/gcp/service-account.json&gt;:/home/runner/.gcp/credentials:ro \
--env ANSIBLE_CONFIG=../gcp-ansible.cfg --env DEPLOYMENT_NAME=&lt;deployment_name&gt; --env GENERATE_INVENTORY=true  \
$IMAGE redhat.ansible_on_clouds.gcp_setup_logging_monitoring -e 'gcp_deployment_name=&lt;deployment_name&gt; \
gcp_service_account_credentials_json_path=/home/runner/.gcp/credentials  monitoring_enabled=&lt;monitoring_enabled&gt; \
logging_enabled=&lt;logging_enabled&gt; default_collector_interval=&lt;interval&gt;'</pre><p class="Role ARG Spec Role ARG Spec">
					Run the supplied command to run the playbook.
				</p><pre class="literallayout Role ARG Spec">$ docker run --rm --env PLATFORM=GCP -v /path/to/credentials:/home/runner/.gcp/credentials:ro \
--env ANSIBLE_CONFIG=../gcp-ansible.cfg --env DEPLOYMENT_NAME=mu-deployment \
--env GENERATE_INVENTORY=true  $IMAGE redhat.ansible_on_clouds.gcp_setup_logging_monitoring \
-e 'gcp_deployment_name=mu-deployment \
gcp_service_account_credentials_json_path=/home/runner/.gcp/credentials  components=["hubs","controllers"]\
monitoring_enabled=True logging_enabled=True default_collector_interval=60s'</pre><p class="Role ARG Spec Role ARG Spec">
					The process may take some time, and provides output similar to the following:
				</p><pre class="literallayout Role ARG Spec">TASK [redhat.ansible_on_clouds.setup_logging_monitoring : Update runtime variable logging_enabled] ***
changed: [&lt;user_name&gt; -&gt; localhost]

TASK [redhat.ansible_on_clouds.setup_logging_monitoring : Update runtime variable monitoring_enabled] ***
changed: [&lt;user_name&gt; -&gt; localhost]

PLAY RECAP *********************************************************************
&lt;user_name&gt;     : ok=20   changed=6    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0</pre></section></section><section class="section Role ARG Spec" id="con-gcp-customize-monitoring-logging"><div class="titlepage"><div><div><h2 class="title">7.3. Customizing monitoring and logging</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				Metrics are provided by <a class="link mimir-link-warn" href="https://docs.ansible.com/automation-controller/latest/html/administration/metrics.html" title="Mimir does not include content from: docs.ansible.com">Ansible</a>, <a class="link mimir-link-warn" href="https://github.com/containers/prometheus-podman-exporter" title="Mimir does not include content from: github.com">Podman</a> and <a class="link mimir-link-warn" href="https://cloud.google.com/stackdriver/docs/solutions/agents/ops-agent" title="Mimir does not include content from: cloud.google.com">Google Ops Agent</a>. Ansible metrics is only installed on automation hub, the Google Ops Agent and Podman are also installed on automation controllers.
			</p><p class="Role ARG Spec Role ARG Spec">
				A configurable process (collector) runs on each automation controller and automation hub to export the collected Ansible and Podman metrics to Google Cloud Platform Monitoring. As the Google Ops Agent is part of the Google Cloud solution, it has its own configuration file.
			</p><p class="Role ARG Spec Role ARG Spec">
				The Google Ops Agent is also responsible for the logging configuration.
			</p><p class="Role ARG Spec Role ARG Spec">
				The service APIs <code class="literal Role ARG Spec">monitoring.googleapis.com</code> and <code class="literal Role ARG Spec">logging.googleapis.com</code> must be respectively enabled for the monitoring and logging capabilities.
			</p><div class="Role ARG Spec Role ARG Spec"><p class="title"><strong>Configuration</strong></p><p>
					Configuration files are located on a disk shared by each automation controller and automation hub. Modify the file <code class="literal Role ARG Spec">/aap/bootstrap/config_file_templates/&lt;controller|hub&gt;/monitoring.yml</code> to configure all exporters and agents.
				</p></div><section class="section Role ARG Spec" id="ref-gcp-ansible-podman-config"><div class="titlepage"><div><div><h3 class="title">7.3.1. Ansible and podman configuration</h3></div></div></div><p class="Role ARG Spec Role ARG Spec">
					The file <code class="literal Role ARG Spec">/aap/bootstrap/config_file_templates/&lt;controller|hub&gt;/monitoring.yaml</code> on automation controller or automation hub contains the configuration for collecting and sending Ansible and podman metrics to GCP.
				</p><p class="Role ARG Spec Role ARG Spec">
					The default configuration for automation controller looks like this:
				</p><pre class="screen Role ARG Spec Role ARG Spec"># This value will be set at deployment time.
# Set to zero if monitoringEnabled is false otherwise 59s
# The collection interval for each collector will be the minimum
# between the defaultCollectorInterval and all send Interval
# of a given collector
# NB: The awx exported should not run on controllers as
# it duplicates the number of records sent to GCP Monitoring

defaultCollectorInterval: $DEFAULT_COLLECTOR_INTERVAL
collectors:
- name: podman
 endpoint: http://localhost:9882/podman/metrics
 enabled: true

# list of metrics to exclude
# excludedMetrics:
# - podman_container_created_seconds

 metrics:
 - name: podman_container_exit_code
   # interval on which the metric must be pushed to gcp
   sendInterval: 59s</pre><p class="Role ARG Spec Role ARG Spec">
					The default configuration for automation hub looks like:
				</p><pre class="screen Role ARG Spec Role ARG Spec"># This value will be set at deployment time.
# Set to zero if monitoringEnabled is false otherwise 59s
# The collection interval for each collector will be the minimum
# between the defaultCollectorInterval and all sendInterval
# of a given collector
# NB: The awx exporter should not run on controllers as
# it duplicates the number of records sent to GCP Monitoring

defaultCollectorInterval: 59s
collectors:
- name: awx
 userName: admin
 endpoint: http://&lt;Controller_LB_IP&gt;/api/v2/metrics/
 enabled: true
 metrics:
 - name: awx_inventories_total
   # interval on which the metric must be pushed to gcp
   sendInterval: 59s
- name: podman
 endpoint: http://localhost:9882/podman/metrics
 enabled: true

# list of metrics to exclude
#  excludedMetrics:
#  - podman_container_created_seconds

 metrics:
 - name: podman_container_exit_code
   # interval on which the metric must be pushed to gcp
   sendInterval: 59s</pre><p class="Role ARG Spec Role ARG Spec">
					where
				</p><p class="Role ARG Spec Role ARG Spec">
					<code class="literal Role ARG Spec">collectors</code> is a configuration array with one item per collector, that is, awx and podman.
				</p><p class="Role ARG Spec Role ARG Spec">
					The awx collector requires authentication and so <code class="literal Role ARG Spec">userName</code> must be set to <code class="literal Role ARG Spec">admin</code>. The password is retrieved from the secret-manager.
				</p><p class="Role ARG Spec Role ARG Spec">
					The endpoint should not be changed.
				</p><p class="Role ARG Spec Role ARG Spec">
					<code class="literal Role ARG Spec">defaultCollectorInterval</code> specifies the default interval at which the exporter collects the information from the metric end-point and sends it to Google Cloud Platform Monitoring.
				</p><p class="Role ARG Spec Role ARG Spec">
					Setting this value to <code class="literal Role ARG Spec">0</code> or omitting this attribute disables all collectors.
				</p><p class="Role ARG Spec Role ARG Spec">
					Each collector can be enabled or disabled separately by setting <code class="literal Role ARG Spec">enabled</code> to <code class="literal Role ARG Spec">true</code> or <code class="literal Role ARG Spec">false</code>.
				</p><p class="Role ARG Spec Role ARG Spec">
					A collector returns all available metrics grouped by families, but you can exclude the families that should not be sent to Google Cloud Platform Monitoring by adding their name in the array <code class="literal Role ARG Spec">excludedMetrics</code>.
				</p><p class="Role ARG Spec Role ARG Spec">
					For all other family metrics, you can specify the interval at which you want to collect and send them to the Google Cloud Platform Monitoring. The collector interval is the minimum between all family metrics interval and the <code class="literal Role ARG Spec">defaultCollectorInterval</code>. This to ensure that a collection is made for each set of metrics sent to Google Cloud Platform Monitoring.
				</p></section><section class="section Role ARG Spec" id="ref-gcp-configure-google-cloud-ops-agent"><div class="titlepage"><div><div><h3 class="title">7.3.2. Google cloud ops agent configuration</h3></div></div></div><p class="Role ARG Spec Role ARG Spec">
					The configuration file details can be found <a class="link mimir-link-warn" href="https://cloud.google.com/stackdriver/docs/solutions/agents/ops-agent/configuration" title="Mimir does not include content from: cloud.google.com">here</a>.
				</p><p class="Role ARG Spec Role ARG Spec">
					The configuration file is located in <code class="literal Role ARG Spec">/etc/google-cloud-ops-agent/config.yml</code>.
				</p><p class="Role ARG Spec Role ARG Spec">
					This is a symbolic link to the shared disk <code class="literal Role ARG Spec">/aap/bootstrap/config_file_templates/controller/gcp-ops-agent-config.yml</code> or <code class="literal Role ARG Spec">/aap/bootstrap/config_file_templates/hub/gcp-ops-agent-config.yml</code> depending on the component type.
				</p><p class="Role ARG Spec Role ARG Spec">
					The configuration file contains a number of receivers specifying what should be collected by the ops agent.
				</p><p class="Role ARG Spec Role ARG Spec">
					Your selection of <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Connect Logging</span></strong></span> and <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Connect Metrics</span></strong></span> during deployment determines which pipelines are included in the file and therefore which logs and metrics are collected and sent to GCP.
				</p><p class="Role ARG Spec Role ARG Spec">
					If you need to add more pipelines post-deployment, you can insert them in <code class="literal Role ARG Spec">/aap/bootstrap/config_file_templates/hub|controller/gcp-ops-agent-config.yml</code>.
				</p><p class="Role ARG Spec Role ARG Spec">
					A crontab job restarts the agent if <code class="literal Role ARG Spec">gcp-ops-agent-config.yml</code> changed in the last 10 minutes. The agent rereads its configuration after a restart.
				</p></section></section></section><section class="chapter Role ARG Spec" id="assembly-gcp-uninstall"><div class="titlepage"><div><div><h1 class="title">Chapter 8. Uninstalling Red Hat Ansible Automation Platform from GCP Marketplace</h1></div></div></div><p class="Role ARG Spec Role ARG Spec">
			This chapter explains how to uninstall Ansible Automation Platform from GCP Marketplace.
		</p><section class="section Role ARG Spec" id="proc-gcp-uninstall-application-uninstall"><div class="titlepage"><div><div><h2 class="title">8.1. Uninstalling the application</h2></div></div></div><div class="admonition important Role ARG Spec"><div class="admonition_header">Important</div><div><p class="Role ARG Spec Role ARG Spec">
					This action cannot be reversed.
				</p><p class="Role ARG Spec Role ARG Spec">
					If a Load Balancer was added for the deployment, it must be deleted before uninstalling the deployment.
				</p><p class="Role ARG Spec Role ARG Spec">
					If an extension node was added to the deployment, it must also be deleted before uninstalling the deployment. Follow the instructions in <a class="link" href="#proc-gcp-delete-extension-nodes" title="8.2. Deleting Extension Nodes">Removing extension nodes</a>
				</p></div></div><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem">
						Select the main menu from the top left.
					</li><li class="listitem">
						Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Deployment Manager</span></strong></span>. If you do not see <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Deployment Manager</span></strong></span>, select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">View All Products</span></strong></span>.
					</li><li class="listitem">
						Tick the checkbox in front of the deployment to be deleted.
					</li><li class="listitem">
						Click <span class="guibutton">Delete</span> in the top bar. This action cannot be reversed.
					</li></ol></div><p class="Role ARG Spec Role ARG Spec">
				The deployment is deleted.
			</p></section><section class="section Role ARG Spec" id="proc-gcp-delete-extension-nodes"><div class="titlepage"><div><div><h2 class="title">8.2. Deleting Extension Nodes</h2></div></div></div><div class="admonition important Role ARG Spec"><div class="admonition_header">Important</div><div><p class="Role ARG Spec Role ARG Spec">
					This action cannot be reversed.
				</p></div></div><p class="Role ARG Spec Role ARG Spec">
				Extension nodes are created as deployments in GCP Deployment Mananger. As such, the process to delete an Ansible Automation Platform extension node is the same as the process to delete the main Ansible Automation Platform deployment.
			</p><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem">
						Select the main menu.
					</li><li class="listitem">
						Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Deployment Manager</span></strong></span>. If you do not see <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Deployment Manager</span></strong></span>, select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">View All Products</span></strong></span>.
					</li><li class="listitem"><p class="simpara">
						Tick the checkbox in front of the extension node you want to delete.
					</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
							Extension nodes and the main deployment are both found in <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Deployment Manager</span></strong></span>. Ensure that you select the extension node and not the main deployment. The name of the extension node was chosen by the person that created it.
						</p></div></div></li><li class="listitem">
						Click <span class="guibutton">Delete</span> in the top bar. This action cannot be reversed.
					</li></ol></div><p class="Role ARG Spec Role ARG Spec">
				The extension node is deleted.
			</p></section><section class="section Role ARG Spec" id="proc-gcp-delete-administration-secret"><div class="titlepage"><div><div><h2 class="title">8.3. Deleting the administration secret</h2></div></div></div><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem">
						Select the main menu from the top left.
					</li><li class="listitem">
						Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Security</span></strong></span>. If you do not see <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Security</span></strong></span>, select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">View All Products</span></strong></span>.
					</li><li class="listitem">
						Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Secret Manager</span></strong></span>.
					</li><li class="listitem">
						The format of the secret name is <code class="literal Role ARG Spec">&lt;DeploymentName&gt;-aap-admin</code>. Filter using this name.
					</li><li class="listitem">
						Click the <span class="guibutton">More Actions</span> icon *⋮ on the line of the deployment.
					</li><li class="listitem">
						Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Delete</span></strong></span>.
					</li><li class="listitem">
						The administration password is displayed.
					</li><li class="listitem">
						Enter the name of the secret.
					</li><li class="listitem">
						Click <span class="guibutton">Delete Secret</span>.
					</li></ol></div></section><section class="section Role ARG Spec" id="proc-gcp-delete-service-account"><div class="titlepage"><div><div><h2 class="title">8.4. Deleting the service account</h2></div></div></div><div class="admonition important Role ARG Spec"><div class="admonition_header">Important</div><div><p class="Role ARG Spec Role ARG Spec">
					If a new service account was created for the deployment and if it is not used anywhere else, it can be deleted
				</p></div></div><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem">
						Select the main menu from the top left.
					</li><li class="listitem">
						Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">IAM &amp; Admin</span></strong></span>. If you do not see <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">IAM &amp; Admin</span></strong></span>, select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">View All Products</span></strong></span>.
					</li><li class="listitem">
						Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Service Accounts</span></strong></span>.
					</li><li class="listitem">
						Filter with the name of the service account.
					</li><li class="listitem">
						Click the <span class="guibutton">More Actions</span> icon *⋮ on the line of the service account.
					</li><li class="listitem">
						Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Delete</span></strong></span>.
					</li><li class="listitem">
						The administration password is displayed.
					</li><li class="listitem">
						Click <span class="guibutton">Delete</span>.
					</li></ol></div></section><section class="section Role ARG Spec" id="proc-gcp-delete-upgrade-secrets"><div class="titlepage"><div><div><h2 class="title">8.5. Deleting secrets left over after upgrade, backup and restore</h2></div></div></div><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
					This action cannot be reversed.
				</p><p class="Role ARG Spec Role ARG Spec">
					Only perform this action if your deployment is deleted.
				</p></div></div><p class="Role ARG Spec Role ARG Spec">
				There are several possible secret names you can find, depending on the procedures you have completed:
			</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem">
						<span class="emphasis"><em><span class="Role ARG Spec Role ARG Spec">&lt;deployment_name&gt;</span></em></span>-aap-secret-key
					</li><li class="listitem">
						<span class="emphasis"><em><span class="Role ARG Spec Role ARG Spec">&lt;deployment_name&gt;</span></em></span>-aap-admin
					</li><li class="listitem">
						<span class="emphasis"><em><span class="Role ARG Spec Role ARG Spec">&lt;deployment_name&gt;</span></em></span>-container_auth_private_key_pem
					</li><li class="listitem">
						<span class="emphasis"><em><span class="Role ARG Spec Role ARG Spec">&lt;deployment_name&gt;</span></em></span>-container_auth_public_key_pem
					</li><li class="listitem">
						<span class="emphasis"><em><span class="Role ARG Spec Role ARG Spec">&lt;deployment_name&gt;</span></em></span>-database_fields_symmetric_key
					</li><li class="listitem">
						<span class="emphasis"><em><span class="Role ARG Spec Role ARG Spec">&lt;deployment_name&gt;</span></em></span>-pulp_cert
					</li><li class="listitem">
						<span class="emphasis"><em><span class="Role ARG Spec Role ARG Spec">&lt;deployment_name&gt;</span></em></span>-pulp_key
					</li></ul></div><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem">
						Select the main menu from the top left.
					</li><li class="listitem">
						Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Security</span></strong></span>. If you do not see <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Security</span></strong></span>, select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">View All Products</span></strong></span>.
					</li><li class="listitem">
						Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Secret Manager</span></strong></span>.
					</li><li class="listitem">
						Search your deployment name, looking for the names in the list above.
					</li><li class="listitem">
						Click the <span class="guibutton">More Actions</span> icon *⋮ on the line of the deployment.
					</li><li class="listitem">
						Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Delete</span></strong></span>. The administration password is displayed.
					</li><li class="listitem">
						Enter the name of the secret.
					</li><li class="listitem">
						Click <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Delete Secret</span></strong></span>.
					</li></ol></div></section><section class="section Role ARG Spec" id="proc-gcp-delete-backup-leftovers"><div class="titlepage"><div><div><h2 class="title">8.6. Deleting the filestore after backup</h2></div></div></div><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
					This action cannot be reversed.
				</p></div></div><div class="orderedlist Role ARG Spec"><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem">
						Procedure
					</li><li class="listitem">
						Select the main menu from the top left.
					</li><li class="listitem">
						Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Filestore</span></strong></span>. If you do not see <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Filestore</span></strong></span>, select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">View All Products</span></strong></span>.
					</li><li class="listitem">
						Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Backups</span></strong></span>.
					</li><li class="listitem">
						The format of the backup name is <code class="literal Role ARG Spec">&lt;DeploymentName&gt;-filestore-&lt;RandomSufix&gt;</code>. Filter using this name.
					</li><li class="listitem">
						Click the <span class="guibutton">More Actions</span> icon *⋮ on the line of the deployment.
					</li><li class="listitem">
						Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Delete</span></strong></span>.
					</li><li class="listitem">
						The administration password is displayed.
					</li><li class="listitem">
						Enter the name of the secret.
					</li><li class="listitem">
						Click <span class="guibutton">Delete Backup</span>.
					</li></ol></div></section><section class="section Role ARG Spec" id="proc-gcp-delete-object-storage"><div class="titlepage"><div><div><h2 class="title">8.7. Deleting the object storage bucket after backup</h2></div></div></div><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem">
						Select the main menu from the top left.
					</li><li class="listitem">
						Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Cloud Storage</span></strong></span>. If you do not see <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Cloud Storage</span></strong></span>, select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">View All Products</span></strong></span>.
					</li><li class="listitem">
						Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Buckets</span></strong></span>.
					</li><li class="listitem">
						Search for your deployment name.
					</li><li class="listitem">
						Click the <span class="guibutton">More Actions</span> icon *⋮ on the line of the deployment.
					</li><li class="listitem">
						Select <span class="strong strong"><strong><span class="Role ARG Spec Role ARG Spec">Delete</span></strong></span>.
					</li><li class="listitem">
						The administration password is displayed.
					</li><li class="listitem">
						Enter the name of the secret.
					</li><li class="listitem">
						Click <span class="guibutton">Delete Secret</span>.
					</li></ol></div></section></section><section class="chapter Role ARG Spec" id="assembly-aap-gcp-backup-and-recovery"><div class="titlepage"><div><div><h1 class="title">Chapter 9. Backup and Restore for Ansible Automation Platform from GCP Marketplace</h1></div></div></div><div class="admonition important Role ARG Spec"><div class="admonition_header">Important</div><div><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem">
						You must restore with the same operational image version as the backup.
					</li><li class="listitem">
						You can only restore using a new VPC network. Backup and restore into an existing VPC network is not currently supported.
					</li><li class="listitem">
						You cannot delete the backed up environment before a restore because the database backups are stored in the deployment. Deleting your deployment therefore deletes the database backups.
					</li><li class="listitem">
						Versioned or point-in-time backups are not supported by the <code class="literal Role ARG Spec">ansible-on-clouds-op</code> container. Only the most recent backup of a deployment is used to restore the deployment.
					</li></ul></div></div></div><p class="Role ARG Spec Role ARG Spec">
			To backup and restore your Ansible Automation Platform deployment, it is vital to have your existing Ansible Automation Platform administration secret name and value recorded somewhere safe.
		</p><p class="Role ARG Spec Role ARG Spec">
			It is also important to take regular manual backups of the Cloud SQL database instance and filestore backups, to ensure a deployment can be restored as close as possible to its previous working state.
		</p><p class="Role ARG Spec Role ARG Spec">
			The playbooks backup and restore provides backup and restore support for the Ansible Automation Platform from GCP Marketplace foundation deployment.
		</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
				The restore process deploys a new Ansible Automation Platform with the filestore and SQL database instance being restored to the specified backup.
			</p></div></div><section class="section Role ARG Spec" id="con-gcp-backup-process"><div class="titlepage"><div><div><h2 class="title">9.1. The Backup Process</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				A backup enables you to backup your environment by saving the database and the shared file system. A new environment is created during the restore using the saved shared file system. When the new environment is in place, the process restores the database.
			</p><p class="Role ARG Spec Role ARG Spec">
				The backup and restore process must use the same version. If your backup was done with an earlier version, you must use the restore process of that version. Then, if required, you can run an upgrade.
			</p><p class="Role ARG Spec Role ARG Spec">
				You must also make a backup before an upgrade. For further information, see <a class="link" href="#assembly-gcp-upgrade" title="Chapter 10. Upgrading your deployment">Upgrading your deployment</a>
			</p><p class="Role ARG Spec Role ARG Spec">
				The backup process involves taking a backup of the Cloud SQL database and filestore instances at a given point in time. The backup playbook requires an active Ansible Automation Platform from GCP Marketplace foundation deployment to be running.
			</p><p class="Role ARG Spec Role ARG Spec">
				A bucket needs to be created in your project as restore information will be stored in that bucket.
			</p><p class="Role ARG Spec Role ARG Spec">
				Only one backup per version is kept in the bucket, if multiple versions of the backup need to be retain then a new bucket must be created for the new version of the backup.
			</p><p class="Role ARG Spec Role ARG Spec">
				The following procedures describe how to backup the Ansible Automation Platform from GCP Marketplace deployment.
			</p><section class="section Role ARG Spec" id="proc-gcp-upgrade-pull-container-image_backup"><div class="titlepage"><div><div><h3 class="title">9.1.1. Pulling the ansible-on-clouds-ops 2.3 container image</h3></div></div></div><div class="itemizedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem"><p class="simpara">
							Pull the docker image for the <code class="literal Role ARG Spec">ansible-on-clouds-ops</code> 2.3 container with the same tag as the foundation deployment.
						</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
								Before pulling the docker image, make sure you are logged in to registry.redhat.com using docker. Use the following command to login to registry.redhat.com.
							</p><pre class="literallayout Role ARG Spec">$ docker login registry.redhat.io</pre><p class="Role ARG Spec Role ARG Spec">
								For more information about registry login, see <a class="link mimir-link-warn" href="https://access.redhat.com/RegistryAuthentication" title="This content is not included in Mimir.">Registry Authentication</a>
							</p></div></div><pre class="literallayout Role ARG Spec">$ export IMAGE=registry.redhat.io/ansible-on-clouds/ansible-on-clouds-ops-rhel8:2.3.20230221
$ docker pull $IMAGE --platform=linux/amd64</pre></li></ul></div><p class="Role ARG Spec Role ARG Spec">
					For EMEA regions (Europe, Middle East, Africa) run the following command instead:
				</p><pre class="literallayout Role ARG Spec">$ export IMAGE=registry.redhat.io/ansible-on-clouds/ansible-on-clouds-ops-emea-rhel8:2.3.20230221
$ docker pull $IMAGE --platform=linux/amd64</pre></section><section class="section Role ARG Spec" id="proc-gcp-setup-environment_backup"><div class="titlepage"><div><div><h3 class="title">9.1.2. Setting up the environment</h3></div></div></div><div class="itemizedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem"><p class="simpara">
							Create a folder to hold the configuration files.
						</p><pre class="literallayout Role ARG Spec">$ mkdir command_generator_data</pre></li></ul></div></section><section class="section Role ARG Spec" id="proc-gcp-create-data-file"><div class="titlepage"><div><div><h3 class="title">9.1.3. Creating the backup data file</h3></div></div></div><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem"><p class="simpara">
							Populate the <code class="literal Role ARG Spec">command_generator_data</code> directory with the configuration file template.
						</p><pre class="literallayout Role ARG Spec">docker run --rm -v $(pwd)/command_generator_data/:/data $IMAGE command_generator_vars gcp_backup_deployment --output-data-file /data/backup.yml</pre><p class="Role ARG Spec Role ARG Spec">
							Produces the following output:
						</p><pre class="literallayout Role ARG Spec">docker run --rm -v $(pwd)/command_generator_data/:/data $IMAGE \
command_generator_vars gcp_backup_deployment --output-data-file /data/backup.yml

===============================================
Playbook: gcp_backup_deployment
Description: This playbook is used to backup the Ansible Automation Platform from GCP Marketplace environment.
-----------------------------------------------
This playbook is used to backup the Ansible Automation Platform from GCP Marketplace environment.
For more information regarding backup and restore, visit our official documentation -
https://access.redhat.com/documentation/en-us/ansible_on_clouds/2.x/html/red_hat_ansible_automation_platform_from_gcp_marketplace_guide/assembly-gcp-backup-and-restore
-----------------------------------------------</pre></li><li class="listitem"><p class="simpara">
							Run the supplied command:
						</p><pre class="literallayout Role ARG Spec">$ docker run --rm -v $(pwd)/command_generator_data/:/data $IMAGE \
command_generator_vars gcp_backup_deployment --output-data-file /data/backup.yml</pre></li><li class="listitem"><p class="simpara">
							After running the command, a <code class="literal Role ARG Spec">/tmp/backup.yml</code> template file is created. This template file resembles the following:
						</p><pre class="literallayout Role ARG Spec">gcp_backup_deployment:
  cloud_credentials_path:
  deployment_name:
  extra_vars:
    gcp_bucket_backup_name:
    gcp_compute_region:
    gcp_compute_zone:</pre></li></ol></div></section><section class="section Role ARG Spec" id="ref-gcp-populate-backup-file"><div class="titlepage"><div><div><h3 class="title">9.1.4. Parameters in the backup.yml file</h3></div></div></div><p class="Role ARG Spec Role ARG Spec">
					You must populate the data file before triggering the backup. The following variables are parameters listed in the data file.
				</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem">
							<code class="literal Role ARG Spec">cloud_credentials_path</code> is the path for your Google Cloud service account credentials file. This must be an absolute path.
						</li><li class="listitem">
							<code class="literal Role ARG Spec">gcp_deployment_name</code> is the name of the AAP deployment manager deployment you want to back up.
						</li><li class="listitem">
							<code class="literal Role ARG Spec">gcp_bucket_backup_name</code> is the bucket that was previously created to use for the backup. Only the most recent backup is stored in the bucket. Every subsequent backup to the same bucket overwrites the backup files with the latest backup.
						</li><li class="listitem">
							<code class="literal Role ARG Spec">gcp_compute_region</code> is GCP region where the foundation deployment is deployed. This can be retrieved by checking the Deployments config in Deployment Manager.
						</li><li class="listitem">
							<code class="literal Role ARG Spec">gcp_compute_zone</code> is the GCP zone where the foundation deployment is deployed. This can be retrieved by checking the Deployments config in Deployment Manager.
						</li></ul></div></section><section class="section Role ARG Spec" id="proc-gcp-run-backup-playbook"><div class="titlepage"><div><div><h3 class="title">9.1.5. Running the backup playbook</h3></div></div></div><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem"><p class="simpara">
							To run the backup, run the command generator to generate the backup command.
						</p><pre class="literallayout Role ARG Spec">docker run --rm -v $(pwd)/command_generator_data:/data $IMAGE command_generator gcp_backup_deployment --data-file /data/backup.yml</pre><p class="Role ARG Spec Role ARG Spec">
							Resulting in the following ouput:
						</p><pre class="literallayout Role ARG Spec">-----------------------------------------------
Command to run playbook:

docker run --rm --env PLATFORM=GCP -v &lt;/path/to/gcp/service-account.json&gt;:/home/runner/.gcp/credentials:ro \
--env ANSIBLE_CONFIG=../gcp-ansible.cfg  $IMAGE redhat.ansible_on_clouds.gcp_backup_deployment \
-e 'gcp_service_account_credentials_json_path=/home/runner/.gcp/credentials  \
gcp_deployment_name=&lt;deployment_name&gt; gcp_compute_region=&lt;region&gt; \
gcp_compute_zone=&lt;zone&gt; gcp_bucket_backup_name=&lt;bucket&gt;'</pre></li><li class="listitem"><p class="simpara">
							Run the supplied backup command to trigger the backup.
						</p><pre class="literallayout Role ARG Spec">$ docker run --rm --env PLATFORM=GCP -v &lt;/path/to/gcp/service-account.json&gt;:/home/runner/.gcp/credentials:ro \
--env ANSIBLE_CONFIG=../gcp-ansible.cfg  $IMAGE redhat.ansible_on_clouds.gcp_backup_deployment \
-e 'gcp_service_account_credentials_json_path=/home/runner/.gcp/credentials  \
gcp_deployment_name=&lt;deployment_name&gt; gcp_compute_region=&lt;region&gt; \
gcp_compute_zone=&lt;zone&gt; gcp_bucket_backup_name=&lt;bucket&gt;'</pre></li><li class="listitem"><p class="simpara">
							When the playbook has finished running, the output resembles the following:
						</p><pre class="literallayout Role ARG Spec">TASK [redhat.ansible_on_clouds.standalone_gcp_backup : [backup_deployment] Print vars required for restore process] ***
ok: [localhost] =&gt;
  msg:
  - AAP on GCP Backup successful. Please note below the bucket name which is required for restore process.
  - &lt;bucket_name&gt;

PLAY RECAP **********************************************************************************************
localhost          : ok=33   changed=6    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0</pre></li></ol></div></section></section><section class="section Role ARG Spec" id="con-gcp-restore-process"><div class="titlepage"><div><div><h2 class="title">9.2. Restore Process</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				The restore process deploys a new deployment, and restores the filestore and SQL database instance to the specified backup.
			</p><div class="admonition important Role ARG Spec"><div class="admonition_header">Important</div><div><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem">
							You must restore with the same operational image version which was used for the backup.
						</li><li class="listitem">
							Backup and restore into an existing VPC network is not currently supported.
						</li><li class="listitem">
							You cannot delete the backed up environment before a restore because the database backups are stored in the deployment. Deleting your deployment therefore deletes the database backups.
						</li><li class="listitem">
							Versioned or point-in-time backups are not supported by the <code class="literal Role ARG Spec">ansible-on-clouds-op</code> container. Only the most recent backup of a deployment is used to restore the deployment.
						</li></ul></div></div></div><p class="Role ARG Spec Role ARG Spec">
				The following procedures describe how to restore the Ansible Automation Platform from GCP Marketplace deployment.
			</p><section class="section Role ARG Spec" id="proc-gcp-upgrade-pull-container-image_restore"><div class="titlepage"><div><div><h3 class="title">9.2.1. Pulling the ansible-on-clouds-ops 2.3 container image</h3></div></div></div><div class="itemizedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem"><p class="simpara">
							Pull the docker image for the <code class="literal Role ARG Spec">ansible-on-clouds-ops</code> 2.3 container with the same tag as the foundation deployment.
						</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
								Before pulling the docker image, make sure you are logged in to registry.redhat.com using docker. Use the following command to login to registry.redhat.com.
							</p><pre class="literallayout Role ARG Spec">$ docker login registry.redhat.io</pre><p class="Role ARG Spec Role ARG Spec">
								For more information about registry login, see <a class="link mimir-link-warn" href="https://access.redhat.com/RegistryAuthentication" title="This content is not included in Mimir.">Registry Authentication</a>
							</p></div></div><pre class="literallayout Role ARG Spec">$ export IMAGE=registry.redhat.io/ansible-on-clouds/ansible-on-clouds-ops-rhel8:2.3.20230221
$ docker pull $IMAGE --platform=linux/amd64</pre></li></ul></div><p class="Role ARG Spec Role ARG Spec">
					For EMEA regions (Europe, Middle East, Africa) run the following command instead:
				</p><pre class="literallayout Role ARG Spec">$ export IMAGE=registry.redhat.io/ansible-on-clouds/ansible-on-clouds-ops-emea-rhel8:2.3.20230221
$ docker pull $IMAGE --platform=linux/amd64</pre></section><section class="section Role ARG Spec" id="proc-gcp-setup-environment_restore"><div class="titlepage"><div><div><h3 class="title">9.2.2. Setting up the environment</h3></div></div></div><div class="itemizedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem"><p class="simpara">
							Create a folder to hold the configuration files.
						</p><pre class="literallayout Role ARG Spec">$ mkdir command_generator_data</pre></li></ul></div></section><section class="section Role ARG Spec" id="proc-gcp-generate-restore-yml-file"><div class="titlepage"><div><div><h3 class="title">9.2.3. Generating the restore.yml file</h3></div></div></div><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem"><p class="simpara">
							Run the command generator <code class="literal Role ARG Spec">command_generator_vars`</code> to generate <code class="literal Role ARG Spec">restore.yml</code>.
						</p><pre class="literallayout Role ARG Spec">docker run --rm -v $(pwd)/command_generator_data:/data $IMAGE command_generator_vars gcp_restore_deployment --output-data-file /data/restore.yml</pre><p class="Role ARG Spec Role ARG Spec">
							Providing the following output:
						</p><pre class="literallayout Role ARG Spec">===============================================
Playbook: gcp_restore_deployment
Description: This playbook is used to restore the Ansible Automation Platform from GCP Marketplace environment from a backup.
-----------------------------------------------
This playbook is used to restore the Ansible Automation Platform from GCP Marketplace environment from a backup.
For more information regarding backup and restore, visit our official documentation -
https://access.redhat.com/documentation/en-us/ansible_on_clouds/2.x/html/red_hat_ansible_automation_platform_from_gcp_marketplace_guide/assembly-gcp-backup-and-restore
-----------------------------------------------
Command generator template:

docker run --rm -v &lt;local_data_file_directory&gt;:/data $IMAGE command_generator gcp_restore_deployment --data-file /data/restore.yml</pre><p class="Role ARG Spec Role ARG Spec">
							The template resembles the following:
						</p><pre class="literallayout Role ARG Spec">gcp_restore_deployment:
  cloud_credentials_path:
  deployment_name:
  extra_vars:
    gcp_bucket_backup_name:
    gcp_cloud_sql_peering_network:
    gcp_compute_region:
    gcp_compute_zone:
    gcp_controller_internal_ip_address:
    gcp_existing_vpc:
    gcp_filestore_ip_range:
    gcp_hub_internal_ip_address:
    gcp_restored_deployment_name:</pre></li></ol></div></section><section class="section Role ARG Spec" id="ref-gcp-populate-restore-file"><div class="titlepage"><div><div><h3 class="title">9.2.4. Parameters of the restore.yml file</h3></div></div></div><p class="Role ARG Spec Role ARG Spec">
					You can only restore into a new VPC network.
				</p><div class="Role ARG Spec Role ARG Spec"><p class="title"><strong>For a new VPC</strong></p><p>
						If you want to restore using a new VPC set the following parameters:
					</p></div><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem">
							<code class="literal Role ARG Spec">gcp_existing_vpc</code> must be set to <code class="literal Role ARG Spec">false</code>.
						</li></ul></div><p class="Role ARG Spec Role ARG Spec">
					The following parameters must be removed:
				</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem">
							<code class="literal Role ARG Spec">gcp_filestore_ip_range</code>
						</li><li class="listitem">
							<code class="literal Role ARG Spec">gcp_cloud_sql_peering_network</code>
						</li><li class="listitem">
							<code class="literal Role ARG Spec">gcp_controller_internal_ip_address</code>
						</li><li class="listitem">
							<code class="literal Role ARG Spec">gcp_hub_internal_ip_address</code>
						</li></ul></div><p class="Role ARG Spec Role ARG Spec">
					Provide values for the following parameters:
				</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem">
							<code class="literal Role ARG Spec">gcp_existing_vpc</code> must be set to <code class="literal Role ARG Spec">false</code>.
						</li><li class="listitem">
							<code class="literal Role ARG Spec">cloud_credentials_path</code> is the path for your Google Cloud service account credentials file.
						</li><li class="listitem">
							<code class="literal Role ARG Spec">gcp_deployment_name</code> is the name of the AAP deployment manager deployment you want to back up.
						</li><li class="listitem">
							<code class="literal Role ARG Spec">gcp_restored_deployment_name</code> is the name under which the deployment must be restored. A new deployment will be created with this name. A deployment must not already exist with this name.
						</li><li class="listitem">
							<code class="literal Role ARG Spec">gcp_bucket_backup_name</code> is the bucket name you used for the backup.
						</li><li class="listitem">
							<code class="literal Role ARG Spec">gcp_compute_region</code> is the region where the backup was taken. This can be retrieved by checking the Deployments config in Deployment Manager.
						</li><li class="listitem">
							<code class="literal Role ARG Spec">gcp_compute_zone</code> is the zone where the backup was taken. This can be retrieved by checking the Deployments config in Deployment Manager.
						</li></ul></div></section><section class="section Role ARG Spec" id="ref-gcp-run-restore-command"><div class="titlepage"><div><div><h3 class="title">9.2.5. Running the restore command</h3></div></div></div><p class="Role ARG Spec Role ARG Spec">
					When <code class="literal Role ARG Spec">restore.yml</code> is populated, you can use the command generator to create the restore command.
				</p><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem"><p class="simpara">
							Run the command generator.
						</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
								As <code class="literal Role ARG Spec">/tmp</code> is used, the <code class="literal Role ARG Spec">&lt;local_data_file_directory&gt;</code> must be set to <code class="literal Role ARG Spec">/tmp</code> unless you chose a different location for <code class="literal Role ARG Spec">restore.yml</code>.
							</p></div></div><pre class="literallayout Role ARG Spec">$ docker run --rm -v $(pwd)/command_generator_data:/data $IMAGE command_generator gcp_restore_deployment --data-file /data/restore.yml</pre><p class="Role ARG Spec Role ARG Spec">
							This generates a new command containing all needed volumes, environment variables and parameters.
						</p><p class="Role ARG Spec Role ARG Spec">
							The generated command resembles the following:
						</p><pre class="literallayout Role ARG Spec">docker run --rm --env PLATFORM=GCP -v &lt;local_credential_file&gt;:/home/runner/.gcp/credentials:ro \
--env ANSIBLE_CONFIG=../gcp-ansible.cfg  $IMAGE redhat.ansible_on_clouds.gcp_restore_deployment \
-e 'gcp_service_account_credentials_json_path=/home/runner/.gcp/credentials  \
gcp_deployment_name=&lt;former_deployment_name&gt; gcp_restored_deployment_name=&lt;new_deployment_name&gt; \
gcp_compute_region=&lt;region&gt; gcp_compute_zone=&lt;zone&gt; gcp_bucket_backup_name=&lt;bucket&gt; gcp_existing_vpc=False'</pre></li><li class="listitem"><p class="simpara">
							Run the generated command.
						</p><pre class="literallayout Role ARG Spec">$ docker run --rm --env PLATFORM=GCP -v &lt;local_credential_file&gt;:/home/runner/.gcp/credentials:ro \
--env ANSIBLE_CONFIG=../gcp-ansible.cfg  $IMAGE redhat.ansible_on_clouds.gcp_restore_deployment \
-e 'gcp_service_account_credentials_json_path=/home/runner/.gcp/credentials  \
gcp_deployment_name=&lt;former_deployment_name&gt; gcp_restored_deployment_name=&lt;new_deployment_name&gt; \
gcp_compute_region=&lt;region&gt; gcp_compute_zone=&lt;zone&gt; gcp_bucket_backup_name=&lt;bucket&gt; gcp_existing_vpc=False'</pre></li><li class="listitem"><p class="simpara">
							When the playbook has completed, the output resembles the following:
						</p><pre class="literallayout Role ARG Spec">TASK [redhat.ansible_on_clouds.standalone_gcp_restore : Display internal IP addresses] ***
ok: [localhost] =&gt;
  msg:
  - 'Hub        internal IP: 192.168.240.21'
  - 'Controller internal IP: 192.168.240.20'

PLAY RECAP *********************************************************************
localhost                  : ok=33   changed=8    unreachable=0    failed=0    skipped=6    rescued=0    ignored=2</pre></li></ol></div></section></section></section><section class="chapter Role ARG Spec" id="assembly-gcp-upgrade"><div class="titlepage"><div><div><h1 class="title">Chapter 10. Upgrading your deployment</h1></div></div></div><p class="Role ARG Spec Role ARG Spec">
			You can upgrade your existing Ansible Automation Platform from GCP Marketplace deployment to the newer version. The upgrade process covers upgrading of automation hub and automation controller. The upgrade process takes roughly the same amount of time as a Ansible Automation Platform from GCP Marketplace deployment install.
		</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
				Ansible Automation Platform from GCP Marketplace supports sequential upgrades. All upgrades should be no more than one major version behind the version you are currently upgrading to. For example, to upgrade to Ansible Automation Platform from GCP Marketplace to 2.3.20230221-00, you must be on version 2.2.20230215-00.
			</p></div></div><div class="itemizedlist Role ARG Spec"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem">
					Docker must be installed to run the upgrade playbook.
				</li><li class="listitem">
					The upgrade process requires several volumes to be mounted. Prepare a fresh directory to be used for this process.
				</li></ul></div><p class="Role ARG Spec Role ARG Spec">
			The following procedures form the upgrade process:
		</p><div class="orderedlist Role ARG Spec"><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem"><p class="simpara">
					Backup your Ansible Automation Platform 2.2 stack.
				</p><div class="orderedlist Role ARG Spec"><ol class="orderedlist Role ARG Spec" type="a"><li class="listitem">
							Pull the <code class="literal Role ARG Spec">ansible-on-clouds-ops</code> 2.2 container image
						</li><li class="listitem">
							Prepare the environment
						</li><li class="listitem">
							Run the <code class="literal Role ARG Spec">ansible-on-clouds-ops</code> 2.2 container to backup the stack
						</li></ol></div></li><li class="listitem"><p class="simpara">
					Upgrade Ansible Automation Platform.
				</p><div class="orderedlist Role ARG Spec"><ol class="orderedlist Role ARG Spec" type="a"><li class="listitem">
							Pull the <code class="literal Role ARG Spec">ansible-on-clouds-ops</code> 2.3 container image
						</li><li class="listitem">
							Generate data files by running the <code class="literal Role ARG Spec">ansible-on-clouds-ops</code> container
						</li><li class="listitem">
							Update the data file
						</li><li class="listitem">
							Run the <code class="literal Role ARG Spec">ansible-on-clouds-ops</code> 2.3 container to upgrade your Ansible Automation Platform from GCP Marketplace deployment
						</li></ol></div></li><li class="listitem"><p class="simpara">
					(Optional) Restore the stack from backup.
				</p><div class="orderedlist Role ARG Spec"><ol class="orderedlist Role ARG Spec" type="a"><li class="listitem">
							Pull the <code class="literal Role ARG Spec">ansible-on-clouds-ops</code> 2.2 container image
						</li><li class="listitem">
							Prepare the environment
						</li><li class="listitem">
							Run the <code class="literal Role ARG Spec">ansible-on-clouds-ops</code> 2.2 container to restore the stack
						</li></ol></div></li></ol></div><section class="section Role ARG Spec" id="con-gcp-upgrade-backup-process"><div class="titlepage"><div><div><h2 class="title">10.1. Backing up before the upgrade</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				The following procedures backup the deployment before the upgrade process begins.
			</p><section class="section Role ARG Spec" id="proc-gcp-pull-backup-container-image"><div class="titlepage"><div><div><h3 class="title">10.1.1. Pulling the ansible-on-clouds-ops 2.2 container image</h3></div></div></div><div class="itemizedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem"><p class="simpara">
							Pull the <code class="literal Role ARG Spec">ansible-on-clouds-ops 2.2</code> container image with the same tag version as the foundation deployment.
						</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
								Before pulling the docker image, make sure you are logged in to registry.redhat.com using docker. Use the following command to login to registry.redhat.com.
							</p><pre class="literallayout Role ARG Spec">$ docker login registry.redhat.io</pre><p class="Role ARG Spec Role ARG Spec">
								For more information about registry login, see <a class="link mimir-link-warn" href="https://access.redhat.com/RegistryAuthentication" title="This content is not included in Mimir.">Registry Authentication</a>
							</p></div></div><pre class="literallayout Role ARG Spec">$ export IMAGE=registry.redhat.io/ansible-on-clouds/ansible-on-clouds-ops-rhel8:2.2.20230215
$ docker pull $IMAGE --platform=linux/amd64</pre></li></ul></div><p class="Role ARG Spec Role ARG Spec">
					For EMEA regions (Europe, Middle East, Africa) run the following command instead:
				</p><pre class="literallayout Role ARG Spec">$ export IMAGE=registry.redhat.io/ansible-on-clouds/ansible-on-clouds-ops-emea-rhel8:2.2.20230215
$ docker pull $IMAGE --platform=linux/amd64</pre></section><section class="section Role ARG Spec" id="proc-gcp-prepare-backup-environment_backup"><div class="titlepage"><div><div><h3 class="title">10.1.2. Preparing the backup environment</h3></div></div></div><div class="itemizedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem"><p class="simpara">
							Create the directories used to configure the upgrade process using the following commands:
						</p><pre class="literallayout Role ARG Spec"># Secrets directory. Store the GCP credentials file.
$ mkdir secrets
# Extra vars directory. All the configuration variables for the upgrade process.
$ mkdir extra_vars</pre></li></ul></div></section><section class="section Role ARG Spec" id="proc-gcp-backup-platform-stack"><div class="titlepage"><div><div><h3 class="title">10.1.3. Backing up your Ansible Automation Platform stack</h3></div></div></div><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem"><p class="simpara">
							Store your service account credential JSON file in the <code class="literal Role ARG Spec">/secrets</code> directory.
						</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
								To create the GCP credentials file, see, <a class="link mimir-link-warn" href="https://developers.google.com/workspace/guides/create-credentials" title="Mimir does not include content from: developers.google.com">Create credentials</a> and <a class="link mimir-link-warn" href="https://cloud.google.com/iam/docs/keys-create-delete" title="Mimir does not include content from: cloud.google.com">Create and delete service account keys</a>
							</p></div></div></li><li class="listitem"><p class="simpara">
							The <code class="literal Role ARG Spec">extra_vars.yml</code> file contains the following input variables within the <code class="literal Role ARG Spec">extra_vars</code> directory:
						</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem"><p class="simpara">
									<code class="literal Role ARG Spec">gcp_service_account_credentials_json_path</code> is the service account credential JSON file path for the Google cloud account. This is the path within an <code class="literal Role ARG Spec">ansible-on-clouds-ops</code> container where the credentials JSON file is mounted to the <code class="literal Role ARG Spec">/secrets</code> directory. The path should be <code class="literal Role ARG Spec">/secrets/&lt;service-account-creds-json-filename&gt;</code>.
								</p><p class="Role ARG Spec Role ARG Spec">
									Replace <code class="literal Role ARG Spec">&lt;service-account-creds-json-filename&gt;</code> with your Google service account credential filename.
								</p></li><li class="listitem">
									<code class="literal Role ARG Spec">gcp_deployment_name</code> is the deployment name that you want to upgrade.
								</li><li class="listitem">
									<code class="literal Role ARG Spec">gcp_compute_region</code> is the GCP region that you provided when deploying foundation deployment. If you have not provided a region when deploying the foundation, use the default region <code class="literal Role ARG Spec">us-east1</code> here.
								</li><li class="listitem"><p class="simpara">
									<code class="literal Role ARG Spec">gcp_compute_zone</code> is the GCP zone that you provided when deploying foundation deployment. If you have not provided a zone when deploying the foundation, use the default <code class="literal Role ARG Spec">us-east1-b</code> here.
								</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
										You can find the region and zone from the filestore instance deployed with the foundation deployment. Look for the filestore with the name <code class="literal Role ARG Spec">&lt;deployment-name&gt;-filestore</code>.
									</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="circle"><li class="listitem">
												Make note of the location field that is your <code class="literal Role ARG Spec">gcp_compute_zone</code>. For example, the filestore instance location might be <code class="literal Role ARG Spec">us-east1-d</code>
											</li><li class="listitem">
												Remove the last two characters from the location that is your <code class="literal Role ARG Spec">gcp_compute_region</code>. For example, if your <code class="literal Role ARG Spec">gcp_compute_zone</code> location is <code class="literal Role ARG Spec">us-east1-d</code>, your region is <code class="literal Role ARG Spec">us-east1</code>.
											</li></ul></div></div></div><pre class="literallayout Role ARG Spec">gcp_service_account_credentials_json_path: "/secrets/&lt;service-account-creds-json-filename&gt;"
gcp_deployment_name: ""
gcp_compute_region: ""
gcp_compute_zone: ""</pre></li></ul></div></li><li class="listitem"><p class="simpara">
							The final result should look similar to the following:
						</p><pre class="literallayout Role ARG Spec">$ tree
tree
.
├── extra_vars
│   └── extra_vars.yaml
└── secrets
    └── gc-ansible-cloud-123434.json</pre></li></ol></div></section><section class="section Role ARG Spec" id="proc-gcp-run-backup-playbook-as-container"><div class="titlepage"><div><div><h3 class="title">10.1.4. Running the backup playbook as a container</h3></div></div></div><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem">
							Replace <code class="literal Role ARG Spec">&lt;absolute path to Google application credentials dir&gt;</code> with the path to the service account credential JSON file for the Google cloud.
						</li><li class="listitem">
							Replace <code class="literal Role ARG Spec">&lt;absolute path of extra vars dir&gt;</code> with the path to the directory where the <code class="literal Role ARG Spec">extra_vars.yml</code> file you created in <a class="link" href="#proc-gcp-backup-platform-stack" title="10.1.3. Backing up your Ansible Automation Platform stack">step 1</a> of the backup process.
						</li><li class="listitem"><p class="simpara">
							Use the following command to run the playbook:
						</p><pre class="literallayout Role ARG Spec">$ docker run --rm \
-v &lt;absolute path to google application credentials dir&gt;:/secrets:ro \
-v &lt;absolute path of extra vars dir&gt;:/extra_vars:ro \
$IMAGE \
redhat.ansible_on_clouds.gcp_backup_deployment \
-e @/extra_vars/extra_vars.yaml</pre></li><li class="listitem"><p class="simpara">
							Note the output of the playbook.
						</p><p class="Role ARG Spec Role ARG Spec">
							The playbook output resembles the following:
						</p><pre class="literallayout Role ARG Spec">TASK [redhat.ansible_on_clouds.standalone_gcp_backup : [backup_deployment] Print vars required for restore process] ***
ok: [localhost] =&gt; {
    "msg": [
        "AAP on GCP Backup successful. Please note below vars which are required for restore process.",
        "{ gcp_sql_backup_id: 1677552759614 , gcp_sql_backup_db_name: test-bnr-aap-db ,gcp_filestore_backup_name: test-bnr-filestore-iygs }"
    ]
}</pre><div class="admonition important Role ARG Spec"><div class="admonition_header">Important</div><div><p class="Role ARG Spec Role ARG Spec">
								Make a note of the SQL database backup ID, SQL database backup name and the filestore backup name. You will require these for the restore playbook.
							</p></div></div></li></ol></div></section></section><section class="section Role ARG Spec" id="con-gcp-upgrade-upgrading"><div class="titlepage"><div><div><h2 class="title">10.2. Upgrading Ansible Automation Platform</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				The following procedures form the upgrading process for Ansible Automation Platform from GCP Marketplace.
			</p><section class="section Role ARG Spec" id="proc-gcp-upgrade-pull-container-image"><div class="titlepage"><div><div><h3 class="title">10.2.1. Pulling the ansible-on-clouds-ops 2.3 container image</h3></div></div></div><div class="itemizedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem"><p class="simpara">
							Pull the docker image for the <code class="literal Role ARG Spec">ansible-on-clouds-ops</code> 2.3 container with the same tag as the version you want to upgrade to.
						</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
								Before pulling the docker image, make sure you are logged in to registry.redhat.com using docker. Use the following command to login to registry.redhat.com.
							</p><pre class="literallayout Role ARG Spec">$ docker login registry.redhat.io</pre><p class="Role ARG Spec Role ARG Spec">
								For more information about registry login, see <a class="link mimir-link-warn" href="https://access.redhat.com/RegistryAuthentication" title="This content is not included in Mimir.">Registry Authentication</a>
							</p></div></div><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
								The <code class="literal Role ARG Spec">ansible-on-clouds-ops</code> container image tag must match the version that you want to upgrade to. For example, if your foundation deployment version is 2.2.20230215-00, pull the <code class="literal Role ARG Spec">ansible-on-clouds-ops</code> image with tag 2.3.20230221 to upgrade to version 2.3.20230221.
							</p></div></div><pre class="literallayout Role ARG Spec">$ export IMAGE=registry.redhat.io/ansible-on-clouds/ansible-on-clouds-ops-rhel8:2.3.20230221
$ docker pull $IMAGE --platform=linux/amd64</pre></li></ul></div><p class="Role ARG Spec Role ARG Spec">
					For EMEA regions (Europe, Middle East, Africa) run the following command instead:
				</p><pre class="literallayout Role ARG Spec">$ export IMAGE=registry.redhat.io/ansible-on-clouds/ansible-on-clouds-ops-emea-rhel8:2.3.20230221
$ docker pull $IMAGE --platform=linux/amd64</pre></section><section class="section Role ARG Spec" id="proc-gcp-generate-upgrade-data-file"><div class="titlepage"><div><div><h3 class="title">10.2.2. Generating the data file</h3></div></div></div><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem"><p class="simpara">
							Run the following commands to generate the required data file. These commands create a directory, and populate it with an empty data template that, when populated, is used during the upgrade.
						</p><pre class="literallayout Role ARG Spec"># Create a folder to hold the configuration files
$ mkdir command_generator_data
# Populate command_generator_data folder with configuration file template
$ docker run --rm -v $(pwd)/command_generator_data:/data $IMAGE \
command_generator_vars gcp_upgrade \
--output-data-file /data/extra_vars.yml</pre></li><li class="listitem"><p class="simpara">
							After running the previous commands, a <code class="literal Role ARG Spec">command_generator_data/extra_vars.yml</code> template is created. This template file should resemble:
						</p><pre class="literallayout Role ARG Spec">  gcp_upgrade:
  ansible_config_path:
  cloud_credentials_path:
  deployment_name:
  extra_vars:
    gcp_backup_taken:
    gcp_compute_region:
    gcp_compute_zone:</pre></li></ol></div></section><section class="section Role ARG Spec" id="ref-gcp-update-upgrade-data-file"><div class="titlepage"><div><div><h3 class="title">10.2.3. Updating the data file</h3></div></div></div><p class="Role ARG Spec Role ARG Spec">
					You must populate the data file before triggering the upgrade. The following variables are parameters listed in the data file.
				</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem">
							<code class="literal Role ARG Spec">ansible_config_path</code> (Optional) Only use if overriding with a custom ansible_config.
						</li><li class="listitem">
							<code class="literal Role ARG Spec">cloud_credentials_path</code> is the path to your GCP credentials file.
						</li><li class="listitem">
							<code class="literal Role ARG Spec">deployment_name</code> is the name of the foundation deployment. This is the same name you used when you deployed the foundation.
						</li><li class="listitem">
							<code class="literal Role ARG Spec">gcp_backup_taken</code> is the verification that a manual backup of the current deployment was recently created prior to running this upgrade. Use <code class="literal Role ARG Spec">true</code> here to verify a recent backup was created.
						</li><li class="listitem">
							<code class="literal Role ARG Spec">gcp_compute_region</code> is the GCP region that you provided when deploying foundation deployment. If you have not provided a region when deploying the foundation, use the default region <code class="literal Role ARG Spec">us-east1</code> here.
						</li><li class="listitem">
							<code class="literal Role ARG Spec">gcp_compute_zone</code> is the GCP zone that you provided when deploying foundation deployment. If you have not provided a zone when deploying the foundation, use the default <code class="literal Role ARG Spec">us-east1-b</code> here.
						</li></ul></div><p class="Role ARG Spec Role ARG Spec">
					After populating the data file, it should resemble the following.
				</p><p class="Role ARG Spec Role ARG Spec">
					The following values are provided as examples:
				</p><pre class="literallayout Role ARG Spec">gcp_upgrade:
  ansible_config_path:
  cloud_credentials_path: ~/secrets/GCP-secrets.json
  deployment_name: AnsibleAutomationPlatform
  extra_vars:
    gcp_backup_taken: true
    gcp_compute_region: us-east1
    gcp_compute_zone: us-east1-b</pre></section><section class="section Role ARG Spec" id="proc-gcp-running-upgrade"><div class="titlepage"><div><div><h3 class="title">10.2.4. Running the upgrade playbook</h3></div></div></div><div class="orderedlist Role ARG Spec"><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem"><p class="simpara">
							To run the upgrade, run the command generator to generate the upgrade CLI command:
						</p><pre class="literallayout Role ARG Spec">$ docker run --rm -v $(pwd)/command_generator_data:/data $IMAGE command_generator --data-file /data/extra_vars.yml</pre><p class="Role ARG Spec Role ARG Spec">
							This generates the following command:
						</p><pre class="literallayout Role ARG Spec">-----------------------------------------------
docker run --rm --env PLATFORM=GCP -v ~/secrets/GCP-secrets.json:/home/runner/.gcp/credentials:ro
--env ANSIBLE_CONFIG=../gcp-ansible.cfg
--env DEPLOYMENT_NAME=AnsibleAutomationPlatform
--env GENERATE_INVENTORY=true  $IMAGE redhat.ansible_on_clouds.gcp_upgrade \
-e 'gcp_deployment_name=AnsibleAutomationPlatform \
gcp_service_account_credentials_json_path=/home/runner/.gcp/credentials \
gcp_compute_region=us-east1 gcp_compute_zone=us-east1-b gcp_backup_taken=True'
===============================================</pre></li><li class="listitem"><p class="simpara">
							Run the given upgrade command to trigger the upgrade.
						</p><pre class="literallayout Role ARG Spec">$ docker run --rm --env PLATFORM=GCP -v ~/secrets/GCP-secrets.json:/home/runner/.gcp/credentials:ro \
--env ANSIBLE_CONFIG=../gcp-ansible.cfg \
--env DEPLOYMENT_NAME=AnsibleAutomationPlatform \
--env GENERATE_INVENTORY=true  $IMAGE redhat.ansible_on_clouds.gcp_upgrade \
-e 'gcp_deployment_name=AnsibleAutomationPlatform \
gcp_service_account_credentials_json_path=/home/runner/.gcp/credentials \
gcp_compute_region=us-east1 gcp_compute_zone=us-east1-b gcp_backup_taken=True'</pre></li><li class="listitem"><p class="simpara">
							The upgrade can take some time to complete, but can take longer depending on the number of extension nodes on the system. A successful upgrade is marked by the log below.
						</p><pre class="literallayout Role ARG Spec">TASK [redhat.ansible_on_clouds.standalone_gcp_upgrade : [upgrade] Show GCP current version] ***
ok: [localhost] =&gt; {
    "msg": "gcp_current_version: 2.3.20230221-00"
}</pre></li><li class="listitem">
							Your Ansible Automation Platform from GCP Marketplace deployment is now upgraded to a newer version and you can log in to Red Hat Ansible Automation Platform automation controller and automation hub using your deployment credentials.
						</li></ol></div></section></section><section class="section Role ARG Spec" id="con-gcp-upgrade-restore-from-stack"><div class="titlepage"><div><div><h2 class="title">10.3. Restoring the stack from backups</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				If, for some reason, the upgrade process fails, you can use the backup files from <a class="link" href="#proc-gcp-backup-platform-stack" title="10.1.3. Backing up your Ansible Automation Platform stack">Backing up your Ansible Automation Platform stack</a> to restore your stack.
			</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
					The following procedures are optional.
				</p></div></div><p class="Role ARG Spec Role ARG Spec">
				If the upgrade process fails, you can use the backup files from <a class="link" href="#con-gcp-upgrade-backup-process" title="10.1. Backing up before the upgrade">Backing up before the upgrade</a> to restore your stack. The restore process installs a new deployment, and restores the filestore and SQL database instance to the specified backup.
			</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
					The restored filestore instance uses CIDR network range 192.168.244.0/29, which is different from the default network filestore network range of the backup deployment.
				</p></div></div><p class="Role ARG Spec Role ARG Spec">
				The following instructions describe how to run the restore playbook.
			</p><section class="section Role ARG Spec" id="proc-gcp-from-stack-pull-container-image"><div class="titlepage"><div><div><h3 class="title">10.3.1. Pulling the ansible-on-clouds-ops 2.2 container image to restore the stack</h3></div></div></div><div class="itemizedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem"><p class="simpara">
							Pull the <code class="literal Role ARG Spec">ansible-on-clouds-ops 2.2</code> container image with the same tag version as the foundation deployment.
						</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
								Before pulling the docker image, make sure you are logged in to registry.redhat.com using docker. Use the following command to login to registry.redhat.com.
							</p><pre class="literallayout Role ARG Spec">$ docker login registry.redhat.io</pre><p class="Role ARG Spec Role ARG Spec">
								For more information about registry login, see <a class="link mimir-link-warn" href="https://access.redhat.com/RegistryAuthentication" title="This content is not included in Mimir.">Registry Authentication</a>
							</p></div></div><pre class="literallayout Role ARG Spec">$ export IMAGE=registry.redhat.io/ansible-on-clouds/ansible-on-clouds-ops-rhel8:2.2.20230215
$ docker pull $IMAGE --platform=linux/amd64</pre></li></ul></div><p class="Role ARG Spec Role ARG Spec">
					For EMEA regions (Europe, Middle East, Africa) run the following command instead:
				</p><pre class="literallayout Role ARG Spec">$ export IMAGE=registry.redhat.io/ansible-on-clouds/ansible-on-clouds-ops-emea-rhel8:2.2.20230215
$ docker pull $IMAGE --platform=linux/amd64</pre></section><section class="section Role ARG Spec" id="proc-gcp-prepare-backup-environment_restore"><div class="titlepage"><div><div><h3 class="title">10.3.2. Preparing the backup environment</h3></div></div></div><div class="itemizedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem"><p class="simpara">
							Create the directories used to configure the upgrade process using the following commands:
						</p><pre class="literallayout Role ARG Spec"># Secrets directory. Store the GCP credentials file.
$ mkdir secrets
# Extra vars directory. All the configuration variables for the upgrade process.
$ mkdir extra_vars</pre></li></ul></div></section><section class="section Role ARG Spec" id="proc-gcp-run-restore-playbook-as-container"><div class="titlepage"><div><div><h3 class="title">10.3.3. Running the restore playbook as a container</h3></div></div></div><div class="orderedlist Role ARG Spec"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist Role ARG Spec" type="1"><li class="listitem">
							Replace <code class="literal Role ARG Spec">&lt;absolute path to Google application credentials dir&gt;</code> with the path to the service account credential JSON file for the Google cloud.
						</li><li class="listitem">
							Replace <code class="literal Role ARG Spec">&lt;absolute path of extra vars dir&gt;</code> with the path to the <code class="literal Role ARG Spec">extra_vars.yml</code> file you created in <a class="link" href="#proc-gcp-prepare-backup-environment_backup" title="10.1.2. Preparing the backup environment">Preparing the backup environment</a>.
						</li><li class="listitem"><p class="simpara">
							Use the following command to run the playbook.
						</p><pre class="literallayout Role ARG Spec">$ docker run --rm \
-v &lt;absolute path to Google application credentials dir&gt;:/secrets:ro \
-v &lt;absolute path of extra vars dir&gt;:/extra_vars:ro \
$IMAGE \
redhat.ansible_on_clouds.gcp_restore_deployment \
-e @/extra_vars/extra_vars.yaml</pre></li><li class="listitem"><p class="simpara">
							When you have run the playbook, a new restored deployment is visible in the GCP deployment. It can take a few minutes for the deployment to finish and for all the containers to run.
						</p><div class="admonition note Role ARG Spec"><div class="admonition_header">Note</div><div><p class="Role ARG Spec Role ARG Spec">
								Access to the restored deployment must be configured through either an external load balancer or VPN. When a connection method is configured you can log in to Red Hat Ansible Automation Platform automation controller and automation hub using your old deployment credentials. In addition, all job history, uploaded collections and other records must be in the same state as the restored deployment.
							</p></div></div></li></ol></div></section></section></section><section class="chapter Role ARG Spec" id="assembly-gcp-tech-notes"><div class="titlepage"><div><div><h1 class="title">Chapter 11. Technical Notes</h1></div></div></div><p class="Role ARG Spec Role ARG Spec">
			Ansible Automation Platform from GCP Marketplace is a self-managed deployment. The following are technical notes regarding the Ansible Automation Platform from GCP Marketplace deployment.
		</p><section class="section Role ARG Spec" id="tech-note-aws-vm-limitations"><div class="titlepage"><div><div><h2 class="title">11.1. Virtual Machine Limitations</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				You cannot restart virtual machines, instead virtual machines must be replaced. You cannot configure on virtual machines, because any configuration is lost when virtual machines are replaced. This always happens on upgrade.
			</p></section></section><section class="chapter Role ARG Spec" id="assembly-gcp-support"><div class="titlepage"><div><div><h1 class="title">Chapter 12. Support</h1></div></div></div><p class="Role ARG Spec Role ARG Spec">
			Ansible Automation Platform from GCP Marketplace is a self-managed deployment. When the application is deployed into your GCP infrastructure, customers are responsible for the maintenance of the GCP infrastructure and Ansible Automation Platform patching. However, Red Hat does not support any changes to the infrastructure resources deployed as part of the solution unless there is documentation by Red Hat to do so, such as in route table configuration for networking or documented upgrade processes. Adding additional compute resources outside of extension nodes voids Red Hat support for the Ansible Automation Platform from GCP Marketplace deployment.
		</p><section class="section Role ARG Spec" id="ref-gcp-vm-image-packages"><div class="titlepage"><div><div><h2 class="title">12.1. VM Image packages</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				Ansible Automation Platform from GCP Marketplace is delivered through virtual machines that are based on a VM image produced by the Red Hat Ansible team. This image contains packages from Red Hat and Google in order to properly function on Google Cloud Platform and run Red Hat Ansible Automation Platform. The image contains the following Google packages and containers:
			</p><div class="informaltable"><table class="lt-4-cols lt-7-rows Role ARG Spec"><colgroup><col style="width: 43%; " class="col_1"><!--Empty--></col><col style="width: 57%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140691883029040" scope="col">Package Name</th><th align="left" valign="top" id="idm140691883027952" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140691883029040"> <p>
								<code class="literal Role ARG Spec">google-osconfig-agent</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140691883027952"> <p>
								The Google OS Configuration Agent uses the management service to deploy, query, and maintain consistent configurations, that is, the desired state and software for your VM instance.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140691883029040"> <p>
								<code class="literal Role ARG Spec">google-cloud-ops-agent</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140691883027952"> <p>
								The Ops Agent is the primary agent for collecting telemetry from your Compute Engine instances. Combining logging and metrics into a single agent, the Ops Agent uses Fluent Bit for logs, which supports high-throughput logging, and the OpenTelemetry Collector for metrics.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140691883029040"> <p>
								<code class="literal Role ARG Spec">gce-proxy</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140691883027952"> <p>
								The Cloud SQL Authorization proxy is used to connect Ansible Automation Platform components with the Cloud SQL database using the virtual machine service account.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140691883029040"> <p>
								<code class="literal Role ARG Spec">gcloud CLI</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140691883027952"> <p>
								The gcloud command line interface is used to configure the Ansible Automation Platform installation.
							</p>
							 </td></tr></tbody></table></div><p class="Role ARG Spec Role ARG Spec">
				Upgrades, including package updates and CVE patches, will be provided as new VM images through the GCP Marketplace. Red Hat operates within its premium support policies for providing updated machine images to Red Hat Ansible Automation Platform from GCP Marketplace, and will provide upgrade instructions to customers when upgradable machine images are available.
			</p></section><section class="section Role ARG Spec" id="ref-gcp-supported-changes"><div class="titlepage"><div><div><h2 class="title">12.2. Supported infrastructure configuration changes</h2></div></div></div><p class="Role ARG Spec Role ARG Spec">
				Red Hat supports changes to the following options:
			</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem">
						VPC Route Configuration
					</li><li class="listitem">
						VPC Firewall Configuration
					</li><li class="listitem">
						VPC Load Balancer Configuration
					</li><li class="listitem">
						Block Storage Expansion
					</li><li class="listitem">
						DNS and <code class="literal Role ARG Spec">resolv.conf</code> files
					</li></ul></div><div class="Role ARG Spec Role ARG Spec"><p class="title"><strong>Red Hat Responsibilities</strong></p><p>
					Red Hat has the following responsibilities.
				</p></div><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem">
						Premium support for Ansible Automation Platform.
					</li><li class="listitem"><p class="simpara">
						Directions and how-to processes for upgrading Ansible Automation Platform from GCP Marketplace.
					</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="circle"><li class="listitem">
								Provided through knowledge base articles when upgrades are published.
							</li></ul></div></li></ul></div><div class="Role ARG Spec Role ARG Spec"><p class="title"><strong>Customer Responsibilities</strong></p><p>
					You have the following responsibilities:
				</p></div><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="disc"><li class="listitem">
						GCP Infrastructure Uptime
					</li><li class="listitem">
						GCP Infrastructure Changes (ex: increasing block storage sizes)
					</li><li class="listitem">
						GCP Network Peering and Configuration
					</li><li class="listitem">
						Backing up Ansible data from GCP databases and file storageResources
					</li><li class="listitem"><p class="simpara">
						Application of Ansible Automation Platform upgrades
					</p><div class="itemizedlist Role ARG Spec"><ul class="itemizedlist Role ARG Spec" type="circle"><li class="listitem">
								Upgrade instructions will be provided at upgrade time through Red Hat Knowledge Base articles.
							</li></ul></div></li></ul></div></section></section><div><div xml:lang="en-US" class="legalnotice" id="idm140691889446160"><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"><!--Empty--></span>© 2023 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri mimir-link-warn" href="http://creativecommons.org/licenses/by-sa/3.0/" title="Mimir does not include content from: creativecommons.org">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div></body>

        
        
    </div>
    

</div> 


                            </bdo>
                        </main>
                    </div>
                </main>
            </div>
        
            <!--#include virtual="/includes/footer/index.html" -->
        </div>
    </body>
</html>
