<!DOCTYPE html>
<html>
    <head>
        
        <link rel="stylesheet" type="text/css" media="screen" href="/mimir/styles/mimir.min.css">
        




    <link rel="stylesheet" type="text/css" media="screen" href="/sites/dxp-docs/files/css/css_87GMcmxT1ib8ziQiU2KUAnTDFtZQV6iP-KGslA9LigM.css" />

    <link rel="stylesheet" type="text/css" media="screen" href="/sites/dxp-docs/files/css/css_Bwzy34i9pSdDlzGALvqVwG4fpgGp08KLMAkClGNY9M4.css" />



<link rel="stylesheet" type="text/css" media="screen" href="/mimir/styles/mimir-doc-toc.min.css" />



        
        <!--#include virtual="/includes/head/index.html" -->

        
        <title>
Security Guide - JBoss Enterprise Application Platform Common Criteria Certification 6.2.2
</title>
        
<meta name="product" content="JBoss Enterprise Application Platform Common Criteria Certification" />
<meta name="documentation_version" content="6.2.2" />
<meta name="documentKind" content="documentation" />
<meta name="portal_content_subtype" content="title" />
<meta name="lastModifiedDate" content="2017-11-28T18:42:47.000Z" />


        
            
        
        
            
                
                
                <!-- mimir_solr_yesindex -->
                <meta name="mimir_solr_yesindex" content="true" />
            
        
    </head>

    <body class="mimir-body">

        
        

        
        <div id="page-wrap" class="page-wrap">
            <div id="pers-top-page-wrap" class="top-page-wrap pers-loader-bg">
                <div id="hero-bg-top-left" class="summit-bg-shapes"></div>
                <div id="hero-bg-top-right" class="summit-bg-shapes"></div>

                <header class="masthead" id="masthead">

                    
                    <!--#include virtual="/includes/header/index.html" -->

                    
                    
                    
                        
                    
                    
                        <div class="breadcrumbs">
                            <div id="breadcrumbs" class="container">
                                
                                <a href="/">Home</a>
                                
                                <a href="/products/">Product Documentation</a>
                                
                                <a href="/documentation/en-us/jboss_enterprise_application_platform_common_criteria_certification/7.2.3/">JBoss Enterprise Application Platform Common Criteria Certification</a>
                                
                                <a href="/documentation/en-us/jboss_enterprise_application_platform_common_criteria_certification/6.2.2/">6.2.2</a>
                                
                                
                                Security Guide
                                
                            </div>
                        </div>
                    
                </header>

                <main id="cp-main" class="portal-content-area">
                    <div id="cp-content" class="main-content">
                        
                        <main class="container mimir-docs">
                            
                            <bdo>
                                

<script type="module" src="/mimir/scripts/mimir-doc-toc.min.js"></script>






<div class="docs-grid">

    <nav id="mimir-doc-toc" class="mimir-doc-toc">
      <div class="mimir-doc-toc-inner">
          <!-- single-page -->
        
            
              <ol>
                <li>
                        
                        <a href="#">Security Guide</a>
                    </li><li>
                        <a href="#part-Security_for_Red_Hat_JBoss_Enterprise_Application_Platform_6">
                            I. Security for Red Hat JBoss Enterprise Application Platform 6
                        </a><ol>
                <li>
                        <a href="#chap-Introduction">
                            1. Introduction
                        </a><ol>
                <li>
                        <a href="#About_JBoss_Enterprise_Application_Platform_6">
                            1.1. About Red Hat JBoss Enterprise Application Platform 6 (JBoss EAP 6)
                        </a>
                    </li><li>
                        <a href="#About_Security">
                            1.2. About Securing JBoss Enterprise Application Platform 6
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#chap-Security_Overview">
                            2. Security Overview
                        </a><ol>
                <li>
                        <a href="#sect-About_Declarative_Security">
                            2.1. About Declarative Security
                        </a><ol>
                <li>
                        <a href="#Java_EE_Declarative_Security_Overview">
                            2.1.1. Java EE Declarative Security Overview
                        </a>
                    </li><li>
                        <a href="#Security_References">
                            2.1.2. Security References
                        </a>
                    </li><li>
                        <a href="#Security_Identity">
                            2.1.3. Security Identity
                        </a>
                    </li><li>
                        <a href="#Security_Roles1">
                            2.1.4. Security Roles
                        </a>
                    </li><li>
                        <a href="#EJB_Method_Permissions">
                            2.1.5. EJB Method Permissions
                        </a>
                    </li><li>
                        <a href="#Enterprise_Beans_Security_Annotations">
                            2.1.6. Enterprise Beans Security Annotations
                        </a>
                    </li><li>
                        <a href="#Web_Content_Security_Constraints">
                            2.1.7. Web Content Security Constraints
                        </a>
                    </li><li>
                        <a href="#Enable_Form-based_Authentication">
                            2.1.8. Enable Form-based Authentication
                        </a>
                    </li><li>
                        <a href="#Enable_Declarative_Security1">
                            2.1.9. Enable Declarative Security
                        </a>
                    </li>
            </ol>
                    </li>
            </ol>
                    </li><li>
                        <a href="#chap-Introduction_to_JAAS">
                            3. Introduction to JAAS
                        </a><ol>
                <li>
                        <a href="#About_JAAS">
                            3.1. About JAAS
                        </a>
                    </li><li>
                        <a href="#JAAS_Core_Classes">
                            3.2. JAAS Core Classes
                        </a>
                    </li><li>
                        <a href="#Subject_and_Principal_classes">
                            3.3. Subject and Principal classes
                        </a>
                    </li><li>
                        <a href="#Subject_Authentication">
                            3.4. Subject Authentication
                        </a>
                    </li>
            </ol>
                    </li>
            </ol>
                    </li><li>
                        <a href="#part-Securing_the_Platform">
                            II. Securing the Platform
                        </a><ol>
                <li>
                        <a href="#chap-The_Security_Subsystem">
                            4. The Security Subsystem
                        </a><ol>
                <li>
                        <a href="#About_the_Security_Subsystem">
                            4.1. About the Security Subsystem
                        </a>
                    </li><li>
                        <a href="#About_the_Structure_of_the_Security_Subsystem">
                            4.2. About the Structure of the Security Subsystem
                        </a>
                    </li><li>
                        <a href="#sect-Configuring_the_Security_Subsystem">
                            4.3. Configuring the Security Subsystem
                        </a><ol>
                <li>
                        <a href="#Configure_the_Security_Subsystem">
                            4.3.1. Configure the Security Subsystem
                        </a>
                    </li><li>
                        <a href="#sect-Security_Management">
                            4.3.2. Security Management
                        </a>
                    </li><li>
                        <a href="#sect-Security_Domains">
                            4.3.3. Security Domains
                        </a>
                    </li>
            </ol>
                    </li>
            </ol>
                    </li><li>
                        <a href="#chap-PicketLink_Identity_Management">
                            5. PicketLink Identity Management
                        </a><ol>
                <li>
                        <a href="#Security_Token_Server_STS">
                            5.1. About Security Token Service (STS)
                        </a>
                    </li><li>
                        <a href="#Configure_STS_Login_Modules">
                            5.2. Configure PicketLink STS
                        </a>
                    </li><li>
                        <a href="#About_PicketLink_STS_Login_Modules">
                            5.3. About PicketLink STS Login Modules
                        </a>
                    </li><li>
                        <a href="#Configure_STSIssuingLoginModule">
                            5.4. Configure STSIssuingLoginModule
                        </a>
                    </li><li>
                        <a href="#Configure_STSValidatingLoginModule">
                            5.5. Configure STSValidatingLoginModule
                        </a>
                    </li><li>
                        <a href="#sect-SAML_Web_Browser_Based_SSO">
                            5.6. SAML Web Browser Based SSO
                        </a><ol>
                <li>
                        <a href="#SAML_Web_Browser_Based_SSO">
                            5.6.1. About SAML Web Browser Based SSO
                        </a>
                    </li><li>
                        <a href="#Setup_SAML_v2_based_Web_SSO_using_HTTPRedirect_Binding">
                            5.6.2. Setup SAML v2 based Web SSO using HTTP/Redirect Binding
                        </a>
                    </li><li>
                        <a href="#Configure_Identity_Provider">
                            5.6.3. Configure Identity Provider
                        </a>
                    </li><li>
                        <a href="#Configure_Service_Provider">
                            5.6.4. Configure Service Provider
                        </a>
                    </li><li>
                        <a href="#Setup_SAML_v2_based_Web_SSO_using_HTTPPOST_Binding">
                            5.6.5. Setup SAML v2 based Web SSO using HTTP/POST Binding
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#SAML_Global_Logout_Profile">
                            5.7. Configure SAML Global Logout Profile
                        </a>
                    </li><li>
                        <a href="#sect-Kerberos_and_SPNEGO_Integration">
                            5.8. Kerberos and SPNEGO Integration
                        </a><ol>
                <li>
                        <a href="#About_Kerberos_Integration">
                            5.8.1. About Kerberos and SPNEGO Integration
                        </a>
                    </li><li>
                        <a href="#Desktop_SSO_using_SPNego">
                            5.8.2. Desktop SSO using SPNEGO
                        </a>
                    </li><li>
                        <a href="#Configure_JBoss_Negotiation_for_Microsoft_Windows_Domain">
                            5.8.3. Configure JBoss Negotiation for Microsoft Windows Domain
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#sect-Authentication">
                            5.9. Authentication
                        </a><ol>
                <li>
                        <a href="#About_Authentication1">
                            5.9.1. About Authentication
                        </a>
                    </li><li>
                        <a href="#Configure_Authentication_in_a_Security_Domain">
                            5.9.2. Configure Authentication in a Security Domain
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#sect-Java_Authentication_SPI_for_Containers_JASPI">
                            5.10. Java Authentication SPI for Containers (JASPI)
                        </a><ol>
                <li>
                        <a href="#About_Java_Authentication_SPI_for_Containers_JASPI_Security1">
                            5.10.1. About Java Authentication SPI for Containers (JASPI) Security
                        </a>
                    </li><li>
                        <a href="#Configure_Java_Authentication_SPI_for_Containers_JASPI_Security1">
                            5.10.2. Configure Java Authentication SPI for Containers (JASPI) Security
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#sect-Authorization">
                            5.11. Authorization
                        </a><ol>
                <li>
                        <a href="#About_Authorization1">
                            5.11.1. About Authorization
                        </a>
                    </li><li>
                        <a href="#Configure_Authorization_in_a_Security_Domain1">
                            5.11.2. Configure Authorization in a Security Domain
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#sect-Java_Authorization_Contract_for_Containers_JACC">
                            5.12. Java Authorization Contract for Containers (JACC)
                        </a><ol>
                <li>
                        <a href="#About_Java_Authorization_Contract_for_Containers_JACC">
                            5.12.1. About Java Authorization Contract for Containers (JACC)
                        </a>
                    </li><li>
                        <a href="#Configure_Java_Authorization_Contract_for_Containers_JACC_Security">
                            5.12.2. Configure Java Authorization Contract for Containers (JACC) Security
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#sect-Security_Auditing">
                            5.13. Security Auditing
                        </a><ol>
                <li>
                        <a href="#About_Security_Auditing1">
                            5.13.1. About Security Auditing
                        </a>
                    </li><li>
                        <a href="#Configure_Security_Auditing1">
                            5.13.2. Configure Security Auditing
                        </a>
                    </li><li>
                        <a href="#New_Security_Properties">
                            5.13.3. New Security Properties
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#sect-Security_Mapping">
                            5.14. Security Mapping
                        </a><ol>
                <li>
                        <a href="#About_Security_Mapping1">
                            5.14.1. About Security Mapping
                        </a>
                    </li><li>
                        <a href="#Configure_Security_Mapping_in_a_Security_Domain">
                            5.14.2. Configure Security Mapping in a Security Domain
                        </a>
                    </li>
            </ol>
                    </li>
            </ol>
                    </li><li>
                        <a href="#chap-Java_Security_Manager">
                            6. Java Security Manager
                        </a><ol>
                <li>
                        <a href="#About_the_Java_Security_Manager">
                            6.1. About the Java Security Manager
                        </a>
                    </li><li>
                        <a href="#About_Java_Security_Manager_Policies">
                            6.2. About Java Security Manager Policies
                        </a>
                    </li><li>
                        <a href="#Write_a_Java_Security_Manager_Policy1">
                            6.3. Write a Java Security Manager Policy
                        </a>
                    </li><li>
                        <a href="#IBM_JRE_and_the_Java_Security_Manager">
                            6.4. IBM JRE and the Java Security Manager
                        </a>
                    </li><li>
                        <a href="#Java_Security_Policy_Statements">
                            6.5. Java Security Policy Statements
                        </a>
                    </li><li>
                        <a href="#Run_JBoss_Enterprise_Application_Platform_Within_the_Java_Security_Manager">
                            6.6. Run JBoss EAP 6 Within the Java Security Manager
                        </a>
                    </li><li>
                        <a href="#Debug_Security_Manager_Policies">
                            6.7. Debug Security Manager Policies
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#chap-Security_Realms">
                            7. Security Realms
                        </a><ol>
                <li>
                        <a href="#About_Security_Realms">
                            7.1. About Security Realms
                        </a>
                    </li><li>
                        <a href="#Add_a_New_Security_Realm">
                            7.2. Add a New Security Realm
                        </a>
                    </li><li>
                        <a href="#Add_a_User_to_a_Security_Realm">
                            7.3. Add a User to a Security Realm
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#chap-Encryption">
                            8. Encryption
                        </a><ol>
                <li>
                        <a href="#About_Encryption">
                            8.1. About Encryption
                        </a>
                    </li><li>
                        <a href="#About_SSL_Encryption">
                            8.2. About SSL Encryption
                        </a>
                    </li><li>
                        <a href="#Implement_SSL_Encryption_for_the_JBoss_Enterprise_Application_Platform_Web_Server1">
                            8.3. Implement SSL Encryption for the JBoss EAP 6 Web Server
                        </a>
                    </li><li>
                        <a href="#Generate_a_SSL_Encryption_Key_and_Certificate">
                            8.4. Generate a SSL Encryption Key and Certificate
                        </a>
                    </li><li>
                        <a href="#SSL_Connector_Reference1">
                            8.5. SSL Connector Reference
                        </a>
                    </li><li>
                        <a href="#sect-FIPS_140-2_Compliant_Encryption">
                            8.6. FIPS 140-2 Compliant Encryption
                        </a><ol>
                <li>
                        <a href="#About_FIPS_140-2_Compliance">
                            8.6.1. About FIPS 140-2 Compliance
                        </a>
                    </li><li>
                        <a href="#FIPS_140-2_Compliant_Passwords">
                            8.6.2. FIPS 140-2 Compliant Passwords
                        </a>
                    </li><li>
                        <a href="#Enable_FIPS_140-2_Cryptography_for_SSL_on_Red_Hat_Enterprise_Linux_6">
                            8.6.3. Enable FIPS 140-2 Cryptography for SSL on Red Hat Enterprise Linux 6
                        </a>
                    </li>
            </ol>
                    </li>
            </ol>
                    </li><li>
                        <a href="#chap-Network_Security">
                            9. Network Security
                        </a><ol>
                <li>
                        <a href="#Secure_the_Management_Interfaces2">
                            9.1. Secure the Management Interfaces
                        </a>
                    </li><li>
                        <a href="#Specify_Which_Network_Interface_the_Enterprise_Application_Platform_Uses">
                            9.2. Specify Which Network Interface JBoss EAP 6 Uses
                        </a>
                    </li><li>
                        <a href="#Configure_Network_Firewalls_to_Work_with_JBoss_Enterprise_Application_Platform_6">
                            9.3. Configure Network Firewalls to Work with JBoss EAP 6
                        </a>
                    </li><li>
                        <a href="#Network_Ports_Used_By_JBoss_Enterprise_Application_Platform_62">
                            9.4. Network Ports Used By JBoss EAP 6
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#chap-Management_Interface_Security">
                            10. Management Interface Security
                        </a><ol>
                <li>
                        <a href="#Secure_the_Management_Interfaces">
                            10.1. Secure the Management Interfaces
                        </a>
                    </li><li>
                        <a href="#Default_User_Security_Configuration">
                            10.2. Default User Security Configuration
                        </a>
                    </li><li>
                        <a href="#Overview_of_Advanced_Management_Interface_Configuration1">
                            10.3. Overview of Advanced Management Interface Configuration
                        </a>
                    </li><li>
                        <a href="#Disable_the_HTTP_Management_Interface">
                            10.4. Disable the HTTP Management Interface
                        </a>
                    </li><li>
                        <a href="#Remove_Silent_Authentication_from_the_Default_Security_Realm">
                            10.5. Remove Silent Authentication from the Default Security Realm
                        </a>
                    </li><li>
                        <a href="#Disable_Remote_Access_to_the_JMX_Subsystem1">
                            10.6. Disable Remote Access to the JMX Subsystem
                        </a>
                    </li><li>
                        <a href="#Configure_Security_Realms_for_the_Management_Interfaces">
                            10.7. Configure Security Realms for the Management Interfaces
                        </a>
                    </li><li>
                        <a href="#Configure_the_Management_Console_for_HTTPS_in_Standalone_mode">
                            10.8. Configure the Management Console for HTTPS in Standalone mode
                        </a>
                    </li><li>
                        <a href="#Configure_the_Management_Console_for_HTTPS_in_Domain_mode">
                            10.9. Configure the Management Console for HTTPS in Domain mode
                        </a>
                    </li><li>
                        <a href="#Using_2-way_SSL_for_the_Management_interface_and_the_CLI">
                            10.10. Using 2-way SSL for the Management interface and the CLI
                        </a>
                    </li><li>
                        <a href="#sect-Password_Vaults_for_Sensitive_Strings">
                            10.11. Password Vaults for Sensitive Strings
                        </a><ol>
                <li>
                        <a href="#About_Securing_Sensitive_Strings_in_Clear-Text_Files1">
                            10.11.1. About Securing Sensitive Strings in Clear-Text Files
                        </a>
                    </li><li>
                        <a href="#Create_a_Java_Keystore_to_Store_Sensitive_Strings">
                            10.11.2. Create a Java Keystore to Store Sensitive Strings
                        </a>
                    </li><li>
                        <a href="#Mask_the_Keystore_Password_and_Initialize_the_Password_Vault.">
                            10.11.3. Mask the Keystore Password and Initialize the Password Vault
                        </a>
                    </li><li>
                        <a href="#Configure_the_Enterprise_Application_Platform_to_Use_the_Password_Vault1">
                            10.11.4. Configure JBoss EAP 6 to Use the Password Vault
                        </a>
                    </li><li>
                        <a href="#Store_and_Retrieve_Encrypted_Sensitive_Strings_in_the_Java_Keystore">
                            10.11.5. Store and Retrieve Encrypted Sensitive Strings in the Java Keystore
                        </a>
                    </li><li>
                        <a href="#Store_and_Resolve_Sensitive_Strings_In_Your_Applications1">
                            10.11.6. Store and Resolve Sensitive Strings In Your Applications
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#sect-LDAP">
                            10.12. LDAP
                        </a><ol>
                <li>
                        <a href="#About_LDAP1">
                            10.12.1. About LDAP
                        </a>
                    </li><li>
                        <a href="#Use_LDAP_to_Authenticate_to_the_Management_Interfaces1">
                            10.12.2. Use LDAP to Authenticate to the Management Interfaces
                        </a>
                    </li>
            </ol>
                    </li>
            </ol>
                    </li><li>
                        <a href="#chap-Securing_the_Management_Interfaces_with_Role-Based_Access_Control">
                            11. Securing the Management Interfaces with Role-Based Access Control
                        </a><ol>
                <li>
                        <a href="#About_Role-Based_Access_Control_RBAC">
                            11.1. About Role-Based Access Control (RBAC)
                        </a>
                    </li><li>
                        <a href="#Role-Based_Access_Control_in_the_GUI_and_CLI">
                            11.2. Role-Based Access Control in the GUI and CLI
                        </a>
                    </li><li>
                        <a href="#Supported_Authentication_Schemes">
                            11.3. Supported Authentication Schemes
                        </a>
                    </li><li>
                        <a href="#Supported_Roles">
                            11.4. The Standard Roles
                        </a>
                    </li><li>
                        <a href="#Role_Permissions_Matrix">
                            11.5. About Role Permissions
                        </a>
                    </li><li>
                        <a href="#Application_Resources">
                            11.6. About Constraints
                        </a>
                    </li><li>
                        <a href="#About_JMX_and_Role-Based_Access_Control">
                            11.7. About JMX and Role-Based Access Control
                        </a>
                    </li><li>
                        <a href="#sect-Configuring_Role-Based_Access_Control">
                            11.8. Configuring Role-Based Access Control
                        </a><ol>
                <li>
                        <a href="#Overview_of_RBAC_Configuration_Tasks">
                            11.8.1. Overview of RBAC Configuration Tasks
                        </a>
                    </li><li>
                        <a href="#Enabling_Role-Based_Access_Control">
                            11.8.2. Enabling Role-Based Access Control
                        </a>
                    </li><li>
                        <a href="#Changing_the_Permission_Combination_Policy">
                            11.8.3. Changing the Permission Combination Policy
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#sect-Managing_Roles">
                            11.9. Managing Roles
                        </a><ol>
                <li>
                        <a href="#About_Role_Membership">
                            11.9.1. About Role Membership
                        </a>
                    </li><li>
                        <a href="#Configure_User_Role_Assignment_using_the_Management_Console">
                            11.9.2. Configure User Role Assignment
                        </a>
                    </li><li>
                        <a href="#Configure_User_Role_Assignment_using_jboss-cli.sh">
                            11.9.3. Configure User Role Assignment using jboss-cli.sh
                        </a>
                    </li><li>
                        <a href="#About_Roles_and_User_Groups">
                            11.9.4. About Roles and User Groups
                        </a>
                    </li><li>
                        <a href="#Configure_Group_Role_Assignment_with_the_Management_Console">
                            11.9.5. Configure Group Role Assignment
                        </a>
                    </li><li>
                        <a href="#Configure_Group_Role_Assignment_with_jboss-cli.sh">
                            11.9.6. Configure Group Role Assignment with jboss-cli.sh
                        </a>
                    </li><li>
                        <a href="#About_Authorization_and_Group_Loading_with_LDAP">
                            11.9.7. About Authorization and Group Loading with LDAP
                        </a>
                    </li><li>
                        <a href="#Scoped_Roles">
                            11.9.8. About Scoped Roles
                        </a>
                    </li><li>
                        <a href="#Creating_Scoped_Roles">
                            11.9.9. Creating Scoped Roles
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#sect-Configuring_Constraints">
                            11.10. Configuring Constraints
                        </a><ol>
                <li>
                        <a href="#Configure_Sensitivity_Constraints">
                            11.10.1. Configure Sensitivity Constraints
                        </a>
                    </li><li>
                        <a href="#Configure_Application_Resource_Constraints">
                            11.10.2. Configure Application Resource Constraints
                        </a>
                    </li><li>
                        <a href="#Configure_the_Vault_Expression_Constraint">
                            11.10.3. Configure the Vault Expression Constraint
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#sect-Constraints_Reference">
                            11.11. Constraints Reference
                        </a><ol>
                <li>
                        <a href="#Application_Resource_Constraints_Reference">
                            11.11.1. Application Resource Constraints Reference
                        </a>
                    </li><li>
                        <a href="#Sensitivity_Constraints_Reference">
                            11.11.2. Sensitivity Constraints Reference
                        </a>
                    </li>
            </ol>
                    </li>
            </ol>
                    </li><li>
                        <a href="#chap-Web_HTTP_Connectors_and_HTTP_Clustering">
                            12. Web, HTTP Connectors, and HTTP Clustering
                        </a><ol>
                <li>
                        <a href="#Configure_a_mod_cluster_Worker_Node">
                            12.1. Configure a mod_cluster Worker Node
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#chap-Patch_Installation">
                            13. Patch Installation
                        </a><ol>
                <li>
                        <a href="#About_Patches_and_Upgrades">
                            13.1. About Patches and Upgrades
                        </a>
                    </li><li>
                        <a href="#About_Patching_Mechanisms">
                            13.2. About Patching Mechanisms
                        </a>
                    </li><li>
                        <a href="#Subscribe_to_Patch_Mailing_Lists">
                            13.3. Subscribe to Patch Mailing Lists
                        </a>
                    </li><li>
                        <a href="#sect-Install_Patches_in_Zip_Form">
                            13.4. Install Patches in Zip Form
                        </a><ol>
                <li>
                        <a href="#The_patch_Command">
                            13.4.1. The patch Command
                        </a>
                    </li><li>
                        <a href="#Installing_Patches_in_Zip_Form_Using_the_patch_Command">
                            13.4.2. Installing Patches in Zip Form Using the patch Command
                        </a>
                    </li><li>
                        <a href="#Rollback_the_Application_of_a_Patch_in_Zip_Form_Using_the_patch_Command">
                            13.4.3. Rollback the Application of a Patch in Zip Form Using the patch Command
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#Install_Patches_in_RPM_form">
                            13.5. Install Patches in RPM form
                        </a>
                    </li><li>
                        <a href="#Severity_and_Impact_Rating_of_JBoss_Security_Patches">
                            13.6. Severity and Impact Rating of JBoss Security Patches
                        </a>
                    </li><li>
                        <a href="#Manage_Security_Updates_for_Dependencies_Bundled_Inside_the_Applications_Deployed_on_JBoss_EAP">
                            13.7. Manage Security Updates for Dependencies Bundled Inside the Applications Deployed on JBoss EAP
                        </a>
                    </li>
            </ol>
                    </li>
            </ol>
                    </li><li>
                        <a href="#part-Securing_Applications">
                            III. Securing Applications
                        </a><ol>
                <li>
                        <a href="#chap-Application_Security">
                            14. Application Security
                        </a><ol>
                <li>
                        <a href="#About_Application_Security">
                            14.1. About Application Security
                        </a>
                    </li><li>
                        <a href="#EnablingDisabling_Descriptor_Based_Property_Replacement1">
                            14.2. Enabling/Disabling Descriptor Based Property Replacement
                        </a>
                    </li><li>
                        <a href="#sect-Datasource_Security">
                            14.3. Datasource Security
                        </a><ol>
                <li>
                        <a href="#About_Datasource_Security">
                            14.3.1. About Datasource Security
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#sect-EJB_Application_Security">
                            14.4. EJB Application Security
                        </a><ol>
                <li>
                        <a href="#sect-Security_Identity">
                            14.4.1. Security Identity
                        </a>
                    </li><li>
                        <a href="#sect-EJB_Method_Permissions">
                            14.4.2. EJB Method Permissions
                        </a>
                    </li><li>
                        <a href="#sect-EJB_Security_Annotations">
                            14.4.3. EJB Security Annotations
                        </a>
                    </li><li>
                        <a href="#sect-Remote_Access_to_EJBs">
                            14.4.4. Remote Access to EJBs
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#sect-JAX-RS_Application_Security">
                            14.5. JAX-RS Application Security
                        </a><ol>
                <li>
                        <a href="#Enable_Role-Based_Security_for_a_RESTEasy_JAX-RS_Web_Service">
                            14.5.1. Enable Role-Based Security for a RESTEasy JAX-RS Web Service
                        </a>
                    </li><li>
                        <a href="#Secure_a_JAX-RS_Web_Service_using_Annotations">
                            14.5.2. Secure a JAX-RS Web Service using Annotations
                        </a>
                    </li>
            </ol>
                    </li>
            </ol>
                    </li><li>
                        <a href="#chap-Login_Modules">
                            15. Login Modules
                        </a><ol>
                <li>
                        <a href="#sect-Using_Modules">
                            15.1. Using Modules
                        </a><ol>
                <li>
                        <a href="#Password_Stacking">
                            15.1.1. Password Stacking
                        </a>
                    </li><li>
                        <a href="#Password_Hashing">
                            15.1.2. Password Hashing
                        </a>
                    </li><li>
                        <a href="#Unauthenticated_Identity">
                            15.1.3. Unauthenticated Identity
                        </a>
                    </li><li>
                        <a href="#LdapLoginModule1">
                            15.1.4. Ldap Login Module
                        </a>
                    </li><li>
                        <a href="#LdapExtLoginModule">
                            15.1.5. LdapExtended Login Module
                        </a>
                    </li><li>
                        <a href="#UsersRolesLoginModule">
                            15.1.6. UsersRoles Login Module
                        </a>
                    </li><li>
                        <a href="#DatabaseServerLoginModule">
                            15.1.7. Database Login Module
                        </a>
                    </li><li>
                        <a href="#BaseCertLoginModule">
                            15.1.8. Certificate Login Module
                        </a>
                    </li><li>
                        <a href="#IdentityLoginModule">
                            15.1.9. Identity Login Module
                        </a>
                    </li><li>
                        <a href="#sect-RunAs_Login_Module">
                            15.1.10. RunAs Login Module
                        </a>
                    </li><li>
                        <a href="#ClientLoginModule">
                            15.1.11. Client Login Module
                        </a>
                    </li><li>
                        <a href="#SPNEGOLoginModule">
                            15.1.12. SPNEGO Login Module
                        </a>
                    </li><li>
                        <a href="#RoleMappingLoginModule">
                            15.1.13. RoleMapping Login Module
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#sect-Custom_Modules">
                            15.2. Custom Modules
                        </a><ol>
                <li>
                        <a href="#Subject_Usage_Pattern_Support">
                            15.2.1. Subject Usage Pattern Support
                        </a>
                    </li><li>
                        <a href="#Custom_LoginModule_Example">
                            15.2.2. Custom LoginModule Example
                        </a>
                    </li>
            </ol>
                    </li>
            </ol>
                    </li><li>
                        <a href="#chap-Single_Sign_On_SSO">
                            16. Single Sign On (SSO)
                        </a><ol>
                <li>
                        <a href="#About_Single_Sign_On_SSO_for_Web_Applications">
                            16.1. About Single Sign On (SSO) for Web Applications
                        </a>
                    </li><li>
                        <a href="#About_Clustered_Single_Sign_On_SSO_for_Web_Applications">
                            16.2. About Clustered Single Sign On (SSO) for Web Applications
                        </a>
                    </li><li>
                        <a href="#Choose_the_Right_SSO_Implementation">
                            16.3. Choose the Right SSO Implementation
                        </a>
                    </li><li>
                        <a href="#Use_Single_Sign_On_SSO_In_A_Web_Application">
                            16.4. Use Single Sign On (SSO) In A Web Application
                        </a>
                    </li><li>
                        <a href="#About_Kerberos">
                            16.5. About Kerberos
                        </a>
                    </li><li>
                        <a href="#About_SPNEGO">
                            16.6. About SPNEGO
                        </a>
                    </li><li>
                        <a href="#About_Microsoft_Active_Directory">
                            16.7. About Microsoft Active Directory
                        </a>
                    </li><li>
                        <a href="#Configure_Kerberos_or_Microsoft_Active_Directory_Desktop_SSO_for_Web_Applications">
                            16.8. Configure Kerberos or Microsoft Active Directory Desktop SSO for Web Applications
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#chap-Role-Based_Security_in_Applications">
                            17. Role-Based Security in Applications
                        </a><ol>
                <li>
                        <a href="#Java_Authentication_and_Authorization_Service_JAAS">
                            17.1. Java Authentication and Authorization Service (JAAS)
                        </a>
                    </li><li>
                        <a href="#About_Java_Authentication_and_Authorization_Service_JAAS">
                            17.2. About Java Authentication and Authorization Service (JAAS)
                        </a>
                    </li><li>
                        <a href="#Use_a_Security_Domain_in_Your_Application">
                            17.3. Use a Security Domain in Your Application
                        </a>
                    </li><li>
                        <a href="#Use_Role-Based_Security_In_Servlets">
                            17.4. Use Role-Based Security In Servlets
                        </a>
                    </li><li>
                        <a href="#Use_A_Third-Party_Authentication_System_In_Your_Application">
                            17.5. Use A Third-Party Authentication System In Your Application
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#chap-Migration">
                            18. Migration
                        </a><ol>
                <li>
                        <a href="#Configure_Application_Security_Changes">
                            18.1. Configure Application Security Changes
                        </a>
                    </li>
            </ol>
                    </li>
            </ol>
                    </li><li>
                        <a href="#appe-Reference">
                            A. Reference
                        </a><ol>
                <li>
                        <a href="#Included_Authentication_Modules1">
                            A.1. Included Authentication Modules
                        </a>
                    </li><li>
                        <a href="#Included_Authorization_Modules1">
                            A.2. Included Authorization Modules
                        </a>
                    </li><li>
                        <a href="#Included_Security_Mapping_Modules">
                            A.3. Included Security Mapping Modules
                        </a>
                    </li><li>
                        <a href="#Included_Security_Auditing_Provider_Modules">
                            A.4. Included Security Auditing Provider Modules
                        </a>
                    </li><li>
                        <a href="#jboss-webxml_Configuration_Reference">
                            A.5. jboss-web.xml Configuration Reference
                        </a>
                    </li><li>
                        <a href="#EJB_Security_Parameter_Reference">
                            A.6. EJB Security Parameter Reference
                        </a>
                    </li>
            </ol>
                    </li><li>
                        <a href="#appe-Revision_History">
                            B. Revision History
                        </a>
                    </li><li>
                        <a href="#idm140707314531872">
                            Legal Notice
                        </a>
                    </li>
            </ol>
            
        
      </div>
    </nav>

    
    <div class="pvof-doc__wrapper" id="doc-wrapper">
        <section class="mimir-doc-title" id="mimir-doc--security_guide">
            <h1 class="title">Security Guide</h1>
        </section>
        <body><div xml:lang="en-US" class="book" id="idm140707344203296" lang="en-US"><div class="titlepage"><div><div class="producttitle"><span class="productname">JBoss Enterprise Application Platform Common Criteria Certification</span> <span class="productnumber">6.2.2</span></div><div><h2 class="subtitle">For Use with Red Hat JBoss Enterprise Application Platform 6</h2></div><div><h3 class="corpauthor">
		<span class="inlinemediaobject"><object data="https://access.redhat.com/webassets/avalon/d/JBoss_Enterprise_Application_Platform_Common_Criteria_Certification-6.2.2-Security_Guide-en-US/images/a78399a6916bd5b945caa082f6c4fa4e/title_logo.svg" type="image/svg+xml"><img src="/webassets/avalon/d/JBoss_Enterprise_Application_Platform_Common_Criteria_Certification-6.2.2-Security_Guide-en-US/images/20c014cff25dbc2aeb4126383228ede4/title_logo.png" alt="" /></object></span>

	</h3></div><div><div xml:lang="en-US" class="authorgroup" id="Author_Group" lang="en-US"><div class="author"><h3 class="author"><span class="firstname">Nidhi</span> <span class="surname">Chaudhary</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Lucas</span> <span class="surname">Costi</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Russell</span> <span class="surname">Dickenson</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Sande</span> <span class="surname">Gilda</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Vikram</span> <span class="surname">Goyal</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Eamon</span> <span class="surname">Logue</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Darrin</span> <span class="surname">Mison</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Scott</span> <span class="surname">Mumford</span></h3></div><div class="author"><h3 class="author"><span class="firstname">David</span> <span class="surname">Ryan</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Misty</span> <span class="surname">Stanley-Jones</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Keerat</span> <span class="surname">Verma</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Tom</span> <span class="surname">Wells</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Nichola</span> <span class="surname">Moore</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Nidhi</span> <span class="surname">Srinivas</span></h3></div></div></div><div><a href="#idm140707314531872">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
			This book is a guide to securing Red Hat JBoss Enterprise Application Platform 6 and its patch releases.
		</div></div></div></div></div><div xml:lang="en-US" class="part" id="part-Security_for_Red_Hat_JBoss_Enterprise_Application_Platform_6" lang="en-US"><div class="titlepage"><div><div><h1 class="title">Part I. Security for Red Hat JBoss Enterprise Application Platform 6</h1></div></div></div><div xml:lang="en-US" class="chapter" id="chap-Introduction" lang="en-US"><div class="titlepage"><div><div><h2 class="title">Chapter 1. Introduction</h2></div></div></div><div xml:lang="en-US" class="section" id="About_JBoss_Enterprise_Application_Platform_6" lang="en-US"><div class="titlepage"><div><div><h2 class="title">1.1. About Red Hat JBoss Enterprise Application Platform 6 (JBoss EAP 6)</h2></div></div></div><div class="para">
		Red Hat JBoss Enterprise Application Platform 6 (JBoss EAP 6) is a fast, secure, powerful middleware platform built upon open standards, and compliant with the Java Enterprise Edition 6 specification. It integrates JBoss Application Server 7 with high-availability clustering, powerful messaging, distributed caching, and other technologies to create a stable and scalable platform.
	</div><div class="para">
		The new modular structure allows for services to be enabled only when required, significantly increasing start up speed. The Management Console and Management Command Line Interface remove the need to edit XML configuration files by hand, adding the ability to script and automate tasks. In addition, it includes APIs and development frameworks that can be used to develop secure, powerful, and scalable Java EE applications quickly.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+228-458161+%5BSpecified%5D&amp;comment=Title%3A+About+Red+Hat+JBoss+Enterprise+Application+Platform+6+%28JBoss+EAP+6%29%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=228-458161+07+Jun+2013+12%3A15+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="About_Security" lang="en-US"><div class="titlepage"><div><div><h2 class="title">1.2. About Securing JBoss Enterprise Application Platform 6</h2></div></div></div><div class="para">
		Computer security is the all encompassing term given to the field of information technology that deals with securing the virtual environments that power the digital age. This can include data protection and integrity, application security, risk and vulnerability assessment and authentication and authorization protocols.
	</div><div class="para">
		Computer data is an all important asset for most organizations. Data protection is vital and forms the core of most businesses. JBoss EAP 6 provides a multi-layered approach to security to take care of data at all stages.
	</div><div class="para">
		Truly secure systems are the ones that are designed from the ground up with security as the main feature. Such systems use the principle of Security by Design. In such systems, malicious attacks and infiltration's are accepted as part and parcel of normal security apparatus and systems are designed to work around them.
	</div><div class="para">
		Security can be applied at the operating system, middleware and application level. For more information about security at the operating system level as it applies to RHEL, refer to the Red Hat Enterprise Linux Security Guide.
	</div><div class="para">
		In the coming chapters, you will read about the different levels and layers of security within JBoss EAP 6. These layers provides the infrastructure for all security functionality within the platform.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+13955-555636+%5BSpecified%5D&amp;comment=Title%3A+About+Securing+JBoss+Enterprise+Application+Platform+6%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=13955-555636+13+Nov+2013+20%3A29+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div xml:lang="en-US" class="chapter" id="chap-Security_Overview" lang="en-US"><div class="titlepage"><div><div><h2 class="title">Chapter 2. Security Overview</h2></div></div></div><div class="section" id="sect-About_Declarative_Security"><div class="titlepage"><div><div><h2 class="title">2.1. About Declarative Security</h2></div></div></div><div class="para">
			<em class="firstterm">Declarative security</em> is a method to separate security concerns from your application code by using the container to manage security. The container provides an authorization system based on either file permissions or users, groups, and roles. This approach is usually superior to <em class="firstterm">programmatic</em> security, which gives the application itself all of the responsibility for security.
		</div><div class="para">
			JBoss EAP 6 provides declarative security via security domains.
		</div><div class="para RoleCreateBugPara">
			<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+IDs%3A%0A4766-460002+%5BSpecified%5D&amp;comment=Title%3A+About+Declarative+Security%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
		</div><div xml:lang="en-US" class="section" id="Java_EE_Declarative_Security_Overview" lang="en-US"><div class="titlepage"><div><div><h3 class="title">2.1.1. Java EE Declarative Security Overview</h3></div></div></div><div class="para">
		The J2EE security model is declarative in that you describe the security roles and permissions in a standard XML descriptor rather than embedding security into your business component. This isolates security from business-level code because security tends to be more a function of where the component is deployed than an inherent aspect of the component's business logic. For example, consider an Automated Teller Machine (ATM) that is to be used to access a bank account. The security requirements, roles and permissions will vary independent of how you access the bank account, based on what bank is managing the account, where the ATM is located, and so on.
	</div><div class="para">
		Securing a J2EE application is based on the specification of the application security requirements via the standard J2EE deployment descriptors. You secure access to EJBs and web components in an enterprise application by using the <code class="literal">ejb-jar.xml</code> and <code class="literal">web.xml</code> deployment descriptors.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24326-549222+%5BSpecified%5D&amp;comment=Title%3A+Java+EE+Declarative+Security+Overview%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24326-549222+28+Oct+2013+13%3A49+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Security_References" lang="en-US"><div class="titlepage"><div><div><h3 class="title">2.1.2. Security References</h3></div></div></div><div class="para">
		Both Enterprise Java Beans (EJBs) and servlets can declare one or more <span class="markup">&lt;security-role-ref&gt;</span> elements.
	</div><div class="figure" id="idm140707321705504"><div class="figure-contents"><div class="mediaobject"><img src="/webassets/avalon/d/JBoss_Enterprise_Application_Platform_Common_Criteria_Certification-6.2.2-Security_Guide-en-US/images/c7268aff144e04296d2b45fc96b8815c/4194.png" alt="Illustration of Security Roles Reference Model" /></div></div><p class="title"><strong>Figure 2.1. Security Roles Reference Model</strong></p></div><div class="para">
		This element declares that a component is using the <span class="markup">&lt;role-name&gt;</span> element's <code class="literal">role-nameType</code> attribute value as an argument to the <code class="methodname">isCallerInRole(String)</code> method. By using the <code class="methodname">isCallerInRole</code> method, a component can verify whether the caller is in a role that has been declared with a <span class="markup">&lt;security-role-ref&gt;</span> or <span class="markup">&lt;role-name&gt;</span> element. The <span class="markup">&lt;role-name&gt;</span> element value must link to a <span class="markup">&lt;security-role&gt;</span> element through the <span class="markup">&lt;role-link&gt;</span> element. The typical use of <code class="methodname">isCallerInRole</code> is to perform a security check that cannot be defined by using the role-based <span class="markup">&lt;method-permissions&gt;</span> elements.
	</div><div class="example" id="idm140707324995376"><p class="title"><strong>Example 2.1. ejb-jar.xml descriptor fragment</strong></p><div class="example-contents"><pre class="programlisting language-xml">
  
  &lt;!-- A sample ejb-jar.xml fragment --&gt;
    &lt;ejb-jar&gt;
      &lt;enterprise-beans&gt;
        &lt;session&gt;
          &lt;ejb-name&gt;ASessionBean&lt;/ejb-name&gt;
          ...
          &lt;security-role-ref&gt;
            &lt;role-name&gt;TheRoleICheck&lt;role-name&gt;
              &lt;role-link&gt;TheApplicationRole&lt;/role-link&gt;
          &lt;/security-role-ref&gt;
        &lt;/session&gt;
      &lt;/enterprise-beans&gt;
    ...
    &lt;/ejb-jar&gt;
</pre></div></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			This fragment is an example only. In deployments, the elements in this section must contain role names and links relevant to the EJB deployment.
		</div></div></div><div class="example" id="idm140707330356240"><p class="title"><strong>Example 2.2. web.xml descriptor fragment</strong></p><div class="example-contents"><pre class="programlisting language-xml">

&lt;web-app&gt;
  &lt;servlet&gt;
    &lt;servlet-name&gt;AServlet&lt;/servlet-name&gt;
    ...
    &lt;security-role-ref&gt;
      &lt;role-name&gt;TheServletRole&lt;/role-name&gt;
      &lt;role-link&gt;TheApplicationRole&lt;/role-link&gt;
    &lt;/security-role-ref&gt;
  &lt;/servlet&gt;
    ...
&lt;/web-app&gt;
</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24093-548989+%5BSpecified%5D&amp;comment=Title%3A+Security+References%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24093-548989+25+Oct+2013+17%3A09+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Security_Identity" lang="en-US"><div class="titlepage"><div><div><h3 class="title">2.1.3. Security Identity</h3></div></div></div><div class="para">
		An Enterprise Java Bean (EJB) can specify the identity another EJB must use when it invokes methods on components using the <span class="markup">&lt;security-identity&gt;</span> element.
	</div><div class="figure" id="idm140707318403760"><div class="figure-contents"><div class="mediaobject"><img src="/webassets/avalon/d/JBoss_Enterprise_Application_Platform_Common_Criteria_Certification-6.2.2-Security_Guide-en-US/images/beaf60a1778e06a1f3ce9c9e52d50aba/4195.png" alt="Illustration of J2EE Security Identity Model" /></div></div><p class="title"><strong>Figure 2.2. J2EE Security Identity Data Model</strong></p></div><div class="para">
		The invocation identity can be that of the current caller, or it can be a specific role. The application assembler uses the <span class="markup">&lt;security-identity&gt;</span> element with a <span class="markup">&lt;use-caller-identity&gt;</span> child element. This indicate that the current caller's identity should be propagated as the security identity for method invocations made by the EJB. Propagation of the caller's identity is the default used in the absence of an explicit <span class="markup">&lt;security-identity&gt;</span> element declaration.
	</div><div class="para">
		Alternatively, the application assembler can use the <span class="markup">&lt;run-as&gt;</span> or <span class="markup">&lt;role-name&gt;</span> child element to specify that a specific security role supplied by the <span class="markup">&lt;role-name&gt;</span> element value must be used as the security identity for method invocations made by the EJB.
	</div><div class="para">
		Note that this does not change the caller's identity as seen by the <code class="methodname">EJBContext.getCallerPrincipal()</code> method. Rather, the caller's security roles are set to the single role specified by the <span class="markup">&lt;run-as&gt;</span> or <span class="markup">&lt;role-name&gt;</span> element value.
	</div><div class="para">
		One use case for the <span class="markup">&lt;run-as&gt;</span> element is to prevent external clients from accessing internal EJBs. You configure this behavior by assigning the internal EJB <span class="markup">&lt;method-permission&gt;</span> elements, which restrict access to a role never assigned to an external client. EJBs that must in turn use internal EJBs are then configured with a <span class="markup">&lt;run-as&gt;</span> or <span class="markup">&lt;role-name&gt;</span> equal to the restricted role. The following descriptor fragment describes an example<span class="markup">&lt;security-identity&gt;</span> element usage.
	</div><pre class="programlisting language-xml">

&lt;ejb-jar&gt;
    &lt;enterprise-beans&gt;
        &lt;session&gt;
            &lt;ejb-name&gt;ASessionBean&lt;/ejb-name&gt;
            &lt;!-- ... --&gt;
            &lt;security-identity&gt;
                &lt;use-caller-identity/&gt;
            &lt;/security-identity&gt;
        &lt;/session&gt;
        &lt;session&gt;
            &lt;ejb-name&gt;RunAsBean&lt;/ejb-name&gt;
            &lt;!-- ... --&gt;
            &lt;security-identity&gt;
                &lt;run-as&gt;
                    &lt;description&gt;A private internal role&lt;/description&gt;
                    &lt;role-name&gt;InternalRole&lt;/role-name&gt;
                &lt;/run-as&gt;
            &lt;/security-identity&gt;
        &lt;/session&gt;
    &lt;/enterprise-beans&gt;
    &lt;!-- ... --&gt;
&lt;/ejb-jar&gt;
</pre><div class="para">
		When you use <span class="markup">&lt;run-as&gt;</span> to assign a specific role to outgoing calls, a principal named <code class="literal">anonymous</code> is assigned to all outgoing calls. If you want another principal to be associated with the call, you must associate a <span class="markup">&lt;run-as-principal&gt;</span> with the bean in the <code class="filename">jboss.xml</code> file. The following fragment associates a principal named <code class="literal">internal</code> with <code class="literal">RunAsBean</code> from the prior example.
	</div><pre class="programlisting language-xml">

&lt;session&gt;
    &lt;ejb-name&gt;RunAsBean&lt;/ejb-name&gt;
    &lt;security-identity&gt;
        &lt;run-as-principal&gt;internal&lt;/run-as-principal&gt;
    &lt;/security-identity&gt;
&lt;/session&gt;
</pre><div class="para">
		The <span class="markup">&lt;run-as&gt;</span> element is also available in servlet definitions in a <code class="filename">web.xml</code> file. The following example shows how to assign the role <code class="literal">InternalRole</code> to a servlet:
	</div><pre class="programlisting language-xml">

  &lt;servlet&gt;
    &lt;servlet-name&gt;AServlet&lt;/servlet-name&gt;
    &lt;!-- ... --&gt;
    &lt;run-as&gt; 
        &lt;role-name&gt;InternalRole&lt;/role-name&gt;
    &lt;/run-as&gt;
  &lt;/servlet&gt;
</pre><div class="para">
		Calls from this servlet are associated with the anonymous <code class="literal">principal</code>. The <span class="markup">&lt;run-as-principal&gt;</span> element is available in the <code class="filename">jboss-web.xml</code> file to assign a specific principal to go along with the <code class="literal">run-as</code> role. The following fragment shows how to associate a principal named <code class="literal">internal</code> to the servlet above.
	</div><pre class="programlisting language-xml">

  &lt;servlet&gt;
    &lt;servlet-name&gt;AServlet&lt;/servlet-name&gt;
    &lt;run-as-principal&gt;internal&lt;/run-as-principal&gt;
  &lt;/servlet&gt;
</pre><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24094-548934+%5BSpecified%5D&amp;comment=Title%3A+Security+Identity%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24094-548934+25+Oct+2013+17%3A07+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Security_Roles1" lang="en-US"><div class="titlepage"><div><div><h3 class="title">2.1.4. Security Roles</h3></div></div></div><div class="para">
		The security role name referenced by either the <code class="literal">security-role-ref</code> or <code class="literal">security-identity</code> element needs to map to one of the application's declared roles. An application assembler defines logical security roles by declaring <code class="literal">security-role</code> elements. The <code class="literal">role-name</code> value is a logical application role name like Administrator, Architect, SalesManager, etc.
	</div><div class="para">
		The J2EE specifications note that it is important to keep in mind that the security roles in the deployment descriptor are used to define the logical security view of an application. Roles defined in the J2EE deployment descriptors should not be confused with the user groups, users, principals, and other concepts that exist in the target enterprise's operational environment. The deployment descriptor roles are application constructs with application domain-specific names. For example, a banking application might use role names such as BankManager, Teller, or Customer.
	</div><div class="para">
		In JBoss EAP, a <code class="literal">security-role</code> element is only used to map <code class="literal">security-role-ref/role-name</code> values to the logical role that the component role references. The user's assigned roles are a dynamic function of the application's security manager. JBoss does not require the definition of <code class="literal">security-role</code> elements in order to declare method permissions. However, the specification of <code class="literal">security-role</code> elements is still a recommended practice to ensure portability across application servers and for deployment descriptor maintenance.
	</div><div class="example" id="idm140707325746128"><p class="title"><strong>Example 2.3. An ejb-jar.xml descriptor fragment that illustrates the security-role element usage.</strong></p><div class="example-contents"><pre class="programlisting language-xml">
&lt;!-- A sample ejb-jar.xml fragment --&gt;
&lt;ejb-jar&gt;
    &lt;assembly-descriptor&gt;
        &lt;security-role&gt;
            &lt;description&gt;The single application role&lt;/description&gt;
            &lt;role-name&gt;TheApplicationRole&lt;/role-name&gt;
        &lt;/security-role&gt;
    &lt;/assembly-descriptor&gt;
&lt;/ejb-jar&gt;
</pre></div></div><div class="example" id="idm140707329774304"><p class="title"><strong>Example 2.4. An example web.xml descriptor fragment that illustrates the security-role element usage.</strong></p><div class="example-contents"><pre class="programlisting language-xml">
&lt;!-- A sample web.xml fragment --&gt;
&lt;web-app&gt;
  &lt;security-role&gt;
    &lt;description&gt;The single application role&lt;/description&gt;
    &lt;role-name&gt;TheApplicationRole&lt;/role-name&gt;
  &lt;/security-role&gt;
&lt;/web-app&gt;
</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24095-549164+%5BSpecified%5D&amp;comment=Title%3A+Security+Roles%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24095-549164+28+Oct+2013+11%3A15+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="EJB_Method_Permissions" lang="en-US"><div class="titlepage"><div><div><h3 class="title">2.1.5. EJB Method Permissions</h3></div></div></div><div class="para">
		An application assembler can set the roles that are allowed to invoke an EJB's home and remote interface methods through method-permission element declarations.
	</div><div class="figure" id="idm140707338021264"><div class="figure-contents"><div class="mediaobject"><img src="/webassets/avalon/d/JBoss_Enterprise_Application_Platform_Common_Criteria_Certification-6.2.2-Security_Guide-en-US/images/2e8378c501f6a136b4dd9bfe17b60b63/4210.png" alt="Illustration of the J2EE method permissions element" /></div></div><p class="title"><strong>Figure 2.3. J2EE Method Permissions Element</strong></p></div><div class="para">
		Each <code class="literal">method-permission</code> element contains one or more role-name child elements that define the logical roles that are allowed to access the EJB methods as identified by method child elements. You can also specify an <code class="literal">unchecked</code> element instead of the <code class="literal">role-name</code> element to declare that any authenticated user can access the methods identified by method child elements. In addition, you can declare that no one should have access to a method that has the <code class="literal">exclude-list</code> element. If an EJB has methods that have not been declared as accessible by a role using a <code class="literal">method-permission</code> element, the EJB methods default to being excluded from use. This is equivalent to defaulting the methods into the <code class="literal">exclude-list</code>.
	</div><div class="figure" id="idm140707325076736"><div class="figure-contents"><div class="mediaobject"><img src="/webassets/avalon/d/JBoss_Enterprise_Application_Platform_Common_Criteria_Certification-6.2.2-Security_Guide-en-US/images/d0cea6085ddc6454493e0a5ca1eed54e/4211.png" alt="Illustration of the J2EE method element" /></div></div><p class="title"><strong>Figure 2.4. J2EE Method Element</strong></p></div><div class="para">
		There are three supported styles of method element declarations.
	</div><div class="para">
		The first is used for referring to all the home and component interface methods of the named enterprise bean:
	</div><pre class="programlisting language-xml">
&lt;method&gt;
  &lt;ejb-name&gt;EJBNAME&lt;/ejb-name&gt;
  &lt;method-name&gt;*&lt;/method-name&gt;
&lt;/method&gt;
</pre><div class="para">
		The second style is used for referring to a specified method of the home or component interface of the named enterprise bean:
	</div><pre class="programlisting language-xml">
  &lt;method&gt;
    &lt;ejb-name&gt;EJBNAME&lt;/ejb-name&gt;
    &lt;method-name&gt;METHOD&lt;/method-name&gt;
  &lt;/method&gt;
</pre><div class="para">
		If there are multiple methods with the same overloaded name, this style refers to all of the overloaded methods.
	</div><div class="para">
		The third style is used to refer to a specified method within a set of methods with an overloaded name:
	</div><pre class="programlisting language-xml">&lt;method&gt;
    &lt;ejb-name&gt;EJBNAME&lt;/ejb-name&gt;
    &lt;method-name&gt;METHOD&lt;/method-name&gt;
    &lt;method-params&gt;
        &lt;method-param&gt;PARAMETER_1&lt;/method-param&gt;
        &lt;!-- ... --&gt;
        &lt;method-param&gt;PARAMETER_N&lt;/method-param&gt;
    &lt;/method-params&gt;
&lt;/method&gt;
</pre><div class="para">
		The method must be defined in the specified enterprise bean's home or remote interface. The method-param element values are the fully qualified name of the corresponding method parameter type. If there are multiple methods with the same overloaded signature, the permission applies to all of the matching overloaded methods.
	</div><div class="para">
		The optional <code class="literal">method-intf</code> element can be used to differentiate methods with the same name and signature that are defined in both the home and remote interfaces of an enterprise bean.
	</div><div class="para">
		<a class="xref" href="#EJB_method_permissions-An_ejb_jar.xml_descriptor_fragment_that_illustrates_the_method_permission_element_usage.">Example 2.5, “An ejb-jar.xml descriptor fragment that illustrates the method-permission element usage.”</a> provides complete examples of the <code class="literal">method-permission</code> element usage.
	</div><div class="example" id="EJB_method_permissions-An_ejb_jar.xml_descriptor_fragment_that_illustrates_the_method_permission_element_usage."><p class="title"><strong>Example 2.5. An ejb-jar.xml descriptor fragment that illustrates the method-permission element usage.</strong></p><div class="example-contents"><pre class="programlisting language-xml XML XML">&lt;ejb-jar&gt;
    &lt;assembly-descriptor&gt;
        &lt;method-permission&gt;
            &lt;description&gt;The employee and temp-employee roles may access any
                method of the EmployeeService bean &lt;/description&gt;
            &lt;role-name&gt;employee&lt;/role-name&gt;
            &lt;role-name&gt;temp-employee&lt;/role-name&gt;
            &lt;method&gt;
                &lt;ejb-name&gt;EmployeeService&lt;/ejb-name&gt;
                &lt;method-name&gt;*&lt;/method-name&gt;
            &lt;/method&gt;
        &lt;/method-permission&gt;
        &lt;method-permission&gt;
            &lt;description&gt;The employee role may access the findByPrimaryKey,
                getEmployeeInfo, and the updateEmployeeInfo(String) method of
                the AardvarkPayroll bean &lt;/description&gt;
            &lt;role-name&gt;employee&lt;/role-name&gt;
            &lt;method&gt;
                &lt;ejb-name&gt;AardvarkPayroll&lt;/ejb-name&gt;
                &lt;method-name&gt;findByPrimaryKey&lt;/method-name&gt;
            &lt;/method&gt;
            &lt;method&gt;
                &lt;ejb-name&gt;AardvarkPayroll&lt;/ejb-name&gt;
                &lt;method-name&gt;getEmployeeInfo&lt;/method-name&gt;
            &lt;/method&gt;
            &lt;method&gt;
                &lt;ejb-name&gt;AardvarkPayroll&lt;/ejb-name&gt;
                &lt;method-name&gt;updateEmployeeInfo&lt;/method-name&gt;
                &lt;method-params&gt;
                    &lt;method-param&gt;java.lang.String&lt;/method-param&gt;
                &lt;/method-params&gt;
            &lt;/method&gt;
        &lt;/method-permission&gt;
        &lt;method-permission&gt;
            &lt;description&gt;The admin role may access any method of the
                EmployeeServiceAdmin bean &lt;/description&gt;
            &lt;role-name&gt;admin&lt;/role-name&gt;
            &lt;method&gt;
                &lt;ejb-name&gt;EmployeeServiceAdmin&lt;/ejb-name&gt;
                &lt;method-name&gt;*&lt;/method-name&gt;
            &lt;/method&gt;
        &lt;/method-permission&gt;
        &lt;method-permission&gt;
            &lt;description&gt;Any authenticated user may access any method of the
                EmployeeServiceHelp bean&lt;/description&gt;
            &lt;unchecked/&gt;
            &lt;method&gt;
                &lt;ejb-name&gt;EmployeeServiceHelp&lt;/ejb-name&gt;
                &lt;method-name&gt;*&lt;/method-name&gt;
            &lt;/method&gt;
        &lt;/method-permission&gt;
        &lt;exclude-list&gt;
            &lt;description&gt;No fireTheCTO methods of the EmployeeFiring bean may be
                used in this deployment&lt;/description&gt;
            &lt;method&gt;
                &lt;ejb-name&gt;EmployeeFiring&lt;/ejb-name&gt;
                &lt;method-name&gt;fireTheCTO&lt;/method-name&gt;
            &lt;/method&gt;
        &lt;/exclude-list&gt;
    &lt;/assembly-descriptor&gt;
&lt;/ejb-jar&gt;
</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24096-549176+%5BSpecified%5D&amp;comment=Title%3A+EJB+Method+Permissions%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24096-549176+28+Oct+2013+11%3A46+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Enterprise_Beans_Security_Annotations" lang="en-US"><div class="titlepage"><div><div><h3 class="title">2.1.6. Enterprise Beans Security Annotations</h3></div></div></div><div class="para">
		Enterprise beans use Annotations to pass information to the deployer about security and other aspects of the application. The deployer can set up the appropriate enterprise bean security policy for the application if specified in annotations, or the deployment descriptor.
	</div><div class="para">
		Any method values explicitly specified in the deployment descriptor override annotation values. If a method value is not specified in the deployment descriptor, those values set using annotations are used. The overriding granularity is on a per-method basis
	</div><div class="para">
		Those annotations that address security and can be used in an enterprise beans include the following:
	</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><em class="parameter"><code>@DeclareRoles</code></em></span></dt><dd><div class="para">
					Declares each security role declared in the code. For information about configuring roles, refer to the <em class="citetitle">Java EE 5 Tutorial</em> <a href="http://docs.sun.com/app/docs/doc/819-3669/bnbyp?l=en&amp;a=view" class="mimir-link-warn" title="Mimir does not include content from: docs.sun.com">Declaring Security Roles Using Annotations</a>.
				</div></dd><dt><span class="term"><em class="parameter"><code>@RolesAllowed</code></em>, <em class="parameter"><code>@PermitAll</code></em>, and <em class="parameter"><code>@DenyAll</code></em></span></dt><dd><div class="para">
					Specifies method permissions for annotations. For information about configuring annotation method permissions, refer to the <em class="citetitle">Java EE 5 Tutorial</em> <a href="http://docs.sun.com/app/docs/doc/819-3669/bnbyw?l=en&amp;a=view" class="mimir-link-warn" title="Mimir does not include content from: docs.sun.com">Specifying Method Permissions Using Annotations</a>.
				</div></dd><dt><span class="term"><em class="parameter"><code>@RunAs</code></em></span></dt><dd><div class="para">
					Configures the propagated security identity of a component. For information about configuring propagated security identities using annotations, refer to the <em class="citetitle">Java EE 5 Tutorial</em> <a href="http://docs.oracle.com/cd/E19226-01/820-7627/bnbzb/index.html" class="mimir-link-warn" title="Mimir does not include content from: docs.oracle.com">Configuring a Component’s Propagated Security Identity</a>.
				</div></dd></dl></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24097-549282+%5BSpecified%5D&amp;comment=Title%3A+Enterprise+Beans+Security+Annotations%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24097-549282+28+Oct+2013+21%3A34+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Web_Content_Security_Constraints" lang="en-US"><div class="titlepage"><div><div><h3 class="title">2.1.7. Web Content Security Constraints</h3></div></div></div><div class="para">
		In a web application, security is defined by the roles that are allowed access to content by a URL pattern that identifies the protected content. This set of information is declared by using the <code class="filename">web.xml</code><span class="markup">security-constraint</span> element.
	</div><div class="figure" id="idm140707325072720"><div class="figure-contents"><div class="mediaobject"><img src="/webassets/avalon/d/JBoss_Enterprise_Application_Platform_Common_Criteria_Certification-6.2.2-Security_Guide-en-US/images/38ebcf0405140fc4e6b3dc2f5670643c/4213.png" alt="Illustration of Web Content Security Constraints" /></div></div><p class="title"><strong>Figure 2.5. Web Content Security Constraints</strong></p></div><div class="para">
		The content to be secured is declared using one or more <span class="markup">&lt;web-resource-collection&gt;</span> elements. Each <span class="markup">&lt;web-resource-collection&gt;</span> element contains an optional series of <span class="markup">&lt;url-pattern&gt;</span> elements followed by an optional series of <span class="markup">&lt;http-method&gt;</span> elements. The <span class="markup">&lt;url-pattern&gt;</span> element value specifies a URL pattern against which a request URL must match for the request to correspond to an attempt to access secured content. The <span class="markup">&lt;http-method&gt;</span> element value specifies a type of HTTP request to allow.
	</div><div class="para">
		The optional <span class="markup">&lt;user-data-constraint&gt;</span> element specifies the requirements for the transport layer of the client to server connection. The requirement may be for content integrity (preventing data tampering in the communication process) or for confidentiality (preventing reading while in transit). The <span class="markup">&lt;transport-guarantee&gt;</span> element value specifies the degree to which communication between the client and server should be protected. Its values are <code class="literal">NONE</code>, <code class="literal">INTEGRAL</code>, and <code class="literal">CONFIDENTIAL</code>. A value of <code class="literal">NONE</code> means that the application does not require any transport guarantees. A value of <code class="literal">INTEGRAL</code> means that the application requires the data sent between the client and server to be sent in such a way that it can not be changed in transit. A value of <code class="literal">CONFIDENTIAL</code> means that the application requires the data to be transmitted in a fashion that prevents other entities from observing the contents of the transmission. In most cases, the presence of the <code class="literal">INTEGRAL</code> or <code class="literal">CONFIDENTIAL</code> flag indicates that the use of SSL is required.
	</div><div class="para">
		The optional <span class="markup">&lt;login-config&gt;</span> element is used to configure the authentication method that should be used, the realm name that should be used for the application, and the attributes that are needed by the form login mechanism.
	</div><div class="figure" id="idm140707335050784"><div class="figure-contents"><div class="mediaobject"><img src="/webassets/avalon/d/JBoss_Enterprise_Application_Platform_Common_Criteria_Certification-6.2.2-Security_Guide-en-US/images/93e3a318960fc13584366b2cbb39ead3/4214.png" alt="Illustration of Web Login Configuration" /></div></div><p class="title"><strong>Figure 2.6. Web Login Configuration</strong></p></div><div class="para">
		The <span class="markup">&lt;auth-method&gt;</span> child element specifies the authentication mechanism for the web application. As a prerequisite to gaining access to any web resources that are protected by an authorization constraint, a user must have authenticated using the configured mechanism. Legal <span class="markup">&lt;auth-method&gt;</span> values are <code class="literal">BASIC</code>, <code class="literal">DIGEST</code>, <code class="literal">FORM</code>, and <code class="literal">CLIENT-CERT</code>. The <span class="markup">&lt;realm-name&gt;</span> child element specifies the realm name to use in HTTP basic and digest authorization. The <span class="markup">&lt;form-login-config&gt;</span> child element specifies the log in as well as error pages that should be used in form-based log in. If the <span class="markup">&lt;auth-method&gt;</span> value is not <code class="literal">FORM</code>, then <code class="literal">form-login-config</code> and its child elements are ignored.
	</div><div class="para">
		The following configuration example indicates that any URL lying under the web application's <code class="filename">/restricted</code> path requires an <code class="literal">AuthorizedUser</code> role. There is no required transport guarantee and the authentication method used for obtaining the user identity is BASIC HTTP authentication.
	</div><div class="example" id="idm140707314773952"><p class="title"><strong>Example 2.6. web.xml Descriptor Fragment</strong></p><div class="example-contents"><pre class="programlisting language-xml">
&lt;web-app&gt;
    &lt;security-constraint&gt;
        &lt;web-resource-collection&gt;
            &lt;web-resource-name&gt;Secure Content&lt;/web-resource-name&gt;
            &lt;url-pattern&gt;/restricted/*&lt;/url-pattern&gt;
        &lt;/web-resource-collection&gt;
        &lt;auth-constraint&gt;
            &lt;role-name&gt;AuthorizedUser&lt;/role-name&gt;
        &lt;/auth-constraint&gt;
        &lt;user-data-constraint&gt;
            &lt;transport-guarantee&gt;NONE&lt;/transport-guarantee&gt;
        &lt;/user-data-constraint&gt;
    &lt;/security-constraint&gt;
    &lt;!-- ... --&gt;
    &lt;login-config&gt;
        &lt;auth-method&gt;BASIC&lt;/auth-method&gt;
        &lt;realm-name&gt;The Restricted Zone&lt;/realm-name&gt;
    &lt;/login-config&gt;
    &lt;!-- ... --&gt;
    &lt;security-role&gt;
        &lt;description&gt;The role required to access restricted content &lt;/description&gt;
        &lt;role-name&gt;AuthorizedUser&lt;/role-name&gt;
    &lt;/security-role&gt;
&lt;/web-app&gt;
</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24098-549602+%5BSpecified%5D&amp;comment=Title%3A+Web+Content+Security+Constraints%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24098-549602+30+Oct+2013+13%3A56+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Enable_Form-based_Authentication" lang="en-US"><div class="titlepage"><div><div><h3 class="title">2.1.8. Enable Form-based Authentication</h3></div></div></div><div class="para">
		Form-based authentication provides flexibility in defining a custom JSP/HTML page for log in, and a separate page to which users are directed if an error occurs during login.
	</div><div class="para">
		Form-based authentication is defined by including <code class="code">&lt;auth-method&gt;FORM&lt;/auth-method&gt;</code> in the <span class="markup">&lt;login-config&gt;</span> element of the deployment descriptor, <code class="filename">web.xml</code>. The login and error pages are also defined in <span class="markup">&lt;login-config&gt;</span>, as follows:
	</div><pre class="programlisting">&lt;login-config&gt;
  &lt;auth-method&gt;FORM&lt;/auth-method&gt;
  &lt;form-login-config&gt;
    &lt;form-login-page&gt;/login.html&lt;/form-login-page&gt;
    &lt;form-error-page&gt;/error.html&lt;/form-error-page&gt;
  &lt;/form-login-config&gt;
&lt;/login-config&gt;</pre><div class="para">
		When a web application with form-based authentication is deployed, the web container uses <code class="classname">FormAuthenticator</code> to direct users to the appropriate page. JBoss EAP maintains a session pool so that authentication information does not need to be present for each request. When <code class="classname">FormAuthenticator</code> receives a request, it queries <code class="classname">org.apache.catalina.session.Manager</code> for an existing session. If no session exists, a new session is created. <code class="classname">FormAuthenticator</code> then verifies the credentials of the session.
	</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			Each session is identified by a session ID, a 16 byte string generated from random values. These values are retrieved from <code class="filename">/dev/urandom</code> (Linux) by default, and hashed with MD5. Checks are performed at session ID creation to ensure that the ID created is unique.
		</div></div></div><div class="para">
		Once verified, the session ID is assigned as part of a cookie, and then returned to the client. This cookie is expected in subsequent client requests and is used to identify the user session.
	</div><div class="para">
		The cookie passed to the client is a name value pair with several optional attributes. The identifier attribute is called <code class="varname">JSESSIONID</code> . Its value is a hex-string of the session ID. This cookie is configured to be non-persistent. This means that on the client side it will be deleted when the browser exits. On the server side, sessions expire after 60 seconds of inactivity, at which time session objects and their credential information are deleted.
	</div><div class="para">
		Say a user attempts to access a web application that is protected with form-based authentication. <code class="classname">FormAuthenticator</code> caches the request, creates a new session if necessary, and redirects the user to the login page defined in <code class="literal">login-config</code>. (In the previous example code, the login page is <code class="filename">login.html</code>.) The user then enters their user name and password in the HTML form provided. User name and password are passed to <code class="classname">FormAuthenticator</code> via the <code class="methodname">j_security_check</code> form action.
	</div><div class="para">
		The <code class="classname">FormAuthenticator</code> then authenticates the user name and password against the realm attached to the web application context. In JBoss Enterprise Application Platform, the realm is <code class="literal">JBossWebRealm</code>. When authentication is successful, <code class="classname">FormAuthenticator</code> retrieves the saved request from the cache and redirects the user to their original request.
	</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			The server recognizes form authentication requests only when the URI ends with <code class="literal">/j_security_check</code> and at least the <code class="varname">j_username</code> and <code class="varname">j_password</code> parameters exist.
		</div></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24099-549604+%5BSpecified%5D&amp;comment=Title%3A+Enable+Form-based+Authentication%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24099-549604+30+Oct+2013+14%3A03+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Enable_Declarative_Security1" lang="en-US"><div class="titlepage"><div><div><h3 class="title">2.1.9. Enable Declarative Security</h3></div></div></div><div class="para">
		The Java EE security elements that have been covered so far describe the security requirements only from the application's perspective. Because Java EE security elements declare logical roles, the application deployer maps the roles from the application domain onto the deployment environment. The Java EE specifications omit these application server-specific details.
	</div><div class="para">
		To map application roles onto the deployment environment, you must specify a security manager that implements the Java EE security model using JBoss EAP-specific deployment descriptors. Refer to the custom login module example for details of this security configuration.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24100-549607+%5BSpecified%5D&amp;comment=Title%3A+Enable+Declarative+Security%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24100-549607+30+Oct+2013+14%3A13+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div></div><div xml:lang="en-US" class="chapter" id="chap-Introduction_to_JAAS" lang="en-US"><div class="titlepage"><div><div><h2 class="title">Chapter 3. Introduction to JAAS</h2></div></div></div><div xml:lang="en-US" class="section" id="About_JAAS" lang="en-US"><div class="titlepage"><div><div><h2 class="title">3.1. About JAAS</h2></div></div></div><div class="para">
		The JBossSX framework is based on the JAAS API. You must understand the basic elements of the JAAS API before you can understand the implementation details of JBossSX. The following sections provide an introduction to JAAS to prepare you for the JBossSX architecture discussion later in this guide.
	</div><div class="para">
		The JAAS 1.0 API consists of a set of Java packages designed for user authentication and authorization. The API implements a Java version of the standard Pluggable Authentication Modules (PAM) framework and extends the Java 2 Platform access control architecture to support user-based authorization.
	</div><div class="para">
		JAAS was first released as an extension package for JDK 1.3 and is bundled with JDK 1.5. Because the JBossSX framework only uses the authentication capabilities of JAAS to implement the declarative role-based J2EE security model, this introduction focuses on only that topic.
	</div><div class="para">
		JAAS authentication is performed in a pluggable fashion. This permits Java applications to remain independent from underlying authentication technologies, and allows the JBossSX security manager to work in different security infrastructures. Integration with a security infrastructure is achievable without changing the JBossSX security manager implementation. You need only change the configuration of the authentication stack JAAS uses.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24380-550355+%5BSpecified%5D&amp;comment=Title%3A+About+JAAS%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24380-550355+04+Nov+2013+12%3A39+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="JAAS_Core_Classes" lang="en-US"><div class="titlepage"><div><div><h2 class="title">3.2. JAAS Core Classes</h2></div></div></div><div class="para">
		The JAAS core classes can be broken down into three categories: common, authentication, and authorization. The following list presents only the common and authentication classes because these are the specific classes used to implement the functionality of JBossSX covered in this chapter.
	</div><div class="para">
		These are the common classes:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				<code class="literal">Subject</code> (<code class="classname">javax.security.auth.Subject</code>)
			</div></li></ul></div><div class="para">
		These are the authentication classes:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				<code class="literal">Configuration</code> (<code class="classname">javax.security.auth.login.Configuration</code>)
			</div></li><li class="listitem"><div class="para">
				<code class="literal">LoginContext</code> (<code class="classname">javax.security.auth.login.LoginContext</code>)
			</div></li></ul></div><div class="para">
		These are the associated interfaces:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				<code class="literal">Principal</code> (<code class="classname">java.security.Principal</code>)
			</div></li><li class="listitem"><div class="para">
				<code class="literal">Callback</code> (<code class="classname">javax.security.auth.callback.Callback</code>)
			</div></li><li class="listitem"><div class="para">
				<code class="literal">CallbackHandler</code> (<code class="classname">javax.security.auth.callback.CallbackHandler</code>)
			</div></li><li class="listitem"><div class="para">
				<code class="literal">LoginModule</code> (<code class="classname">javax.security.auth.spi.LoginModule</code>)
			</div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24101-549623+%5BSpecified%5D&amp;comment=Title%3A+JAAS+Core+Classes%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24101-549623+30+Oct+2013+14%3A38+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Subject_and_Principal_classes" lang="en-US"><div class="titlepage"><div><div><h2 class="title">3.3. Subject and Principal classes</h2></div></div></div><div class="para">
		To authorize access to resources, applications must first authenticate the request's source. The JAAS framework defines the term subject to represent a request's source. The <code class="classname">Subject</code> class is the central class in JAAS. A <code class="classname">Subject</code> represents information for a single entity, such as a person or service. It encompasses the entity's principals, public credentials, and private credentials. The JAAS APIs use the existing Java 2 <code class="classname">java.security.Principal</code> interface to represent a principal, which is essentially a typed name.
	</div><div class="para">
		During the authentication process, a subject is populated with associated identities, or principals. A subject may have many principals. For example, a person may have a name principal (John Doe), a social security number principal (123-45-6789), and a user name principal (johnd), all of which help distinguish the subject from other subjects. To retrieve the principals associated with a subject, two methods are available:
	</div><pre class="programlisting language-java">
public Set getPrincipals() {...}
public Set getPrincipals(Class c) {...}
</pre><div class="para">
		<code class="methodname">getPrincipals()</code> returns all principals contained in the subject. <code class="methodname">getPrincipals(Class c)</code> returns only those principals that are instances of class <code class="literal">c</code> or one of its subclasses. An empty set is returned if the subject has no matching principals.
	</div><div class="para">
		Note that the <code class="classname">java.security.acl.Group</code> interface is a sub-interface of <code class="classname">java.security.Principal</code>, so an instance in the principals set may represent a logical grouping of other principals or groups of principals.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24102-549625+%5BSpecified%5D&amp;comment=Title%3A+Subject+and+Principal+classes%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24102-549625+30+Oct+2013+14%3A42+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Subject_Authentication" lang="en-US"><div class="titlepage"><div><div><h2 class="title">3.4. Subject Authentication</h2></div></div></div><div class="para">
		Subject Authentication requires a JAAS login. The login process consists of the following points:
	</div><div class="orderedlist"><ol><li class="listitem"><div class="para">
				An application instantiates a <code class="literal">LoginContext</code> and passes in the name of the login configuration and a <code class="literal">CallbackHandler</code> to populate the <code class="literal">Callback</code> objects, as required by the configuration <code class="literal">LoginModule</code>s.
			</div></li><li class="listitem"><div class="para">
				The <code class="literal">LoginContext</code> consults a <code class="literal">Configuration</code> to load all the <code class="literal">LoginModules</code> included in the named login configuration. If no such named configuration exists the <code class="literal">other</code> configuration is used as a default.
			</div></li><li class="listitem"><div class="para">
				The application invokes the <code class="methodname">LoginContext.login</code> method.
			</div></li><li class="listitem"><div class="para">
				The login method invokes all the loaded <code class="literal">LoginModule</code>s. As each <code class="literal">LoginModule</code> attempts to authenticate the subject, it invokes the handle method on the associated <code class="literal">CallbackHandler</code> to obtain the information required for the authentication process. The required information is passed to the handle method in the form of an array of <code class="literal">Callback</code> objects. Upon success, the <code class="literal">LoginModule</code>s associate relevant principals and credentials with the subject.
			</div></li><li class="listitem"><div class="para">
				The <code class="literal">LoginContext</code> returns the authentication status to the application. Success is represented by a return from the login method. Failure is represented through a LoginException being thrown by the login method.
			</div></li><li class="listitem"><div class="para">
				If authentication succeeds, the application retrieves the authenticated subject using the <code class="methodname">LoginContext.getSubject</code> method.
			</div></li><li class="listitem"><div class="para">
				After the scope of the subject authentication is complete, all principals and related information associated with the subject by the <code class="literal">login</code> method can be removed by invoking the <code class="methodname">LoginContext.logout</code> method.
			</div></li></ol></div><div class="para">
		The <code class="classname">LoginContext</code> class provides the basic methods for authenticating subjects and offers a way to develop an application that is independent of the underlying authentication technology. The <code class="classname">LoginContext</code> consults a <code class="literal">Configuration</code> to determine the authentication services configured for a particular application. <code class="classname">LoginModule</code> classes represent the authentication services. Therefore, you can plug different login modules into an application without changing the application itself. The following code shows the steps required by an application to authenticate a subject.
	</div><pre class="programlisting language-java">
CallbackHandler handler = new MyHandler();
LoginContext lc = new LoginContext("some-config", handler);

try {
    lc.login();
    Subject subject = lc.getSubject();
} catch(LoginException e) {
    System.out.println("authentication failed");
    e.printStackTrace();
}
                        
// Perform work as authenticated Subject
// ...

// Scope of work complete, logout to remove authentication info
try {
    lc.logout();
} catch(LoginException e) {
    System.out.println("logout failed");
    e.printStackTrace();
}
                        
// A sample MyHandler class
class MyHandler 
    implements CallbackHandler
{
    public void handle(Callback[] callbacks) throws
        IOException, UnsupportedCallbackException
    {
        for (int i = 0; i &lt; callbacks.length; i++) {
            if (callbacks[i] instanceof NameCallback) {
                NameCallback nc = (NameCallback)callbacks[i];
                nc.setName(username);
            } else if (callbacks[i] instanceof PasswordCallback) {
                PasswordCallback pc = (PasswordCallback)callbacks[i];
                pc.setPassword(password);
            } else {
                throw new UnsupportedCallbackException(callbacks[i],
                                                       "Unrecognized Callback");
            }
        }
    }
}
</pre><div class="para">
		Developers integrate with an authentication technology by creating an implementation of the <code class="literal">LoginModule</code> interface. This allows an administrator to plug different authentication technologies into an application. You can chain together multiple <code class="literal">LoginModule</code>s to allow for more than one authentication technology to participate in the authentication process. For example, one <code class="literal">LoginModule</code> may perform user name/password-based authentication, while another may interface to hardware devices such as smart card readers or biometric authenticators.
	</div><div class="para">
		The life cycle of a <code class="literal">LoginModule</code> is driven by the <code class="literal">LoginContext</code> object against which the client creates and issues the login method. The process consists of two phases. The steps of the process are as follows:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				The <code class="literal">LoginContext</code> creates each configured <code class="literal">LoginModule</code> using its public no-arg constructor.
			</div></li><li class="listitem"><div class="para">
				Each <code class="literal">LoginModule</code> is initialized with a call to its initialize method. The <code class="literal">Subject</code> argument is guaranteed to be non-null. The signature of the initialize method is: <code class="methodname">public void initialize(Subject subject, CallbackHandler callbackHandler, Map sharedState, Map options)</code>
			</div></li><li class="listitem"><div class="para">
				The <code class="methodname">login</code> method is called to start the authentication process. For example, a method implementation might prompt the user for a user name and password and then verify the information against data stored in a naming service such as NIS or LDAP. Alternative implementations might interface to smart cards and biometric devices, or simply extract user information from the underlying operating system. The validation of user identity by each <code class="literal">LoginModule</code> is considered phase 1 of JAAS authentication. The signature of the <code class="methodname">login</code> method is <code class="methodname">boolean login() throws LoginException</code> . A <code class="literal">LoginException</code> indicates failure. A return value of true indicates that the method succeeded, whereas a return value of false indicates that the login module should be ignored.
			</div></li><li class="listitem"><div class="para">
				If the <code class="literal">LoginContext</code>'s overall authentication succeeds, <code class="literal">commit</code> is invoked on each <code class="literal">LoginModule</code>. If phase 1 succeeds for a <code class="literal">LoginModule</code>, then the commit method continues with phase 2 and associates the relevant principals, public credentials, and/or private credentials with the subject. If phase 1 fails for a <code class="literal">LoginModule</code>, then <code class="literal">commit</code> removes any previously stored authentication state, such as user names or passwords. The signature of the <code class="methodname">commit</code> method is: <code class="methodname">boolean commit() throws LoginException</code> . Failure to complete the commit phase is indicated by throwing a <code class="literal">LoginException</code>. A return of true indicates that the method succeeded, whereas a return of false indicates that the login module should be ignored.
			</div></li><li class="listitem"><div class="para">
				If the <code class="literal">LoginContext</code>'s overall authentication fails, then the <code class="methodname">abort</code> method is invoked on each <code class="literal">LoginModule</code>. The <code class="literal">abort</code> method removes or destroys any authentication state created by the login or initialize methods. The signature of the <code class="literal">abort</code> method is <code class="methodname">boolean abort() throws LoginException</code> . Failure to complete the <code class="literal">abort</code> phase is indicated by throwing a <code class="literal">LoginException</code>. A return of true indicates that the method succeeded, whereas a return of false indicates that the login module should be ignored.
			</div></li><li class="listitem"><div class="para">
				To remove the authentication state after a successful login, the application invokes <code class="literal">logout</code> on the <code class="literal">LoginContext</code>. This in turn results in a <code class="methodname">logout</code> method invocation on each <code class="literal">LoginModule</code>. The <code class="methodname">logout</code> method removes the principals and credentials originally associated with the subject during the <code class="literal">commit</code> operation. Credentials should be destroyed upon removal. The signature of the <code class="methodname">logout</code> method is: <code class="methodname">boolean logout() throws LoginException</code> . Failure to complete the logout process is indicated by throwing a <code class="literal">LoginException</code>. A return of true indicates that the method succeeded, whereas a return of false indicates that the login module should be ignored.
			</div></li></ul></div><div class="para">
		When a <code class="literal">LoginModule</code> must communicate with the user to obtain authentication information, it uses a <code class="literal">CallbackHandler</code> object. Applications implement the <span class="interface"> CallbackHandler </span> interface and pass it to the <code class="literal">LoginContext</code>, which send the authentication information directly to the underlying login modules.
	</div><div class="para">
		Login modules use the <code class="literal">CallbackHandler</code> both to gather input from users, such as a password or smart card PIN, and to supply information to users, such as status information. By allowing the application to specify the <code class="literal">CallbackHandler</code>, underlying <code class="literal">LoginModule</code>s remain independent from the different ways applications interact with users. For example, a <code class="literal">CallbackHandler</code>'s implementation for a GUI application might display a window to solicit user input. On the other hand, a <code class="literal">CallbackHandler</code> implementation for a non-GUI environment, such as an application server, might simply obtain credential information by using an application server API. The <span class="interface"> CallbackHandler </span> interface has one method to implement:
	</div><pre class="programlisting language-java">
void handle(Callback[] callbacks)
    throws java.io.IOException, 
           UnsupportedCallbackException;
</pre><div class="para">
		The <code class="literal">Callback</code> interface is the last authentication class we will look at. This is a tagging interface for which several default implementations are provided, including the <code class="literal">NameCallback</code> and <code class="literal">PasswordCallback</code> used in an earlier example. A <code class="literal">LoginModule</code> uses a <code class="literal">Callback</code> to request information required by the authentication mechanism. <code class="literal">LoginModule</code>s pass an array of <code class="literal">Callback</code>s directly to the <code class="methodname">CallbackHandler.handle</code> method during the authentication's login phase. If a <code class="literal">callbackhandler</code> does not understand how to use a <code class="literal">Callback</code> object passed into the handle method, it throws an <code class="literal">UnsupportedCallbackException</code> to abort the login call.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24103-549630+%5BSpecified%5D&amp;comment=Title%3A+Subject+Authentication%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24103-549630+30+Oct+2013+14%3A50+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div></div><div xml:lang="en-US" class="part" id="part-Securing_the_Platform" lang="en-US"><div class="titlepage"><div><div><h1 class="title">Part II. Securing the Platform</h1></div></div></div><div xml:lang="en-US" class="chapter" id="chap-The_Security_Subsystem" lang="en-US"><div class="titlepage"><div><div><h2 class="title">Chapter 4. The Security Subsystem</h2></div></div></div><div xml:lang="en-US" class="section" id="About_the_Security_Subsystem" lang="en-US"><div class="titlepage"><div><div><h2 class="title">4.1. About the Security Subsystem</h2></div></div></div><div class="para">
		The security subsystem provides the infrastructure for all security functionality in JBoss EAP 6. Most configuration elements rarely need to be changed. The only configuration element which may need to be changed is whether to use <em class="firstterm">deep-copy-subject-mode</em>. In addition, you can configure system-wide security properties. Most of the configuration relates to <em class="firstterm">security domains</em>.
	</div><div class="para"><div class="title">Deep Copy Mode</div><p>
			If deep copy subject mode is disabled (the default), copying a security data structure makes a reference to the original, rather than copying the entire data structure. This behavior is more efficient, but is prone to data corruption if multiple threads with the same identity clear the subject by means of a flush or logout operation.
		</p></div><div class="para">
		Deep copy subject mode causes a complete copy of the data structure and all its associated data to be made, as long as they are marked cloneable. This is more thread-safe, but less efficient.
	</div><div class="para"><div class="title">System-Wide Security Properties</div><p>
			You can set system-wide security properties, which are applied to <code class="code">java.security.Security</code> class.
		</p></div><div class="para"><div class="title">Security Domain</div><p>
			A security domain is a set of <em class="firstterm">Java Authentication and Authorization Service (JAAS)</em> declarative security configurations which one or more applications use to control authentication, authorization, auditing, and mapping. Three security domains are included by default: <code class="literal">jboss-ejb-policy</code>, <code class="literal">jboss-web-policy</code>, and <code class="literal">other</code>. You can create as many security domains as you need to accommodate the needs of your applications.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4702-490493+%5BSpecified%5D&amp;comment=Title%3A+About+the+Security+Subsystem%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4702-490493+02+Aug+2013+15%3A42+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="About_the_Structure_of_the_Security_Subsystem" lang="en-US"><div class="titlepage"><div><div><h2 class="title">4.2. About the Structure of the Security Subsystem</h2></div></div></div><div class="para">
		The security subsystem is configured in the managed domain or standalone configuration file. Most of the configuration elements can be configured using the web-based management console or the console-based management CLI. The following is the XML representing an example security subsystem.
	</div><div class="example" id="idm140707322729328"><p class="title"><strong>Example 4.1. Example Security Subsystem Configuration</strong></p><div class="example-contents"><pre class="programlisting language-xml XML XML">
&lt;subsystem xmlns="urn:jboss:domain:security:1.2"&gt;
	&lt;security-management&gt;
		...
	&lt;/security-management&gt;
	&lt;security-domains&gt;
        &lt;security-domain name="other" cache-type="default"&gt;
            &lt;authentication&gt;
                &lt;login-module code="Remoting" flag="optional"&gt;
                    &lt;module-option name="password-stacking" value="useFirstPass"/&gt;
                &lt;/login-module&gt;
                &lt;login-module code="RealmUsersRoles" flag="required"&gt;
                    &lt;module-option name="usersProperties" value="${jboss.domain.config.dir}/application-users.properties"/&gt;
                    &lt;module-option name="rolesProperties" value="${jboss.domain.config.dir}/application-roles.properties"/&gt;
                    &lt;module-option name="realm" value="ApplicationRealm"/&gt;
                    &lt;module-option name="password-stacking" value="useFirstPass"/&gt;
                &lt;/login-module&gt;
            &lt;/authentication&gt;
        &lt;/security-domain&gt;
        &lt;security-domain name="jboss-web-policy" cache-type="default"&gt;
            &lt;authorization&gt;
                &lt;policy-module code="Delegating" flag="required"/&gt;
            &lt;/authorization&gt;
        &lt;/security-domain&gt;
        &lt;security-domain name="jboss-ejb-policy" cache-type="default"&gt;
            &lt;authorization&gt;
                &lt;policy-module code="Delegating" flag="required"/&gt;
            &lt;/authorization&gt;
        &lt;/security-domain&gt;
    &lt;/security-domains&gt;
    &lt;vault&gt;
    	...
    &lt;/vault&gt;
&lt;/subsystem&gt;		

</pre><div class="para">
			The <code class="sgmltag-element">&lt;security-management&gt;</code>, <code class="sgmltag-element">&lt;subject-factory&gt;</code> and <code class="sgmltag-element">&lt;security-properties&gt;</code> elements are not present in the default configuration. The <code class="sgmltag-element">&lt;subject-factory&gt;</code> and <code class="sgmltag-element">&lt;security-properties&gt;</code> elements have been deprecated in JBoss EAP 6.1 onwards.
		</div></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+7200-458752+%5BSpecified%5D&amp;comment=Title%3A+About+the+Structure+of+the+Security+Subsystem%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7200-458752+11+Jun+2013+14%3A18+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div class="section" id="sect-Configuring_the_Security_Subsystem"><div class="titlepage"><div><div><h2 class="title">4.3. Configuring the Security Subsystem</h2></div></div></div><div xml:lang="en-US" class="section" id="Configure_the_Security_Subsystem" lang="en-US"><div class="titlepage"><div><div><h3 class="title">4.3.1. Configure the Security Subsystem</h3></div></div></div><div class="para">
		You can configure the security subsystem using the Management CLI or web-based Management Console.
	</div><div class="para">
		Each top-level element within the security subsystem contains information about a different aspect of the security configuration. Refer to <a class="xref" href="#About_the_Structure_of_the_Security_Subsystem">Section 4.2, “About the Structure of the Security Subsystem”</a> for an example of security subsystem configuration.
	</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">&lt;security-management&gt;</span></dt><dd><div class="para">
					This section overrides high-level behaviors of the security subsystem. Each setting is optional. It is unusual to change any of these settings except for deep copy subject mode.
				</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707311213792" scope="col"> Option </th><th id="idm140707307113552" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140707311213792"> deep-copy-subject-mode </td><td headers="idm140707307113552"> <div class="para">
									Specifies whether to copy or link to security tokens, for additional thread safety.
								</div>
								 </td></tr><tr><td headers="idm140707311213792"> authentication-manager-class-name </td><td headers="idm140707307113552"> <div class="para">
									Specifies an alternate AuthenticationManager implementation class name to use.
								</div>
								 </td></tr><tr><td headers="idm140707311213792"> authorization-manager-class-name </td><td headers="idm140707307113552"> <div class="para">
									Specifies an alternate AuthorizationManager implementation class name to use.
								</div>
								 </td></tr><tr><td headers="idm140707311213792"> audit-manager-class-name </td><td headers="idm140707307113552"> <div class="para">
									Specifies an alternate AuditManager implementation class name to use.
								</div>
								 </td></tr><tr><td headers="idm140707311213792"> identity-trust-manager-class-name </td><td headers="idm140707307113552"> <div class="para">
									Specifies an alternate IdentityTrustManager implementation class name to use.
								</div>
								 </td></tr><tr><td headers="idm140707311213792"> mapping-manager-class-name </td><td headers="idm140707307113552"> <div class="para">
									Specifies the MappingManager implementation class name to use.
								</div>
								 </td></tr></tbody></table></div></dd><dt><span class="term">&lt;subject-factory&gt;</span></dt><dd><div class="para">
					The subject factory controls creation of subject instances. It may use the authentication manager to verify the caller. The main use of the subject factory is for JCA components to establish a subject.It is unusual to need to modify the subject factory.
				</div></dd><dt><span class="term">&lt;security-domains&gt;</span></dt><dd><div class="para">
					A container element which holds multiple security domains. A security domain may contain information about authentication, authorization, mapping, and auditing modules, as well as JASPI authentication and JSSE configuration. Your application would specify a security domain to manage its security information.
				</div></dd><dt><span class="term">&lt;security-properties&gt;</span></dt><dd><div class="para">
					Contains names and values of properties which are set on the java.security.Security class.
				</div></dd></dl></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+8424-466657+%5BSpecified%5D&amp;comment=Title%3A+Configure+the+Security+Subsystem%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=8424-466657+19+Jun+2013+15%3A47+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div class="section" id="sect-Security_Management"><div class="titlepage"><div><div><h3 class="title">4.3.2. Security Management</h3></div></div></div><div xml:lang="en-US" class="section" id="About_Deep_Copy_Subject_Mode" lang="en-US"><div class="titlepage"><div><div><h4 class="title">4.3.2.1. About Deep Copy Subject Mode</h4></div></div></div><div class="para">
		If <em class="firstterm">deep copy subject mode</em> is disabled (the default), copying a security data structure makes a reference to the original, rather than copying the entire data structure. This behavior is more efficient, but is prone to data corruption if multiple threads with the same identity clear the subject by means of a flush or logout operation.
	</div><div class="para">
		Deep copy subject mode causes a complete copy of the data structure and all its associated data to be made, as long as they are marked cloneable. This is more thread-safe, but less efficient.
	</div><div class="para">
		Deep copy subject mode is configured as part of the security subsystem.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+6851-328492+%5BSpecified%5D&amp;comment=Title%3A+About+Deep+Copy+Subject+Mode%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=6851-328492+05+Nov+2012+14%3A24+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Enable_Deep_Copy_Subject_Mode" lang="en-US"><div class="titlepage"><div><div><h4 class="title">4.3.2.2. Enable Deep Copy Subject Mode</h4></div></div></div><div class="para">
		You can enable deep copy security mode from the web-based management console or the management CLI.
	</div><div class="procedure"><p class="title"><strong>Procedure 4.1. Enable Deep Copy Security Mode from the Management Console</strong></p><ol class="1"><li class="step"><p class="title"><strong>Log into the Management Console.</strong></p><div class="para">
				The management console is usually available at a URL such as <a href="http://127.0.0.1:9990/" class="mimir-link-warn" title="Mimir does not include content from: 127.0.0.1">http://127.0.0.1:9990/</a>. Adjust this value to suit your needs.
			</div></li><li class="step"><p class="title"><strong>Managed Domain: Select the appropriate profile.</strong></p><div class="para">
				In a managed domain, the security subsystem is configured per profile, and you can enable or disable the deep copy security mode in each, independently.
			</div><div class="para">
				To select a profile, click the <span class="guilabel"><strong>Profiles</strong></span> label at the top right of the console display, and then select the profile you wish to change from the <span class="guilabel"><strong>Profile</strong></span> selection box at the top left.
			</div></li><li class="step"><p class="title"><strong>Open the <span class="guilabel"><strong>Security Subsystem</strong></span> configuration menu.</strong></p><div class="para">
				Expand the <span class="guilabel"><strong>Security</strong></span> menu item at the right of the management console, then click the <span class="guilabel"><strong>Security Subsystem</strong></span> link.
			</div></li><li class="step"><p class="title"><strong>Modify the <span class="guilabel"><strong>deep-copy-subject-mode</strong></span> value.</strong></p><div class="para">
				Click the <span class="guibutton"><strong>Edit</strong></span> button. Check the box beside <span class="guilabel"><strong>Deep Copy Subjects:</strong></span> to enable deep copy subject mode.
			</div></li></ol></div><div class="para"><div class="title">Enable Deep Copy Subject Mode Using the Management CLI</div><p>
			If you prefer to use the management CLI to enable this option, use one of the following commands.
		</p></div><div class="example" id="idm140707341300096"><p class="title"><strong>Example 4.2. Managed Domain</strong></p><div class="example-contents"><pre class="screen">/profile=full/subsystem=security:write-attribute(name=deep-copy-subject-mode,value=TRUE)</pre></div></div><div class="example" id="idm140707314620688"><p class="title"><strong>Example 4.3. Standalone Server</strong></p><div class="example-contents"><pre class="screen">/subsystem=security:write-attribute(name=deep-copy-subject-mode,value=TRUE)</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+6852-436012+%5BSpecified%5D&amp;comment=Title%3A+Enable+Deep+Copy+Subject+Mode%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=6852-436012+19+Apr+2013+09%3A51+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div class="section" id="sect-Security_Domains"><div class="titlepage"><div><div><h3 class="title">4.3.3. Security Domains</h3></div></div></div><div xml:lang="en-US" class="section" id="About_Security_Domains" lang="en-US"><div class="titlepage"><div><div><h4 class="title">4.3.3.1. About Security Domains</h4></div></div></div><div class="para">
		Security domains are part of the JBoss EAP 6 security subsystem. All security configuration is now managed centrally, by the domain controller of a managed domain, or by the standalone server.
	</div><div class="para">
		A security domain consists of configurations for authentication, authorization, security mapping, and auditing. It implements <em class="firstterm">Java Authentication and Authorization Service (JAAS)</em> declarative security.
	</div><div class="para">
		Authentication refers to verifying the identity of a user. In security terminology, this user is referred to as a <em class="firstterm">principal</em>. Although authentication and authorization are different, many of the included authentication modules also handle authorization.
	</div><div class="para">
		An <em class="firstterm">authorization</em> is a security policy, by which the server determines whether an authenticated user has permission to access specific privileges or resources in the system or operation. In security terminology, this is often referred to as a role.
	</div><div class="para">
		<em class="firstterm">Security mapping</em> refers to the ability to add, modify, or delete information from a principal, role, or attribute before passing the information to your application.
	</div><div class="para">
		The auditing manager allows you to configure <em class="firstterm">provider modules</em> to control the way that security events are reported.
	</div><div class="para">
		If you use security domains, you can remove all specific security configuration from your application itself. This allows you to change security parameters centrally. One common scenario that benefits from this type of configuration structure is the process of moving applications between testing and production environments.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4721-481770+%5BSpecified%5D&amp;comment=Title%3A+About+Security+Domains%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4721-481770+25+Jul+2013+13%3A19+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="About_Picketbox" lang="en-US"><div class="titlepage"><div><div><h4 class="title">4.3.3.2. About Picketbox</h4></div></div></div><div class="para">
		Picketbox is the foundational security framework that provides the authentication, authorization, audit and mapping capabilities to Java applications running in JBoss EAP 6. It provides the following capabilities, in a single framework with a single configuration:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				<a class="xref" href="#About_Authentication1">Section 5.9.1, “About Authentication”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#About_Authorization1">Section 5.11.1, “About Authorization”</a> and access control
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#About_Security_Auditing1">Section 5.13.1, “About Security Auditing”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#About_Security_Mapping1">Section 5.14.1, “About Security Mapping”</a> of principals, roles, and attributes
			</div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4722-458756+%5BSpecified%5D&amp;comment=Title%3A+About+Picketbox%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4722-458756+11+Jun+2013+14%3A22+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div></div></div><div xml:lang="en-US" class="chapter" id="chap-PicketLink_Identity_Management" lang="en-US"><div class="titlepage"><div><div><h2 class="title">Chapter 5. PicketLink Identity Management</h2></div></div></div><div xml:lang="en-US" class="section" id="Security_Token_Server_STS" lang="en-US"><div class="titlepage"><div><div><h2 class="title">5.1. About Security Token Service (STS)</h2></div></div></div><div class="para">
		The Security Token Service generates and manages the security tokens. It does not issue tokens of a specific type. Instead, it defines generic interfaces that allows multiple token providers to be plugged in. As a result, it can be configured to deal with various types of token, as long as a token provider exists for each token type. It also specifies the format of the security token request and response messages.
	</div><div class="para">
		A security token request message specifies the following:
	</div><div class="para">
		<div class="itemizedlist"><ul><li class="listitem"><div class="para">
					Type of the request, such as Issue, Renew, and so on.
				</div></li></ul></div>
		 <div class="itemizedlist"><ul><li class="listitem"><div class="para">
					Type of the token.
				</div></li></ul></div>
		 <div class="itemizedlist"><ul><li class="listitem"><div class="para">
					Lifetime of the issued token.
				</div></li></ul></div>
		 <div class="itemizedlist"><ul><li class="listitem"><div class="para">
					Information about the service provider that requested the token.
				</div></li></ul></div>
		 <div class="itemizedlist"><ul><li class="listitem"><div class="para">
					Information used to encrypt the generated token.
				</div></li></ul></div>

	</div><div class="para">
		The token request message is sent in the body of the SOAP message. All information related to the token request is enclosed in the <code class="code">RequestSecurityToken</code> element. The sample request contains two other WS-Trust elements: <code class="code">RequestType</code>, which specifies that this request is an Issue request, and <code class="code">TokenType</code>, which specifies the type of the token to be issued.
	</div><div class="para">
		The following is an example of the WS-Trust request message.
	</div><div class="example" id="idm140707312430160"><p class="title"><strong>Example 5.1. WS-Trust security token request message</strong></p><div class="example-contents"><pre class="programlisting">&lt;S11:Envelope xmlns:S11=".." xmlns:wsu=".." xmlns:wst=".."&gt;  
   &lt;S11:Header&gt;  
      ...  
   &lt;/S11:Header&gt;  
   &lt;S11:Body wsu:Id="body"&gt;  
      &lt;wst:RequestSecurityToken Context="context"&gt;  
         &lt;wst:TokenType&gt;http://www.tokens.org/SpecialToken&lt;/wst:TokenType&gt;  
         &lt;wst:RequestType&gt;  
            http://docs.oasis-open.org/ws-sx/ws-trust/200512/Issue  
         &lt;/wst:RequestType&gt;  
      &lt;/wst:RequestSecurityToken&gt;  
   &lt;/S11:Body&gt;  
&lt;/S11:Envelope&gt;
</pre></div></div><div class="para">
		The following is an example of a security token response.
	</div><div class="example" id="idm140707312716336"><p class="title"><strong>Example 5.2. Security token response message</strong></p><div class="example-contents"><pre class="programlisting">    &lt;wst:RequestSecurityTokenResponse Context="context" xmlns:wst=".." xmlns:wsu=".."&gt;  
       &lt;wst:TokenType&gt;http://www.tokens.org/SpecialToken&lt;/wst:TokenType&gt;  
       &lt;wst:RequestedSecurityToken&gt;  
          &lt;token:SpecialToken xmlns:token="..."&gt;  
             ARhjefhE2FEjneovi&amp;@FHfeoveq3  
          &lt;/token:SpecialToken&gt;  
       &lt;/wst:RequestedSecurityToken&gt;  
       &lt;wst:Lifetime&gt;  
          &lt;wsu:Created&gt;...&lt;/wsu:Created&gt;  
          &lt;wsu:Expires&gt;...&lt;/wsu:Expires&gt;  
       &lt;/wst:Lifetime&gt;  
    &lt;/wst:RequestSecurityTokenResponse&gt;
</pre></div></div><div class="para">
		In the example for the security token response, the <code class="code">TokenType</code> element specifies the type of the issued token, while the <code class="code">RequestedSecurityToken</code> element contains the token itself. The format of the token depends on the type of the token. The <code class="code">Lifetime</code> element specifies when the token was created and when it expires.
	</div><div class="para"><div class="title">Security Token Request Processing</div><p>
			The following are the steps in which the security token requests are processed:
		</p></div><div class="para">
		<div class="itemizedlist"><ul><li class="listitem"><div class="para">
					A client sends a security token request to <code class="code">PicketLinkSTS</code>.
				</div></li></ul></div>
		 <div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<code class="code">PicketLinkSTS</code> parses the request message, generating a JAXB object model.
				</div></li></ul></div>
		 <div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<code class="code">PicketLinkSTS</code> reads the configuration file and creates the <code class="code">STSConfiguration</code> object, if needed. Then it obtains a reference to the <code class="code">WSTrustRequestHandler</code> from the configuration and delegates the request processing to the handler instance.
				</div></li></ul></div>
		 <div class="itemizedlist"><ul><li class="listitem"><div class="para">
					The request handler uses the <code class="code">STSConfiguration</code> to set default values when needed (for example, when the request doesn't specify a token lifetime value).
				</div></li></ul></div>
		 <div class="itemizedlist"><ul><li class="listitem"><div class="para">
					The <code class="code">WSTrustRequestHandler</code> creates the <code class="code">WSTrustRequestContext</code>, setting the <code class="code">JAXB</code> request object and the caller principal it received from <code class="code">PicketLinkSTS</code>.
				</div></li></ul></div>
		 <div class="itemizedlist"><ul><li class="listitem"><div class="para">
					The <code class="code">WSTrustRequestHandler</code> uses the <code class="code">STSConfiguration</code> to get the <code class="code">SecurityTokenProvider</code> that must be used to process the request based on the type of the token that is being requested. Then it invokes the provider, passing the constructed <code class="code">WSTrustRequestContext</code> as a parameter.
				</div></li></ul></div>
		 <div class="itemizedlist"><ul><li class="listitem"><div class="para">
					The <code class="code">SecurityTokenProvider</code> instance process the token request and stores the issued token in the request context.
				</div></li></ul></div>
		 <div class="itemizedlist"><ul><li class="listitem"><div class="para">
					The <code class="code">WSTrustRequestHandler</code> obtains the token from the context, encrypts it if needed, and constructs the WS-Trust response object containing the security token.
				</div></li></ul></div>
		 <div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<code class="code">PicketLinkSTS</code> dictates the response generated by the request handler and returns it to the client.
				</div></li></ul></div>

	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24107-547960+%5BSpecified%5D&amp;comment=Title%3A+About+Security+Token+Service+%28STS%29%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24107-547960+20+Oct+2013+03%3A54+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_STS_Login_Modules" lang="en-US"><div class="titlepage"><div><div><h2 class="title">5.2. Configure PicketLink STS</h2></div></div></div><div class="para">
		PicketLink STS defines several interfaces that provide extension points where implementations can be plugged via configuration and the default values for some properties can be specified via configuration. All PicketLink STS configurations must be specified in the <code class="filename">picketlink-sts.xml</code> file. The following are the elements that can be configured in the <code class="filename">picketlink-sts.xml</code> file.
	</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			In the following text, a service provider refers to the Web service that requires a security token to be presented by its clients.
		</div></div></div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				<code class="code">PicketLinkSTS</code>: This is the root element. It defines some properties that allows the STS administrator to set a the following default values:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<code class="code">STSName</code>: A string representing the name of the security token service. If not specified, the default <code class="code">PicketLinkSTS</code> value is used.
					</div></li><li class="listitem"><div class="para">
						<code class="code">TokenTimeout</code>: The token lifetime value in seconds. If not specified, the default value of 3600 (one hour) is used.
					</div></li><li class="listitem"><div class="para">
						<code class="code">EncryptToken</code>: A boolean specifying whether issued tokens are to be encrypted or not. The default value is false.
					</div></li></ul></div></li><li class="listitem"><div class="para">
				<code class="code">KeyProvider</code>: This element and all its sub elements are used to configure the keystore that are used by PicketLink STS to sign and encrypt tokens. Properties like the keystore location, its password, and the signing (private key) alias and password are all configured in this section.
			</div></li><li class="listitem"><div class="para">
				<code class="code">RequestHandler</code>: This element specifies the fully qualified name of the <code class="code">WSTrustRequestHandler</code> implementation to be used. If not specified, the default <code class="code">org.picketlink.identity.federation.core.wstrust.StandardRequestHandler</code> is used.
			</div></li><li class="listitem"><div class="para">
				<code class="code">SecurityTokenProvider</code>: This section specifies the <code class="code">SecurityTokenProvider</code> implementations that must be used to handle each type of security token. In the example we have two providers - one that handles tokens of type <code class="code">SpecialToken</code> and one that handles tokens of type <code class="code">StandardToken</code>. The <code class="code">WSTrustRequestHandler</code> calls the <code class="code">getProviderForTokenType</code>(String type)method of <code class="code">STSConfiguration</code> to obtain a reference to the appropriate <code class="code">SecurityTokenProvider</code>.
			</div></li><li class="listitem"><div class="para">
				<code class="code">TokenTimeout</code>: This is used by the <code class="code">WSTrustRequestHandler</code> when no Lifetime has been specified in the WS-Trust request. It creates a Lifetime instance that has the current time as the creation time and expires after the specified number of seconds.
			</div></li><li class="listitem"><div class="para">
				<code class="code">ServiceProviders</code>: This section specifies the token types that must be used for each service provider (the Web service that requires a security token). When a WS-Trust request does not contain the token type, the <code class="code">WSTrustRequestHandler</code> must use the service provider endpoint to find out the type of the token that must be issued.
			</div></li><li class="listitem"><div class="para">
				<code class="code">EncryptToken</code>: This is used by the <code class="code">WSTrustRequestHandler</code> to decide if the issued token must be encrypted or not. If true, the public key certificate (PKC) of the service provider is used to encrypt the token.
			</div></li></ul></div><div class="para">
		The following is an example of PicketLink STS configuration.
	</div><div class="example" id="idm140707323116944"><p class="title"><strong>Example 5.3. PicketLink STS Configuration</strong></p><div class="example-contents"><pre class="programlisting">    &lt;PicketLinkSTS xmlns="urn:picketlink:identity-federation:config:1.0"  
         STSName="Test STS" TokenTimeout="7200" EncryptToken="true"&gt;  
         &lt;KeyProvider ClassName="org.picketlink.identity.federation.bindings.tomcat.KeyStoreKeyManager"&gt;  
              &lt;Auth Key="KeyStoreURL" Value="keystore/sts_keystore.jks"/&gt;   
                &lt;Auth Key="KeyStorePass" Value="testpass"/&gt;  
                &lt;Auth Key="SigningKeyAlias" Value="sts"/&gt;  
                &lt;Auth Key="SigningKeyPass" Value="keypass"/&gt;  
                &lt;ValidatingAlias Key="http://services.testcorp.org/provider1" Value="service1"/&gt;  
                &lt;ValidatingAlias Key="http://services.testcorp.org/provider2" Value="service2"/&gt;  
         &lt;/KeyProvider&gt;  
         &lt;RequestHandler&gt;org.picketlink.identity.federation.core.wstrust.StandardRequestHandler&lt;/RequestHandler&gt;  
         &lt;TokenProviders&gt;  
              &lt;TokenProvider ProviderClass="org.picketlink.test.identity.federation.bindings.wstrust.SpecialTokenProvider"  
                   TokenType="http://www.tokens.org/SpecialToken"/&gt;  
              &lt;TokenProvider ProviderClass="org.picketlink.identity.federation.api.wstrust.plugins.saml.SAML20TokenProvider"  
                   TokenType="http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0"/&gt;  
         &lt;/TokenProviders&gt;  
         &lt;ServiceProviders&gt;  
              &lt;ServiceProvider Endpoint="http://services.testcorp.org/provider1" TokenType="http://www.tokens.org/SpecialToken"  
                   TruststoreAlias="service1"/&gt;  
              &lt;ServiceProvider Endpoint="http://services.testcorp.org/provider2" TokenType="http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0"  
                   TruststoreAlias="service2"/&gt;  
         &lt;/ServiceProviders&gt;  
    &lt;/PicketLinkSTS&gt;
</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24108-547829+%5BSpecified%5D&amp;comment=Title%3A+Configure+PicketLink+STS%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24108-547829+18+Oct+2013+17%3A02+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="About_PicketLink_STS_Login_Modules" lang="en-US"><div class="titlepage"><div><div><h2 class="title">5.3. About PicketLink STS Login Modules</h2></div></div></div><div class="para">
		A PicketLink Login Module is typically configured as part of the security setup of a JEE container to use a Security Token Service for authenticating users. The STS may be collocated on the same container as the Login Module or be accessed remotely through Web Service calls or another technology. PicketLink Login Modules support non-PicketLink STS implementations through standard WS-Trust calls.
	</div><div class="para"><div class="title">Types of STS Login Modules</div><p>
			The following are the different types of STS Login Modules.
		</p></div><div class="itemizedlist"><p class="title"><strong>STSIssuingLoginModule</strong></p><ul><li class="listitem"><div class="para">
				Calls the configured STS and requests for a security token. Upon successfully receiving the <code class="code">RequestedSecurityToken</code>, it marks the authentication as successful.
			</div></li><li class="listitem"><div class="para">
				A call to STS typically requires authentication. This Login Module uses credentials from one of the following sources:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						Its properties file, if the <code class="code">useOptionsCredentials</code> module option is set to <code class="code">true</code>.
					</div></li><li class="listitem"><div class="para">
						Previous login module credentials if the <code class="code">password-stacking</code>module option is set to <code class="code">useFirstPass</code>.
					</div></li><li class="listitem"><div class="para">
						From the configured <code class="code">CallbackHandler</code> by supplying a Name and Password Callback.
					</div></li></ul></div></li><li class="listitem"><div class="para">
				Upon successful authentication, the <code class="code">SamlCredential</code> is inserted in the Subject's public credentials if one with the same Assertion is not found to be already present there.
			</div></li></ul></div><div class="itemizedlist"><p class="title"><strong>STSValidatingLoginModule</strong></p><ul><li class="listitem"><div class="para">
				Calls the configured STS and validates an available security token.
			</div></li><li class="listitem"><div class="para">
				A call to STS typically requires authentication. This Login Module uses credentials from one of the following sources:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						Its properties file, if the <code class="code">useOptionsCredentials</code> module option is set to <code class="code">true</code>.
					</div></li><li class="listitem"><div class="para">
						Previous login module credentials if the <code class="code">password-stacking</code> module option is set to <code class="code">useFirstPass</code>.
					</div></li><li class="listitem"><div class="para">
						From the configured <code class="code">CallbackHandler</code> by supplying a Name and Password Callback.
					</div></li></ul></div></li><li class="listitem"><div class="para">
				Upon successful authentication, the SamlCredential is inserted in the Subject's public credentials if one with the same Assertion is not found to be already present there.
			</div></li></ul></div><div class="itemizedlist"><p class="title"><strong>SAML2STSLoginModule</strong></p><ul><li class="listitem"><div class="para">
				This Login Module supplies a <code class="code">ObjectCallback</code> to the configured <code class="code">CallbackHandler</code> and expects a <code class="code">SamlCredential</code> object back. The Assertion is validated against the configured STS.
			</div></li><li class="listitem"><div class="para">
				If a user ID and SAML token are shared, this Login Module bypasses validation When stacked on top of another Login Module that is successfully authenticated.
			</div></li><li class="listitem"><div class="para">
				Upon successful authentication, the <code class="code">SamlCredential</code> is inspected for a <code class="code">NameID</code> and a multi-valued role attribute that is respectively set as the ID and roles of the user.
			</div></li></ul></div><div class="itemizedlist"><p class="title"><strong>SAML2LoginModule</strong></p><ul><li class="listitem"><div class="para">
				This login module is used in conjunction with other components for SAML authentication and performs no authentication itself.
			</div></li><li class="listitem"><div class="para">
				The <code class="code">SPRedirectFormAuthenticator</code> uses this login module in PicketLink's implementation of the SAML v2 HTTP Redirect Profile.
			</div></li><li class="listitem"><div class="para">
				The Tomcat authenticator valve performs authentication through redirecting to the identity provider and getting a SAML assertion.
			</div></li><li class="listitem"><div class="para">
				This login module is used to pass the user ID and roles to the JBoss security framework to be populated in the JAAS subject.
			</div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24255-548426+%5BSpecified%5D&amp;comment=Title%3A+About+PicketLink+STS+Login+Modules%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24255-548426+23+Oct+2013+09%3A10+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_STSIssuingLoginModule" lang="en-US"><div class="titlepage"><div><div><h2 class="title">5.4. Configure STSIssuingLoginModule</h2></div></div></div><div class="para">
		The <code class="code">STSIssuingLoginModule</code> uses a user name and password to authenticate the user against an STS by retrieving a token.
	</div><div class="example" id="idm140707325302912"><p class="title"><strong>Example 5.4. Configure STSIssuingLoginModule</strong></p><div class="example-contents"><pre class="programlisting">&lt;application-policy name="saml-issue-token"&gt;
    &lt;authentication&gt;
        &lt;login-module
            code="org.picketlink.identity.federation.core.wstrust.auth.STSIssuingLoginModule" flag="required"&gt;          &lt;module-option name="configFile"&gt;./picketlink-sts-client.properties&lt;/module-option&gt;
          &lt;module-option name="endpointURI"&gt;http://security_saml/endpoint&lt;/module-option&gt;
        &lt;/login-module&gt;
    &lt;/authentication&gt;
    &lt;mapping&gt;
        &lt;mapping-module
            code="org.picketlink.identity.federation.bindings.jboss.auth.mapping.STSPrincipalMappingProvider"
            type="principal" /&gt;
        &lt;mapping-module
            code="org.picketlink.identity.federation.bindings.jboss.auth.mapping.STSGroupMappingProvider"
            type="role" /&gt;
    &lt;/mapping&gt;
&lt;/application-policy&gt;
</pre></div></div><div class="para">
		Most configurations can switch to the configuration sited in the above example by:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				changing their declared security-domain
			</div></li><li class="listitem"><div class="para">
				specifying a Principal mapping provider
			</div></li><li class="listitem"><div class="para">
				specifying a RoleGroup mapping provider
			</div></li></ul></div><div class="para">
		The specified Principal mapping provider and the RoleGroup mapping provider results in an authenticated Subject being populated that enables coarse-grained and role-based authorization. After authentication, the Security Token is available and may be used to invoke other services by Single Sign-On.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24270-548426+%5BSpecified%5D&amp;comment=Title%3A+Configure+STSIssuingLoginModule%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24270-548426+23+Oct+2013+09%3A10+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_STSValidatingLoginModule" lang="en-US"><div class="titlepage"><div><div><h2 class="title">5.5. Configure STSValidatingLoginModule</h2></div></div></div><div class="para">
		The STSValidatingLoginModule uses a TokenCallback to ask the configured CallbackHandler an STS by retrieving a token.
	</div><div class="example" id="idm140707330510240"><p class="title"><strong>Example 5.5. Configure STSValidatingLoginModule</strong></p><div class="example-contents"><pre class="programlisting">&lt;application-policy name="saml-validate-token"&gt;
    &lt;authentication&gt;
        &lt;login-module
            code="org.picketlink.identity.federation.core.wstrust.auth.STSValidatingLoginModule" flag="required"&gt;
            &lt;module-option name="configFile"&gt;./picketlink-sts-client.properties&lt;/module-option&gt;
            &lt;module-option name="endpointURI"&gt;http://security_saml/endpoint&lt;/module-option&gt;
        &lt;/login-module&gt;
    &lt;/authentication&gt;
    &lt;mapping&gt;
        &lt;mapping-module
            code="org.picketlink.identity.federation.bindings.jboss.auth.mapping.STSPrincipalMappingProvider"
            type="principal" /&gt;
        &lt;mapping-module
            code="org.picketlink.identity.federation.bindings.jboss.auth.mapping.STSGroupMappingProvider"
            type="role" /&gt;
    &lt;/mapping&gt;
&lt;/application-policy&gt;
</pre></div></div><div class="para">
		The configuration cited in the example enables Single Sign-On for your applications and services. A token once issued, either by directly contacting the STS or through a token-issuing login module, can be used to authenticate against multiple applications and services by employing the setup provided in the example. Providing a Principal mapping provider and a RoleGroup mapping provider result in an authenticated Subject being populated that enables coarse-grained and role-based authorization. After authentication, the Security Token is available and can be used to invoke other services by Single Sign-On.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24271-549126+%5BSpecified%5D&amp;comment=Title%3A+Configure+STSValidatingLoginModule%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24271-549126+28+Oct+2013+09%3A35+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div class="section" id="sect-SAML_Web_Browser_Based_SSO"><div class="titlepage"><div><div><h2 class="title">5.6. SAML Web Browser Based SSO</h2></div></div></div><div xml:lang="en-US" class="section" id="SAML_Web_Browser_Based_SSO" lang="en-US"><div class="titlepage"><div><div><h3 class="title">5.6.1. About SAML Web Browser Based SSO</h3></div></div></div><div class="para">
		PicketLink in JBoss EAP provides a platform to implement federated identity based services. This includes centralized identity services and Single Sign-On (SSO) for applications.
	</div><div class="para">
		The SAML profile has support for both the HTTP/POST and the HTTP/Redirect bindings with centralized identity services to enable web SSO for your applications. The architecture for the SAML v2 based Web SSO follows the hub and spoke architecture of identity management. In this architecture an identity provider (IDP) acts as the central source (hub) for identity and role information to all the applications (Service Providers). The spokes are the service providers (SP).
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24105-558044+%5BSpecified%5D&amp;comment=Title%3A+About+SAML+Web+Browser+Based+SSO%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24105-558044+22+Nov+2013+10%3A22+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Setup_SAML_v2_based_Web_SSO_using_HTTPRedirect_Binding" lang="en-US"><div class="titlepage"><div><div><h3 class="title">5.6.2. Setup SAML v2 based Web SSO using HTTP/Redirect Binding</h3></div></div></div><div class="para">
		To setup SAML v2 based SSO using HTTP/Redirect Binding you have to configure the following:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				Identity Provider: The Identity Provider is the authoritative entity responsible for authenticating an end user and asserting the identity for that user in a trusted fashion to trusted partners.
			</div></li><li class="listitem"><div class="para">
				Service Provider: The Service Provider relies on the Identity Provider to assert information about a user via an electronic user credential, leaving the service provider to manage access control and dissemination based on a trusted set of user credential assertions.
			</div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24273-548426+%5BSpecified%5D&amp;comment=Title%3A+Setup+SAML+v2+based+Web+SSO+using+HTTP%2FRedirect+Binding%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24273-548426+23+Oct+2013+09%3A10+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_Identity_Provider" lang="en-US"><div class="titlepage"><div><div><h3 class="title">5.6.3. Configure Identity Provider</h3></div></div></div><div class="para">
		The Identity Provider (IDP) is a JBoss EAP server instance.
	</div><div class="procedure"><p class="title"><strong>Procedure 5.1. Configure Identity Provider (IDP)</strong></p><ol class="1"><li class="step"><p class="title"><strong>Configure the web application security for the IDP</strong></p><div class="para">
				Configure a web application as the Identity provider.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					The use of FORM based web application security is recommended as it gives you the ability to customize the login page.
				</div></div></div><div class="para">
				The following is an example of the <code class="filename">web.xml</code> configuration
			</div><div class="example" id="idm140707316209088"><p class="title"><strong>Example 5.6. web.xml Configuration for IDP</strong></p><div class="example-contents"><pre class="programlisting">&lt;display-name&gt;IDP&lt;/display-name&gt;
&lt;description&gt;IDP&lt;/description&gt;
&lt;!-- Define a security constraint that gives unlimited access to images --&gt;
&lt;security-constraint&gt;
  &lt;web-resource-collection&gt;
  &lt;web-resource-name&gt;Images&lt;/web-resource-name&gt;
  &lt;url-pattern&gt;/images/*&lt;/url-pattern&gt;
&lt;/web-resource-collection&gt;
&lt;/security-constraint&gt;
&lt;!-- Define a Security Constraint on this Application --&gt;
&lt;security-constraint&gt;
  &lt;web-resource-collection&gt;
  &lt;web-resource-name&gt;IDP&lt;/web-resource-name&gt;
  &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/web-resource-collection&gt;
  &lt;auth-constraint&gt;
  &lt;role-name&gt;manager&lt;/role-name&gt;
&lt;/auth-constraint&gt;
&lt;/security-constraint&gt;
&lt;!-- Define the Login Configuration for this Application --&gt;
&lt;login-config&gt;
  &lt;auth-method&gt;FORM&lt;/auth-method&gt;
  &lt;realm-name&gt;IDP Application&lt;/realm-name&gt;
  &lt;form-login-config&gt;
    &lt;form-login-page&gt;/jsp/login.jsp&lt;/form-login-page&gt;
    &lt;form-error-page&gt;/jsp/loginerror.jsp&lt;/form-error-page&gt;
  &lt;/form-login-config&gt;
&lt;/login-config&gt;
&lt;!-- Security roles referenced by this web application --&gt;
&lt;security-role&gt;
 &lt;description&gt;
  The role that is required to log in to the IDP Application
 &lt;/description&gt;
 &lt;role-name&gt;manager&lt;/role-name&gt;
&lt;/security-role&gt;
&lt;/web-app&gt;
</pre></div></div></li><li class="step"><p class="title"><strong>Configure the IDP Valves</strong></p><div class="para">
				Create a <code class="filename">context.xml</code> file in the WEB-INF directory of your IDP web application to configure the valves for the IDP. The following is an example of <code class="filename">context.xml</code> file.
			</div><div class="example" id="idm140707326441264"><p class="title"><strong>Example 5.7. context.xml File Configuration for IDP Valves</strong></p><div class="example-contents"><pre class="programlisting">&lt;context&gt;
  &lt;Valve className="org.picketlink.identity.federation.bindings.tomcat.idp.IDPWebBrowserSSOValve"/&gt;
&lt;/context&gt;
</pre></div></div></li><li class="step"><p class="title"><strong>Configure the PicketLink Configuration File (picketlink.xml)</strong></p><div class="para">
				Configure <code class="filename">picketlink.xml</code> in the WEB-INF directory of your IDP web application. In this configuration file you provide the URL that gets added as the issuer in the outgoing SAML2 assertions to the service providers and the IDP. The following is an example of <code class="filename">picketlink.xml</code> configuration.
			</div><div class="example" id="idm140707319029088"><p class="title"><strong>Example 5.8. picketlink-idfed.xml Configuration</strong></p><div class="example-contents"><pre class="programlisting">&lt;PicketLink xmlns="urn:picketlink:identity-federation:config:2.1"&gt;
        &lt;PicketLinkIDP xmlns="urn:picketlink:identity-federation:config:2.1"&gt;
                &lt;IdentityURL&gt;http://localhost:8080/idp/&lt;/IdentityURL&gt;
        &lt;/PicketLinkIDP&gt;
        &lt;Handlers xmlns="urn:picketlink:identity-federation:handler:config:2.1"&gt;
                &lt;Handler
                        class="org.picketlink.identity.federation.web.handlers.saml2.SAML2IssuerTrustHandler" /&gt;
                &lt;Handler
                        class="org.picketlink.identity.federation.web.handlers.saml2.SAML2LogOutHandler" /&gt;
                &lt;Handler
                        class="org.picketlink.identity.federation.web.handlers.saml2.SAML2AuthenticationHandler" /&gt;
                &lt;Handler
                        class="org.picketlink.identity.federation.web.handlers.saml2.RolesGenerationHandler" /&gt;
        &lt;/Handlers&gt;
&lt;/PicketLink&gt;
</pre></div></div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24284-558063+%5BSpecified%5D&amp;comment=Title%3A+Configure+Identity+Provider%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24284-558063+22+Nov+2013+11%3A07+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_Service_Provider" lang="en-US"><div class="titlepage"><div><div><h3 class="title">5.6.4. Configure Service Provider</h3></div></div></div><div class="para">
		The Service Provider (SP) can be a JBoss EAP server instance.
	</div><div class="procedure"><p class="title"><strong>Procedure 5.2. Configure Service Provider (SP)</strong></p><ol class="1"><li class="step"><p class="title"><strong>Configure the Web Application Security For the SP</strong></p><div class="para">
				The web application to be configured as a SP should have FORM based security enabled in its web.xml file.
			</div><div class="example" id="idm140707321518240"><p class="title"><strong>Example 5.9. web.xml Configuration for SP</strong></p><div class="example-contents"><pre class="programlisting">&lt;display-name&gt;IDP&lt;/display-name&gt;
&lt;description&gt;IDP&lt;/description&gt;
&lt;!-- Define a security constraint that gives unlimited access to images --&gt;
&lt;security-constraint&gt;
  &lt;web-resource-collection&gt;
    &lt;web-resource-name&gt;Images&lt;/web-resource-name&gt;
    &lt;url-pattern&gt;/images/*&lt;/url-pattern&gt;
  &lt;/web-resource-collection&gt;
&lt;/security-constraint&gt;
&lt;!-- Define a Security Constraint on this Application --&gt;
&lt;security-constraint&gt;
  &lt;web-resource-collection&gt;
    &lt;web-resource-name&gt;IDP&lt;/web-resource-name&gt;
    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
  &lt;/web-resource-collection&gt;
  &lt;auth-constraint&gt;
    &lt;role-name&gt;manager&lt;/role-name&gt;
  &lt;/auth-constraint&gt;
&lt;/security-constraint&gt;
&lt;!-- Define the Login Configuration for this Application --&gt;
&lt;login-config&gt;
  &lt;auth-method&gt;FORM&lt;/auth-method&gt;
  &lt;realm-name&gt;IDP Application&lt;/realm-name&gt;
  &lt;form-login-config&gt;
    &lt;form-login-page&gt;/jsp/login.jsp&lt;/form-login-page&gt;
    &lt;form-error-page&gt;/jsp/loginerror.jsp&lt;/form-error-page&gt;
  &lt;/form-login-config&gt;
&lt;/login-config&gt;
&lt;!-- Security roles referenced by this web application --&gt;
&lt;security-role&gt;
    &lt;description&gt;
   The role that is required to log in to the IDP Application
  &lt;/description&gt;
  &lt;role-name&gt;manager&lt;/role-name&gt;
&lt;/security-role&gt;
&lt;/web-app&gt;
</pre></div></div></li><li class="step"><p class="title"><strong>Configure the SP Valve</strong></p><div class="para">
				To configure the valve for the SP, create a <code class="filename">context.xml</code> in the WEB-INF directory of your SP web application.
			</div><div class="example" id="idm140707324680592"><p class="title"><strong>Example 5.10. context.xml File Configuration for IDP Valves</strong></p><div class="example-contents"><pre class="programlisting">&lt;Context&gt;
  &lt;Valve className="org.jboss.identity.federation.bindings.tomcat.sp.SPRedirectSignatureFormAuthenticator" /&gt;
&lt;/Context&gt;
</pre></div></div></li><li class="step"><p class="title"><strong>Configure the PicketLink Federation configuration file (picketlink-idfed.xml)</strong></p><div class="para">
				Configure <code class="filename">picketlink-idfed.xml</code> in WEB-INF of your IDP web application. In this configuration file you provide the URL that gets added as the issuer in the outgoing SAML2 assertions to the Service Providers and the IDP. The following is an example of <code class="filename">picketlink-idfed.xml</code> configuration.
			</div><div class="example" id="idm140707317769488"><p class="title"><strong>Example 5.11. picketlink-idfed.xml Configuration</strong></p><div class="example-contents"><pre class="programlisting">&lt;PicketLinkIDP xmlns="urn:picketlink:identity-federation:config:1.0" &gt;
&lt;IdentityURL&gt;http://localhost:8080/idp/&lt;/IdentityURL&gt;
&lt;/PicketLinkIDP
</pre></div></div></li><li class="step"><p class="title"><strong>Configure the PicketLink Federation Handlers file (<code class="filename">picketlink-handlers.xml</code>)</strong></p><div class="para">
				Configure <code class="filename">picketlink-handlers.xml</code> in WEB-INF of your SP web application.
			</div><div class="example" id="idm140707327916784"><p class="title"><strong>Example 5.12. Configure picketlink-handlers.xml</strong></p><div class="example-contents"><pre class="programlisting">&lt;Handlers xmlns="urn:picketlink:identity-federation:handler:config:1.0"&gt;
&lt;Handler class="org.picketlink.identity.federation.web.handlers.saml2.SAML2LogOutHandler"/&gt;
&lt;Handler
class="org.picketlink.identity.federation.web.handlers.saml2.SAML2AuthenticationHandler"/&gt;
&lt;/Handlers&gt;
</pre></div></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					Retain the order in which the handlers are listed.
				</div></div></div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24286-561316+%5BSpecified%5D&amp;comment=Title%3A+Configure+Service+Provider%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24286-561316+28+Nov+2013+10%3A27+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Setup_SAML_v2_based_Web_SSO_using_HTTPPOST_Binding" lang="en-US"><div class="titlepage"><div><div><h3 class="title">5.6.5. Setup SAML v2 based Web SSO using HTTP/POST Binding</h3></div></div></div><div class="para">
		HTTP/POST binding is the recommended binding for obtaining the web browser based SSO.
	</div><div class="procedure"><p class="title"><strong>Procedure 5.3. Setup SAML v2 based Web SSO using HTTP/POST Binding</strong></p><ol class="1"><li class="step"><p class="title"><strong>Configure the Identity Provider (IDP).</strong></p><div class="para">
				The steps to configure IDP for HTTP/POST Binding are same as that of the HTTP/Redirect Binding. For more information on configuring the IDP, see <a class="xref" href="#Setup_SAML_v2_based_Web_SSO_using_HTTPRedirect_Binding">Section 5.6.2, “Setup SAML v2 based Web SSO using HTTP/Redirect Binding”</a>
			</div></li><li class="step"><p class="title"><strong>Configure the Service Provider (SP)</strong></p><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					The steps to configure SP for HTTP/POST Binding are the same as that of the HTTP/Redirect Binding, except for a variation in the <code class="filename">context.xml</code> file.
				</div></div></div><div class="para">
				The following is an example of the <code class="filename">context.xml</code> file for IDP valves.
			</div><div class="example" id="idm140707340002032"><p class="title"><strong>Example 5.13. context.xml File Configuration for IDP Valves</strong></p><div class="example-contents"><pre class="programlisting">&lt;Context&gt;
  &lt;Valve className="org.picketlink.identity.federation.bindings.tomcat.sp.SPPostFormAuthenticator"
/&gt;
&lt;/Context&gt;
</pre></div></div><div class="para">
				For more information on configuring the SP, see <a class="xref" href="#Configure_Service_Provider">Section 5.6.4, “Configure Service Provider”</a>
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24287-555790+%5BSpecified%5D&amp;comment=Title%3A+Setup+SAML+v2+based+Web+SSO+using+HTTP%2FPOST+Binding%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24287-555790+14+Nov+2013+13%3A54+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div xml:lang="en-US" class="section" id="SAML_Global_Logout_Profile" lang="en-US"><div class="titlepage"><div><div><h2 class="title">5.7. Configure SAML Global Logout Profile</h2></div></div></div><div class="para">
		A Global Logout initiated at one service provider logs out the user from the Identity Provider (IDP) and all the service providers.
	</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			For a Global Logout to function appropriately ensure that you have only up to five Service Providers per Identity Provider.
		</div></div></div><div class="procedure"><p class="title"><strong>Procedure 5.4. Configure Global Logout</strong></p><ol class="1"><li class="step"><p class="title"><strong>Configure picketlink-handlers.xml</strong></p><div class="para">
				Add the <code class="code">SAML2LogOutHandler</code> in the picketlink-handlers.xml.
			</div></li><li class="step"><p class="title"><strong>Configure Service Provider web page</strong></p><div class="para">
				Append <code class="code">GLO=true</code> to the link at the end of your web page of the service provider.
			</div><div class="example" id="idm140707319806192"><p class="title"><strong>Example 5.14. Link to Global Logout</strong></p><div class="example-contents"><div class="para">
					
<pre class="programlisting">&lt;a href="?GLO=true"&gt;Click to Globally LogOut&lt;/a&gt;
</pre>

				</div></div></div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24106-548150+%5BSpecified%5D&amp;comment=Title%3A+Configure+SAML+Global+Logout+Profile%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24106-548150+22+Oct+2013+05%3A47+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div class="section" id="sect-Kerberos_and_SPNEGO_Integration"><div class="titlepage"><div><div><h2 class="title">5.8. Kerberos and SPNEGO Integration</h2></div></div></div><div xml:lang="en-US" class="section" id="About_Kerberos_Integration" lang="en-US"><div class="titlepage"><div><div><h3 class="title">5.8.1. About Kerberos and SPNEGO Integration</h3></div></div></div><div class="para">
		Kerberos is an authentication method that is designed for open network computing environments. It works on the basis of a ticket and authenticator to establish the identity of both the user and the server. It helps the two nodes communicating over a non secure environment to establish their identity to each other in a secured manner.
	</div><div class="para">
		SPNEGO is an authentication method used by a client application to authenticate itself to the server. This technology is used when the client application and the server trying to communicate with each other are not sure of the authentication protocol the other supports. SPNEGO determines the common GSSAPI mechanisms between the client application and the server and then dispatches all further security operations to it.
	</div><div class="para"><div class="title">Kerberos and SPNEGO Integration</div><p>
			In a typical setup, the user logs into a desktop which is governed by the Active Directory domain. The user then uses the web browser, either Firebox or Internet Explorer, to access a web application that uses JBoss Negotiation hosted on the JBoss EAP. The web browser transfers the desktop sign on information to the web application. JBoss EAP uses background GSS messages with the Active Directory or any Kerberos Server to validate the user. This enables the user to achieve a seamless SSO into the web application.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24109-548398+%5BSpecified%5D&amp;comment=Title%3A+About+Kerberos+and+SPNEGO+Integration%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24109-548398+23+Oct+2013+02%3A04+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Desktop_SSO_using_SPNego" lang="en-US"><div class="titlepage"><div><div><h3 class="title">5.8.2. Desktop SSO using SPNEGO</h3></div></div></div><div class="para">
		To configure the desktop SSO using SPNEGO configure the following:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				Security Domain
			</div></li><li class="listitem"><div class="para">
				System Properties
			</div></li><li class="listitem"><div class="para">
				Web Application
			</div></li></ul></div><div class="procedure"><p class="title"><strong>Procedure 5.5. Configure Desktop SSO using SPNEGO</strong></p><ol class="1"><li class="step"><p class="title"><strong>Configure Security Domain</strong></p><div class="para">
				Configure the security domains to represent the identity of the server and to secure the web application.
			</div><div class="example" id="idm140707315766864"><p class="title"><strong>Example 5.15. Security Domain Configuration</strong></p><div class="example-contents"><pre class="programlisting">&lt;security-domains&gt;

    &lt;security-domain name="host" cache-type="default"&gt;

      &lt;authentication&gt;

        &lt;login-module code="Kerberos" flag="required"&gt;

          &lt;module-option name="storeKey" value="true"/&gt;

          &lt;module-option name="useKeyTab" value="true"/&gt;

          &lt;module-option name="principal" value="host/testserver@MY_REALM"/&gt;

          &lt;module-option name="keyTab" value="/home/username/service.keytab"/&gt;

          &lt;module-option name="doNotPrompt" value="true"/&gt;

          &lt;module-option name="debug" value="false"/&gt;

        &lt;/login-module&gt;

       &lt;/authentication&gt;

     &lt;/security-domain&gt;

   

     &lt;security-domain name="SPNEGO" cache-type="default"&gt;

       &lt;authentication&gt;

         &lt;login-module code="SPNEGO"  flag="requisite"&gt;

           &lt;module-option name="password-stacking" value="useFirstPass"/&gt;

           &lt;module-option name="serverSecurityDomain" value="host"/&gt;

         &lt;/login-module&gt;


         &lt;!-- Login Module For Roles Search --&gt;

       &lt;/security-domain&gt;
</pre></div></div></li><li class="step"><p class="title"><strong>Setup the System Properties</strong></p><div class="para">
				If required, the system properties can be set in the domain model.
			</div><div class="example" id="idm140707311719216"><p class="title"><strong>Example 5.16. Configure System Properties</strong></p><div class="example-contents"><pre class="programlisting">&lt;system-properties&gt;

      &lt;property name="java.security.krb5.kdc" value="mykdc.mydomain"/&gt;

      &lt;property name="java.security.krb5.realm" value="MY_REALM"/&gt;

    &lt;/system-properties&gt;
</pre></div></div></li><li class="step"><p class="title"><strong>Configure Web Application</strong></p><div class="para">
				It is not possible to override the authenticators, but it is possible to add the <code class="filename">NegotiationAuthenticator</code> as a valve to your jboss-web.xml descriptor to configure the web application.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					The valve requires the <code class="code">security-constraint</code> and <code class="code">login-config</code> to be defined in the web.xml file as this is used to decide which resources are secured. However, the chosen <code class="code">auth-method</code> is overridden by this authenticator.
				</div></div></div><div class="example" id="idm140707316725040"><p class="title"><strong>Example 5.17. Configure Web Application</strong></p><div class="example-contents"><pre class="programlisting"> &lt;!DOCTYPE jboss-web PUBLIC
  "-//JBoss//DTD Web Application 2.4//EN"
  "http://www.jboss.org/j2ee/dtd/jboss-web_4_0.dtd"&gt;   

  &lt;jboss-web&gt;

    &lt;security-domain&gt;java:/jaas/SPNEGO&lt;/security-domain&gt;

    &lt;valve&gt;

      &lt;class-name&gt;org.jboss.security.negotiation.NegotiationAuthenticator&lt;/class-name&gt;

    &lt;/valve&gt;

  &lt;/jboss-web&gt;
</pre></div></div><div class="para">
				The web application also requires a dependency defining in <code class="filename">META-INF/MANIFEST.MF</code> so that the JBoss Negotiation classes can be located.
			</div><div class="example" id="idm140707326326448"><p class="title"><strong>Example 5.18. Define Dependency in <code class="filename">META-INF/MANIFEST.MF</code></strong></p><div class="example-contents"><pre class="programlisting">    Manifest-Version: 1.0

    Build-Jdk: 1.6.0_24

    Dependencies: org.jboss.security.negotiation
</pre></div></div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24110-548401+%5BSpecified%5D&amp;comment=Title%3A+Desktop+SSO+using+SPNEGO%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24110-548401+23+Oct+2013+04%3A03+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_JBoss_Negotiation_for_Microsoft_Windows_Domain" lang="en-US"><div class="titlepage"><div><div><h3 class="title">5.8.3. Configure JBoss Negotiation for Microsoft Windows Domain</h3></div></div></div><div class="para">
		This section describes how to configure the accounts required for JBoss Negotiation to be used when JBoss EAP is running on a Microsoft Windows server, which is a part of the Active Directory domain.
	</div><div class="para">
		In this section, the hostname that is used to access the server as is referred to as <code class="code">{hostname}</code>, realm is referred to as <code class="code">{realm}</code>, domain is referred to as <code class="code">{domain}</code>, and the server hosting the JBoss EAP instance is referred to as <code class="code">{machine_name}</code>.
	</div><div class="procedure"><p class="title"><strong>Procedure 5.6. Configure JBoss Negotiation for Microsoft Windows Domain</strong></p><ol class="1"><li class="step"><p class="title"><strong>Clear Existing Service Principal Mappings</strong></p><div class="para">
				On a Microsoft Windows network some mappings are created automatically. Delete the automatically created mappings to map the identity of the server to the service principal for negotiation to take place correctly. The mapping enables the web browser on the client computer to trust the server and attempt SPNEGO. The client computer verifies with the domain controller for a mapping in the form of <code class="code">HTTP{hostname}</code>.
			</div><div class="para">
				The following are the steps to delete the existing mappings:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						List the mapping registered with the domain for the computer using the command, <code class="code">setspn -L {machine_name}</code>.
					</div></li><li class="listitem"><div class="para">
						Delete the existing mappings using the commands, <code class="code">setspn -D HTTP/{hostname} {machine_name}</code> and <code class="code">setspn -D host/{hostname} {machine_name}</code>.
					</div></li></ul></div></li><li class="step"><div class="para">
				Create a host user account.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					Ensure the host user name is different from the <code class="code">{machine_name}</code>.
				</div></div></div><div class="para">
				In the rest of the section the host user name is referred to as <code class="code">{user_name}</code>.
			</div></li><li class="step"><p class="title"><strong>Define the mapping between the <code class="code">{user_name}</code> and <code class="code">{hostname}</code>.</strong></p><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						Run the following command to configure the Service Principal Mapping, <code class="code">ktpass -princ HTTP/{hostname}@{realm} -pass * -mapuser {domain}\{user_name}</code>.
					</div></li><li class="listitem"><div class="para">
						Enter the password for the user name when prompted. 
						<div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
								Reset the password for the user name as it is a prerequisite for exporting the keytab.
							</div></div></div>

					</div></li><li class="listitem"><div class="para">
						Verify the mapping by running the following command, <code class="code">setspn -L {user_name}</code>
					</div></li></ul></div></li><li class="step"><p class="title"><strong>Export the keytab of the user to the server on which EAP JBoss is installed.</strong></p><div class="para">
				Run the following command to export the keytab, <code class="code">ktab -k service.keytab -a HTTP/{hostname}@{realm}</code>.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					This command exports the ticket for the HTTP/{hostname} principal to the keytab <code class="code">service.keytab</code>, which is used to configure the host security domain on JBoss.
				</div></div></div></li><li class="step"><div class="para">
				Define the principal within the security domain as follows:
			</div><div class="para">
				
<pre class="programlisting">&lt;module-option name="principal"&gt;HTTP/{hostname}@{realm}&lt;/module-option&gt;
</pre>

			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24328-555789+%5BSpecified%5D&amp;comment=Title%3A+Configure+JBoss+Negotiation+for+Microsoft+Windows+Domain%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24328-555789+14+Nov+2013+13%3A47+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div class="section" id="sect-Authentication"><div class="titlepage"><div><div><h2 class="title">5.9. Authentication</h2></div></div></div><div xml:lang="en-US" class="section" id="About_Authentication1" lang="en-US"><div class="titlepage"><div><div><h3 class="title">5.9.1. About Authentication</h3></div></div></div><div class="para">
		Authentication refers to identifying a subject and verifying the authenticity of the identification. The most common authentication mechanism is a username and password combination. Other common authentication mechanisms use shared keys, smart cards, or fingerprints. The outcome of a successful authentication is referred to as a principal, in terms of Java Enterprise Edition declarative security.
	</div><div class="para">
		JBoss EAP 6 uses a pluggable system of authentication modules to provide flexibility and integration with the authentication systems you already use in your organization. Each security domain contains one or more configured authentication modules. Each module includes additional configuration parameters to customize its behavior. The easiest way to configure the authentication subsystem is within the web-based management console.
	</div><div class="para">
		Authentication is not the same as authorization, although they are often linked. Many of the included authentication modules can also handle authorization.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4723-458757+%5BSpecified%5D&amp;comment=Title%3A+About+Authentication%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4723-458757+11+Jun+2013+14%3A27+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_Authentication_in_a_Security_Domain" lang="en-US"><div class="titlepage"><div><div><h3 class="title">5.9.2. Configure Authentication in a Security Domain</h3></div></div></div><div class="para">
		To configure authentication settings for a security domain, log into the management console and follow this procedure.
	</div><div class="procedure"><p class="title"><strong>Procedure 5.7. Setup Authentication Settings for a Security Domain</strong></p><ol class="1"><li class="step"><p class="title"><strong>Open the security domain's detailed view.</strong></p><div class="para">
				Click the <span class="guilabel"><strong>Profiles</strong></span> label at the top right of the management console. In a managed domain, select the profile to modify from the <span class="guilabel"><strong>Profile</strong></span> selection box at the top left of the Profile view. Click the <span class="guilabel"><strong>Security</strong></span> menu item at the left, and click <span class="guilabel"><strong>Security Domains</strong></span> from the expanded menu. Click the <span class="guilabel"><strong>View</strong></span> link for the security domain you want to edit.
			</div></li><li class="step"><p class="title"><strong>Navigate to the Authentication subsystem configuration.</strong></p><div class="para">
				Click the <span class="guilabel"><strong>Authentication</strong></span> label at the top of the view if it is not already selected.
			</div><div class="para">
				The configuration area is divided into two areas: <span class="guilabel"><strong>Login Modules</strong></span> and <span class="guilabel"><strong>Details</strong></span>. The login module is the basic unit of configuration. A security domain can include several login modules, each of which can include several attributes and options.
			</div></li><li class="step"><p class="title"><strong>Add an authentication module.</strong></p><div class="para">
				Click the <span class="guilabel"><strong>Add</strong></span> button to add a JAAS authentication module. Fill in the details for your module. The <span class="guilabel"><strong>Code</strong></span> is the class name of the module. The <span class="guilabel"><strong>Flags</strong></span> controls how the module relates to other authentication modules within the same security domain.
			</div><div class="para"><div class="title">Explanation of the Flags</div><p>
					The Java Enterprise Edition 6 specification provides the following explanation of the flags for security modules. The following list is taken from <a href="http://docs.oracle.com/javase/6/docs/technotes/guides/security/jaas/JAASRefGuide.html#AppendixA" class="mimir-link-warn" title="Mimir does not include content from: docs.oracle.com">http://docs.oracle.com/javase/6/docs/technotes/guides/security/jaas/JAASRefGuide.html#AppendixA</a>. Refer to that document for more detailed information.
				</p></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707319995264" scope="col"> Flag </th><th id="idm140707322406016" scope="col"> Details </th></tr></thead><tbody><tr><td headers="idm140707319995264"> required </td><td headers="idm140707322406016"> <div class="para">
								The LoginModule is required to succeed. If it succeeds or fails, authentication still continues to proceed down the LoginModule list.
							</div>
							 </td></tr><tr><td headers="idm140707319995264"> requisite </td><td headers="idm140707322406016"> <div class="para">
								LoginModule is required to succeed. If it succeeds, authentication continues down the LoginModule list. If it fails, control immediately returns to the application (authentication does not proceed down the LoginModule list).
							</div>
							 </td></tr><tr><td headers="idm140707319995264"> sufficient </td><td headers="idm140707322406016"> <div class="para">
								The LoginModule is not required to succeed. If it does succeed, control immediately returns to the application (authentication does not proceed down the LoginModule list). If it fails, authentication continues down the LoginModule list.
							</div>
							 </td></tr><tr><td headers="idm140707319995264"> optional </td><td headers="idm140707322406016"> <div class="para">
								The LoginModule is not required to succeed. If it succeeds or fails, authentication still continues to proceed down the LoginModule list.
							</div>
							 </td></tr></tbody></table></div><div class="para">
				After you have added your module, you can modify its <span class="guilabel"><strong>Code</strong></span> or <span class="guilabel"><strong>Flags</strong></span> by clicking the <span class="guibutton"><strong>Edit</strong></span> button in the <span class="guilabel"><strong>Details</strong></span> section of the screen. Be sure the <span class="guilabel"><strong>Attributes</strong></span> tab is selected.
			</div></li><li class="step"><p class="title"><strong>Optional: Add or remove module options.</strong></p><div class="para">
				If you need to add options to your module, click its entry in the <span class="guilabel"><strong>Login Modules</strong></span> list, and select the <span class="guilabel"><strong>Module Options</strong></span> tab in the <span class="guilabel"><strong>Details</strong></span> section of the page. Click the <span class="guibutton"><strong>Add</strong></span> button, and provide the key and value for the option. Use the <span class="guibutton"><strong>Remove</strong></span> button to remove an option.
			</div></li></ol></div><div class="para"><div class="title">Result</div><p>
			Your authentication module is added to the security domain, and is immediately available to applications which use the security domain.
		</p></div><div class="para"><div class="title">The <code class="code">jboss.security.security_domain</code> Module Option</div><p>
			By default, each login module defined in a security domain has the <code class="code">jboss.security.security_domain</code> module option added to it automatically. This option causes problems with login modules which check to make sure that only known options are defined. The IBM Kerberos login module, <code class="code">com.ibm.security.auth.module.Krb5LoginModule</code> is one of these.
		</p></div><div class="para">
		You can disable the behavior of adding this module option by setting the system property to <code class="code">true</code> when starting JBoss EAP 6. Add the following to your start-up parameters.
	</div><pre class="screen">-Djboss.security.disable.secdomain.option=true</pre><div class="para">
		You can also set this property using the web-based Management Console. In a standalone server, you can set system properties in the <span class="guilabel"><strong>Profile</strong></span> section of the configuration. In a managed domain, you can set system properties for each server group.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4724-490496+%5BSpecified%5D&amp;comment=Title%3A+Configure+Authentication+in+a+Security+Domain%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4724-490496+02+Aug+2013+15%3A52+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div class="section" id="sect-Java_Authentication_SPI_for_Containers_JASPI"><div class="titlepage"><div><div><h2 class="title">5.10. Java Authentication SPI for Containers (JASPI)</h2></div></div></div><div xml:lang="en-US" class="section" id="About_Java_Authentication_SPI_for_Containers_JASPI_Security1" lang="en-US"><div class="titlepage"><div><div><h3 class="title">5.10.1. About Java Authentication SPI for Containers (JASPI) Security</h3></div></div></div><div class="para">
		Java Application SPI for Containers (JASPI or JASPIC) is a pluggable interface for Java applications. It is defined in JSR-196 of the Java Community Process. Refer to <a href="http://www.jcp.org/en/jsr/detail?id=196" class="mimir-link-warn" title="Mimir does not include content from: www.jcp.org">http://www.jcp.org/en/jsr/detail?id=196</a> for details about the specification.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+7199-328604+%5BSpecified%5D&amp;comment=Title%3A+About+Java+Authentication+SPI+for+Containers+%28JASPI%29+Security%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7199-328604+05+Nov+2012+14%3A55+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_Java_Authentication_SPI_for_Containers_JASPI_Security1" lang="en-US"><div class="titlepage"><div><div><h3 class="title">5.10.2. Configure Java Authentication SPI for Containers (JASPI) Security</h3></div></div></div><div class="para">
		To authenticate against a JASPI provider, add a <code class="sgmltag-element">&lt;authentication-jaspi&gt;</code> element to your security domain. The configuration is similar to a standard authentication module, but login module elements are enclosed in a <code class="sgmltag-element">&lt;login-module-stack&gt;</code> element. The structure of the configuration is:
	</div><div class="example" id="idm140707322079328"><p class="title"><strong>Example 5.19. Structure of the <code class="literal">authentication-jaspi</code> element</strong></p><div class="example-contents"><pre class="programlisting language-java JAVA JAVA">
&lt;authentication-jaspi&gt;
	&lt;login-module-stack name="..."&gt;
	  &lt;login-module code="..." flag="..."&gt;
	    &lt;module-option name="..." value="..."/&gt;
	  &lt;/login-module&gt;
	&lt;/login-module-stack&gt;
	&lt;auth-module code="..." login-module-stack-ref="..."&gt;
	  &lt;module-option name="..." value="..."/&gt;
	&lt;/auth-module&gt;
&lt;/authentication-jaspi&gt;

</pre></div></div><div class="para">
		The login module itself is configured in exactly the same way as a standard authentication module.
	</div><div class="para">
		Because the web-based management console does not expose the configuration of JASPI authentication modules, you need to stop JBoss EAP 6 completely before adding the configuration directly to <code class="filename"><em class="replaceable">EAP_HOME</em>/domain/configuration/domain.xml</code> or <code class="filename"><em class="replaceable">EAP_HOME</em>/standalone/configuration/standalone.xml</code>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4934-458763+%5BSpecified%5D&amp;comment=Title%3A+Configure+Java+Authentication+SPI+for+Containers+%28JASPI%29+Security%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4934-458763+11+Jun+2013+14%3A34+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div class="section" id="sect-Authorization"><div class="titlepage"><div><div><h2 class="title">5.11. Authorization</h2></div></div></div><div xml:lang="en-US" class="section" id="About_Authorization1" lang="en-US"><div class="titlepage"><div><div><h3 class="title">5.11.1. About Authorization</h3></div></div></div><div class="para">
		Authorization is a mechanism for granting or denying access to a resource based on identity. It is implemented as a set of declarative security roles which can be granted to principals.
	</div><div class="para">
		JBoss EAP 6 uses a modular system to configure authorization. Each security domain can contain one or more authorization policies. Each policy has a basic module which defines its behavior. It is configured through specific flags and attributes. The easiest way to configure the authorization subsystem is by using the web-based management console.
	</div><div class="para">
		Authorization is different from authentication, and usually happens after authentication. Many of the authentication modules also handle authorization.
	</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			XACML is not permitted in the Common Criteria Certified configuration.
		</div></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4725-642063+%5BSpecified%5D&amp;comment=Title%3A+About+Authorization%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4725-642063+21+May+2014+10%3A02+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_Authorization_in_a_Security_Domain1" lang="en-US"><div class="titlepage"><div><div><h3 class="title">5.11.2. Configure Authorization in a Security Domain</h3></div></div></div><div class="para">
		To configure authorization settings for a security domain, log into the management console and follow this procedure.
	</div><div class="procedure"><p class="title"><strong>Procedure 5.8. Setup Authorization in a Security Domain</strong></p><ol class="1"><li class="step"><p class="title"><strong>Open the security domain's detailed view.</strong></p><div class="para">
				Click the <span class="guilabel"><strong>Profiles</strong></span> label at the top right of the management console. In a managed domain, select the profile to modify from the <span class="guilabel"><strong>Profile</strong></span> selection box at the top left of the Profile view. Click the <span class="guilabel"><strong>Security</strong></span> menu item at the left, and click <span class="guilabel"><strong>Security Domains</strong></span> from the expanded menu. Click the <span class="guilabel"><strong>View</strong></span> link for the security domain you want to edit.
			</div></li><li class="step"><p class="title"><strong>Navigate to the Authorization subsystem configuration.</strong></p><div class="para">
				Click the <span class="guilabel"><strong>Authorization</strong></span> label at the top of the view if it is not already selected.
			</div><div class="para">
				The configuration area is divided into two areas: <span class="guilabel"><strong>Policies</strong></span> and <span class="guilabel"><strong>Details</strong></span>. The login module is the basic unit of configuration. A security domain can include several authorization policies, each of which can include several attributes and options.
			</div></li><li class="step"><p class="title"><strong>Add a policy.</strong></p><div class="para">
				Click the <span class="guilabel"><strong>Add</strong></span> button to add a JAAS authorization policy module. Fill in the details for your module. The <span class="guilabel"><strong>Code</strong></span> is the class name of the module. The <span class="guilabel"><strong>Flags</strong></span> controls how the module relates to other authorization policy modules within the same security domain.
			</div><div class="para"><div class="title">Explanation of the Flags</div><p>
					The Java Enterprise Edition 6 specification provides the following explanation of the flags for security modules. The following list is taken from <a href="http://docs.oracle.com/javase/6/docs/technotes/guides/security/jaas/JAASRefGuide.html#AppendixA" class="mimir-link-warn" title="Mimir does not include content from: docs.oracle.com">http://docs.oracle.com/javase/6/docs/technotes/guides/security/jaas/JAASRefGuide.html#AppendixA</a>. Refer to that document for more detailed information.
				</p></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707325270656" scope="col"> Flag </th><th id="idm140707320639728" scope="col"> Details </th></tr></thead><tbody><tr><td headers="idm140707325270656"> required </td><td headers="idm140707320639728"> <div class="para">
								The LoginModule is required to succeed. If it succeeds or fails, authorization still continues to proceed down the LoginModule list.
							</div>
							 </td></tr><tr><td headers="idm140707325270656"> requisite </td><td headers="idm140707320639728"> <div class="para">
								LoginModule is required to succeed. If it succeeds, authorization continues down the LoginModule list. If it fails, control immediately returns to the application (authorization does not proceed down the LoginModule list).
							</div>
							 </td></tr><tr><td headers="idm140707325270656"> sufficient </td><td headers="idm140707320639728"> <div class="para">
								The LoginModule is not required to succeed. If it does succeed, control immediately returns to the application (authorization does not proceed down the LoginModule list). If it fails, authorization continues down the LoginModule list.
							</div>
							 </td></tr><tr><td headers="idm140707325270656"> optional </td><td headers="idm140707320639728"> <div class="para">
								The LoginModule is not required to succeed. If it succeeds or fails, authorization still continues to proceed down the LoginModule list.
							</div>
							 </td></tr></tbody></table></div><div class="para">
				After you have added your module, you can modify its <span class="guilabel"><strong>Code</strong></span> or <span class="guilabel"><strong>Flags</strong></span> by clicking the <span class="guibutton"><strong>Edit</strong></span> button in the <span class="guilabel"><strong>Details</strong></span> section of the screen. Be sure the <span class="guilabel"><strong>Attributes</strong></span> tab is selected.
			</div></li><li class="step"><p class="title"><strong>Optional: Add, edit, or remove module options.</strong></p><div class="para">
				If you need to add options to your module, click its entry in the <span class="guilabel"><strong>Login Modules</strong></span> list, and select the <span class="guilabel"><strong>Module Options</strong></span> tab in the <span class="guilabel"><strong>Details</strong></span> section of the page. Click the <span class="guibutton"><strong>Add</strong></span> button, and provide the key and value for the option. To edit an option that already exists, click the key or to change it. Use the <span class="guibutton"><strong>Remove</strong></span> button to remove an option.
			</div></li></ol></div><div class="para"><div class="title">Result</div><p>
			Your authorization policy module is added to the security domain, and is immediately available to applications which use the security domain.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4726-504599+%5BSpecified%5D&amp;comment=Title%3A+Configure+Authorization+in+a+Security+Domain%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4726-504599+30+Aug+2013+12%3A56+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div class="section" id="sect-Java_Authorization_Contract_for_Containers_JACC"><div class="titlepage"><div><div><h2 class="title">5.12. Java Authorization Contract for Containers (JACC)</h2></div></div></div><div xml:lang="en-US" class="section" id="About_Java_Authorization_Contract_for_Containers_JACC" lang="en-US"><div class="titlepage"><div><div><h3 class="title">5.12.1. About Java Authorization Contract for Containers (JACC)</h3></div></div></div><div class="para">
		Java Authorization Contract for Containers (JACC) is a standard which defines a contract between containers and authorization service providers, which results in the implementation of providers for use by containers. It was defined in JSR-115, which can be found on the Java Community Process website at <a href="http://jcp.org/en/jsr/detail?id=115" class="mimir-link-warn" title="Mimir does not include content from: jcp.org">http://jcp.org/en/jsr/detail?id=115</a>. It has been part of the core Java Enterprise Edition (Java EE) specification since Java EE version 1.3.
	</div><div class="para">
		JBoss EAP 6 implements support for JACC within the security functionality of the security subsystem.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+7687-458762+%5BSpecified%5D&amp;comment=Title%3A+About+Java+Authorization+Contract+for+Containers+%28JACC%29%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7687-458762+11+Jun+2013+14%3A32+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_Java_Authorization_Contract_for_Containers_JACC_Security" lang="en-US"><div class="titlepage"><div><div><h3 class="title">5.12.2. Configure Java Authorization Contract for Containers (JACC) Security</h3></div></div></div><div class="para">
		To configure Java Authorization Contract for Containers (JACC), you need to configure your security domain with the correct module, and then modify your <code class="filename">jboss-web.xml</code> to include the correct parameters.
	</div><div class="para"><div class="title">Add JACC Support to the Security Domain</div><p>
			To add JACC support to the security domain, add the <code class="literal">JACC</code> authorization policy to the authorization stack of the security domain, with the <code class="literal">required</code> flag set. The following is an example of a security domain with JACC support. However, the security domain is configured in the Management Console or Management CLI, rather than directly in the XML.
		</p></div><pre class="programlisting language-xml XML XML">
&lt;security-domain name="jacc" cache-type="default"&gt;
    &lt;authentication&gt;
        &lt;login-module code="UsersRoles" flag="required"&gt;
        &lt;/login-module&gt;
    &lt;/authentication&gt;
    &lt;authorization&gt;
        &lt;policy-module code="JACC" flag="required"/&gt;
    &lt;/authorization&gt;
&lt;/security-domain&gt;
</pre><div class="para"><div class="title">Configure a Web Application to use JACC</div><p>
			The <code class="filename">jboss-web.xml</code> is located in the <code class="filename">META-INF/</code> or <code class="filename">WEB-INF/</code> directory of your deployment, and contains overrides and additional JBoss-specific configuration for the web container. To use your JACC-enabled security domain, you need to include the <code class="sgmltag-element">&lt;security-domain&gt;</code> element, and also set the <code class="sgmltag-element">&lt;use-jboss-authorization&gt;</code> element to <code class="literal">true</code>. The following application is properly configured to use the JACC security domain above.
		</p></div><pre class="programlisting language-xml XML XML">
&lt;jboss-web&gt;
    &lt;security-domain&gt;jacc&lt;/security-domain&gt;
    &lt;use-jboss-authorization&gt;true&lt;/use-jboss-authorization&gt;
&lt;/jboss-web&gt;
</pre><div class="para"><div class="title">Configure an EJB Application to Use JACC</div><p>
			Configuring EJBs to use a security domain and to use JACC differs from Web Applications. For an EJB, you can declare <em class="firstterm">method permissions</em> on a method or group of methods, in the <code class="filename">ejb-jar.xml</code> descriptor. Within the <code class="sgmltag-element">&lt;ejb-jar&gt;</code> element, any child <code class="sgmltag-element">&lt;method-permission&gt;</code> elements contain information about JACC roles. Refer to the example configuration for more details. The <code class="code">EJBMethodPermission</code> class is part of the Java Enterprise Edition 6 API, and is documented at <a href="http://docs.oracle.com/javaee/6/api/javax/security/jacc/EJBMethodPermission.html" class="mimir-link-warn" title="Mimir does not include content from: docs.oracle.com">http://docs.oracle.com/javaee/6/api/javax/security/jacc/EJBMethodPermission.html</a>.
		</p></div><div class="example" id="idm140707318006016"><p class="title"><strong>Example 5.20. Example JACC Method Permissions in an EJB</strong></p><div class="example-contents"><pre class="programlisting language-xml XML XML">
&lt;ejb-jar&gt;
  &lt;method-permission&gt;
    &lt;description&gt;The employee and temp-employee roles may access any method of the EmployeeService bean &lt;/description&gt;
    &lt;role-name&gt;employee&lt;/role-name&gt;
    &lt;role-name&gt;temp-employee&lt;/role-name&gt;
    &lt;method&gt;
      &lt;ejb-name&gt;EmployeeService&lt;/ejb-name&gt;
      &lt;method-name&gt;*&lt;/method-name&gt;
    &lt;/method&gt;
  &lt;/method-permission&gt;
&lt;/ejb-jar&gt;

</pre></div></div><div class="para">
		You can also constrain the authentication and authorization mechanisms for an EJB by using a security domain, just as you can do for a web application. Security domains are declared in the <code class="filename">jboss-ejb3.xml</code> descriptor, in the <code class="sgmltag-element">&lt;security&gt;</code> child element. In addition to the security domain, you can also specify the <em class="firstterm">run-as principal</em>, which changes the principal the EJB runs as.
	</div><div class="example" id="idm140707312586496"><p class="title"><strong>Example 5.21. Example Security Domain Declaration in an EJB</strong></p><div class="example-contents"><pre class="programlisting language-xml XML XML">

&lt;security&gt;
  &lt;ejb-name&gt;*&lt;/ejb-name&gt;
  &lt;security-domain&gt;myDomain&lt;/security-domain&gt;
  &lt;run-as-principal&gt;myPrincipal&lt;/run-as-principal&gt;
&lt;/security&gt;

</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4933-455587+%5BSpecified%5D&amp;comment=Title%3A+Configure+Java+Authorization+Contract+for+Containers+%28JACC%29+Security%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4933-455587+29+May+2013+13%3A39+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div class="section" id="sect-Security_Auditing"><div class="titlepage"><div><div><h2 class="title">5.13. Security Auditing</h2></div></div></div><div xml:lang="en-US" class="section" id="About_Security_Auditing1" lang="en-US"><div class="titlepage"><div><div><h3 class="title">5.13.1. About Security Auditing</h3></div></div></div><div class="para">
		Security auditing refers to triggering events, such as writing to a log, in response to an event that happens within the security subsystem. Auditing mechanisms are configured as part of a security domain, along with authentication, authorization, and security mapping details.
	</div><div class="para">
		Auditing uses <em class="firstterm">provider modules</em>. You can use one of the included ones, or implement your own.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4727-328515+%5BSpecified%5D&amp;comment=Title%3A+About+Security+Auditing%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4727-328515+05+Nov+2012+14%3A31+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_Security_Auditing1" lang="en-US"><div class="titlepage"><div><div><h3 class="title">5.13.2. Configure Security Auditing</h3></div></div></div><div class="para">
		To configure security auditing settings for a security domain, log into the management console and follow this procedure.
	</div><div class="procedure"><p class="title"><strong>Procedure 5.9. Setup Security Auditing for a Security Domain</strong></p><ol class="1"><li class="step"><p class="title"><strong>Open the security domain's detailed view.</strong></p><div class="para">
				Click the <span class="guilabel"><strong>Profiles</strong></span> label at the top right of the management console. In a standalone server, the tab is labeled <span class="guilabel"><strong>Profile</strong></span>. In a managed domain, select the profile to modify from the <span class="guilabel"><strong>Profile</strong></span> selection box at the top left of the Profile view. Click the <span class="guilabel"><strong>Security</strong></span> menu item at the left, and click <span class="guilabel"><strong>Security Domains</strong></span> from the expanded menu. Click the <span class="guilabel"><strong>View</strong></span> link for the security domain you want to edit.
			</div></li><li class="step"><p class="title"><strong>Navigate to the Auditing subsystem configuration.</strong></p><div class="para">
				Click the <span class="guilabel"><strong>Audit</strong></span> label at the top of the view if it is not already selected.
			</div><div class="para">
				The configuration area is divided into two areas: <span class="guilabel"><strong>Provider Modules</strong></span> and <span class="guilabel"><strong>Details</strong></span>. The provider module is the basic unit of configuration. A security domain can include several provider modules each of which can include attributes and options.
			</div></li><li class="step"><p class="title"><strong>Add a provider module.</strong></p><div class="para">
				Click the <span class="guilabel"><strong>Add</strong></span> button to add a provider module. Fill in the <span class="guilabel"><strong>Code</strong></span> section with the classname of the provider module.
			</div><div class="para">
				After you have added your module, you can modify its <span class="guilabel"><strong>Code</strong></span> by clicking the <span class="guibutton"><strong>Edit</strong></span> button in the <span class="guilabel"><strong>Details</strong></span> section of the screen. Be sure the <span class="guilabel"><strong>Attributes</strong></span> tab is selected.
			</div></li><li class="step"><p class="title"><strong>Verify if your module is working</strong></p><div class="para">
				The goal of an audit module is to provide a way to monitor the events in the security subsystem. This monitoring can be done by means of writing to a log file, email notifications or any other measurable auditing mechanism.
			</div><div class="para">
				For example, JBoss EAP 6 includes the <code class="filename">LogAuditProvider</code> module by default. If enabled following the steps above, this audit module writes security notifications to a <code class="filename">audit.log</code> file in the <code class="filename">log</code> subfolder within the <code class="filename"><em class="replaceable">EAP_HOME</em></code> directory.
			</div><div class="para">
				To verify if the steps above have worked in the context of the <code class="filename">LogAuditProvider</code>, perform an action that is likely to trigger a notification and then check the audit log file.
			</div><div class="para">
				For a full list of included security auditing provider modules, see here: <a class="xref" href="#Included_Security_Auditing_Provider_Modules">Section A.4, “Included Security Auditing Provider Modules”</a>
			</div></li><li class="step"><p class="title"><strong>Optional: Add, edit, or remove module options.</strong></p><div class="para">
				If you need to add options to your module, click its entry in the <span class="guilabel"><strong>Modules</strong></span> list, and select the <span class="guilabel"><strong>Module Options</strong></span> tab in the <span class="guilabel"><strong>Details</strong></span> section of the page. Click the <span class="guibutton"><strong>Add</strong></span> button, and provide the key and value for the option. To edit an option that already exists, remove it by clicking the <span class="guibutton"><strong>Remove</strong></span> label, and add it again with the correct options by clicking the <span class="guibutton"><strong>Add</strong></span> button.
			</div></li></ol></div><div class="para"><div class="title">Result</div><p>
			Your security auditing module is added to the security domain, and is immediately available to applications which use the security domain.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4728-460687+%5BSpecified%5D&amp;comment=Title%3A+Configure+Security+Auditing%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4728-460687+17+Jun+2013+14%3A27+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="New_Security_Properties" lang="en-US"><div class="titlepage"><div><div><h3 class="title">5.13.3. New Security Properties</h3></div></div></div><div class="para">
		New system properties have been added to the security audit functionality for JBoss EAP versions 6.2.2 and later. These new properties mitigate security concerns surrounding plain text logging of web request components, particularly in scenarios involving BASIC or FORM based authentication.
	</div><div class="para">
		The new properties allow greater control over which components of a web request are captured in audit logs (parameters, cookies, headers or attributes). These components can also be masked using the new properties.
	</div><div class="para">
		The new properties are:
	</div><div class="table" id="idm140707323023440"><p class="title"><strong>Table 5.1. New Security Properties</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows" summary="New Security Properties"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707313249968" scope="col"> Name </th><th id="idm140707321854368" scope="col"> Description </th><th id="idm140707323110640" scope="col"> Possible values </th><th id="idm140707312464208" scope="col"> Behavior </th><th id="idm140707312463728" scope="col"> Default </th></tr></thead><tbody><tr><td headers="idm140707313249968"> <code class="literal">org.jboss.security.web.audit</code> </td><td headers="idm140707321854368"> This property controls the granularity of the security auditing of web requests. </td><td headers="idm140707323110640"> <code class="literal">off</code>, <code class="literal">headers</code>, <code class="literal">cookies</code>, <code class="literal">parameters</code>, <code class="literal">attributes</code> </td><td headers="idm140707312464208"> Any component (or comma-separated group of components) specified will be audited out of web requests. </td><td headers="idm140707312463728"> <code class="literal">headers,parameters</code> </td></tr><tr><td headers="idm140707313249968"> <code class="literal">org.jboss.security.web.audit.mask</code> </td><td headers="idm140707321854368"> This property can be used to specify a list of strings to be matched against headers, parameters, cookies, and attributes of web requests. Any element matching the specified masks will be excluded from security audit logging. </td><td headers="idm140707323110640"> Any comma separated string indicating keys of headers, parameters, cookies, and attributes. </td><td headers="idm140707312464208"> Currently, the matching of the masks is fuzzy rather than strict. For example, a mask of <code class="literal">authorization</code> will mask both the header called <span class="emphasis"><em>authorization</em></span> and the parameter called <span class="emphasis"><em>custom_authorization</em></span>. A future release may introduce strict masks. </td><td headers="idm140707312463728"> j_password,authorization </td></tr></tbody></table></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+29465-608813+%5BSpecified%5D&amp;comment=Title%3A+New+Security+Properties%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=29465-608813+05+Mar+2014+11%3A57+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div class="section" id="sect-Security_Mapping"><div class="titlepage"><div><div><h2 class="title">5.14. Security Mapping</h2></div></div></div><div xml:lang="en-US" class="section" id="About_Security_Mapping1" lang="en-US"><div class="titlepage"><div><div><h3 class="title">5.14.1. About Security Mapping</h3></div></div></div><div class="para">
		Security mapping allows you to combine authentication and authorization information after the authentication or authorization happens, but before the information is passed to your application. One example of this is using an X509 certificate for authentication, and then converting the principal from the certificate to a logical name which your application can display.
	</div><div class="para">
		You can map principals (authentication), roles (authorization), or credentials (attributes which are not principals or roles).
	</div><div class="para">
		Role Mapping is used to add, replace, or remove roles to the subject after authentication.
	</div><div class="para">
		Principal mapping is used to modify a principal after authentication.
	</div><div class="para">
		Attribute mapping is used to convert attributes from an external system to be used by your application, and vice versa.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4729-328516+%5BSpecified%5D&amp;comment=Title%3A+About+Security+Mapping%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4729-328516+05+Nov+2012+14%3A31+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_Security_Mapping_in_a_Security_Domain" lang="en-US"><div class="titlepage"><div><div><h3 class="title">5.14.2. Configure Security Mapping in a Security Domain</h3></div></div></div><div class="para">
		To configure security mapping settings for a security domain, log into the management console and follow this procedure.
	</div><div class="procedure"><p class="title"><strong>Procedure 5.10. Setup Security Mapping Settings in a Security Domain</strong></p><ol class="1"><li class="step"><p class="title"><strong>Open the security domain's detailed view.</strong></p><div class="para">
				Click the <span class="guilabel"><strong>Profiles</strong></span> label at the top right of the management console. This tab is labeled <span class="guilabel"><strong>Profile</strong></span> in a standalone server. In a managed domain, select the profile to modify from the <span class="guilabel"><strong>Profile</strong></span> selection box at the top left of the Profile view. Click the <span class="guilabel"><strong>Security</strong></span> menu item at the left, and click <span class="guilabel"><strong>Security Domains</strong></span> from the expanded menu. Click the <span class="guilabel"><strong>View</strong></span> link for the security domain you want to edit.
			</div></li><li class="step"><p class="title"><strong>Navigate to the Mapping subsystem configuration.</strong></p><div class="para">
				Click the <span class="guilabel"><strong>Mapping</strong></span> label at the top of the view if it is not already selected.
			</div><div class="para">
				The configuration area is divided into two areas: <span class="guilabel"><strong>Modules</strong></span> and <span class="guilabel"><strong>Details</strong></span>. The mapping module is the basic unit of configuration. A security domain can include several mapping modules, each of which can include several attributes and options.
			</div></li><li class="step"><p class="title"><strong>Add a module.</strong></p><div class="para">
				Click the <span class="guilabel"><strong>Add</strong></span> button to add a security mapping module. Fill in the details for your module. The <span class="guilabel"><strong>Code</strong></span> is the class name of the module. The <span class="guilabel"><strong>Type</strong></span> field refers to the type of mapping this module performs. Allowed values are principal, role, attribute or credential.
			</div><div class="para">
				After you have added your module, you can modify its <span class="guilabel"><strong>Code</strong></span> or <span class="guilabel"><strong>Type</strong></span> by clicking the <span class="guibutton"><strong>Edit</strong></span> button in the <span class="guilabel"><strong>Details</strong></span> section of the screen. Be sure the <span class="guilabel"><strong>Attributes</strong></span> tab is selected.
			</div></li><li class="step"><p class="title"><strong>Optional: Add, edit, or remove module options.</strong></p><div class="para">
				If you need to add options to your module, click its entry in the <span class="guilabel"><strong>Modules</strong></span> list, and select the <span class="guilabel"><strong>Module Options</strong></span> tab in the <span class="guilabel"><strong>Details</strong></span> section of the page. Click the <span class="guibutton"><strong>Add</strong></span> button, and provide the key and value for the option. To edit an option that already exists, click the <span class="guilabel"><strong>Remove</strong></span> label key to remove it, and add it again with the new value. Use the <span class="guibutton"><strong>Remove</strong></span> button to remove an option.
			</div></li></ol></div><div class="para"><div class="title">Result</div><p>
			Your security mapping module is added to the security domain, and is immediately available to applications which use the security domain.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4730-432982+%5BSpecified%5D&amp;comment=Title%3A+Configure+Security+Mapping+in+a+Security+Domain%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4730-432982+11+Apr+2013+10%3A49+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div></div><div xml:lang="en-US" class="chapter" id="chap-Java_Security_Manager" lang="en-US"><div class="titlepage"><div><div><h2 class="title">Chapter 6. Java Security Manager</h2></div></div></div><div xml:lang="en-US" class="section" id="About_the_Java_Security_Manager" lang="en-US"><div class="titlepage"><div><div><h2 class="title">6.1. About the Java Security Manager</h2></div></div></div><div class="para">
		<span class="application"><strong>Java Security Manager</strong></span>
	</div><div class="blockquote"><blockquote class="blockquote"><div class="para">
			The Java Security Manager is a class that manages the external boundary of the Java Virtual Machine (JVM) sandbox, controlling how code executing within the JVM can interact with resources outside the JVM. When the Java Security Manager is activated, the Java API checks with the security manager for approval before executing a wide range of potentially unsafe operations.
		</div></blockquote></div><div class="para">
		The Java Security Manager uses a security policy to determine whether a given action will be permitted or denied.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4778-435837+%5BSpecified%5D&amp;comment=Title%3A+About+the+Java+Security+Manager%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4778-435837+19+Apr+2013+03%3A31+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="About_Java_Security_Manager_Policies" lang="en-US"><div class="titlepage"><div><div><h2 class="title">6.2. About Java Security Manager Policies</h2></div></div></div><div class="para">
		<span class="application"><strong>Security Policy</strong></span>
	</div><div class="blockquote"><blockquote class="blockquote"><div class="para">
			A set of defined permissions for different classes of code. The Java Security Manager compares actions requested by applications against the security policy. If an action is allowed by the policy, the Security Manager will permit that action to take place. If the action is not allowed by the policy, the Security Manager will deny that action. The security policy can define permissions based on the location of code, on the code's signature, or based on the subject's principals.
		</div></blockquote></div><div class="para">
		The Java Security Manager and the security policy used are configured using the Java Virtual Machine options <code class="command">java.security.manager</code> and <code class="command">java.security.policy</code>.
	</div><div class="para"><div class="title">Basic Information</div><p>
			A security policy's entry consists of the following configuration elements, which are connected to the <code class="code">policytool</code>:
		</p></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">CodeBase</span></dt><dd><div class="para">
					The URL location (excluding the host and domain information) where the code originates from. This parameter is optional.
				</div></dd><dt><span class="term">SignedBy</span></dt><dd><div class="para">
					The alias used in the keystore to reference the signer whose private key was used to sign the code. This can be a single value or a comma-separated list of values. This parameter is optional. If omitted, presence or lack of a signature has no impact on the Java Security Manager.
				</div></dd><dt><span class="term">Principals</span></dt><dd><div class="para">
					A list of <em class="parameter"><code>principal_type</code></em>/<em class="parameter"><code>principal_name</code></em> pairs, which must be present within the executing thread's principal set. The Principals entry is optional. If it is omitted, it signifies that the principals of the executing thread will have no impact on the Java Security Manager.
				</div></dd><dt><span class="term">Permissions</span></dt><dd><div class="para">
					A permission is the access which is granted to the code. Many permissions are provided as part of the Java Enterprise Edition 6 (Java EE 6) specification. This document only covers additional permissions which are provided by JBoss EAP 6.
				</div></dd></dl></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4781-632642+%5BSpecified%5D&amp;comment=Title%3A+About+Java+Security+Manager+Policies%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4781-632642+22+Apr+2014+14%3A25+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Write_a_Java_Security_Manager_Policy1" lang="en-US"><div class="titlepage"><div><div><h2 class="title">6.3. Write a Java Security Manager Policy</h2></div></div></div><div class="para"><div class="title">Introduction</div><p>
			An application called <code class="command">policytool</code> is included with most JDK and JRE distributions, for the purpose of creating and editing Java Security Manager security policies. Detailed information about <code class="command">policytool</code> is linked from <a href="http://docs.oracle.com/javase/6/docs/technotes/tools/" class="mimir-link-warn" title="Mimir does not include content from: docs.oracle.com">http://docs.oracle.com/javase/6/docs/technotes/tools/</a>.
		</p></div><div class="procedure"><p class="title"><strong>Procedure 6.1. Setup a new Java Security Manager Policy</strong></p><ol class="1"><li class="step"><p class="title"><strong>Start <code class="command">policytool</code>.</strong></p><div class="para">
				Start the <code class="command">policytool</code> tool in one of the following ways.
			</div><ul class="stepalternatives">
				<li class="step"><p class="title"><strong>Red Hat Enterprise Linux</strong></p><div class="para">
						From your GUI or a command prompt, run <code class="command">/usr/bin/policytool</code>.
					</div></li>
				 <li class="step"><p class="title"><strong>Microsoft Windows Server</strong></p><div class="para">
						Run <code class="command">policytool.exe</code> from your Start menu or from the <code class="filename">bin\</code> of your Java installation. The location can vary.
					</div></li>

			</ul></li><li class="step"><p class="title"><strong>Create a policy.</strong></p><div class="para">
				To create a policy, select <span class="guibutton"><strong>Add Policy Entry</strong></span>. Add the parameters you need, then click <span class="guibutton"><strong>Done</strong></span>.
			</div></li><li class="step"><p class="title"><strong>Edit an existing policy</strong></p><div class="para">
				Select the policy from the list of existing policies, and select the <span class="guibutton"><strong>Edit Policy Entry</strong></span> button. Edit the parameters as needed.
			</div></li><li class="step"><p class="title"><strong>Delete an existing policy.</strong></p><div class="para">
				Select the policy from the list of existing policies, and select the <span class="guibutton"><strong>Remove Policy Entry</strong></span> button.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4782-623810+%5BSpecified%5D&amp;comment=Title%3A+Write+a+Java+Security+Manager+Policy%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4782-623810+25+Mar+2014+13%3A39+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="IBM_JRE_and_the_Java_Security_Manager" lang="en-US"><div class="titlepage"><div><div><h2 class="title">6.4. IBM JRE and the Java Security Manager</h2></div></div></div><div class="para">
		IBM JRE uses a default policy provider which does not work correctly with the JBoss Enterprise Application Platform security policy. You must change the JRE configuration to use the standard policy provider, if you want to use the IBM JRE to host JBoss Enterprise Application Platform with the Java Security Manager enabled.
	</div><div class="para">
		To configure the JRE configuration for the IBM JRE, edit the <code class="filename">JAVA_HOME/jre/lib/security/java.security</code> file, and set the <code class="code">policy.provider</code> value to <code class="code">sun.security.provider.PolicyFile</code>.
	</div><pre class="screen">policy.provider=sun.security.provider.PolicyFile</pre><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+30502-632583+%5BSpecified%5D&amp;comment=Title%3A+IBM+JRE+and+the+Java+Security+Manager%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=30502-632583+22+Apr+2014+11%3A17+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Java_Security_Policy_Statements" lang="en-US"><div class="titlepage"><div><div><h2 class="title">6.5. Java Security Policy Statements</h2></div></div></div><div class="para">
		A policy file specifies permissions to modules and deployed applications. Permissions are applied to deployed applications via the <code class="literal">VFS</code> protocol. See the following Oracle Java SE documentation page <em class="citetitle">Default Policy Implementation and Policy File Syntax</em> for further information at <a href="http://docs.oracle.com/javase/7/docs/technotes/guides/security/PolicyFiles.html" class="mimir-link-warn" title="Mimir does not include content from: docs.oracle.com">http://docs.oracle.com/javase/7/docs/technotes/guides/security/PolicyFiles.html</a>
	</div><div class="para">
		The following is an example of policy statements.
	</div><pre class="screen">
// Grant all to the jboss-modules.jar
grant codeBase "file:${jboss.home.dir}/jboss-modules.jar" {
  permission java.security.AllPermission;
};

// Standard extensions get all permissions by default
grant codeBase "file:${{java.ext.dirs}}/*" {
	permission java.security.AllPermission;
};

// Grant read PropertyPermission for all properties to a deployed EJB application
grant codeBase "vfs:/content/ejb-app.jar" {
  permission java.util.PropertyPermission "*", "read";
};

// Grant read FilePermission for all files to a web application
grant codeBase "vfs:/content/myapp.war/-" {
  permission java.io.FilePermission "/-", "read";
};
</pre><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			On Microsoft Windows Server, when specifying a <code class="literal">FilePermission</code> statement including a file path in a string, not a codeBase URL, you must replace single backslash characters with two backslash characters. This is because when file paths are parsed, a single backslash is interpreted as an escape character.
		</div></div></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			Two VFS issues currently exist in JBoss EAP that require a workaround: 
			<div class="itemizedlist"><ul><li class="listitem"><div class="para">
						If you define a grant for a deployment on Microsoft Windows, instead of:
					</div><pre class="screen">grant codeBase "vfs:/content/..." {</pre><div class="para">
						you must use:
					</div><pre class="screen">grant codeBase "vfs:/${user.dir}/content/..." {</pre></li><li class="listitem"><div class="para">
						If your application contains JSPs, then the permissions granted to the deployment using a VFS URL is not sufficient, and you will have to duplicate it with file-based URL. For example, if you have permission:
					</div><pre class="screen">grant codeBase "vfs:/content/application.war/-" {
  permission java.util.PropertyPermission "*", "read";
};</pre><div class="para">
						then you also need to add the following:
					</div><pre class="screen">grant codeBase "file:${jboss.home.dir}/standalone/tmp/work/jboss.web/default-host/application/-" {
  permission java.util.PropertyPermission "*", "read";
};</pre></li></ul></div>

		</div></div></div><div class="para">
		Module permissions are defined in <code class="filename">module.xml</code> (version 1.2 or higher). The following example demonstrates specifying module permissions.
	</div><pre class="programlisting language-xml">&lt;module xmlns="urn:jboss:module:1.2" name="org.jboss.custom.module"&gt;
 &lt;permissions&gt;
  &lt;grant permission="java.io.FilePermission" name="/-" actions="read"/&gt;
  &lt;grant permission="java.lang.RuntimePermission" name="org.jboss.*"/&gt;
 &lt;/permissions&gt;

 &lt;resources&gt;
  &lt;resource-root path="custom-module.jar" /&gt;
 &lt;/resources&gt;
&lt;/module&gt;
</pre><div class="para">
		If there is no <code class="literal">&lt;permissions/&gt;</code> element, then <code class="literal">AllPermission</code> permission is granted to the module. If there is an empty <code class="literal">&lt;permissions/&gt;</code> element, then no permission is granted.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+30196-641256+%5BSpecified%5D&amp;comment=Title%3A+Java+Security+Policy+Statements%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=30196-641256+16+May+2014+06%3A42+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Run_JBoss_Enterprise_Application_Platform_Within_the_Java_Security_Manager" lang="en-US"><div class="titlepage"><div><div><h2 class="title">6.6. Run JBoss EAP 6 Within the Java Security Manager</h2></div></div></div><div class="para">
		To specify a Java Security Manager policy, you need to edit the Java options passed to the domain or server instance during the bootstrap process. For this reason, you cannot pass the parameters as options to the <code class="filename">domain.sh</code> or <code class="filename">standalone.sh</code> scripts. The following procedure guides you through the steps of configuring your instance to run within a Java Security Manager policy.
	</div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul><li class="listitem"><div class="para">
				Before you following this procedure, you need to write a security policy, using the <code class="command">policytool</code> command which is included with your Java Development Kit (JDK). This procedure assumes that your policy is located at <code class="filename"><em class="replaceable">EAP_HOME</em>/bin/server.policy</code>. As an alternative, write the security policy using any text editor and manually save it as <code class="filename"><em class="replaceable">EAP_HOME</em>/bin/server.policy</code>
			</div></li><li class="listitem"><div class="para">
				The domain or standalone server must be completely stopped before you edit any configuration files.
			</div></li></ul></div><div class="para">
		Perform the following procedure for each physical host or instance in your domain, if you have domain members spread across multiple systems.
	</div><div class="procedure"><p class="title"><strong>Procedure 6.2. Configure the Security Manager for JBoss EAP 6</strong></p><ol class="1"><li class="step"><p class="title"><strong>Open the configuration file.</strong></p><div class="para">
				Open the configuration file for editing. This file is located in one of two places, depending on whether you use a managed domain or standalone server. This is not the executable file used to start the server or domain.
			</div><ul class="stepalternatives">
				<li class="step"><p class="title"><strong>Managed Domain</strong></p><div class="itemizedlist"><ul><li class="listitem"><div class="para">
								For Linux: <code class="filename"><em class="replaceable">EAP_HOME</em>/bin/domain.conf</code>
							</div></li><li class="listitem"><div class="para">
								For Windows: <code class="filename"><em class="replaceable">EAP_HOME</em>\bin\domain.conf.bat</code>
							</div></li></ul></div></li>
				 <li class="step"><p class="title"><strong>Standalone Server</strong></p><div class="itemizedlist"><ul><li class="listitem"><div class="para">
								For Linux: <code class="filename"><em class="replaceable">EAP_HOME</em>/bin/standalone.conf</code>
							</div></li><li class="listitem"><div class="para">
								For Windows: <code class="filename"><em class="replaceable">EAP_HOME</em>\bin\standalone.conf.bat</code>
							</div></li></ul></div></li>

			</ul></li><li class="step"><p class="title"><strong>Add the Java options to the file.</strong></p><div class="para">
				To ensure the Java options are used, add them to the code block that begins with:
			</div><pre class="programlisting">if [ "x$JAVA_OPTS" = "x" ]; then
</pre><div class="para">
				You can modify the <code class="literal">-Djava.security.policy</code> value to specify the exact location of your security policy. It should go onto one line only, with no line break. Using <code class="code">==</code> when setting the <code class="literal">-Djava.security.policy</code> property specifies that the security manager will use <span class="emphasis"><em>only</em></span> the specified policy file. Using <code class="code">=</code> specifies that the security manager will use the specified policy <span class="emphasis"><em>combined with</em></span> the policy set in the <code class="literal">policy.url</code> section of <code class="filename"><em class="replaceable">JAVA_HOME</em>/lib/security/java.security</code>.
			</div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
					JBoss Enterprise Application Platform releases from 6.2.2 onwards require that the system property <code class="code">jboss.modules.policy-permissions</code> is set to <span class="emphasis"><em>true</em></span>.
				</div></div></div><div class="example" id="idm140707330688736"><p class="title"><strong>Example 6.1. domain.conf</strong></p><div class="example-contents"><pre class="screen">JAVA_OPTS="$JAVA_OPTS -Djava.security.manager -Djava.security.policy==$PWD/server.policy -Djboss.home.dir=/path/to/EAP_HOME -Djboss.modules.policy-permissions=true"</pre></div></div><div class="example" id="idm140707320492224"><p class="title"><strong>Example 6.2. domain.conf.bat</strong></p><div class="example-contents"><pre class="screen">set "JAVA_OPTS=%JAVA_OPTS% -Djava.security.manager -Djava.security.policy==\path\to\server.policy -Djboss.home.dir=\path\to\EAP_HOME -Djboss.modules.policy-permissions=true"</pre></div></div><div class="example" id="idm140707316645392"><p class="title"><strong>Example 6.3. standalone.conf</strong></p><div class="example-contents"><pre class="screen">JAVA_OPTS="$JAVA_OPTS -Djava.security.manager -Djava.security.policy==$PWD/server.policy -Djboss.home.dir=$JBOSS_HOME -Djboss.modules.policy-permissions=true"</pre></div></div><div class="example" id="idm140707312964128"><p class="title"><strong>Example 6.4. standalone.conf.bat</strong></p><div class="example-contents"><pre class="screen">set "JAVA_OPTS=%JAVA_OPTS% -Djava.security.manager -Djava.security.policy==\path\to\server.policy -Djboss.home.dir=%JBOSS_HOME% -Djboss.modules.policy-permissions=true"</pre></div></div></li><li class="step"><p class="title"><strong>Start the domain or server.</strong></p><div class="para">
				Start the domain or server as normal.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4779-633185+%5BSpecified%5D&amp;comment=Title%3A+Run+JBoss+EAP+6+Within+the+Java+Security+Manager%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4779-633185+23+Apr+2014+16%3A16+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Debug_Security_Manager_Policies" lang="en-US"><div class="titlepage"><div><div><h2 class="title">6.7. Debug Security Manager Policies</h2></div></div></div><div class="para">
		You can enable debugging information to help you troubleshoot security policy-related issues. The <code class="command">java.security.debug</code> option configures the level of security-related information reported. The command <code class="command">java -Djava.security.debug=help</code> will produce help output with the full range of debugging options. Setting the debug level to <code class="command">all</code> is useful when troubleshooting a security-related failure whose cause is completely unknown, but for general use it will produce too much information. A sensible general default is <code class="command">access:failure</code>.
	</div><div class="procedure"><p class="title"><strong>Procedure 6.3. Enable general debugging</strong></p><ul><li class="step"><p class="title"><strong>This procedure will enable a sensible general level of security-related debug information.</strong></p><div class="para">
				Add the following line to the server configuration file. 
				<div class="itemizedlist"><ul><li class="listitem"><div class="para">
							If the JBoss EAP 6 instance is running in a managed domain, the line is added to the <code class="filename">bin/domain.conf</code> file for Linux or the <code class="filename">bin/domain.conf.bat</code> file for Windows.
						</div></li><li class="listitem"><div class="para">
							If the JBoss EAP 6 instance is running as a standalone server, the line is added to the <code class="filename">bin/standalone.conf</code> file for Linux, or the <code class="filename">bin\standalone.conf.bat</code> file for Windows.
						</div></li></ul></div>

			</div></li></ul></div><div class="para">
		<code class="command"> Linux</code>
	</div><div class="para">
		
<pre class="programlisting">
JAVA_OPTS="$JAVA_OPTS -Djava.security.debug=access:failure"
</pre>

	</div><div class="para">
		<code class="command"> Windows</code>
	</div><div class="para">
		
<pre class="programlisting">
JAVA_OPTS="%JAVA_OPTS% -Djava.security.debug=access:failure"
</pre>

	</div><div class="para"><div class="title">Result</div><p>
			A general level of security-related debug information has been enabled.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4780-458784+%5BSpecified%5D&amp;comment=Title%3A+Debug+Security+Manager+Policies%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4780-458784+11+Jun+2013+14%3A59+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div xml:lang="en-US" class="chapter" id="chap-Security_Realms" lang="en-US"><div class="titlepage"><div><div><h2 class="title">Chapter 7. Security Realms</h2></div></div></div><div xml:lang="en-US" class="section" id="About_Security_Realms" lang="en-US"><div class="titlepage"><div><div><h2 class="title">7.1. About Security Realms</h2></div></div></div><div class="para">
		A <em class="firstterm">security realm</em> is a series of mappings between users and passwords, and users and roles. Security realms are a mechanism for adding authentication and authorization to your EJB and Web applications. JBoss EAP 6 provides two security realms by default:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				<code class="literal">ManagementRealm</code> stores authentication information for the Management API, which provides the functionality for the Management CLI and web-based Management Console. It provides an authentication system for managing JBoss EAP 6 itself. You could also use the <code class="literal">ManagementRealm</code> if your application needed to authenticate with the same business rules you use for the Management API.
			</div></li><li class="listitem"><div class="para">
				<code class="literal">ApplicationRealm</code> stores user, password, and role information for Web Applications and EJBs.
			</div></li></ul></div><div class="para">
		Each realm is stored in two files on the filesystem:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				<code class="filename"><em class="replaceable">REALM</em>-users.properties</code> stores usernames and hashed passwords.
			</div></li><li class="listitem"><div class="para">
				<code class="filename"><em class="replaceable">REALM</em>-users.properties</code> stores user-to-role mappings.
			</div></li></ul></div><div class="para">
		The properties files are stored in the <code class="filename">domain/configuration/</code> and <code class="filename">standalone/configuration/</code> directories. The files are written simultaneously by the <code class="filename">add-user.sh</code> or <code class="filename">add-user.bat</code> command. When you run the command, the first decision you make is which realm to add your new user to.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+8269-495465+%5BSpecified%5D&amp;comment=Title%3A+About+Security+Realms%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=8269-495465+16+Aug+2013+16%3A14+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Add_a_New_Security_Realm" lang="en-US"><div class="titlepage"><div><div><h2 class="title">7.2. Add a New Security Realm</h2></div></div></div><div class="procedure"><ol class="1"><li class="step"><p class="title"><strong>Run the Management CLI.</strong></p><div class="para">
				Start the <code class="filename">jboss-cli.sh</code> or <code class="filename">jboss-cli.bat</code> command and connect to the server.
			</div></li><li class="step"><p class="title"><strong>Create the new security realm itself.</strong></p><div class="para">
				Run the following command to create a new security realm named <code class="literal">MyDomainRealm</code> on a domain controller or a standalone server.
			</div><pre class="screen">/host=master/core-service=management/security-realm=MyDomainRealm:add()</pre></li><li class="step"><p class="title"><strong>Create the references to the properties file which will store information about the new role.</strong></p><div class="para">
				Run the following command to create a pointer a file named <code class="filename">myfile.properties</code>, which will contain the properties pertaining to the new role.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					The newly-created properties file is not managed by the included <code class="filename">add-user.sh</code> and <code class="filename">add-user.bat</code> scripts. It must be managed externally.
				</div></div></div><pre class="screen">/host=master/core-service=management/security-realm=MyDomainRealm/authentication=properties:add(path=myfile.properties)</pre></li></ol></div><div class="para"><div class="title">Result</div><p>
			Your new security realm is created. When you add users and roles to this new realm, the information will be stored in a separate file from the default security realms. You can manage this new file using your own applications or procedures.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+8272-455581+%5BSpecified%5D&amp;comment=Title%3A+Add+a+New+Security+Realm%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=8272-455581+29+May+2013+13%3A28+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Add_a_User_to_a_Security_Realm" lang="en-US"><div class="titlepage"><div><div><h2 class="title">7.3. Add a User to a Security Realm</h2></div></div></div><div class="procedure"><ol class="1"><li class="step"><p class="title"><strong>Run the <code class="filename">add-user.sh</code> or <code class="filename">add-user.bat</code> command.</strong></p><div class="para">
				Open a terminal and change directories to the <code class="filename"><em class="replaceable">EAP_HOME</em>/bin/</code> directory. If you run Red Hat Enterprise Linux or another UNIX-like operating system, run <code class="filename">add-user.sh</code>. If you run Microsoft Windows Server, run <code class="filename">add-user.bat</code>.
			</div></li><li class="step"><p class="title"><strong>Choose whether to add a Management User or Application User.</strong></p><div class="para">
				For this procedure, type <code class="literal">b</code> to add an Application User.
			</div></li><li class="step"><p class="title"><strong>Choose the realm the user will be added to.</strong></p><div class="para">
				By default, the only available realm is <code class="literal">ApplicationRealm</code>. If you have added a custom realm, you can type its name instead.
			</div></li><li class="step"><p class="title"><strong>Type the username, password, and roles, when prompted.</strong></p><div class="para">
				Type the desired username, password, and optional roles when prompted. Verify your choice by typing <code class="literal">yes</code>, or type <code class="literal">no</code> to cancel the changes. The changes are written to each of the properties files for the security realm.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+8271-450875+%5BSpecified%5D&amp;comment=Title%3A+Add+a+User+to+a+Security+Realm%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=8271-450875+21+May+2013+14%3A28+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div xml:lang="en-US" class="chapter" id="chap-Encryption" lang="en-US"><div class="titlepage"><div><div><h2 class="title">Chapter 8. Encryption</h2></div></div></div><div xml:lang="en-US" class="section" id="About_Encryption" lang="en-US"><div class="titlepage"><div><div><h2 class="title">8.1. About Encryption</h2></div></div></div><div class="para">
		<em class="firstterm">Encryption</em> refers to obfuscating sensitive information by applying mathematical algorithms to it. Encryption is one of the foundations of securing your infrastructure from data breaches, system outages, and other risks.
	</div><div class="para">
		Encryption can be applied to simple string data, such as passwords. It can also be applied to data communication streams. The HTTPS protocol, for instance, encrypts all data before transferring it from one party to another. If you connect from one server to another using the Secure Shell (SSH) protocol, all of your communication is sent in an encrypted <em class="wordasword"> tunnel </em>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4774-435776+%5BSpecified%5D&amp;comment=Title%3A+About+Encryption%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4774-435776+18+Apr+2013+15%3A10+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="About_SSL_Encryption" lang="en-US"><div class="titlepage"><div><div><h2 class="title">8.2. About SSL Encryption</h2></div></div></div><div class="para">
		Secure Sockets Layer (SSL) encrypts network traffic between two systems. Traffic between the two systems is encrypted using a two-way key, generated during the <em class="glossterm"> handshake</em>
		 phase of the connection and known only by those two systems.
	</div><div class="para">
		For secure exchange of the two-way encryption key, SSL makes use of Public Key Infrastructure (PKI), a method of encryption that utilizes a <em class="glossterm"> key pair</em>
		 . A key pair consists of two separate but matching cryptographic keys - a public key and a private key. The public key is shared with others and is used to encrypt data, and the private key is kept secret and is used to decrypt data that has been encrypted using the public key.
	</div><div class="para">
		When a client requests a secure connection, a handshake phase takes place before secure communication can begin. During the SSL handshake the server passes its public key to the client in the form of a certificate. The certificate contains the identity of the server (its URL), the public key of the server, and a digital signature that validates the certificate. The client then validates the certificate and makes a decision about whether the certificate is trusted or not. If the certificate is trusted, the client generates the two-way encryption key for the SSL connection, encrypts it using the public key of the server, and sends it back to the server. The server decrypts the two-way encryption key, using its private key, and further communication between the two machines over this connection is encrypted using the two-way encryption key.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4775-432896+%5BSpecified%5D&amp;comment=Title%3A+About+SSL+Encryption%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4775-432896+11+Apr+2013+10%3A47+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Implement_SSL_Encryption_for_the_JBoss_Enterprise_Application_Platform_Web_Server1" lang="en-US"><div class="titlepage"><div><div><h2 class="title">8.3. Implement SSL Encryption for the JBoss EAP 6 Web Server</h2></div></div></div><div class="para"><div class="title">Introduction</div><p>
			Many web applications require a SSL-encrypted connection between clients and server, also known as a <code class="code">HTTPS</code> connection. You can use this procedure to enable <code class="code">HTTPS</code> on your server or server group.
		</p></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul><li class="listitem"><div class="para">
				You need a set of SSL encryption keys and a SSL encryption certificate. You may purchase these from a certificate-signing authority, or you can generate them yourself using command-line utilities. To generate encryption keys using Red Hat Enterprise Linux utilities, refer to <a class="xref" href="#Generate_a_SSL_Encryption_Key_and_Certificate">Section 8.4, “Generate a SSL Encryption Key and Certificate”</a>.
			</div></li><li class="listitem"><div class="para">
				You need to know the following details about your specific environment and set-up:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						The full directory name and path to your certificate files
					</div></li><li class="listitem"><div class="para">
						The encryption password for your encryption keys.
					</div></li></ul></div></li><li class="listitem"><div class="para">
				You need to run the Management CLI and connect it to your domain controller or standalone server.
			</div></li></ul></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			This procedure uses commands appropriate for a JBoss EAP 6 configuration that uses a managed domain. If you use a standalone server, modify Management CLI commands by removing the <code class="literal">/profile=default</code> from the beginning of any Management CLI commands.
		</div></div></div><div class="procedure"><p class="title"><strong>Procedure 8.1. Configure the JBoss Web Server to use HTTPS</strong></p><ol class="1"><li class="step"><p class="title"><strong>Add a new HTTPS connector.</strong></p><div class="para">
				Execute the following Management CLI command, changing the profile as appropriate. This creates a new secure connector, called <code class="literal">HTTPS</code>, which uses the <code class="literal">https</code> scheme, the <code class="literal">https</code> socket binding (which defaults to <code class="literal">8443</code>), and is set to be secure.
			</div><div class="example" id="idm140707320901312"><p class="title"><strong>Example 8.1. Management CLI Command</strong></p><div class="example-contents"><pre class="screen">
/profile=default/subsystem=web/connector=HTTPS/:add(socket-binding=https,scheme=https,protocol=HTTP/1.1,secure=true)
</pre></div></div></li><li class="step"><p class="title"><strong>Configure the SSL encryption certificate and keys.</strong></p><div class="para">
				Execute the following CLI commands to configure your SSL certificate, substituting your own values for the example ones. This example assumes that the keystore is copied to the server configuration directory, which is <code class="filename"><em class="replaceable">EAP_HOME</em>/domain/configuration/</code> for a managed domain.
			</div><div class="example" id="idm140707320452736"><p class="title"><strong>Example 8.2. Management CLI Command</strong></p><div class="example-contents"><pre class="screen">
/profile=default/subsystem=web/connector=HTTPS/ssl=configuration:add(name=https,certificate-key-file="${jboss.server.config.dir}/keystore.jks",password=<em class="replaceable">SECRET</em>, key-alias=<em class="replaceable">KEY_ALIAS</em>)
</pre><div class="para">
					For a full listing of parameters you can set for the SSL properties of the connector, refer to <a class="xref" href="#SSL_Connector_Reference1">Section 8.5, “SSL Connector Reference”</a>.
				</div></div></div></li><li class="step"><p class="title"><strong>Deploy an application.</strong></p><div class="para">
				Deploy an application to a server group which uses the profile you have configured. If you use a standalone server, deploy an application to your server. HTTP requests to it use the new SSL-encrypted connection.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+9036-458786+%5BSpecified%5D&amp;comment=Title%3A+Implement+SSL+Encryption+for+the+JBoss+EAP+6+Web+Server%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=9036-458786+11+Jun+2013+15%3A00+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Generate_a_SSL_Encryption_Key_and_Certificate" lang="en-US"><div class="titlepage"><div><div><h2 class="title">8.4. Generate a SSL Encryption Key and Certificate</h2></div></div></div><div class="para">
		To use a SSL-encrypted HTTP connection (HTTPS), as well as other types of SSL-encrypted communication, you need a signed encryption certificate. You can purchase a certificate from a Certificate Authority (CA), or you can use a self-signed certificate. Self-signed certificates are not considered trustworthy by many third parties, but are appropriate for internal testing purposes.
	</div><div class="para">
		This procedure enables you to create a self-signed certificate using utilities which are available on Red Hat Enterprise Linux.
	</div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul><li class="listitem"><div class="para">
				You need the <code class="command">keytool</code> utility, which is provided by any Java Development Kit implementation. OpenJDK on Red Hat Enterprise Linux installs this command to <code class="filename">/usr/bin/keytool</code>.
			</div></li><li class="listitem"><div class="para">
				Understand the syntax and parameters of the <code class="command">keytool</code> command. This procedure uses extremely generic instructions, because further discussion of the specifics of SSL certificates or the <code class="filename">keytool</code> command are out of scope for this documentation.
			</div></li></ul></div><div class="procedure"><p class="title"><strong>Procedure 8.2. Generate a SSL Encryption Key and Certificate</strong></p><ol class="1"><li class="step"><p class="title"><strong>Generate a keystore with public and private keys.</strong></p><div class="para">
				Run the following command to generate a keystore named <code class="literal">server.keystore</code> with the alias <code class="literal">jboss</code> in your current directory. 
<pre class="screen">keytool -genkeypair -alias jboss -keyalg RSA -keystore server.keystore -storepass mykeystorepass --dname "CN=jsmith,OU=Engineering,O=mycompany.com,L=Raleigh,S=NC,C=US"</pre>
				 The following table describes the parameters used in the keytool command:
			</div><div class="informaltable"><table class="lt-4-cols gt-7-rows"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707340943520" scope="col"> Parameter </th><th id="idm140707340943040" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140707340943520"> <em class="parameter"><code>-genkeypair</code></em> </td><td headers="idm140707340943040"> The <code class="command">keytool</code> command to generate a key pair containing a public and private key. </td></tr><tr><td headers="idm140707340943520"> <em class="parameter"><code>-alias</code></em> </td><td headers="idm140707340943040"> The alias for the keystore. This value is arbitrary, but the alias <code class="literal">jboss</code> is the default used by the JBoss Web server. </td></tr><tr><td headers="idm140707340943520"> <em class="parameter"><code>-keyalg</code></em> </td><td headers="idm140707340943040"> The key pair generation algorithm. In this case it is <code class="literal">RSA</code>. </td></tr><tr><td headers="idm140707340943520"> <em class="parameter"><code>-keystore</code></em> </td><td headers="idm140707340943040"> The name and location of the keystore file. The default location is the current directory. The name you choose is arbitrary. In this case, the file will be named <code class="literal">server.keystore</code>. </td></tr><tr><td headers="idm140707340943520"> <em class="parameter"><code>-storepass</code></em> </td><td headers="idm140707340943040"> This password is used to authenticate to the keystore so that the key can be read. The password must be at least 6 characters long and must be provided when the keystore is accessed. In this case, we used <code class="literal">mykeystorepass</code>. If you omit this parameter, you will be prompted to enter it when you execute the command. </td></tr><tr><td headers="idm140707340943520"> <em class="parameter"><code>-keypass</code></em> </td><td headers="idm140707340943040"> <div class="para">
								This is the password for the actual key.
							</div>
							 <div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
									Due to an implementation limitation this must be the same as the store password.
								</div></div></div>
							 </td></tr><tr><td headers="idm140707340943520"> <em class="parameter"><code>--dname</code></em> </td><td headers="idm140707340943040"> A quoted string describing the distinguished name for the key, for example: "CN=jsmith,OU=Engineering,O=mycompany.com,L=Raleigh,C=US". This string is a concatenation of the following components: 
							<div class="itemizedlist"><ul><li class="listitem"><div class="para">
										<code class="literal">CN</code> - The common name or host name. If the hostname is "jsmith.mycompany.com", the <code class="literal">CN</code> is "jsmith".
									</div></li><li class="listitem"><div class="para">
										<code class="literal">OU</code> - The organizational unit, for example "Engineering"
									</div></li><li class="listitem"><div class="para">
										<code class="literal">O</code> - The organization name, for example "mycompany.com".
									</div></li><li class="listitem"><div class="para">
										<code class="literal">L</code> - The locality, for example "Raleigh" or "London"
									</div></li><li class="listitem"><div class="para">
										<code class="literal">S</code> - The state or province, for example "NC". This parameter is optional.
									</div></li><li class="listitem"><div class="para">
										<code class="literal">C</code> - The 2 letter country code, for example "US" or "UK",
									</div></li></ul></div>
							 </td></tr></tbody></table></div><div class="para">
				When you execute the above command, you are prompted for the following information: 
				<div class="itemizedlist"><ul><li class="listitem"><div class="para">
							If you did not use the <em class="parameter"><code>-storepass</code></em> parameter on the command line, you are asked to enter the keystore password. Re-enter the new password at the next prompt.
						</div></li><li class="listitem"><div class="para">
							If you did not use the <code class="code">-keypass</code> parameter on the command line, you are asked to enter the key password. Press <span class="keycap"><strong>Enter</strong></span> to set this to the same value as the keystore password.
						</div></li></ul></div>

			</div><div class="para">
				When the command completes, the file <code class="literal">server.keystore</code> now contains the single key with the alias <code class="literal">jboss</code>.
			</div></li><li class="step"><p class="title"><strong>Verify the key.</strong></p><div class="para">
				Verify that the key works properly by using the following command.
			</div><pre class="screen">keytool -list -keystore server.keystore</pre><div class="para">
				You are prompted for the keystore password. The contents of the keystore are displayed (in this case, a single key called <code class="literal">jboss</code>). Notice the type of the <code class="literal">jboss</code> key, which is <code class="literal">keyEntry</code>. This indicates that the keystore contains both a public and private entry for this key.
			</div></li><li class="step"><p class="title"><strong>Generate a certificate signing request.</strong></p><div class="para">
				Run the following command to generate a certificate signing request using the public key from the keystore you created in step 1.
			</div><pre class="screen">keytool -certreq -keyalg RSA -alias jboss -keystore server.keystore -file certreq.csr</pre><div class="para">
				You are prompted for the password in order to authenticate to the keystore. The <code class="code">keytool</code> command then creates a new certificate signing request called <code class="filename">certreq.csr</code> in the current working directory.
			</div></li><li class="step"><p class="title"><strong>Test the newly generated certificate signing request.</strong></p><div class="para">
				Test the contents of the certificate by using the following command.
			</div><pre class="screen">openssl req -in certreq.csr -noout -text</pre><div class="para">
				The certificate details are shown.
			</div></li><li class="step"><p class="title"><strong>Optional: Submit your certificate signing request to a Certificate Authority (CA).</strong></p><div class="para">
				A Certificate Authority (CA) can authenticate your certificate so that it is considered trustworthy by third-party clients. The CA supplies you with a signed certificate, and optionally with one or more intermediate certificates.
			</div></li><li class="step"><p class="title"><strong>Optional: Export a self-signed certificate from the keystore.</strong></p><div class="para">
				If you only need it for testing or internal purposes, you can use a self-signed certificate. You can export one from the keystore you created in step 1 as follows:
			</div><pre class="screen">keytool -export -alias jboss -keystore server.keystore -file server.crt</pre><div class="para">
				You are prompted for the password in order to authenticate to the keystore. A self-signed certificate, named <code class="code">server.crt</code>, is created in the current working directory.
			</div></li><li class="step"><p class="title"><strong>Import the signed certificate, along with any intermediate certificates.</strong></p><div class="para">
				Import each certificate, in the order that you are instructed by the CA. For each certificate to import, replace <code class="code">intermediate.ca</code> or <code class="code">server.crt</code> with the actual file name. If your certificates are not provided as separate files, create a separate file for each certificate, and paste its contents into the file.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					Your signed certificate and certificate keys are valuable assets. Be cautious with how you transport them between servers.
				</div></div></div><pre class="screen">keytool -import -keystore server.keystore -alias intermediateCA -file intermediate.ca</pre><pre class="screen">keytool -import -alias jboss -keystore server.keystore -file server.crt</pre></li><li class="step"><p class="title"><strong>Test that your certificates imported successfully.</strong></p><div class="para">
				Run the following command, and enter the keystore password when prompted. The contents of your keystore are displayed, and the certificates are part of the list.
			</div><pre class="screen">keytool -list -keystore server.keystore</pre></li></ol></div><div class="para"><div class="title">Result</div><p>
			Your signed certificate is now included in your keystore and is ready to be used to encrypt SSL connections, including HTTPS web server communications.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+9037-490501+%5BSpecified%5D&amp;comment=Title%3A+Generate+a+SSL+Encryption+Key+and+Certificate%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=9037-490501+02+Aug+2013+15%3A55+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="SSL_Connector_Reference1" lang="en-US"><div class="titlepage"><div><div><h2 class="title">8.5. SSL Connector Reference</h2></div></div></div><div class="para">
		JBoss Web connectors may include the following SSL configuration attributes. The CLI commands provided are designed for a managed domain using profile <code class="literal">default</code>. Change the profile name to the one you wish to configure, for a managed domain, or omit the <code class="code">/profile=default</code> portion of the command, for a standalone server.
	</div><div class="table" id="idm140707337243072"><p class="title"><strong>Table 8.1. SSL Connector Attributes</strong></p><div class="table-contents"><table class="lt-4-cols gt-14-rows" summary="SSL Connector Attributes"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707321513680" scope="col"> Attribute </th><th id="idm140707340256416" scope="col"> Description </th><th id="idm140707340255936" scope="col"> CLI Command </th></tr></thead><tbody><tr><td headers="idm140707321513680"> name </td><td headers="idm140707340256416"> <div class="para">
						The display name of the SSL connector.
					</div>
					 </td><td headers="idm140707340255936">
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=name,value=https)</pre>
					 </td></tr><tr><td headers="idm140707321513680"> verify-client </td><td headers="idm140707340256416"> <div class="para">
						Set to <code class="literal">true</code> to require a valid certificate chain from the client before accepting a connection. Set to <code class="literal">want</code> if you want the SSL stack to request a client Certificate, but not fail if one is not presented. Set to <code class="literal">false</code> (the default) to not require a certificate chain unless the client requests a resource protected by a security constraint that uses <code class="code">CLIENT-CERT</code> authentication.
					</div>
					 </td><td headers="idm140707340255936">
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=verify-client,value=want)</pre>
					 </td></tr><tr><td headers="idm140707321513680"> verify-depth </td><td headers="idm140707340256416"> <div class="para">
						The maximum number of intermediate certificate issuers checked before deciding that the clients do not have a valid certificate. The default value is <code class="literal">10</code>.
					</div>
					 </td><td headers="idm140707340255936">
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=verify-depth,value=10)</pre>
					 </td></tr><tr><td headers="idm140707321513680"> certificate-key-file </td><td headers="idm140707340256416"> <div class="para">
						The full file path and file name of the keystore file where the signed server certificate is stored. With JSSE encryption, this certificate file will be the only one, while OpenSSL uses several files. The default value is the <code class="filename">.keystore</code> file in the home directory of the user running JBoss EAP 6. If your <code class="code">keystoreType</code> does not use a file, set the parameter to an empty string.
					</div>
					 </td><td headers="idm140707340255936">
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=certificate-key-file,value=../domain/configuration/server.keystore)</pre>
					 </td></tr><tr><td headers="idm140707321513680"> certificate-file </td><td headers="idm140707340256416"> <div class="para">
						If you use OpenSSL encryption, set the value of this parameter to the path to the file containing the server certificate.
					</div>
					 </td><td headers="idm140707340255936">
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=certificate-file,value=server.crt)</pre>
					 </td></tr><tr><td headers="idm140707321513680"> password </td><td headers="idm140707340256416"> <div class="para">
						The password for both the trustore and keystore. In the following example, replace <em class="replaceable">PASSWORD</em> with your own password.
					</div>
					 </td><td headers="idm140707340255936">
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=password,value=<em class="replaceable">PASSWORD</em>)</pre>
					 </td></tr><tr><td headers="idm140707321513680"> protocol </td><td headers="idm140707340256416"> <div class="para">
						The version of the SSL protocol to use. Supported values include <code class="literal">SSLv2</code>, <code class="literal">SSLv3</code>, <code class="literal">TLSv1</code>, <code class="literal">SSLv2+SSLv3</code>, and <code class="literal">ALL</code>. The default is <code class="literal">ALL</code>.
					</div>
					 </td><td headers="idm140707340255936">
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=protocol,value=ALL)</pre>
					 </td></tr><tr><td headers="idm140707321513680"> cipher-suite </td><td headers="idm140707340256416"> <div class="para">
						A comma-separated list of the encryption ciphers which are allowed. The JVM default for JSSE contains weak ciphers which should not be used. The example only lists two possible ciphers, but real-world examples will likely use more.
					</div>
					 </td><td headers="idm140707340255936">
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=cipher-suite, value="TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA")</pre>
					 </td></tr><tr><td headers="idm140707321513680"> key-alias </td><td headers="idm140707340256416"> <div class="para">
						The alias used to for the server certificate in the keystore. In the following example, replace <em class="replaceable">KEY_ALIAS</em> with your certificate's alias.
					</div>
					 </td><td headers="idm140707340255936">
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=key-alias,value=<em class="replaceable">KEY_ALIAS</em>)</pre>
					 </td></tr><tr><td headers="idm140707321513680"> truststore-type </td><td headers="idm140707340256416"> <div class="para">
						The type of the truststore. Various types of keystores are available, including <code class="literal">PKCS12</code> and Java's standard <code class="literal">JKS</code>.
					</div>
					 </td><td headers="idm140707340255936">
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=truststore-type,value=jks)</pre>
					 </td></tr><tr><td headers="idm140707321513680"> keystore-type </td><td headers="idm140707340256416"> <div class="para">
						The type of the keystore, Various types of keystores are available, including <code class="literal">PKCS12</code> and Java's standard <code class="literal">JKS</code>.
					</div>
					 </td><td headers="idm140707340255936">
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=keystore-type,value=jks)</pre>
					 </td></tr><tr><td headers="idm140707321513680"> ca-certificate-file </td><td headers="idm140707340256416"> <div class="para">
						The file containing the CA certificates. This is the <code class="code">truststoreFile</code>, in the case of JSSE, and uses the same password as the keystore. The <code class="code">ca-certificate-file</code> file is used to validate client certificates.
					</div>
					 </td><td headers="idm140707340255936">
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=certificate-file,value=ca.crt)</pre>
					 </td></tr><tr><td headers="idm140707321513680"> ca-certificate-password </td><td headers="idm140707340256416"> <div class="para">
						The Certificate password for the <code class="code">ca-certificate-file</code>. In the following example, replace the <em class="replaceable">MASKED_PASSWORD</em> with your own masked password.
					</div>
					 </td><td headers="idm140707340255936">
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=ca-certificate-password,value=<em class="replaceable">MASKED_PASSWORD</em>)</pre>
					 </td></tr><tr><td headers="idm140707321513680"> ca-revocation-url </td><td headers="idm140707340256416"> <div class="para">
						A file or URL which contains the revocation list. It refers to the <code class="code">crlFile</code> for JSSE or the <code class="code">SSLCARevocationFile</code> for SSL.
					</div>
					 </td><td headers="idm140707340255936">
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=ca-revocation-url,value=ca.crl)</pre>
					 </td></tr><tr><td headers="idm140707321513680"> session-cache-size </td><td headers="idm140707340256416"> <div class="para">
						The size of the SSLSession cache. This attribute applies only to JSSE connectors. The default is <code class="literal">0</code>, which specifies an unlimited cache size.
					</div>
					 </td><td headers="idm140707340255936">
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=session-cache-size,value=100)</pre>
					 </td></tr><tr><td headers="idm140707321513680"> session-timeout </td><td headers="idm140707340256416"> <div class="para">
						The number of seconds before a cached SSLSession expires. This attribute applies only to JSSE connectors. The default is <code class="literal">86400</code> seconds, which is 24 hours.
					</div>
					 </td><td headers="idm140707340255936">
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=session-timeout,value=43200)</pre>
					 </td></tr></tbody></table></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+9038-496418+%5BSpecified%5D&amp;comment=Title%3A+SSL+Connector+Reference%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=9038-496418+20+Aug+2013+16%3A24+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div class="section" id="sect-FIPS_140-2_Compliant_Encryption"><div class="titlepage"><div><div><h2 class="title">8.6. FIPS 140-2 Compliant Encryption</h2></div></div></div><div xml:lang="en-US" class="section" id="About_FIPS_140-2_Compliance" lang="en-US"><div class="titlepage"><div><div><h3 class="title">8.6.1. About FIPS 140-2 Compliance</h3></div></div></div><div class="para">
		The Federal Information Processing Standard 140-2 (FIPS 140-2) is a US government computer security standard for the accreditation of cryptographic software modules. FIPS 140-2 compliance is often a requirement of software systems used by government agencies and private sector business.
	</div><div class="para">
		JBoss EAP 6 uses external modules encryption and can be configured to use a FIPS 140-2 compliant cryptography module.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+13767-458815+%5BSpecified%5D&amp;comment=Title%3A+About+FIPS+140-2+Compliance%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=13767-458815+11+Jun+2013+15%3A45+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="FIPS_140-2_Compliant_Passwords" lang="en-US"><div class="titlepage"><div><div><h3 class="title">8.6.2. FIPS 140-2 Compliant Passwords</h3></div></div></div><div class="para">
		A FIPS compliant password must have the following characteristics:
	</div><div class="orderedlist"><ol><li class="listitem"><div class="para">
				Must be at least seven (7) characters in length.
			</div></li><li class="listitem"><div class="para">
				Must include characters from at least three (3) of the following character classes:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						ASCII digits,
					</div></li><li class="listitem"><div class="para">
						lowercase ASCII,
					</div></li><li class="listitem"><div class="para">
						uppercase ASCII,
					</div></li><li class="listitem"><div class="para">
						non-alphanumeric ASCII, and
					</div></li><li class="listitem"><div class="para">
						non-ASCII.
					</div></li></ul></div></li></ol></div><div class="para">
		If the first character of the password is an uppercase ASCII letter, then it is not counted as an uppercase ASCII letter for restriction 2.
	</div><div class="para">
		If the last character of the password is an ASCII digit, then it does not count as an ASCII digit for restriction 2.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+13893-383346+%5BSpecified%5D&amp;comment=Title%3A+FIPS+140-2+Compliant+Passwords%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=13893-383346+12+Mar+2013+15%3A52+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Enable_FIPS_140-2_Cryptography_for_SSL_on_Red_Hat_Enterprise_Linux_6" lang="en-US"><div class="titlepage"><div><div><h3 class="title">8.6.3. Enable FIPS 140-2 Cryptography for SSL on Red Hat Enterprise Linux 6</h3></div></div></div><div class="para">
		This task describes how to configure the web container (JBoss Web) of JBoss EAP 6 to FIPS 140-2 compliant cryptography for SSL. This task only covers the steps to do this on Red Hat Enterprise Linux 6.
	</div><div class="para">
		This task uses the Mozilla NSS library in FIPS mode for this feature.
	</div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul><li class="listitem"><div class="para">
				Red Hat Enterprise Linux 6 must already be configured to be FIPS 140-2 compliant. Refer to <a href="https://access.redhat.com/knowledge/solutions/137833" class="mimir-link-warn" title="This content is not included in Mimir.">https://access.redhat.com/knowledge/solutions/137833</a>.
			</div></li></ul></div><div class="procedure"><p class="title"><strong>Procedure 8.3. Enable FIPS 140-2 Compliant Cryptography for SSL</strong></p><ol class="1"><li class="step"><p class="title"><strong>Create the database</strong></p><div class="para">
				Create the NSS database in a directory own by the <code class="literal">jboss</code> user.
			</div><pre class="screen">$ mkdir -p  /usr/share/jboss-as/nssdb
$ chown jboss /usr/share/jboss-as/nssdb 
$ modutil -create -dbdir /usr/share/jboss-as/nssdb</pre></li><li class="step"><p class="title"><strong>Create NSS configuration file</strong></p><div class="para">
				Create a new text file with the name <code class="filename">nss_pkcsll_fips.cfg</code> in the <code class="filename">/usr/share/jboss-as</code> directory with the following contents:
			</div><pre class="programlisting">name = nss-fips
nssLibraryDirectory=/usr/lib64
nssSecmodDirectory=/usr/share/jboss-as/nssdb
nssModule = fips</pre><div class="para">
				The NSS configuration file must specify:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						a name,
					</div></li><li class="listitem"><div class="para">
						the directory where the NSS library is located, and
					</div></li><li class="listitem"><div class="para">
						the directory where the NSS database was created as per step 1.
					</div></li></ul></div><div class="para">
				If you are not running a 64bit version of Red Hat Enterprise Linux 6 then set <code class="code">nssLibraryDirectory</code> to <code class="filename">/usr/lib</code> instead of <code class="filename">/usr/lib64</code>.
			</div></li><li class="step"><p class="title"><strong>Enable SunPKCS11 provider</strong></p><div class="para">
				Edit the <code class="filename">java.security</code> configuration file for your JRE (<code class="filename">$JAVA_HOME/jre/lib/security/java.security</code>) and add the following line:
			</div><pre class="programlisting">security.provider.1=sun.security.pkcs11.SunPKCS11  /usr/share/jboss-as/nss_pkcsll_fips.cfg</pre><div class="para">
				Note that the configuration file specified in this line is the file created in step 2.
			</div><div class="para">
				Any other <code class="code">security.provider.<em class="replaceable">X</em></code> lines in this file must have the value of their <em class="replaceable">X</em> increased by one to ensure that this provider is given priority.
			</div></li><li class="step"><p class="title"><strong>Enable FIPS mode for the NSS library</strong></p><div class="para">
				Run the <code class="command">modutil</code> command as shown to enable FIPS mode:
			</div><pre class="screen">modutil -fips true -dbdir /usr/share/jboss-as/nssdb</pre><div class="para">
				Note that the directory specified here is the one created in step 1.
			</div><div class="para">
				You may get a security library error at this point requiring you to regenerate the library signatures for some of the NSS shared objects.
			</div></li><li class="step"><p class="title"><strong>Change the password on the FIPS token</strong></p><div class="para">
				Set the password on the FIPS token using the following command. Note that the name of the token must be <code class="literal">NSS FIPS 140-2 Certificate DB</code>.
			</div><pre class="screen">modutil -changepw "<code class="literal">NSS FIPS 140-2 Certificate DB</code>" -dbdir /usr/share/jboss-as/nssdb</pre><div class="para">
				The password used for the FIPS token must be a FIPS compliant password.
			</div></li><li class="step"><p class="title"><strong>Create certificate using NSS tools</strong></p><div class="para">
				Enter the following command to create a certificate using the NSS tools.
			</div><pre class="screen">certutil -S -k rsa -n jbossweb  -t "u,u,u" -x -s "CN=localhost, OU=MYOU, O=MYORG, L=MYCITY, ST=MYSTATE, C=MY" -d /usr/share/jboss-as/nssdb</pre></li><li class="step"><p class="title"><strong>Configure the HTTPS connector to use the PKCS11 keystore</strong></p><div class="para">
				Add a HTTPS connector using the following command in the JBoss CLI Tool:
			</div><pre class="screen">/subsystem=web/connector=https/:add(socket-binding=https,scheme=https,protocol=HTTP/1.1,secure=true)</pre><div class="para">
				Then add the SSL configuration with the following command, replacing PASSWORD with the FIPS compliant password from step 5.
			</div><pre class="screen">/subsystem=web/connector=https/ssl=configuration:add(name=https,password=PASSWORD,keystore-type=PCKS11,
cipher-suite="SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA,
TLS_RSA_WITH_AES_128_CBC_SHA,TLS_DHE_DSS_WITH_AES_128_CBC_SHA,
TLS_DHE_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA,
TLS_DHE_DSS_WITH_AES_256_CBC_SHA,TLS_DHE_RSA_WITH_AES_256_CBC_SHA,
TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA,TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA,
TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA,
TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA,
TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA,TLS_ECDH_RSA_WITH_AES_128_CBC_SHA,
TLS_ECDH_RSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,
TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,
TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA,TLS_ECDH_anon_WITH_AES_128_CBC_SHA,
TLS_ECDH_anon_WITH_AES_256_CBC_SHA")</pre></li><li class="step"><p class="title"><strong>Verify</strong></p><div class="para">
				Verify that the JVM can read the private key from the PKCS11 keystore by running the following command:
			</div><pre class="screen">keytool -list -storetype pkcs11</pre></li></ol></div><div class="example" id="idm140707330547184"><p class="title"><strong>Example 8.3. XML configuration for HTTPS connector using FIPS 140-2 compliance</strong></p><div class="example-contents"><pre class="programlisting language-xml">&lt;connector name="https" protocol="HTTP/1.1" scheme="https" socket-binding="https" secure="true"&gt;
  &lt;ssl name="https" password="****" 
      cipher-suite="SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA,
         TLS_RSA_WITH_AES_128_CBC_SHA, TLS_DHE_DSS_WITH_AES_128_CBC_SHA,
         TLS_DHE_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA,
         TLS_DHE_DSS_WITH_AES_256_CBC_SHA,TLS_DHE_RSA_WITH_AES_256_CBC_SHA,
         TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA,TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA,
         TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA,
         TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA,
         TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA,TLS_ECDH_RSA_WITH_AES_128_CBC_SHA,
         TLS_ECDH_RSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,
         TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,
         TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA,TLS_ECDH_anon_WITH_AES_128_CBC_SHA,
         TLS_ECDH_anon_WITH_AES_256_CBC_SHA"
      keystore-type="PKCS11"/&gt;
&lt;/connector&gt;</pre><div class="para">
			Note that the <code class="code">cipher-suite</code> attribute has linebreaks inserted to make it easier to read.
		</div></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+13768-458816+%5BSpecified%5D&amp;comment=Title%3A+Enable+FIPS+140-2+Cryptography+for+SSL+on+Red+Hat+Enterprise+Linux+6%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=13768-458816+11+Jun+2013+15%3A46+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div></div><div xml:lang="en-US" class="chapter" id="chap-Network_Security" lang="en-US"><div class="titlepage"><div><div><h2 class="title">Chapter 9. Network Security</h2></div></div></div><div xml:lang="en-US" class="section" id="Secure_the_Management_Interfaces2" lang="en-US"><div class="titlepage"><div><div><h2 class="title">9.1. Secure the Management Interfaces</h2></div></div></div><div class="para"><div class="title">Summary</div><p>
			In a test environment, it is typical to run JBoss EAP 6 with no security layer on the management interfaces, comprised of the Management Console, Management CLI, and any other API implementation. This allows for rapid development and configuration changes.
		</p></div><div class="para">
		In addition, a silent authentication mode is present by default, allowing a local client on the host machine to connect to the Management CLI without requiring a username or password. This behavior is a convenience for local users and Management CLI scripts, but it can be disabled if required. The procedure is described in the topic <a class="xref" href="#Remove_Silent_Authentication_from_the_Default_Security_Realm">Section 10.5, “Remove Silent Authentication from the Default Security Realm”</a>.
	</div><div class="para">
		When you begin testing and preparing your environment to move to production, it is vitally important to secure the management interfaces by at least the following methods:
	</div><div class="para">
		<div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<a class="xref" href="#Specify_Which_Network_Interface_the_Enterprise_Application_Platform_Uses">Section 9.2, “Specify Which Network Interface JBoss EAP 6 Uses”</a>
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#Configure_Network_Firewalls_to_Work_with_JBoss_Enterprise_Application_Platform_6">Section 9.3, “Configure Network Firewalls to Work with JBoss EAP 6”</a>
				</div></li></ul></div>

	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4703-537642+%5BSpecified%5D&amp;comment=Title%3A+Secure+the+Management+Interfaces%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4703-537642+17+Sep+2013+10%3A18+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Specify_Which_Network_Interface_the_Enterprise_Application_Platform_Uses" lang="en-US"><div class="titlepage"><div><div><h2 class="title">9.2. Specify Which Network Interface JBoss EAP 6 Uses</h2></div></div></div><div class="para"><div class="title">Overview</div><p>
			Isolating services so that they are accessible only to the clients who need them increases the security of your network. JBoss EAP 6 includes two interfaces in its default configuration, both of which bind to the IP address <code class="literal">127.0.0.1</code>, or <code class="literal">localhost</code>, by default. One of the interfaces is called <code class="literal">management</code>, and is used by the Management Console, CLI, and API. The other is called <code class="literal">public</code>, and is used to deploy applications. These interfaces are not special or significant, but are provided as a starting point.
		</p></div><div class="para">
		The <code class="literal">management</code> interface uses ports 9990 and 9999 by default, and the <code class="literal">public</code> interface uses port 8080, or port 8443 if you use HTTPS.
	</div><div class="para">
		You can change the IP address of the management interface, public interface, or both.
	</div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
			If you expose the management interfaces to other network interfaces which are accessible from remote hosts, be aware of the security implications. Most of the time, it is not advisable to provide remote access to the management interfaces.
		</div></div></div><div class="procedure"><ol class="1"><li class="step"><p class="title"><strong>Stop JBoss EAP 6.</strong></p><div class="para">
				Stop JBoss EAP 6 by sending an interrupt in the appropriate way for your operating system. If you are running JBoss EAP 6 as a foreground application, the typical way to do this is to press <span class="keycap"><strong>Ctrl+C</strong></span>.
			</div></li><li class="step"><p class="title"><strong>Restart JBoss EAP 6, specifying the bind address.</strong></p><div class="para">
				Use the <code class="command">-b</code> command-line switch to start JBoss EAP 6 on a specific interface.
			</div><div class="example" id="idm140707321607984"><p class="title"><strong>Example 9.1. Specify the public interface.</strong></p><div class="example-contents"><pre class="screen">
<em class="replaceable">EAP_HOME</em>/bin/domain.sh -b 10.1.1.1</pre></div></div><div class="example" id="idm140707320908272"><p class="title"><strong>Example 9.2. Specify the management interface.</strong></p><div class="example-contents"><pre class="screen">
<em class="replaceable">EAP_HOME</em>/bin/domain.sh -bmanagement=10.1.1.1</pre></div></div><div class="example" id="idm140707339885376"><p class="title"><strong>Example 9.3. Specify different addresses for each interface.</strong></p><div class="example-contents"><pre class="screen">
<em class="replaceable">EAP_HOME</em>/bin/domain.sh -bmanagement=127.0.0.1 -b 10.1.1.1</pre></div></div><div class="example" id="idm140707322879856"><p class="title"><strong>Example 9.4. Bind the public interface to all network interfaces.</strong></p><div class="example-contents"><pre class="screen">
<em class="replaceable">EAP_HOME</em>/bin/domain.sh -b 0.0.0.0</pre></div></div></li></ol></div><div class="para">
		It is possible to edit your XML configuration file directly, to change the default bind addresses. However, if you do this, you will no longer be able to use the <code class="command">-b</code>command-line switch to specify an IP address at run-time, so this is not recommended. If you do decide to do this, be sure to stop JBoss EAP 6 completely before editing the XML file.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4704-458774+%5BSpecified%5D&amp;comment=Title%3A+Specify+Which+Network+Interface+JBoss+EAP+6+Uses%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4704-458774+11+Jun+2013+14%3A49+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_Network_Firewalls_to_Work_with_JBoss_Enterprise_Application_Platform_6" lang="en-US"><div class="titlepage"><div><div><h2 class="title">9.3. Configure Network Firewalls to Work with JBoss EAP 6</h2></div></div></div><div class="para"><div class="title">Summary</div><p>
			Most production environments use firewalls as part of an overall network security strategy. If you need multiple server instances to communicate with each other or with external services such as web servers or databases, your firewall must take this into account. A well-managed firewall only opens the ports which are necessary for operation, and limits access to the ports to specific IP addresses, subnets, and network protocols.
		</p></div><div class="para">
		A full discussion of firewalls is out of the scope of this documentation.
	</div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul><li class="listitem"><div class="para">
				Determine the ports you need to open.
			</div></li><li class="listitem"><div class="para">
				An understanding of your firewall software is required. This procedure uses the <code class="command">system-config-firewall</code> command in Red Hat Enterprise Linux 6. Microsoft Windows Server includes a built-in firewall, and several third-party firewall solutions are available for each platform.
			</div></li></ul></div><div class="para"><div class="title">Assumptions</div><p>
			This procedure configures a firewall in an environment with the following assumptions:
		</p></div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				The operating system is Red Hat Enterprise Linux 6.
			</div></li><li class="listitem"><div class="para">
				JBoss EAP 6 runs on host <code class="literal">10.1.1.2</code>. Optionally, the server has its own firewall.
			</div></li><li class="listitem"><div class="para">
				The network firewall server runs on host <code class="literal">10.1.1.1</code> on interface <code class="literal">eth0</code>, and has an external interface <code class="literal">eth1</code>.
			</div></li><li class="listitem"><div class="para">
				You want traffic on port 5445 (a port used by JMS) forwarded to JBoss EAP 6. No other traffic should be allowed through the network firewall.
			</div></li></ul></div><div class="procedure"><p class="title"><strong>Procedure 9.1. Manage Network Firewalls and JBoss EAP 6 to work together</strong></p><ol class="1"><li class="step"><p class="title"><strong>Log into the Management Console.</strong></p><div class="para">
				Log into the Management Console. By default, it runs on <a href="http://localhost:9990/console/" class="mimir-link-warn" title="Mimir does not include content from: localhost">http://localhost:9990/console/</a>.
			</div></li><li class="step"><p class="title"><strong>Determine the socket bindings used by the socket binding group.</strong></p><div class="para">
				Click the <span class="guilabel"><strong>Profiles</strong></span> label at the top right of the Management Console. At the left side of the screen, a series of menus is shown. The bottom menu heading is <span class="guilabel"><strong>General Configuration</strong></span>. Click the <span class="guilabel"><strong>Socket Binding</strong></span> item below this heading. The <span class="guilabel"><strong>Socket Binding Declarations</strong></span> screen appears. Initially, the <code class="literal">standard-sockets</code> group is shown. You can choose a different group by selecting it from the combo box on the right-hand side.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					If you use a standalone server, it has only one socket binding group.
				</div></div></div><div class="para">
				The list of socket names and ports is shown, eight values per page. You can go through the pages by using the arrow navigation below the table.
			</div></li><li class="step"><p class="title"><strong>Determine the ports you need to open.</strong></p><div class="para">
				Depending on the function of the particular port and the requirements of your environment, some ports may need to be opened on your firewall.
			</div></li><li class="step"><p class="title"><strong>Configure your firewall to forward traffic to JBoss EAP 6.</strong></p><div class="para">
				Perform these steps to configure your network firewall to allow traffic on the desired port.
			</div><ol class="substeps a"><li class="step"><div class="para">
						Log into your firewall machine and access a command prompt, as the root user.
					</div></li><li class="step"><div class="para">
						Issue the command <code class="command">system-config-firewall</code> to launch the firewall configuration utility. A GUI or command-line utility launches, depending on the way you are logged into the firewall system. This task makes the assumption that you are logged in via SSH and using the command-line interface.
					</div></li><li class="step"><div class="para">
						Use the <span class="keycap"><strong>TAB</strong></span> key on your keyboard to navigate to the <span class="guibutton"><strong>Customize</strong></span> button, and press the <span class="keycap"><strong>ENTER</strong></span> key. The <span class="guilabel"><strong>Trusted Services</strong></span> screen appears.
					</div></li><li class="step"><div class="para">
						Do not change any values, but use the <span class="keycap"><strong>TAB</strong></span> key to navigate to the <span class="guibutton"><strong>Forward</strong></span> button, and press <span class="keycap"><strong>ENTER</strong></span> to advanced to the next screen. The <span class="guilabel"><strong>Other Ports</strong></span> screen appears.
					</div></li><li class="step"><div class="para">
						Use the <span class="keycap"><strong>TAB</strong></span> key to navigate to the <span class="guilabel"><strong>&lt;Add&gt;</strong></span> button, and press <span class="keycap"><strong>ENTER</strong></span>. The <span class="guilabel"><strong>Port and Protocol</strong></span> screen appears.
					</div></li><li class="step"><div class="para">
						Enter <code class="literal">5445</code> in the <span class="guilabel"><strong>Port / Port Range</strong></span> field, then use the <span class="keycap"><strong>TAB</strong></span> key to move to the <span class="guilabel"><strong>Protocol</strong></span> field, and enter <code class="literal">tcp</code>. Use the <span class="keycap"><strong>TAB</strong></span> key to navigate to the <span class="guibutton"><strong>OK</strong></span> button, and press <span class="keycap"><strong>ENTER</strong></span>.
					</div></li><li class="step"><div class="para">
						Use the <span class="keycap"><strong>TAB</strong></span> key to navigate to the <span class="guibutton"><strong>Forward</strong></span> button until you reach the <span class="guilabel"><strong>Port Forwarding</strong></span> screen.
					</div></li><li class="step"><div class="para">
						Use the <span class="keycap"><strong>TAB</strong></span> key to navigate to the <span class="guilabel"><strong>&lt;Add&gt;</strong></span> button, and press the <span class="keycap"><strong>ENTER</strong></span> key.
					</div></li><li class="step"><div class="para">
						Fill in the following values to set up port forwarding for port 5445.
					</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
								Source interface: eth1
							</div></li><li class="listitem"><div class="para">
								Protocol: tcp
							</div></li><li class="listitem"><div class="para">
								Port / Port Range: 5445
							</div></li><li class="listitem"><div class="para">
								Destination IP address: 10.1.1.2
							</div></li><li class="listitem"><div class="para">
								Port / Port Range: 5445
							</div></li></ul></div><div class="para">
						Use the <span class="keycap"><strong>TAB</strong></span> key to navigate to the <span class="guibutton"><strong>OK</strong></span> button, and press <span class="keycap"><strong>ENTER</strong></span>.
					</div></li><li class="step"><div class="para">
						Use the <span class="keycap"><strong>TAB</strong></span> key to navigate to the <span class="guibutton"><strong>Close</strong></span> button, and press <span class="keycap"><strong>ENTER</strong></span>.
					</div></li><li class="step"><div class="para">
						Use the <span class="keycap"><strong>TAB</strong></span> key to navigate to the <span class="guibutton"><strong>OK</strong></span> button, and press <span class="keycap"><strong>ENTER</strong></span>. To apply the changes, read the warning and click <span class="guibutton"><strong>Yes</strong></span>.
					</div></li></ol></li><li class="step"><p class="title"><strong>Configure a firewall on your JBoss EAP 6 host.</strong></p><div class="para">
				Some organizations choose to configure a firewall on the JBoss EAP 6 server itself, and close all ports that are not necessary for its operation. See <a class="xref" href="#Network_Ports_Used_By_JBoss_Enterprise_Application_Platform_62">Section 9.4, “Network Ports Used By JBoss EAP 6”</a> and determine which ports to open, then close the rest. The default configuration of Red Hat Enterprise Linux 6 closes all ports except 22 (used for Secure Shell (SSH) and 5353 (used for multicast DNS). While you are configuring ports, ensure you have physical access to your server so that you do not inadvertently lock yourself out.
			</div></li></ol></div><div class="para"><div class="title">Result</div><p>
			Your firewall is configured to forward traffic to your internal JBoss EAP 6 server in the way you specified in your firewall configuration. If you chose to enable a firewall on your server, all ports are closed except the ones needed to run your applications.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4705-548800+%5BSpecified%5D&amp;comment=Title%3A+Configure+Network+Firewalls+to+Work+with+JBoss+EAP+6%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4705-548800+25+Oct+2013+10%3A20+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Network_Ports_Used_By_JBoss_Enterprise_Application_Platform_62" lang="en-US"><div class="titlepage"><div><div><h2 class="title">9.4. Network Ports Used By JBoss EAP 6</h2></div></div></div><div class="para">
		The ports used by the JBoss EAP 6 default configuration depend on several factors:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				Whether your server groups use one of the default socket binding groups, or a custom group.
			</div></li><li class="listitem"><div class="para">
				The requirements of your individual deployments.
			</div></li></ul></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			A numerical port offset can be configured, to alleviate port conflicts when you run multiple servers on the same physical server. If your server uses a numerical port offset, add the offset to the default port number for its server group's socket binding group. For instance, if the HTTP port of the socket binding group is 8080, and your server uses a port offset of 100, its HTTP port is 8180.
		</div></div></div><div class="para">
		Unless otherwise stated, the ports use the TCP protocol.
	</div><div class="itemizedlist"><p class="title"><strong>The default socket binding groups</strong></p><ul><li class="listitem"><div class="para">
				<code class="literal">full-ha-sockets</code>
			</div></li><li class="listitem"><div class="para">
				<code class="literal">full-sockets</code>
			</div></li><li class="listitem"><div class="para">
				<code class="literal">ha-sockets</code>
			</div></li><li class="listitem"><div class="para">
				<code class="literal">standard-sockets</code>
			</div></li></ul></div><div class="table" id="socket-bindings"><p class="title"><strong>Table 9.1. Reference of the default socket bindings</strong></p><div class="table-contents"><table class="gt-4-cols gt-14-rows" summary="Reference of the default socket bindings"><colgroup><col width="11%" align="left" class="c1"><!--Empty--></col><col width="11%" align="left" class="c2"><!--Empty--></col><col width="11%" align="left" class="c3"><!--Empty--></col><col width="22%" align="left" class="c4"><!--Empty--></col><col width="11%" align="left" class="c5"><!--Empty--></col><col width="11%" align="left" class="c6"><!--Empty--></col><col width="11%" align="left" class="c7"><!--Empty--></col><col width="11%" align="left" class="c8"><!--Empty--></col></colgroup><thead><tr><th align="left" id="idm140707314590848" scope="col"> Name </th><th align="left" id="idm140707314590368" scope="col"> Port </th><th align="left" id="idm140707314589888" scope="col"> Mulicast Port </th><th align="left" id="idm140707321569664" scope="col"> Description </th><th align="left" id="idm140707321569184" scope="col"> full-ha-sockets </th><th align="left" id="idm140707320746528" scope="col"> full-sockets </th><th align="left" id="idm140707320746048" scope="col"> ha-socket </th><th align="left" id="idm140707312708064" scope="col"> standard-socket </th></tr></thead><tbody><tr><td align="left" headers="idm140707314590848"> <code class="literal">ajp</code> </td><td align="left" headers="idm140707314590368"> 8009 </td><td align="left" headers="idm140707314589888"> </td><td align="left" headers="idm140707321569664"> Apache JServ Protocol. Used for HTTP clustering and load balancing. </td><td align="left" headers="idm140707321569184"> Yes </td><td align="left" headers="idm140707320746528"> Yes </td><td align="left" headers="idm140707320746048"> Yes </td><td align="left" headers="idm140707312708064"> Yes </td></tr><tr><td align="left" headers="idm140707314590848"> <code class="literal">http</code> </td><td align="left" headers="idm140707314590368"> 8080 </td><td align="left" headers="idm140707314589888"> </td><td align="left" headers="idm140707321569664"> The default port for deployed web applications. </td><td align="left" headers="idm140707321569184"> Yes </td><td align="left" headers="idm140707320746528"> Yes </td><td align="left" headers="idm140707320746048"> Yes </td><td align="left" headers="idm140707312708064"> Yes </td></tr><tr><td align="left" headers="idm140707314590848"> <code class="literal">https</code> </td><td align="left" headers="idm140707314590368"> 8443 </td><td align="left" headers="idm140707314589888"> </td><td align="left" headers="idm140707321569664"> SSL-encrypted connection between deployed web applications and clients. </td><td align="left" headers="idm140707321569184"> Yes </td><td align="left" headers="idm140707320746528"> Yes </td><td align="left" headers="idm140707320746048"> Yes </td><td align="left" headers="idm140707312708064"> Yes </td></tr><tr><td align="left" headers="idm140707314590848"> <code class="literal">jacorb</code> </td><td align="left" headers="idm140707314590368"> 3528 </td><td align="left" headers="idm140707314589888"> </td><td align="left" headers="idm140707321569664"> CORBA services for JTS transactions and other ORB-dependent services. </td><td align="left" headers="idm140707321569184"> Yes </td><td align="left" headers="idm140707320746528"> Yes </td><td align="left" headers="idm140707320746048"> No </td><td align="left" headers="idm140707312708064"> No </td></tr><tr><td align="left" headers="idm140707314590848"> <code class="literal">jacorb-ssl</code> </td><td align="left" headers="idm140707314590368"> 3529 </td><td align="left" headers="idm140707314589888"> </td><td align="left" headers="idm140707321569664"> SSL-encrypted CORBA services. </td><td align="left" headers="idm140707321569184"> Yes </td><td align="left" headers="idm140707320746528"> Yes </td><td align="left" headers="idm140707320746048"> No </td><td align="left" headers="idm140707312708064"> No </td></tr><tr><td align="left" headers="idm140707314590848"> <code class="literal">jgroups-diagnostics</code> </td><td align="left" headers="idm140707314590368"> </td><td align="left" headers="idm140707314589888"> 7500 </td><td align="left" headers="idm140707321569664"> Multicast. Used for peer discovery in HA clusters. Not configurable using the Management Interfaces. </td><td align="left" headers="idm140707321569184"> Yes </td><td align="left" headers="idm140707320746528"> No </td><td align="left" headers="idm140707320746048"> Yes </td><td align="left" headers="idm140707312708064"> No </td></tr><tr><td align="left" headers="idm140707314590848"> <code class="literal">jgroups-mping</code> </td><td align="left" headers="idm140707314590368"> </td><td align="left" headers="idm140707314589888"> 45700 </td><td align="left" headers="idm140707321569664"> Multicast. Used to discover initial membership in a HA cluster. </td><td align="left" headers="idm140707321569184"> Yes </td><td align="left" headers="idm140707320746528"> No </td><td align="left" headers="idm140707320746048"> Yes </td><td align="left" headers="idm140707312708064"> No </td></tr><tr><td align="left" headers="idm140707314590848"> <code class="literal">jgroups-tcp</code> </td><td align="left" headers="idm140707314590368"> 7600 </td><td align="left" headers="idm140707314589888"> </td><td align="left" headers="idm140707321569664"> Unicast peer discovery in HA clusters using TCP. </td><td align="left" headers="idm140707321569184"> Yes </td><td align="left" headers="idm140707320746528"> No </td><td align="left" headers="idm140707320746048"> Yes </td><td align="left" headers="idm140707312708064"> No </td></tr><tr><td align="left" headers="idm140707314590848"> <code class="literal">jgroups-tcp-fd</code> </td><td align="left" headers="idm140707314590368"> 57600 </td><td align="left" headers="idm140707314589888"> </td><td align="left" headers="idm140707321569664"> Used for HA failure detection over TCP. </td><td align="left" headers="idm140707321569184"> Yes </td><td align="left" headers="idm140707320746528"> No </td><td align="left" headers="idm140707320746048"> Yes </td><td align="left" headers="idm140707312708064"> No </td></tr><tr><td align="left" headers="idm140707314590848"> <code class="literal">jgroups-udp</code> </td><td align="left" headers="idm140707314590368"> 55200 </td><td align="left" headers="idm140707314589888"> 45688 </td><td align="left" headers="idm140707321569664"> Unicast peer discovery in HA clusters using UDP. </td><td align="left" headers="idm140707321569184"> Yes </td><td align="left" headers="idm140707320746528"> No </td><td align="left" headers="idm140707320746048"> Yes </td><td align="left" headers="idm140707312708064"> No </td></tr><tr><td align="left" headers="idm140707314590848"> <code class="literal">jgroups-udp-fd</code> </td><td align="left" headers="idm140707314590368"> 54200 </td><td align="left" headers="idm140707314589888"> </td><td align="left" headers="idm140707321569664"> Used for HA failure detection over UDP. </td><td align="left" headers="idm140707321569184"> Yes </td><td align="left" headers="idm140707320746528"> No </td><td align="left" headers="idm140707320746048"> Yes </td><td align="left" headers="idm140707312708064"> No </td></tr><tr><td align="left" headers="idm140707314590848"> <code class="literal">messaging</code> </td><td align="left" headers="idm140707314590368"> 5445 </td><td align="left" headers="idm140707314589888"> </td><td align="left" headers="idm140707321569664"> JMS service. </td><td align="left" headers="idm140707321569184"> Yes </td><td align="left" headers="idm140707320746528"> Yes </td><td align="left" headers="idm140707320746048"> No </td><td align="left" headers="idm140707312708064"> No </td></tr><tr><td align="left" headers="idm140707314590848"> <code class="literal">messaging-group</code> </td><td align="left" headers="idm140707314590368"> </td><td align="left" headers="idm140707314589888"> </td><td align="left" headers="idm140707321569664"> Referenced by HornetQ JMS broadcast and discovery groups. </td><td align="left" headers="idm140707321569184"> Yes </td><td align="left" headers="idm140707320746528"> Yes </td><td align="left" headers="idm140707320746048"> No </td><td align="left" headers="idm140707312708064"> No </td></tr><tr><td align="left" headers="idm140707314590848"> <code class="literal">messaging-throughput</code> </td><td align="left" headers="idm140707314590368"> 5455 </td><td align="left" headers="idm140707314589888"> </td><td align="left" headers="idm140707321569664"> Used by JMS Remoting. </td><td align="left" headers="idm140707321569184"> Yes </td><td align="left" headers="idm140707320746528"> Yes </td><td align="left" headers="idm140707320746048"> No </td><td align="left" headers="idm140707312708064"> No </td></tr><tr><td align="left" headers="idm140707314590848"> <code class="literal">mod_cluster</code> </td><td align="left" headers="idm140707314590368"> </td><td align="left" headers="idm140707314589888"> 23364 </td><td align="left" headers="idm140707321569664"> Multicast port for communication between JBoss EAP 6 and the HTTP load balancer. </td><td align="left" headers="idm140707321569184"> Yes </td><td align="left" headers="idm140707320746528"> No </td><td align="left" headers="idm140707320746048"> Yes </td><td align="left" headers="idm140707312708064"> No </td></tr><tr><td align="left" headers="idm140707314590848"> <code class="literal">osgi-http</code> </td><td align="left" headers="idm140707314590368"> 8090 </td><td align="left" headers="idm140707314589888"> </td><td align="left" headers="idm140707321569664"> Used by internal components which use the OSGi subsystem. Not configurable using the Management Interfaces. </td><td align="left" headers="idm140707321569184"> Yes </td><td align="left" headers="idm140707320746528"> Yes </td><td align="left" headers="idm140707320746048"> Yes </td><td align="left" headers="idm140707312708064"> Yes </td></tr><tr><td align="left" headers="idm140707314590848"> <code class="literal">remoting</code> </td><td align="left" headers="idm140707314590368"> 4447 </td><td align="left" headers="idm140707314589888"> </td><td align="left" headers="idm140707321569664"> Used for remote EJB invocation. </td><td align="left" headers="idm140707321569184"> Yes </td><td align="left" headers="idm140707320746528"> Yes </td><td align="left" headers="idm140707320746048"> Yes </td><td align="left" headers="idm140707312708064"> Yes </td></tr><tr><td align="left" headers="idm140707314590848"> <code class="literal">txn-recovery-environment</code> </td><td align="left" headers="idm140707314590368"> 4712 </td><td align="left" headers="idm140707314589888"> </td><td align="left" headers="idm140707321569664"> The JTA transaction recovery manager. </td><td align="left" headers="idm140707321569184"> Yes </td><td align="left" headers="idm140707320746528"> Yes </td><td align="left" headers="idm140707320746048"> Yes </td><td align="left" headers="idm140707312708064"> Yes </td></tr><tr><td align="left" headers="idm140707314590848"> <code class="literal">txn-status-manager</code> </td><td align="left" headers="idm140707314590368"> 4713 </td><td align="left" headers="idm140707314589888"> </td><td align="left" headers="idm140707321569664"> The JTA / JTS transation manager. </td><td align="left" headers="idm140707321569184"> Yes </td><td align="left" headers="idm140707320746528"> Yes </td><td align="left" headers="idm140707320746048"> Yes </td><td align="left" headers="idm140707312708064"> Yes </td></tr></tbody></table></div></div><div class="para"><div class="title">Management Ports</div><p>
			In addition to the socket binding groups, each host controller opens two more ports for management purposes:
		</p></div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				9990 - The Web Management Console port
			</div></li><li class="listitem"><div class="para">
				9999 - The port used by the Management Console and Management API
			</div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+5377-481771+%5BSpecified%5D&amp;comment=Title%3A+Network+Ports+Used+By+JBoss+EAP+6%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5377-481771+25+Jul+2013+13%3A24+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div xml:lang="en-US" class="chapter" id="chap-Management_Interface_Security" lang="en-US"><div class="titlepage"><div><div><h2 class="title">Chapter 10. Management Interface Security</h2></div></div></div><div xml:lang="en-US" class="section" id="Secure_the_Management_Interfaces" lang="en-US"><div class="titlepage"><div><div><h2 class="title">10.1. Secure the Management Interfaces</h2></div></div></div><div class="para"><div class="title">Summary</div><p>
			In a test environment, it is typical to run JBoss EAP 6 with no security layer on the management interfaces, comprised of the Management Console, Management CLI, and any other API implementation. This allows for rapid development and configuration changes.
		</p></div><div class="para">
		In addition, a silent authentication mode is present by default, allowing a local client on the host machine to connect to the Management CLI without requiring a username or password. This behavior is a convenience for local users and Management CLI scripts, but it can be disabled if required. The procedure is described in the topic <a class="xref" href="#Remove_Silent_Authentication_from_the_Default_Security_Realm">Section 10.5, “Remove Silent Authentication from the Default Security Realm”</a>.
	</div><div class="para">
		When you begin testing and preparing your environment to move to production, it is vitally important to secure the management interfaces by at least the following methods:
	</div><div class="para">
		<div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<a class="xref" href="#Specify_Which_Network_Interface_the_Enterprise_Application_Platform_Uses">Section 9.2, “Specify Which Network Interface JBoss EAP 6 Uses”</a>
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#Configure_Network_Firewalls_to_Work_with_JBoss_Enterprise_Application_Platform_6">Section 9.3, “Configure Network Firewalls to Work with JBoss EAP 6”</a>
				</div></li></ul></div>

	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4703-537642+%5BSpecified%5D&amp;comment=Title%3A+Secure+the+Management+Interfaces%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4703-537642+17+Sep+2013+10%3A18+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Default_User_Security_Configuration" lang="en-US"><div class="titlepage"><div><div><h2 class="title">10.2. Default User Security Configuration</h2></div></div></div><div class="para"><div class="title">Introduction</div><p>
			All management interfaces in JBoss EAP 6 are secured by default. This security takes two different forms:
		</p></div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				Local interfaces are secured by a SASL contract between local clients and the server they connect to. This security mechanism is based on the client's ability to access the local filesystem. This is because access to the local filesystem would allow the client to add a user or otherwise change the configuration to thwart other security mechanisms. This adheres to the principle that if physical access to the filesystem is achieved, other security mechanisms are superfluous. The mechanism happens in four steps:
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					HTTP access is considered to be remote, even if you connect to the localhost using HTTP.
				</div></div></div><div class="orderedlist"><ol><li class="listitem"><div class="para">
						The client sends a message to the server which includes a request to authenticate with the local SASL mechanism.
					</div></li><li class="listitem"><div class="para">
						The server generates a one-time token, writes it to a unique file, and sends a message to the client with the full path of the file.
					</div></li><li class="listitem"><div class="para">
						The client reads the token from the file and sends it to the server, verifying that it has local access to the filesystem.
					</div></li><li class="listitem"><div class="para">
						The server verifies the token and then deletes the file.
					</div></li></ol></div></li><li class="listitem"><div class="para">
				Remote clients, including local HTTP clients, use realm-based security. The default realm with the permissions to configure the JBoss EAP 6 remotely using the management interfaces is <code class="literal">ManagementRealm</code>. A script is provided which allows you to add users to this realm (or realms you create). For more information on adding users, see the <em class="citetitle">Getting Started</em> chapter of the <em class="citetitle">JBoss EAP 6 Installation Guide</em>. For each user, the username, a hashed password, and the realm are stored in a file.
			</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Managed domain</span></dt><dd><div class="para">
							<code class="filename"><em class="replaceable">EAP_HOME</em>/domain/configuration/mgmt-users.properties</code>
						</div></dd><dt><span class="term">Standalone server</span></dt><dd><div class="para">
							<code class="filename"><em class="replaceable">EAP_HOME</em>/standalone/configuration/mgmt-users.properties</code>
						</div></dd></dl></div><div class="para">
				Even though the contents of the <code class="filename">mgmt-users.properties</code> are masked, the file must still be treated as a sensitive file. It is recommended that it be set to the file mode of <code class="literal">600</code>, which gives no access other than read and write access by the file owner.
			</div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+5751-548788+%5BSpecified%5D&amp;comment=Title%3A+Default+User+Security+Configuration%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5751-548788+25+Oct+2013+08%3A38+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Overview_of_Advanced_Management_Interface_Configuration1" lang="en-US"><div class="titlepage"><div><div><h2 class="title">10.3. Overview of Advanced Management Interface Configuration</h2></div></div></div><div class="para">
		The Management interface configuration in the <code class="filename"><em class="replaceable">EAP_HOME</em>/domain/configuration/host.xml</code> or <code class="filename"><em class="replaceable">EAP_HOME</em>/standalone/configuration/standalone.xml</code> controls which network interfaces the host controller process binds to, which types of management interfaces are available at all, and which type of authentication system is used to authenticate users on each interface. This topic discusses how to configure the Management Interfaces to suit your environment.
	</div><div class="para">
		The Management subsystem consists of a <code class="sgmltag-element">&lt;management&gt;</code> element that includes several configurable attributes, and the following three configurable child elements. The security realms and outbound connections are each first defined, and then applied to the management interfaces as attributes.
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				&lt;security-realms&gt;
			</div></li><li class="listitem"><div class="para">
				&lt;outbound-connections&gt;
			</div></li><li class="listitem"><div class="para">
				&lt;management-interfaces&gt;
			</div></li><li class="listitem"><div class="para">
				&lt;audit-log&gt;
			</div></li></ul></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			Refer to the <em class="citetitle">Management Interface Audit Logging</em> section of the <em class="citetitle">Administration and Configuration Guide</em> for more information on audit logging.
		</div></div></div><div class="para"><div class="title">Security Realms</div><p>
			The security realm is responsible for the authentication and authorization of users allowed to administer JBoss EAP 6 via the Management API, Management CLI, or web-based Management Console.
		</p></div><div class="para">
		Two different file-based security realms are included in a default installation: <code class="literal">ManagementRealm</code> and <code class="literal">ApplicationRealm</code>. Each of these security realms uses a <code class="filename">-users.properties</code> file to store users and hashed passwords, and a <code class="filename">-roles.properties</code> to store mappings between users and roles. Support is also included for an LDAP-enabled security realm.
	</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			Security realms can also be used for your own applications. The security realms discussed here are specific to the management interfaces.
		</div></div></div><div class="para"><div class="title">Outbound Connections</div><p>
			Some security realms connect to external interfaces, such as an LDAP server. An outbound connection defines how to make this connection. A pre-defined connection type, <code class="literal">ldap-connection</code>, sets all of the required and optional attributes to connect to the LDAP server and verify the credential.
		</p></div><div class="para">
		For more information on how to configure LDAP authentication see <a class="xref" href="#Use_LDAP_to_Authenticate_to_the_Management_Interfaces1">Section 10.12.2, “Use LDAP to Authenticate to the Management Interfaces”</a>.
	</div><div class="para"><div class="title">Management Interfaces</div><p>
			A management interface includes properties about how connect to and configure JBoss EAP. Such information includes the named network interface, port, security realm, and other configurable information about the interface. Two interfaces are included in a default installation:
		</p></div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				<code class="literal">http-interface</code> is the configuration for the web-based Management Console.
			</div></li><li class="listitem"><div class="para">
				<code class="literal">native-interface</code> is the configuration for the command-line Management CLI and the REST-like Management API.
			</div></li></ul></div><div class="para">
		Each of the three main configurable elements of the host management subsystem are interrelated. A security realm refers to an outbound connection, and a management interface refers to a security realm.
	</div><div class="para">
		Associated information can be found in <a class="xref" href="#Secure_the_Management_Interfaces">Section 10.1, “Secure the Management Interfaces”</a>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+8428-632984+%5BSpecified%5D&amp;comment=Title%3A+Overview+of+Advanced+Management+Interface+Configuration%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=8428-632984+23+Apr+2014+00%3A16+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Disable_the_HTTP_Management_Interface" lang="en-US"><div class="titlepage"><div><div><h2 class="title">10.4. Disable the HTTP Management Interface</h2></div></div></div><div class="para">
		In a managed domain, you only need access to the HTTP interface on the domain controller, rather than on domain member servers. In addition, on a production server, you may decide to disable the web-based Management Console altogether.
	</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			Other clients, such as JBoss Operations Network, also operate using the HTTP interface. If you want to use these services, and simply disable the Management Console itself, you can set the <code class="code">console-enabled</code> attribute of the HTTP interface to <code class="literal">false</code>, instead of disabling the interface completely.
		</div><pre class="screen">/host=master/core-service=management/management-interface=http-interface/:write-attribute(name=console-enabled,value=false)</pre></div></div><div class="para">
		To disable access to the HTTP interface, which also disables access to the web-based Management Console, you can delete the HTTP interface altogether.
	</div><div class="para">
		The following JBoss CLI command allows you to read the current contents of your HTTP interface, in case you decide to add it again.
	</div><div class="example" id="idm140707319112048"><p class="title"><strong>Example 10.1. Read the Configuration of the HTTP Interface</strong></p><div class="example-contents"><pre class="screen">
<code class="command">/host=master/core-service=management/management-interface=http-interface/:read-resource(recursive=true,proxies=false,include-runtime=false,include-defaults=true)</code>
{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "console-enabled" =&gt; true,
        "interface" =&gt; "management",
        "port" =&gt; expression "${jboss.management.http.port:9990}",
        "secure-port" =&gt; undefined,
        "security-realm" =&gt; "ManagementRealm"
    }
}
</pre></div></div><div class="para">
		To remove the HTTP interface, issue the following command:
	</div><div class="example" id="idm140707316714880"><p class="title"><strong>Example 10.2. Remove the HTTP Interface</strong></p><div class="example-contents"><pre class="screen">
/host=master/core-service=management/management-interface=http-interface/:remove
</pre></div></div><div class="para">
		To re-enable access, issue the following commands to re-create the HTTP Interface with the default values.
	</div><div class="example" id="idm140707314853728"><p class="title"><strong>Example 10.3. Re-Create the HTTP Interface</strong></p><div class="example-contents"><pre class="screen">/host=master/core-service=management/management-interface=http-interface:add(console-enabled=true,interface=management,port="${jboss.management.http.port:9990}",security-realm=ManagementRealm)</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+8430-466979+%5BSpecified%5D&amp;comment=Title%3A+Disable+the+HTTP+Management+Interface%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=8430-466979+20+Jun+2013+05%3A14+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Remove_Silent_Authentication_from_the_Default_Security_Realm" lang="en-US"><div class="titlepage"><div><div><h2 class="title">10.5. Remove Silent Authentication from the Default Security Realm</h2></div></div></div><div class="para"><div class="title">Summary</div><p>
			The default installation of JBoss EAP 6 contains a method of silent authentication for a local Management CLI user. This allows the local user the ability to access the Management CLI without username or password authentication. This functionality is enabled as a convenience, and to assist local users running Management CLI scripts without requiring authentication. It is considered a useful feature given that access to the local configuration typically also gives the user the ability to add their own user details or otherwise disable security checks.
		</p></div><div class="para">
		The convenience of silent authentication for local users can be disabled where greater security control is required. This can be achieved by removing the <code class="literal">local</code> element within the <code class="literal">security-realm</code> section of the configuration file. This applies to both the <code class="filename">standalone.xml</code> for a Standalone Server instance, or <code class="filename">host.xml</code> for a Managed Domain. You should only consider the removal of the <code class="literal">local</code> element if you understand the impact that it might have on your particular server configuration.
	</div><div class="para">
		The preferred method of removing silent authentication is by use of the Management CLI, which directly removes the <code class="literal">local</code> element visible in the following example.
	</div><div class="example" id="idm140707311620800"><p class="title"><strong>Example 10.4. Example of the <code class="literal">local</code> element in the <code class="literal">security-realm</code></strong></p><div class="example-contents"><pre class="programlisting">
&lt;security-realms&gt;
    &lt;security-realm name="ManagementRealm"&gt;
        &lt;authentication&gt;
            &lt;local default-user="$local"/&gt;
            &lt;properties path="mgmt-users.properties" relative-to="jboss.server.config.dir"/&gt;
        &lt;/authentication&gt;
    &lt;/security-realm&gt;
    &lt;security-realm name="ApplicationRealm"&gt;
        &lt;authentication&gt;
            &lt;local default-user="$local" allowed-users="*"/&gt;
            &lt;properties path="application-users.properties" relative-to="jboss.server.config.dir"/&gt;
        &lt;/authentication&gt;
        &lt;authorization&gt;
            &lt;properties path="application-roles.properties" relative-to="jboss.server.config.dir"/&gt;
        &lt;/authorization&gt;
    &lt;/security-realm&gt;
&lt;/security-realms&gt;
</pre></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul><li class="listitem"><div class="para">
				Start the JBoss EAP 6 instance.
			</div></li><li class="listitem"><div class="para">
				Launch the Management CLI.
			</div></li></ul></div><div class="procedure"><p class="title"><strong>Procedure 10.1. Remove Silent Authentication from the Default Security Realm</strong></p><ul><li class="step"><p class="title"><strong>Remove silent authentication with the Management CLI</strong></p><div class="para">
				Remove the <code class="literal">local</code> element from the Management Realm and Application Realm as required.
			</div><ol class="substeps a"><li class="step"><div class="para">
						Remove the <code class="literal">local</code> element from the Management Realm.
					</div><ul class="stepalternatives">
						<li class="step"><p class="title"><strong>For Standalone Servers</strong></p><pre class="screen">/core-service=management/security-realm=ManagementRealm/authentication=local:remove</pre></li>
						 <li class="step"><p class="title"><strong>For Managed Domains</strong></p><pre class="screen">/host=<em class="replaceable">HOST_NAME</em>/core-service=management/security-realm=ManagementRealm/authentication=local:remove</pre></li>

					</ul></li><li class="step"><div class="para">
						Remove the <code class="literal">local</code> element from the Application Realm.
					</div><ul class="stepalternatives">
						<li class="step"><p class="title"><strong>For Standalone Servers</strong></p><pre class="screen">/core-service=management/security-realm=ApplicationRealm/authentication=local:remove</pre></li>
						 <li class="step"><p class="title"><strong>For Managed Domains</strong></p><pre class="screen">/host=<em class="replaceable">HOST_NAME</em>/core-service=management/security-realm=ApplicationRealm/authentication=local:remove</pre></li>

					</ul></li></ol></li></ul></div><div class="para"><div class="title">Result</div><p>
			The silent authentication mode is removed from the <code class="literal">ManagementRealm</code> and the <code class="literal">ApplicationRealm</code>.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+9053-458767+%5BSpecified%5D&amp;comment=Title%3A+Remove+Silent+Authentication+from+the+Default+Security+Realm%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=9053-458767+11+Jun+2013+14%3A39+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Disable_Remote_Access_to_the_JMX_Subsystem1" lang="en-US"><div class="titlepage"><div><div><h2 class="title">10.6. Disable Remote Access to the JMX Subsystem</h2></div></div></div><div class="para">
		Remote JMX connectivity allows you to trigger JDK and application management operations. In order to secure an installation, disable this function. You can do this either by removing the remote connection configuration, or removing the JMX subsystem entirely. The JBoss CLI commands reference the default profile in a managed domain configuration. To modify a different profile, modify the <code class="literal">/profile=default</code> part of the command. For a standalone server, remove that portion of the command completely.
	</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			In a managed domain the remoting connector is removed from the JMX subsystem by default. This command is provided for your information, in case you add it during development.
		</div></div></div><div class="example" id="idm140707319315488"><p class="title"><strong>Example 10.5. Remove the Remote Connector from the JMX Subsystem</strong></p><div class="example-contents"><pre class="screen">/profile=default/subsystem=jmx/remoting-connector=jmx/:remove</pre></div></div><div class="example" id="idm140707314939088"><p class="title"><strong>Example 10.6. Remove the JMX Subsystem</strong></p><div class="example-contents"><div class="para">
			Run this command for each profile you use, if you use a managed domain.
		</div><pre class="screen">/profile=default/subsystem=jmx/:remove</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+8432-431484+%5BSpecified%5D&amp;comment=Title%3A+Disable+Remote+Access+to+the+JMX+Subsystem%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=8432-431484+05+Apr+2013+15%3A19+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_Security_Realms_for_the_Management_Interfaces" lang="en-US"><div class="titlepage"><div><div><h2 class="title">10.7. Configure Security Realms for the Management Interfaces</h2></div></div></div><div class="para">
		The Management Interfaces use security realms to control authentication and access to the configuration mechanisms of JBoss EAP 6. This topic shows you how to read and configure security realms. These commands use the Management CLI.
	</div><div class="para"><div class="title">Read a Security Realm's Configuration</div><p>
			This example shows the default configuration for the <code class="literal">ManagementRealm</code> security realm. It uses a file called <code class="filename">mgmt-users.properties</code> to store its configuration information.
		</p></div><div class="example" id="idm140707320321264"><p class="title"><strong>Example 10.7. Default ManagementRealm</strong></p><div class="example-contents"><pre class="screen">
	<code class="command">/host=master/core-service=management/security-realm=ManagementRealm/:read-resource(recursive=true,proxies=false,include-runtime=false,include-defaults=true)</code>
{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "authorization" =&gt; undefined,
        "server-identity" =&gt; undefined,
        "authentication" =&gt; {"properties" =&gt; {
            "path" =&gt; "mgmt-users.properties",
            "plain-text" =&gt; false,
            "relative-to" =&gt; "jboss.domain.config.dir"
        }}
    }
}
</pre></div></div><div class="para"><div class="title">Write a Security Realm</div><p>
			The following commands create a new security realm called <code class="literal">TestRealm</code> and set the directory for the relevant properties file.
		</p></div><div class="example" id="idm140707315916816"><p class="title"><strong>Example 10.8. Writing a Security Realm</strong></p><div class="example-contents"><pre class="screen">
<code class="prompt">/host=master/core-service=management/security-realm=TestRealm/:add</code>
<code class="prompt">/host=master/core-service=management/security-realm=TestRealm/authentication=properties/:add(path=TestUsers.properties, relative-to=jboss.domain.config.dir)</code></pre></div></div><div class="para"><div class="title">Apply a Security Realm to the Management Interface</div><p>
			After adding a security realm, supply it as a reference to the Management Interface.
		</p></div><div class="example" id="idm140707321475360"><p class="title"><strong>Example 10.9. Add a Security Realm to a Management Interface</strong></p><div class="example-contents"><pre class="screen">/host=master/core-service=management/management-interface=http-interface/:write-attribute(security-realm=TestRealm)</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+8433-481767+%5BSpecified%5D&amp;comment=Title%3A+Configure+Security+Realms+for+the+Management+Interfaces%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=8433-481767+25+Jul+2013+13%3A09+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_the_Management_Console_for_HTTPS_in_Standalone_mode" lang="en-US"><div class="titlepage"><div><div><h2 class="title">10.8. Configure the Management Console for HTTPS in Standalone mode</h2></div></div></div><div class="procedure"><p class="title"><strong>Procedure 10.2. </strong></p><ol class="1"><li class="step"><div class="para">
				Ensure the management console binds to <code class="literal">HTTPS</code> for its interface by adding the <code class="literal">management-https</code> configuration and removing the <code class="literal">management-http</code> configuration.
			</div><div class="para">
				This can be done by editing the <code class="filename">standalone.xml</code> file (which is not recommended) or by using the following CLI interface commands:
			</div><pre class="programlisting"><code class="command">/core-service=management/management-interface=http-interface:write-attribute(name=secure-socket-binding, value=management-https)</code></pre><pre class="programlisting"><code class="command">/core-service=management/management-interface=http-interface:undefine-attribute(name=socket-binding)</code></pre></li><li class="step"><p class="title"><strong>Optional:</strong></p><div class="para">
				If you are using a custom <em class="parameter"><code>socket-binding</code></em> group, ensure the <em class="parameter"><code>management-https</code></em> binding is defined (it is present by default, bound to port <code class="literal">9443</code>).
			</div><pre class="programlisting"> &lt;socket-binding-group name="standard-sockets" default-interface="public" port-offset="${jboss.socket.binding.port-offset:0}"&gt;
        &lt;socket-binding name="management-native" interface="management" port="${jboss.management.native.port:9999}"/&gt;
        &lt;socket-binding name="management-http" interface="management" port="${jboss.management.http.port:9990}"/&gt;
        &lt;socket-binding name="management-https" interface="management" port="${jboss.management.https.port:9443}"/&gt;
</pre></li><li class="step"><div class="para">
				Generate a keypair as discussed in <a class="xref" href="#Generate_a_SSL_Encryption_Key_and_Certificate">Section 8.4, “Generate a SSL Encryption Key and Certificate”</a>.
			</div></li><li class="step"><div class="para">
				Add a <em class="parameter"><code>server-identities</code></em> element to the <code class="literal">security-realm</code> section of the <code class="filename">standalone.xml</code> configuration file of your installation.
			</div><div class="para">
				Within this element you define the protocol, the keystore path, the keystore password and alias for the key pair.
			</div><div class="para">
				Execute the following CLI command, substituting your own values for the example ones. This example assumes that the keystore is copied to the server configuration directory, which is <code class="filename"><em class="replaceable">EAP_HOME</em>/standalone/configuration/</code> for a standalone server.
			</div><pre class="programlisting"><code class="command">/core-service=management/security-realm=ManagementRealm/server-identity=ssl:add(keystore-path=server.keystore,keystore-relative-to=jboss.server.config.dir, keystore-password=SECRET, alias=KEY_ALIAS)</code></pre></li><li class="step"><div class="para">
				Restart your standalone server.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+22638-548430+%5BSpecified%5D&amp;comment=Title%3A+Configure+the+Management+Console+for+HTTPS+in+Standalone+mode%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=22638-548430+23+Oct+2013+10%3A27+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_the_Management_Console_for_HTTPS_in_Domain_mode" lang="en-US"><div class="titlepage"><div><div><h2 class="title">10.9. Configure the Management Console for HTTPS in Domain mode</h2></div></div></div><div class="procedure"><p class="title"><strong>Procedure 10.3. </strong></p><ol class="1"><li class="step"><div class="para">
				Generate a keypair as discussed in <a class="xref" href="#Generate_a_SSL_Encryption_Key_and_Certificate">Section 8.4, “Generate a SSL Encryption Key and Certificate”</a>.
			</div></li><li class="step"><div class="para">
				Add a <code class="literal">server-identities</code> element to the <code class="literal">security-realm</code> block in your installations <code class="filename">host.xml.</code>.
			</div><div class="para">
				Within this element you define the protocol, the keystore path, the keystore password and alias for the key pair.
			</div><div class="para">
				Execute the following CLI command, substituting your own values for the example ones. This example assumes that the keystore is copied to the server configuration directory, which is EAP_HOME/domain/configuration/ for a managed domain.
			</div><pre class="programlisting"><code class="command">/host=master/core-service=management/security-realm=ManagementRealm/server-identity=ssl:add(protocol=TLSv1, keystore-path=server.keystore,keystore-relative-to=jboss.domain.config.dir, keystore-password=SECRET, alias=KEY_ALIAS)</code></pre></li><li class="step"><div class="para">
				Change the socket element within the <em class="parameter"><code>management-interface</code></em> section by adding <em class="parameter"><code>secure-port</code></em> and removing port configuration.
			</div><div class="para">
				Use the following commands:
			</div><pre class="programlisting"><code class="command">/host=master/core-service=management/management-interface=http-interface:write-attribute(name=secure-port,value=9443) </code></pre><pre class="programlisting"><code class="command">/host=master/core-service=management/management-interface=http-interface:undefine-attribute(name=port)</code></pre></li><li class="step"><div class="para">
				Restart your domain.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+22639-548431+%5BSpecified%5D&amp;comment=Title%3A+Configure+the+Management+Console+for+HTTPS+in+Domain+mode%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=22639-548431+23+Oct+2013+10%3A29+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Using_2-way_SSL_for_the_Management_interface_and_the_CLI" lang="en-US"><div class="titlepage"><div><div><h2 class="title">10.10. Using 2-way SSL for the Management interface and the CLI</h2></div></div></div><div class="para">
		In this topic the following conventions are used:
	</div><div class="variablelist"><p class="title"><strong><!--Empty--></strong></p><dl class="variablelist"><dt><span class="term"><em class="replaceable">HOST1</em></span></dt><dd><div class="para">
					The JBoss server hostname. For example; <code class="literal">jboss.redhat.com</code>
				</div></dd><dt><span class="term"><em class="replaceable">HOST2</em></span></dt><dd><div class="para">
					A suitable name for the client. For example: <code class="literal">myclient</code>. Note this is not necessarily an actual hostname.
				</div></dd><dt><span class="term"><em class="replaceable">CA_HOST1</em></span></dt><dd><div class="para">
					The DN (distinguished name) to use for the <em class="replaceable">HOST1</em> certificate. For example <code class="literal">cn=jboss,dc=redhat,dc=com</code>.
				</div></dd><dt><span class="term"><em class="replaceable">CA_HOST2</em></span></dt><dd><div class="para">
					The DN (distinguished name) to use for the <em class="replaceable">HOST2</em> certificate. For example <code class="literal">cn=myclient,dc=redhat,dc=com</code>.
				</div></dd></dl></div><div class="procedure"><p class="title"><strong>Procedure 10.4. </strong></p><ol class="1"><li class="step"><div class="para">
				Generate the stores:
			</div><pre class="programlisting">keytool -genkeypair -alias <em class="replaceable">HOST1_alias</em> -keyalg RSA -keysize 1024 -validity 365 -keystore host1.keystore.jks -dname "<em class="replaceable">CA_HOST1</em>" -keypass secret -storepass <em class="replaceable">secret</em></pre><pre class="programlisting">keytool -genkeypair -alias <em class="replaceable">HOST2_alias</em> -keyalg RSA -keysize 1024 -validity 365 -keystore host2.keystore.jks -dname "<em class="replaceable">CA_HOST2</em>" -keypass secret -storepass <em class="replaceable">secret</em></pre></li><li class="step"><div class="para">
				Export the certificates:
			</div><pre class="programlisting">keytool -exportcert  -keystore <em class="replaceable">HOST1</em>.keystore.jks -alias <em class="replaceable">HOST1_alias</em> -keypass <em class="replaceable">secret</em> -storepass <em class="replaceable">secret</em> -file <em class="replaceable">HOST1</em>.cer
</pre><pre class="programlisting">keytool -exportcert  -keystore <em class="replaceable">HOST2</em>.keystore.jks -alias <em class="replaceable">HOST2_alias</em> -keypass <em class="replaceable">secret</em> -storepass <em class="replaceable">secret</em> -file <em class="replaceable">HOST2</em>.cer
</pre></li><li class="step"><div class="para">
				Import the certificates into the opposing trust stores:
			</div><pre class="programlisting">keytool -importcert -keystore <em class="replaceable">HOST1</em>.truststore.jks -storepass <em class="replaceable">secret</em> -alias <em class="replaceable">HOST2_alias</em> -trustcacerts -file <em class="replaceable">HOST2</em>.cer
</pre><pre class="programlisting">keytool -importcert -keystore <em class="replaceable">HOST2</em>.truststore.jks -storepass <em class="replaceable">secret</em> -alias <em class="replaceable">HOST1_alias</em> -trustcacerts -file <em class="replaceable">HOST1</em>.cer
</pre></li><li class="step"><div class="para">
				Define a CertificateRealm in the configuration for your installation (<code class="filename">host.xml</code> or <code class="filename">standalone.xml</code>) and point the interface to it:
			</div><div class="para">
				This can be done by manually editing the configuration file (not recommended) or by using the following commands:
			</div><pre class="programlisting"><code class="command">/core-service=management/security-realm=CertificateRealm:add()</code></pre><pre class="programlisting"><code class="command">/core-service=management/security-realm=CertificateRealm:add/server-identity=ssl:add(keystore-path=/path/to/HOST1.keystore.jks,keystore-password=secret, alias=HOST1_alias)</code></pre><pre class="programlisting"><code class="command">/core-service=management/security-realm=CertificateRealm/authentication=truststore:add(keystore-path=/path/to/HOST1.truststore.jks,keystore-password=secret)</code></pre></li><li class="step"><div class="para">
				Edit the <code class="filename"><em class="replaceable">JBOSS_HOME</em>/bin/jboss-cli.xml</code> and add the SSL configuration (using the appropriate values for the variables):
			</div><pre class="programlisting">&lt;ssl&gt;
  &lt;alias&gt;$HOST2alias&lt;/alias&gt;
  &lt;key-store&gt;/path/to/HOST2.keystore.jks&lt;/key-store&gt;
  &lt;key-store-password&gt;secret&lt;/key-store-password&gt;
  &lt;trust-store&gt;/path/to/HOST2.truststore.jks&lt;/trust-store&gt;
  &lt;trust-store-password&gt;secret&lt;/trust-store-password&gt;
  &lt;modify-trust-store&gt;true&lt;/modify-trust-store&gt;
&lt;/ssl&gt;
</pre></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+22641-548432+%5BSpecified%5D&amp;comment=Title%3A+Using+2-way+SSL+for+the+Management+interface+and+the+CLI%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=22641-548432+23+Oct+2013+10%3A30+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div class="section" id="sect-Password_Vaults_for_Sensitive_Strings"><div class="titlepage"><div><div><h2 class="title">10.11. Password Vaults for Sensitive Strings</h2></div></div></div><div xml:lang="en-US" class="section" id="About_Securing_Sensitive_Strings_in_Clear-Text_Files1" lang="en-US"><div class="titlepage"><div><div><h3 class="title">10.11.1. About Securing Sensitive Strings in Clear-Text Files</h3></div></div></div><div class="para">
		Web applications and other deployments often include clear-text files, such as XML deployment descriptors, which include sensitive information such as passwords and other sensitive strings. JBoss EAP 6 includes a password vault mechanism which enables you to encrypt sensitive strings and store them in an encrypted keystore. The vault mechanism manages decrypting the strings for use with security domains, security realms, or other verification systems. This provides an extra layer of security. The mechanism relies upon tools that are included in all supported Java Development Kit (JDK) implementations.
	</div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
			Problems have been encountered when using the Vault security feature with JBoss EAP 6. It has been found that the vault.keystore generated the Sun/Oracle keytool is not a valid keystore when used with an IBM JDK. This is due to the fact that the JCEKS keystore implementations differ across Java vendors.
		</div><div class="para">
			The issue presents when a keystore generated by Oracle Java is used in a JBoss EAP instance on an IBM Java installation. In these cases the server will not start and throws the following exception:
		</div><pre class="screen">java.io.IOException: com.sun.crypto.provider.SealedObjectForKeyProtector</pre><div class="para">
			At the moment, the only workaround is to avoid attempting to use a keystore generated with an Oracle keytool in an environment using an IBM Java implementation.
		</div></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+9001-550105+%5BSpecified%5D&amp;comment=Title%3A+About+Securing+Sensitive+Strings+in+Clear-Text+Files%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=9001-550105+01+Nov+2013+12%3A48+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Create_a_Java_Keystore_to_Store_Sensitive_Strings" lang="en-US"><div class="titlepage"><div><div><h3 class="title">10.11.2. Create a Java Keystore to Store Sensitive Strings</h3></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul><li class="listitem"><div class="para">
				The <code class="command">keytool</code> command must be available to use. It is provided by the Java Runtime Environment (JRE). Locate the path for the file. In Red Hat Enterprise Linux, it is installed to <code class="filename">/usr/bin/keytool</code>.
			</div></li></ul></div><div class="procedure"><p class="title"><strong>Procedure 10.5. Setup a Java Keystore</strong></p><ol class="1"><li class="step"><p class="title"><strong>Create a directory to store your keystore and other encrypted information.</strong></p><div class="para">
				Create a directory to hold your keystore and other important information. The rest of this procedure assumes that the directory is <code class="filename">/home/<em class="replaceable">USER</em>/vault/</code>.
			</div></li><li class="step"><p class="title"><strong>Determine the parameters to use with <code class="command">keytool</code>.</strong></p><div class="para">
				Determine the following parameters:
			</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">alias</span></dt><dd><div class="para">
							The alias is a unique identifier for the vault or other data stored in the keystore. The alias in the example command at the end of this procedure is <code class="literal">vault</code>. Aliases are case-insensitive.
						</div></dd><dt><span class="term">keyalg</span></dt><dd><div class="para">
							The algorithm to use for encryption. The example in this procedure uses <code class="literal">RSA</code>. Use the documentation for your JRE and operating system to see which other choices may be available to you.
						</div></dd><dt><span class="term">keysize</span></dt><dd><div class="para">
							The size of an encryption key impacts how difficult it is to decrypt through brute force. The example in this procedure uses <code class="literal">2048</code>. For information on appropriate values, see the documentation distributed with the <code class="command">keytool</code>.
						</div></dd><dt><span class="term">keystore</span></dt><dd><div class="para">
							The keystore is a database which holds encrypted information and the information about how to decrypt it. If you do not specify a keystore, the default keystore to use is a file called <code class="filename">.keystore</code> in your home directory. The first time you add data to a keystore, it is created. The example in this procedure uses the <code class="literal">vault.keystore</code> keystore.
						</div></dd></dl></div><div class="para">
				The <code class="command">keytool</code> command has many other options. Refer to the documentation for your JRE or your operating system for more details.
			</div></li><li class="step"><p class="title"><strong>Determine the answers to questions the <code class="command">keystore</code> command will ask.</strong></p><div class="para">
				The <code class="command">keystore</code> needs the following information in order to populate the keystore entry:
			</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Keystore password</span></dt><dd><div class="para">
							When you create a keystore, you must set a password. In order to work with the keystore in the future, you need to provide the password. Create a strong password that you will remember. The keystore is only as secure as its password and the security of the file system and operating system where it resides.
						</div></dd><dt><span class="term">Key password (optional)</span></dt><dd><div class="para">
							In addition to the keystore password, you can specify a password for each key it holds. In order to use such a key, the password needs to be given each time it is used. Usually, this facility is not used.
						</div></dd><dt><span class="term">First name (given name) and last name (surname)</span></dt><dd><div class="para">
							This, and the rest of the information in the list, helps to uniquely identify the key and place it into a hierarchy of other keys. It does not necessarily need to be a name at all, but it should be two words, and must be unique to the key. The example in this procedure uses <code class="literal">Accounting Administrator</code>. In directory terms, this becomes the <em class="firstterm">common name</em> of the certificate.
						</div></dd><dt><span class="term">Organizational unit</span></dt><dd><div class="para">
							This is a single word that identifies who uses the certificate. It may be the application or the business unit. The example in this procedure uses <code class="literal">AccountingServices</code>. Typically, all keystores used by a group or application use the same organizational unit.
						</div></dd><dt><span class="term">Organization</span></dt><dd><div class="para">
							This is usually a single-word representation of your organization's name. This typically remains the same across all certificates used by an organization. This example uses <code class="literal">MyOrganization</code>.
						</div></dd><dt><span class="term">City or municipality</span></dt><dd><div class="para">
							Your city.
						</div></dd><dt><span class="term">State or province</span></dt><dd><div class="para">
							Your state or province, or the equivalent for your locality.
						</div></dd><dt><span class="term">Country</span></dt><dd><div class="para">
							The two-letter code for your country.
						</div></dd></dl></div><div class="para">
				All of this information together will create a hierarchy for your keystores and certificates, ensuring that they use a consistent naming structure but are unique.
			</div></li><li class="step"><p class="title"><strong>Run the <code class="command">keytool</code> command, supplying the information that you gathered.</strong></p><div class="example" id="idm140707330488400"><p class="title"><strong>Example 10.10. Example input and output of <code class="command">keystore</code> command</strong></p><div class="example-contents"><pre class="screen">
$ keytool -genseckey -alias vault -storetype jceks -keyalg AES -keysize 128 -storepass vault22 -keypass vault22 -keystore /home/USER/vault/vault.keystore
Enter keystore password: vault22 
Re-enter new password:vault22 
What is your first and last name?
  [Unknown]:  <code class="command">Accounting Administrator</code>
What is the name of your organizational unit?
  [Unknown]:  <code class="command">AccountingServices</code>
What is the name of your organization?
  [Unknown]:  <code class="command">MyOrganization</code>
What is the name of your City or Locality?
  [Unknown]:  <code class="command">Raleigh</code>
What is the name of your State or Province?
  [Unknown]:  <code class="command">NC</code>
What is the two-letter country code for this unit?
  [Unknown]:  <code class="command">US</code>
Is CN=Accounting Administrator, OU=AccountingServices, O=MyOrganization, L=Raleigh, ST=NC, C=US correct?
  [no]:  <code class="command">yes</code>

Enter key password for &lt;vault&gt;
        (RETURN if same as keystore password):
</pre></div></div></li></ol></div><div class="para"><div class="title">Result</div><p>
			A file named <code class="filename">vault.keystore</code> is created in the <code class="filename">/home/<em class="replaceable">USER</em>/vault/</code> directory. It stores a single key, called <code class="literal">vault</code>, which will be used to store encrypted strings, such as passwords, for JBoss EAP 6.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+5353-549388+%5BSpecified%5D&amp;comment=Title%3A+Create+a+Java+Keystore+to+Store+Sensitive+Strings%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5353-549388+29+Oct+2013+14%3A35+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Mask_the_Keystore_Password_and_Initialize_the_Password_Vault." lang="en-US"><div class="titlepage"><div><div><h3 class="title">10.11.3. Mask the Keystore Password and Initialize the Password Vault</h3></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul><li class="listitem"><div class="para">
				<a class="xref" href="#Create_a_Java_Keystore_to_Store_Sensitive_Strings">Section 10.11.2, “Create a Java Keystore to Store Sensitive Strings”</a>
			</div></li><li class="listitem"><div class="para">
				The <code class="filename"><em class="replaceable">EAP_HOME</em>/bin/vault.sh</code> application needs to be accessible via a command-line interface.
			</div></li></ul></div><div class="procedure"><ol class="1"><li class="step"><p class="title"><strong>Run the <code class="command">vault.sh</code> command.</strong></p><div class="para">
				Run <code class="filename"><em class="replaceable">EAP_HOME</em>/bin/vault.sh</code>. Start a new interactive session by typing <code class="literal">0</code>.
			</div></li><li class="step"><p class="title"><strong>Enter the directory where encrypted files will be stored.</strong></p><div class="para">
				This directory should be reasonably secure, but JBoss EAP 6 needs to be able to access it. If you followed <a class="xref" href="#Create_a_Java_Keystore_to_Store_Sensitive_Strings">Section 10.11.2, “Create a Java Keystore to Store Sensitive Strings”</a>, your keystore is in a directory called <code class="filename">vault/</code> in your home directory. This example uses the directory <code class="filename">/home/<em class="replaceable">USER</em>/vault/</code>.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					Do not forget to include the trailing slash on the directory name. Either use <code class="literal">/</code> or <code class="literal">\</code>, depending on your operating system.
				</div></div></div></li><li class="step"><p class="title"><strong>Enter the path to the keystore.</strong></p><div class="para">
				Enter the full path to the keystore file. This example uses <code class="filename">/home/<em class="replaceable">USER</em>/vault/vault.keystore</code>.
			</div></li><li class="step"><p class="title"><strong>Encrypt the keystore password.</strong></p><div class="para">
				The following steps encrypt the keystore password, so that you can use it in configuration files and applications securely.
			</div><ol class="substeps a"><li class="step"><p class="title"><strong>Enter the keystore password.</strong></p><div class="para">
						When prompted, enter the keystore password.
					</div></li><li class="step"><p class="title"><strong>Enter a salt value.</strong></p><div class="para">
						Enter an 8-character salt value. The salt value, together with the iteration count (below), are used to create the hash value.
					</div></li><li class="step"><p class="title"><strong>Enter the iteration count.</strong></p><div class="para">
						Enter a number for the iteration count.
					</div></li><li class="step"><p class="title"><strong>Make a note of the masked password information.</strong></p><div class="para">
						The masked password, the salt, and the iteration count are printed to standard output. Make a note of them in a secure location. An attacker could use them to decrypt the password.
					</div></li><li class="step"><p class="title"><strong>Enter the alias of the vault.</strong></p><div class="para">
						When prompted, enter the alias of the vault. If you followed <a class="xref" href="#Create_a_Java_Keystore_to_Store_Sensitive_Strings">Section 10.11.2, “Create a Java Keystore to Store Sensitive Strings”</a> to create your vault, the alias is <code class="literal">vault</code>.
					</div></li></ol></li><li class="step"><p class="title"><strong>Exit the interactive console.</strong></p><div class="para">
				Type <code class="literal">2</code> to exit the interactive console.
			</div></li></ol></div><div class="para"><div class="title">Result</div><p>
			Your keystore password has been masked for use in configuration files and deployments. In addition, your vault is fully configured and ready to use.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+5357-458811+%5BSpecified%5D&amp;comment=Title%3A+Mask+the+Keystore+Password+and+Initialize+the+Password+Vault%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5357-458811+11+Jun+2013+15%3A38+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_the_Enterprise_Application_Platform_to_Use_the_Password_Vault1" lang="en-US"><div class="titlepage"><div><div><h3 class="title">10.11.4. Configure JBoss EAP 6 to Use the Password Vault</h3></div></div></div><div class="para"><div class="title">Overview</div><p>
			Before you can mask passwords and other sensitive attributes in configuration files, you need to make JBoss EAP 6 aware of the password vault which stores and decrypts them. Follow this procedure to enable this functionality.
		</p></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul><li class="listitem"><div class="para">
				<a class="xref" href="#Create_a_Java_Keystore_to_Store_Sensitive_Strings">Section 10.11.2, “Create a Java Keystore to Store Sensitive Strings”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#Mask_the_Keystore_Password_and_Initialize_the_Password_Vault.">Section 10.11.3, “Mask the Keystore Password and Initialize the Password Vault”</a>
			</div></li></ul></div><div class="procedure"><p class="title"><strong>Procedure 10.6. Setup a Password Vault</strong></p><ol class="1"><li class="step"><p class="title"><strong>Determine the correct values for the command.</strong></p><div class="para">
				Determine the values for the following parameters, which are determined by the commands used to create the keystore itself. For information on creating a keystore, refer to the following topics: <a class="xref" href="#Create_a_Java_Keystore_to_Store_Sensitive_Strings">Section 10.11.2, “Create a Java Keystore to Store Sensitive Strings”</a> and <a class="xref" href="#Mask_the_Keystore_Password_and_Initialize_the_Password_Vault.">Section 10.11.3, “Mask the Keystore Password and Initialize the Password Vault”</a>.
			</div><div class="informaltable"><table class="lt-4-cols gt-7-rows"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707325966352" scope="col"> Parameter </th><th id="idm140707339675040" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140707325966352"> KEYSTORE_URL </td><td headers="idm140707339675040"> <div class="para">
								The file system path or URI of the keystore file, usually called something like <code class="literal">vault.keystore</code>
							</div>
							 </td></tr><tr><td headers="idm140707325966352"> KEYSTORE_PASSWORD </td><td headers="idm140707339675040"> <div class="para">
								The password used to access the keystore. This value should be masked.
							</div>
							 </td></tr><tr><td headers="idm140707325966352"> KEYSTORE_ALIAS </td><td headers="idm140707339675040"> <div class="para">
								The name of the keystore.
							</div>
							 </td></tr><tr><td headers="idm140707325966352"> SALT </td><td headers="idm140707339675040"> <div class="para">
								The salt used to encrypt and decrypt keystore values.
							</div>
							 </td></tr><tr><td headers="idm140707325966352"> ITERATION_COUNT </td><td headers="idm140707339675040"> <div class="para">
								The number of times the encryption algorithm is run.
							</div>
							 </td></tr><tr><td headers="idm140707325966352"> ENC_FILE_DIR </td><td headers="idm140707339675040"> <div class="para">
								The path to the directory from which the keystore commands are run. Typically the directory containing the password vault.
							</div>
							 </td></tr><tr><td headers="idm140707325966352"> host (managed domain only) </td><td headers="idm140707339675040"> <div class="para">
								The name of the host you are configuring
							</div>
							 </td></tr></tbody></table></div></li><li class="step"><p class="title"><strong>Use the Management CLI to enable the password vault.</strong></p><div class="para">
				Run one of the following commands, depending on whether you use a managed domain or standalone server configuration. Substitute the values in the command with the ones from the first step of this procedure.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					If you use Microsoft Windows Server, replace each <code class="literal">/</code> character in a filename or directory path with four <code class="literal">\</code> characters. This is because it should be two <code class="literal">\</code> characters, each escaped. This does not need to be done for other <code class="literal">/</code> characters.
				</div></div></div><ul class="stepalternatives">
				<li class="step"><p class="title"><strong>Managed Domain</strong></p><pre class="screen">
/host=<em class="replaceable">YOUR_HOST</em>/core-service=vault:add(vault-options=[("KEYSTORE_URL" =&gt; "<em class="replaceable">PATH_TO_KEYSTORE</em>"), ("KEYSTORE_PASSWORD" =&gt; "<em class="replaceable">MASKED_PASSWORD</em>"), ("KEYSTORE_ALIAS" =&gt; "<em class="replaceable">ALIAS</em>"), ("SALT" =&gt; "<em class="replaceable">SALT</em>"),("ITERATION_COUNT" =&gt; "<em class="replaceable">ITERATION_COUNT</em>"), ("ENC_FILE_DIR" =&gt; "<em class="replaceable">ENC_FILE_DIR</em>")])
</pre></li>
				 <li class="step"><p class="title"><strong>Standalone Server</strong></p><pre class="screen">
/core-service=vault:add(vault-options=[("KEYSTORE_URL" =&gt; "<em class="replaceable">PATH_TO_KEYSTORE</em>"), ("KEYSTORE_PASSWORD" =&gt; "<em class="replaceable">MASKED_PASSWORD</em>"), ("KEYSTORE_ALIAS" =&gt; "<em class="replaceable">ALIAS</em>"), ("SALT" =&gt; "<em class="replaceable">SALT</em>"),("ITERATION_COUNT" =&gt; "<em class="replaceable">ITERATION_COUNT</em>"), ("ENC_FILE_DIR" =&gt; "<em class="replaceable">ENC_FILE_DIR</em>")])
</pre></li>

			</ul><div class="para">
				The following is an example of the command with hypothetical values:
			</div><pre class="screen">
/core-service=vault:add(vault-options=[("KEYSTORE_URL" =&gt; "/home/user/vault/vault.keystore"), ("KEYSTORE_PASSWORD" =&gt; "MASK-3y28rCZlcKR"), ("KEYSTORE_ALIAS" =&gt; "vault"), ("SALT" =&gt; "12438567"),("ITERATION_COUNT" =&gt; "50"), ("ENC_FILE_DIR" =&gt; "/home/user/vault/")])
</pre></li></ol></div><div class="para"><div class="title">Result</div><p>
			JBoss EAP 6 is configured to decrypt masked strings using the password vault. To add strings to the vault and use them in your configuration, refer to the following topic: <a class="xref" href="#Store_and_Retrieve_Encrypted_Sensitive_Strings_in_the_Java_Keystore">Section 10.11.5, “Store and Retrieve Encrypted Sensitive Strings in the Java Keystore”</a>.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+5358-498084+%5BSpecified%5D&amp;comment=Title%3A+Configure+JBoss+EAP+6+to+Use+the+Password+Vault%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5358-498084+22+Aug+2013+10%3A21+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Store_and_Retrieve_Encrypted_Sensitive_Strings_in_the_Java_Keystore" lang="en-US"><div class="titlepage"><div><div><h3 class="title">10.11.5. Store and Retrieve Encrypted Sensitive Strings in the Java Keystore</h3></div></div></div><div class="para"><div class="title">Summary</div><p>
			Including passwords and other sensitive strings in plain-text configuration files is insecure. JBoss EAP 6 includes the ability to store and mask these sensitive strings in an encrypted keystore, and use masked values in configuration files.
		</p></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul><li class="listitem"><div class="para">
				<a class="xref" href="#Create_a_Java_Keystore_to_Store_Sensitive_Strings">Section 10.11.2, “Create a Java Keystore to Store Sensitive Strings”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#Mask_the_Keystore_Password_and_Initialize_the_Password_Vault.">Section 10.11.3, “Mask the Keystore Password and Initialize the Password Vault”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#Configure_the_Enterprise_Application_Platform_to_Use_the_Password_Vault1">Section 10.11.4, “Configure JBoss EAP 6 to Use the Password Vault”</a>
			</div></li><li class="listitem"><div class="para">
				The <code class="filename"><em class="replaceable">EAP_HOME</em>/bin/vault.sh</code> application needs to be accessible via a command-line interface.
			</div></li></ul></div><div class="procedure"><p class="title"><strong>Procedure 10.7. Setup the Java Keystore</strong></p><ol class="1"><li class="step"><p class="title"><strong>Run the <code class="command">vault.sh</code> command.</strong></p><div class="para">
				Run <code class="filename"><em class="replaceable">EAP_HOME</em>/bin/vault.sh</code>. Start a new interactive session by typing <code class="literal">0</code>.
			</div></li><li class="step"><p class="title"><strong>Enter the directory where encrypted files will be stored.</strong></p><div class="para">
				If you followed <a class="xref" href="#Create_a_Java_Keystore_to_Store_Sensitive_Strings">Section 10.11.2, “Create a Java Keystore to Store Sensitive Strings”</a>, your keystore is in a directory called <code class="filename">vault/</code> in your home directory. In most cases, it makes sense to store all of your encrypted information in the same place as the key store. This example uses the directory <code class="filename">/home/<em class="replaceable">USER</em>/vault/</code>.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					Do not forget to include the trailing slash on the directory name. Either use <code class="literal">/</code> or <code class="literal">\</code>, depending on your operating system.
				</div></div></div></li><li class="step"><p class="title"><strong>Enter the path to the keystore.</strong></p><div class="para">
				Enter the full path to the keystore file. This example uses <code class="filename">/home/<em class="replaceable">USER</em>/vault/vault.keystore</code>.
			</div></li><li class="step"><p class="title"><strong>Enter the keystore password, vault name, salt, and iteration count.</strong></p><div class="para">
				When prompted, enter the keystore password, vault name, salt, and iteration count. A handshake is performed.
			</div></li><li class="step"><p class="title"><strong>Select the option to store a password.</strong></p><div class="para">
				Select option <code class="literal">0</code> to store a password or other sensitive string.
			</div></li><li class="step"><p class="title"><strong>Enter the value.</strong></p><div class="para">
				When prompted, enter the value twice. If the values do not match, you are prompted to try again.
			</div></li><li class="step"><p class="title"><strong>Enter the vault block.</strong></p><div class="para">
				Enter the vault block, which is a container for attributes which pertain to the same resource. An example of an attribute name would be <code class="literal">ds_ExampleDS</code>. This will form part of the reference to the encrypted string, in your datasource or other service definition.
			</div></li><li class="step"><p class="title"><strong>Enter the attribute name.</strong></p><div class="para">
				Enter the name of the attribute you are storing. An example attribute name would be <code class="literal">password</code>.
			</div><div class="para"><div class="title">Result</div><p>
					A message such as the one below shows that the attribute has been saved.
				</p></div><pre class="screen">Attribute Value for (ds_ExampleDS, password) saved</pre></li><li class="step"><p class="title"><strong>Make note of the information about the encrypted string.</strong></p><div class="para">
				A message prints to standard output, showing the vault block, attribute name, shared key, and advice about using the string in your configuration. Make note of this information in a secure location. Example output is shown below.
			</div><pre class="screen">
********************************************
Vault Block:ds_ExampleDS
Attribute Name:password
Configuration should be done as follows:
VAULT::ds_ExampleDS::password::1
********************************************
</pre></li><li class="step"><p class="title"><strong>Use the encrypted string in your configuration.</strong></p><div class="para">
				Use the string from the previous step in your configuration, in place of a plain-text string. A datasource using the encrypted password above is shown below.
			</div><pre class="screen">
...
  &lt;subsystem xmlns="urn:jboss:domain:datasources:1.0"&gt;
    &lt;datasources&gt;
      &lt;datasource jndi-name="java:jboss/datasources/ExampleDS" enabled="true" use-java-context="true" pool-name="H2DS"&gt;
        &lt;connection-url&gt;jdbc:h2:mem:test;DB_CLOSE_DELAY=-1&lt;/connection-url&gt;
        &lt;driver&gt;h2&lt;/driver&gt;
        &lt;pool&gt;&lt;/pool&gt;
        &lt;security&gt;
          &lt;user-name&gt;sa&lt;/user-name&gt;
          &lt;password&gt;${VAULT::ds_ExampleDS::password::1}&lt;/password&gt;
        &lt;/security&gt;
      &lt;/datasource&gt;
      &lt;drivers&gt;
         &lt;driver name="h2" module="com.h2database.h2"&gt;
            &lt;xa-datasource-class&gt;org.h2.jdbcx.JdbcDataSource&lt;/xa-datasource-class&gt;
         &lt;/driver&gt;
      &lt;/drivers&gt;
    &lt;/datasources&gt;
  &lt;/subsystem&gt;
...
</pre><div class="para">
				You can use an encrypted string anywhere in your domain or standalone configuration file where expressions are allowed.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					To check if expressions are allowed within a particular subsystem, run the following CLI command against that subsystem:
				</div><pre class="programlisting">/host=master/core-service=management/security-realm=TestRealm:read-resource-description(recursive=true)</pre><div class="para">
					From the output of running this command, look for the value for the <code class="literal">expressions-allowed</code> parameter. If this is true, then you can use expressions within the configuration of this particular subsystem.
				</div></div></div><div class="para">
				After you store your string in the keystore, use the following syntax to replace any clear-text string with an encrypted one.
			</div><pre class="screen">${VAULT::&lt;replaceable&gt;VAULT_BLOCK&lt;/replaceable&gt;::&lt;replaceable&gt;ATTRIBUTE_NAME&lt;/replaceable&gt;::&lt;replaceable&gt;ENCRYPTED_VALUE&lt;/replaceable&gt;}</pre><div class="para">
				Here is a sample real-world value, where the vault block is <code class="literal">ds_ExampleDS</code> and the attribute is <code class="literal">password</code>.
			</div><pre class="screen">&lt;password&gt;${VAULT::ds_ExampleDS::password::1}&lt;/password&gt;</pre></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+5359-550324+%5BSpecified%5D&amp;comment=Title%3A+Store+and+Retrieve+Encrypted+Sensitive+Strings+in+the+Java+Keystore%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5359-550324+04+Nov+2013+10%3A50+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Store_and_Resolve_Sensitive_Strings_In_Your_Applications1" lang="en-US"><div class="titlepage"><div><div><h3 class="title">10.11.6. Store and Resolve Sensitive Strings In Your Applications</h3></div></div></div><div class="para"><div class="title">Overview</div><p>
			Configuration elements of JBoss EAP 6 support the ability to resolve encrypted strings against values stored in a Java Keystore, via the Security Vault mechanism. You can add support for this feature to your own applications.
		</p></div><div class="para">
		First, add the password to the vault. Second, replace the clear-text password with the one stored in the vault. You can use this method to obscure any sensitive string in your application.
	</div><div class="para"><div class="title">Prerequisites</div><p>
			Before performing this procedure, make sure that the directory for storing your vault files exists. It does not matter where you place them, as long as the user who executes JBoss EAP 6 has permission to read and write the files. This example places the <code class="filename">vault/</code> directory into the <code class="filename">/home/<em class="replaceable">USER</em>/vault/</code> directory. The vault itself is a file called <code class="filename">vault.keystore</code> inside the <code class="filename">vault/</code> directory.
		</p></div><div class="example" id="idm140707319466912"><p class="title"><strong>Example 10.11. Adding the Password String to the Vault</strong></p><div class="example-contents"><div class="para">
			Add the string to the vault using the <code class="filename"><em class="replaceable">EAP_HOME</em>/bin/vault.sh</code> command. The full series of commands and responses is included in the following screen output. Values entered by the user are emphasized. Some output is removed for formatting. In Microsoft Windows, the name of the command is <code class="filename">vault.bat</code>. Note that in Microsoft Windows, file paths use the <code class="literal">\</code> character as a directory separator, rather than the <code class="literal">/</code> character.
		</div><pre class="screen">
[user@host bin]$ ./vault.sh 
**********************************
****  JBoss Vault ********
**********************************
Please enter a Digit::   0: Start Interactive Session  1: Remove Interactive Session  2: Exit
<strong class="userinput"><code>0</code></strong>
Starting an interactive session
Enter directory to store encrypted files:<strong class="userinput"><code>/home/user/vault/</code></strong>
Enter Keystore URL:<strong class="userinput"><code>/home/user/vault/vault.keystore</code></strong>
Enter Keystore password: <strong class="userinput"><code>...</code></strong>
Enter Keystore password again: <strong class="userinput"><code>...</code></strong>
Values match
Enter 8 character salt:<strong class="userinput"><code>12345678</code></strong>
Enter iteration count as a number (Eg: 44):<strong class="userinput"><code>25</code></strong>

Enter Keystore Alias:<strong class="userinput"><code>vault</code></strong>
Vault is initialized and ready for use
Handshake with Vault complete
Please enter a Digit::   0: Store a password  1: Check whether password exists  2: Exit
<strong class="userinput"><code>0</code></strong>
Task:  Store a password
Please enter attribute value: <strong class="userinput"><code>sa</code></strong>
Please enter attribute value again: <strong class="userinput"><code>sa</code></strong>
Values match
Enter Vault Block:<strong class="userinput"><code>DS</code></strong>
Enter Attribute Name:<strong class="userinput"><code>thePass</code></strong>
Attribute Value for (DS, thePass) saved

Please make note of the following:
********************************************
Vault Block:DS
Attribute Name:thePass
Configuration should be done as follows:
VAULT::DS::thePass::1
********************************************

Please enter a Digit::   0: Store a password  1: Check whether password exists  2: Exit
<strong class="userinput"><code>2</code></strong></pre><div class="para">
			The string that will be added to the Java code is the last value of the output, the line beginning with <code class="literal">VAULT</code>.
		</div></div></div><div class="para">
		The following servlet uses the vaulted string instead of a clear-text password. The clear-text version is commented out so that you can see the difference.
	</div><div class="example" id="idm140707311910800"><p class="title"><strong>Example 10.12. Servlet Using a Vaulted Password</strong></p><div class="example-contents"><pre class="programlisting language-java JAVA JAVA">
package vaulterror.web;
 
import java.io.IOException;
import java.io.Writer;
 
import javax.annotation.Resource;
import javax.annotation.sql.DataSourceDefinition;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.sql.DataSource;
 
 
/*@DataSourceDefinition(
        name = "java:jboss/datasources/LoginDS",
        user = "sa",
        password = "sa",
        className = "org.h2.jdbcx.JdbcDataSource",
        url = "jdbc:h2:tcp://localhost/mem:test"
)*/
@DataSourceDefinition(
        name = "java:jboss/datasources/LoginDS",
        user = "sa",
        password = "VAULT::DS::thePass::1",
        className = "org.h2.jdbcx.JdbcDataSource",
        url = "jdbc:h2:tcp://localhost/mem:test"
)
@WebServlet(name = "MyTestServlet", urlPatterns = { "/my/" }, loadOnStartup = 1)
public class MyTestServlet  extends HttpServlet {
 
    private static final long serialVersionUID = 1L;
 
 
    @Resource(lookup = "java:jboss/datasources/LoginDS")
    private DataSource ds;
 
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        Writer writer = resp.getWriter();
        writer.write((ds != null) + "");
    }
}
</pre></div></div><div class="para">
		Your servlet is now able to resolve the vaulted string.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4930-550325+%5BSpecified%5D&amp;comment=Title%3A+Store+and+Resolve+Sensitive+Strings+In+Your+Applications%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4930-550325+04+Nov+2013+10%3A56+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div class="section" id="sect-LDAP"><div class="titlepage"><div><div><h2 class="title">10.12. LDAP</h2></div></div></div><div xml:lang="en-US" class="section" id="About_LDAP1" lang="en-US"><div class="titlepage"><div><div><h3 class="title">10.12.1. About LDAP</h3></div></div></div><div class="para">
		Lightweight Directory Access Protocol (LDAP) is a protocol for storing and distributing directory information across a network. This directory information includes information about users, hardware devices, access roles and restrictions, and other information.
	</div><div class="para">
		Some common implementations of LDAP include OpenLDAP, Microsoft Active Directory, IBM Tivoli Directory Server, Oracle Internet Directory, and others.
	</div><div class="para">
		JBoss EAP 6 includes several authentication and authorization modules which allow you to use a LDAP server as the authentication and authorization authority for your Web and EJB applications.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+7819-555585+%5BSpecified%5D&amp;comment=Title%3A+About+LDAP%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7819-555585+13+Nov+2013+18%3A18+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Use_LDAP_to_Authenticate_to_the_Management_Interfaces1" lang="en-US"><div class="titlepage"><div><div><h3 class="title">10.12.2. Use LDAP to Authenticate to the Management Interfaces</h3></div></div></div><div class="para">
		To use an LDAP directory server as the authentication source for the Management Console, Management CLI, or Management API, you need to perform the following procedures:
	</div><div class="orderedlist"><ol><li class="listitem"><div class="para">
				Create an outbound connection to the LDAP server.
			</div></li><li class="listitem"><div class="para">
				Create an LDAP-enabled security realm.
			</div></li><li class="listitem"><div class="para">
				Reference the new security domain in the Management Interface.
			</div></li></ol></div><div class="para"><div class="title">Create an Outbound Connection to an LDAP Server</div><p>
			The LDAP outbound connection allows the following attributes:
		</p></div><div class="table" id="idm140707321350288"><p class="title"><strong>Table 10.1. Attributes of an LDAP Outbound Connection</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="Attributes of an LDAP Outbound Connection"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707340160064" scope="col"> Attribute </th><th id="idm140707311718688" scope="col"> Required </th><th id="idm140707311718208" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140707340160064"> url </td><td headers="idm140707311718688"> yes </td><td headers="idm140707311718208"> <div class="para">
						The URL address of the directory server.
					</div>
					 </td></tr><tr><td headers="idm140707340160064"> search-dn </td><td headers="idm140707311718688"> yes </td><td headers="idm140707311718208"> <div class="para">
						The fully distinguished name (DN) of the user authorized to perform searches.
					</div>
					 </td></tr><tr><td headers="idm140707340160064"> search-credentials </td><td headers="idm140707311718688"> yes </td><td headers="idm140707311718208"> <div class="para">
						The password of the user authorized to perform searches.
					</div>
					 </td></tr><tr><td headers="idm140707340160064"> initial-context-factory </td><td headers="idm140707311718688"> no </td><td headers="idm140707311718208"> <div class="para">
						The initial context factory to use when establishing the connection. Defaults to <code class="code">com.sun.jndi.ldap.LdapCtxFactory</code>.
					</div>
					 </td></tr><tr><td headers="idm140707340160064"> security-realm </td><td headers="idm140707311718688"> no </td><td headers="idm140707311718208"> <div class="para">
						The security realm to reference to obtain a configured <code class="code">SSLContext</code> to use when establishing the connection.
					</div>
					 </td></tr></tbody></table></div></div><div class="example" id="idm140707330922048"><p class="title"><strong>Example 10.13. Add an LDAP Outbound Connection</strong></p><div class="example-contents"><div class="para">
			This example adds an outbound connection with the following properties set:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					Search DN: <code class="literal">cn=search,dc=acme,dc=com</code>
				</div></li><li class="listitem"><div class="para">
					Search Credential: <code class="literal">myPass</code>
				</div></li><li class="listitem"><div class="para">
					URL: <code class="literal">ldap://127.0.0.1:389</code>
				</div></li></ul></div><div class="para">
			The first command adds the security realm.
		</div><pre class="screen">/host=master/core-service=management/security-realm=ldap_security_realm:add</pre><div class="para">
			The second command adds the LDAP connection.
		</div><pre class="screen">/host=master/core-service=management/ldap-connection=ldap_connection/:add(search-credential=myPass,url=ldap://127.0.0.1:389,search-dn="cn=search,dc=acme,dc=com")</pre></div></div><div class="para"><div class="title">Create an LDAP-Enabled Security Realm</div><p>
			The Management Interfaces can authenticate against LDAP server instead of the property-file based security realms configured by default. The LDAP authenticator operates by first establishing a connection to the remote directory server. It then performs a search using the username which the user passed to the authentication system, to find the fully-qualified distinguished name (DN) of the LDAP record. A new connection is established, using the DN of the user as the credential, and password supplied by the user. If this authentication to the LDAP server is successful, the DN is verified to be valid.
		</p></div><div class="para">
		The LDAP security realm needs the following configuration attributes and elements in order to perform its functions.
	</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">connection</span></dt><dd><div class="para">
					The name of the connection defined in <code class="sgmltag-element">&lt;outbound-connections&gt;</code> to use to connect to the LDAP directory.
				</div></dd><dt><span class="term">base-dn</span></dt><dd><div class="para">
					The distinguished name of the context to begin searching for the user.
				</div></dd><dt><span class="term">recursive</span></dt><dd><div class="para">
					Whether the search should be recursive throughout the LDAP directory tree, or only search the specified context. Defaults to <code class="literal">false</code>.
				</div></dd><dt><span class="term">user-dn</span></dt><dd><div class="para">
					The attribute of the user that holds the distinguished name. This is subsequently used to test authentication as the user can complete. Defaults to <code class="literal">dn</code>.
				</div></dd><dt><span class="term">One of <code class="literal">username-filter</code> or <code class="literal">advanced-filter</code>, as a child element</span></dt><dd><div class="para">
					The <code class="literal">username-filter</code> takes a single attribute called <code class="literal">attribute</code>, whose value is the name of the LDAP attribute which holds the username, such as <code class="literal">userName</code> or <code class="literal">sambaAccountName</code>.
				</div><div class="para">
					The <code class="literal">advanced-filter</code> takes a single attribute called <code class="literal">filter</code>. This attribute contains a filter query in standard LDAP syntax. Be cautious to escape any <code class="literal">&amp;</code> characters by changing them to <code class="literal">&amp;amp;</code>. An example of a filter is:
				</div><pre class="screen"><code class="literal">(&amp;(sAMAccountName={0})(memberOf=cn=admin,cn=users,dc=acme,dc=com))</code></pre><div class="para">
					After escaping the ampersand character, the filter appears as:
				</div><pre class="screen"><code class="literal">(&amp;amp;(sAMAccountName={0})(memberOf=cn=admin,cn=users,dc=acme,dc=com))</code></pre></dd></dl></div><div class="example" id="idm140707318996704"><p class="title"><strong>Example 10.14. XML Representing an LDAP-enabled Security Realm</strong></p><div class="example-contents"><div class="para">
			This example uses the following parameters:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					connection - <code class="literal">ldap_connection</code>
				</div></li><li class="listitem"><div class="para">
					base-dn - <code class="literal">cn=users,dc=acme,dc=com</code>.
				</div></li><li class="listitem"><div class="para">
					username-filter - <code class="literal">attribute="sambaAccountName"</code>
				</div></li></ul></div><pre class="programlisting language-xml XML XML">
&lt;security-realm name="ldap_security_realm"&gt;
   &lt;authentication&gt;
      &lt;ldap connection="ldap_connection" base-dn="cn=users,dc=acme,dc=com"&gt;
         &lt;username-filter attribute="sambaAccountName" /&gt;
      &lt;/ldap&gt;
  &lt;/authentication&gt;
&lt;/security-realm&gt;	

</pre></div></div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
			It is important to ensure that you do not allow empty LDAP passwords; unless you specifically desire this in your environment, it is a serious security concern.
		</div><div class="para">
			EAP 6.1 includes a patch for CVE-2012-5629, which sets the allowEmptyPasswords option for the LDAP login modules to false if the option is not already configured. For older versions, this option should be configured manually
		</div></div></div><div class="example" id="idm140707316559072"><p class="title"><strong>Example 10.15. Add an LDAP Security Realm</strong></p><div class="example-contents"><div class="para">
			The command below adds a security realm and sets its attributes for a standalone server. 
		</div><pre class="screen">/host=master/core-service=management/security-realm=ldap_security_realm/authentication=ldap:add(base-dn="<em class="replaceable">DC=mycompany</em>,<em class="replaceable">DC=org</em>", recursive=true, username-attribute="<em class="replaceable">MyAccountName</em>", connection="ldap_connection")</pre></div></div><div class="para"><div class="title">Apply the New Security Realm to the Management Interface</div><p>
			After you create a security realm, you need to reference it in the configuration of your management interface. The management interface will use the security realm for HTTP digest authentication.
		</p></div><div class="example" id="idm140707315690080"><p class="title"><strong>Example 10.16. Apply the Security Realm to the HTTP Interface</strong></p><div class="example-contents"><div class="para">
			After this configuration is in place, and you restart the host controller, the web-based Management Console will use LDAP to authenticate its users.
		</div><pre class="screen">/host=master/core-service=management/management-interface=http-interface/:write-attribute(name=security-realm,value=ldap-security-realm)</pre></div></div><div class="para"><div class="title">Configure a Managed Domain Member to Authenticate using Microsoft Active Directory</div><p>
			To configure a host in a managed domain to authenticate to Microsoft Active Directory, follow this procedure, which creates a security domain and maps roles to Active Directory groups, using JAAS authentication. This procedure is required because Microsoft Active Directory allows binding with an empty password. This procedure prevents an empty password from being used within the application platform.
		</p></div><div class="para">
		Before performing this procedure, you need to know the name of your host controller. This example assumes the host controller is named <code class="literal">master</code>.
	</div><div class="procedure"><ol class="1"><li class="step"><p class="title"><strong>Add a new <code class="code">&lt;security-realm&gt;</code> named <code class="literal">ldap_security_realm</code>, and configure it to use JAAS.</strong></p><div class="para">
				The following Management CLI commands add the new security realm and set its authentication mechanism. Change the name of the host as required.
			</div><pre class="screen">/host=<em class="replaceable">master</em>/core-service=management/security-realm=ldap_security_realm/:add</pre><pre class="screen">/host=<em class="replaceable">master</em>/core-service=management/security-realm=ldap_security_realm/authentication=jaas/:add(name=managementLDAPDomain)</pre></li><li class="step"><p class="title"><strong>Configure the <code class="code">&lt;http-interface&gt;</code> to use the new security realm.</strong></p><div class="para">
				The following Management CLI command configures the HTTP interface.
			</div><pre class="screen">/host=<em class="replaceable">master</em>/core-service=management/management-interface=http-interface/:write-attribute(name=security-realm,value=ldap_security_realm)</pre></li><li class="step"><p class="title"><strong>Configure JBoss Enterprise Application Platform to add the custom JAAS configuration to its start-up parameters.</strong></p><div class="para">
				Edit the <code class="filename"><em class="replaceable">EAP_HOME</em>/bin/domain.conf</code> file. Search for the <code class="literal">HOST_CONTROLLER_JAVA_OPTS</code> variable. This is where you add directives for the JVM which are needed before JBoss Enterprise Application Platform starts. The following is an example of the default contents of this parameter:
			</div><pre class="screen">
HOST_CONTROLLER_JAVA_OPTS="$JAVA_OPTS"
</pre><div class="para">
				Add the following directive to the line: <code class="literal">-Djava.security.auth.login.config=/opt/jboss-eap-6.0/domain/configuration/jaas.conf"</code>
			</div><div class="para">
				The edited line is similar to the following:
			</div><pre class="screen">
-Djava.security.auth.login.config=/opt/jboss-eap-6.0/domain/configuration/jaas.conf"
</pre></li><li class="step"><p class="title"><strong>Add the login module to the module options.</strong></p><div class="para">
				In the same file, find the line containing the following:
			</div><pre class="screen">JBOSS_MODULES_SYSTEM_PKGS="org.jboss.byteman"</pre><div class="para">
				Change that line to read as follows. Make sure not to insert any extra spaces.
			</div><pre class="screen">JBOSS_MODULES_SYSTEM_PKGS="org.jboss.byteman,com.sun.security.auth.login"</pre><div class="para">
				Save and close the <code class="filename">domain.conf</code> file.
			</div></li><li class="step"><p class="title"><strong>Create the JAAS configuration which will be added to the classpath.</strong></p><div class="para">
				Create a new file at the following location: <code class="filename"><em class="replaceable">EAP_HOME</em>/domain/configuration/jaas.conf</code>
			</div><div class="para">
				The file should contain the following contents. Edit the parameters to match your own environment.
			</div><pre class="screen">
managementLDAPDomain {
    org.jboss.security.auth.spi.LdapExtLoginModule required
        java.naming.factory.initial="com.sun.jndi.ldap.LdapCtxFactory"
        java.naming.provider.url="<em class="replaceable">ldap://your_active_directory_host:389</em>"
        java.naming.security.authentication="<em class="replaceable">simple</em>"
        bindDN="<em class="replaceable">cn=Administrator,cn=users,dc=domain,dc=your_company,dc=com</em>"
        bindCredential="<em class="replaceable">password</em>"
        baseCtxDN="<em class="replaceable">cn=users,dc=domain,dc=redhat,dc=com</em>"
        baseFilter="<em class="replaceable">(&amp;(sAMAccountName={0})(|(memberOf=cn=Domain Guests,cn=Users,dc=domain,dc=acme,dc=com)(memberOf=cn=Domain Admins,cn=Users,dc=domain,dc=acme,dc=com)))</em>"
        allowEmptyPasswords="false"
        rolesCtxDN="<em class="replaceable">cn=users,dc=domain,dc=acme,dc=com</em>"
        roleFilter="<em class="replaceable">(cn=no such group)</em>"
        searchScope="<em class="replaceable">SUBTREE_SCOPE</em>";
};
</pre></li><li class="step"><div class="para">
				Restart JBoss Enterprise Application Platform and your HTTP interface uses your LDAP server for authentication.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+8429-555586+%5BSpecified%5D&amp;comment=Title%3A+Use+LDAP+to+Authenticate+to+the+Management+Interfaces%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=8429-555586+13+Nov+2013+18%3A19+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div></div><div xml:lang="en-US" class="chapter" id="chap-Securing_the_Management_Interfaces_with_Role-Based_Access_Control" lang="en-US"><div class="titlepage"><div><div><h2 class="title">Chapter 11. Securing the Management Interfaces with Role-Based Access Control</h2></div></div></div><div xml:lang="en-US" class="section" id="About_Role-Based_Access_Control_RBAC" lang="en-US"><div class="titlepage"><div><div><h2 class="title">11.1. About Role-Based Access Control (RBAC)</h2></div></div></div><div class="para"><p><!--Empty--></p>
		Role-Based Access Control (RBAC) is a mechanism for specifying a set of permissions for management users. It allows multiple users to share responsibility for managing JBoss EAP 6.2 servers without each of them requiring unrestricted access. By providing "separation of duties" for management users, JBoss EAP 6.2 makes it easy for an organization to spread responsibility between individuals or groups without granting unnecessary privileges. This ensures the maximum possible security of your servers and data while still providing flexibility for configuration, deployment, and management.
	</div><div class="para"><p><!--Empty--></p>
		Role-Based Access Control in JBoss EAP 6.2 works through a combination of role permissions and constraints.
	</div><div class="para"><p><!--Empty--></p>
		Seven predefined roles are provided that each have different fixed permissions. The predefined roles are: Monitor, Operator, Maintainer, Deployer, Auditor, Administrator, and SuperUser. Each management user is assigned one or more roles, what the user is permitted to do when managing the server is specified by their assigned roles.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+23145-550867+%5BSpecified%5D&amp;comment=Title%3A+About+Role-Based+Access+Control+%28RBAC%29%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=23145-550867+05+Nov+2013+18%3A19+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Role-Based_Access_Control_in_the_GUI_and_CLI" lang="en-US"><div class="titlepage"><div><div><h2 class="title">11.2. Role-Based Access Control in the GUI and CLI</h2></div></div></div><div class="para"><p><!--Empty--></p>
		When Role-Based Access Control(RBAC) is enabled, some users will not be able to run some operations, read from some resources or even be able to see parts of the management model at all, according to the roles assigned to them.
	</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">The Management Console</span></dt><dd><div class="para"><p><!--Empty--></p>
					In the management console some controls and views are disabled (greyed out) or not visible at all depending on the permissions of your assigned role.
				</div><div class="para"><p><!--Empty--></p>
					If you do not have read permissions to a resource attribute, that attribute will appear blank in the console. For example, most roles cannot read the username and password fields for datasources.
				</div><div class="para"><p><!--Empty--></p>
					If you do not have write permissions to a resource attribute, that attribute will be disabled (greyed-out) in the edit form for the resource. If you do not have write permissions to the resource at all, then the edit button for the resource will not appear.
				</div><div class="para"><p><!--Empty--></p>
					If you do not have permissions to access a resource or attribute at all (it is "unaddressable" for your role) then it does not appear in the console at all for you. An example of that is the access control system itself which is only visible to a few roles by default.
				</div></dd><dt><span class="term">The Management API</span></dt><dd><div class="para"><p><!--Empty--></p>
					Users that use the <code class="command">jboss-cli.sh</code> tool or use the API directly will encounter slightly different behaviour in the API when RBAC is enabled.
				</div><div class="para"><p><!--Empty--></p>
					Resources and attributes that cannot be read are filtered from results. If the filtered items are addressable by the role, their names are listed as <code class="code">filtered-attributes</code> in the <code class="code">response-headers</code> section of the result. If a resource or attribute is not addressable by the role, it is not listed at all.
				</div><div class="para"><p><!--Empty--></p>
					Attempting to access a resource that is not addressable will result in a "resource not found" error.
				</div><div class="para"><p><!--Empty--></p>
					If a user attempts to write or read a resource that they can address but lack the appropriate write or read permissions, a "Permission Denied" error is returned.
				</div></dd></dl></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+23148-550930+%5BSpecified%5D&amp;comment=Title%3A+Role-Based+Access+Control+in+the+GUI+and+CLI%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=23148-550930+06+Nov+2013+10%3A14+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Supported_Authentication_Schemes" lang="en-US"><div class="titlepage"><div><div><h2 class="title">11.3. Supported Authentication Schemes</h2></div></div></div><div class="para">
		Role-Based Access Control works with the standard authentication providers that are included with JBoss EAP 6.2. The standard authentication providers are: <code class="systemitem">username/password</code>, <code class="systemitem">client certificate</code>, and <code class="systemitem">local user</code>.
	</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Username/Password</span></dt><dd><div class="para"><p><!--Empty--></p>
					Users are authenticated using a username and password combination which is verified against either the <code class="filename">mgmt-users.properties</code> file, or an LDAP server.
				</div></dd><dt><span class="term">Client Certificate</span></dt><dd><div class="para"><p><!--Empty--></p>
					Using the Trust Store.
				</div></dd><dt><span class="term">Local User</span></dt><dd><div class="para"><p><!--Empty--></p>
					<code class="command">jboss-cli.sh</code> authenticates automatically as Local User if the server that is running on the same machine. By default Local User is a member of the <code class="systemitem">SuperUser</code> group.
				</div></dd></dl></div><div class="para">
		Regardless of which provider is used, JBoss EAP is responsible for the assignment of roles to users. However when authenticating with the <code class="filename">mgmt-users.properties</code> file or an LDAP server, those systems can supply user group information. This information can also be used by JBoss EAP to assign roles to users.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+23150-546770+%5BSpecified%5D&amp;comment=Title%3A+Supported+Authentication+Schemes%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=23150-546770+16+Oct+2013+17%3A26+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Supported_Roles" lang="en-US"><div class="titlepage"><div><div><h2 class="title">11.4. The Standard Roles</h2></div></div></div><div class="para"><p><!--Empty--></p>
		JBoss EAP 6 provides seven predefined user roles: Monitor, Operator, Maintainer, Deployer, Auditor, Administrator, and SuperUser. Each of these roles has a different set of permissions and is designed for specific use cases. The Monitor, Operator, Maintainer, Administrator, and SuperUser role each build upon each other, with each having more permissions than the previous. The Auditor and Deployer roles are similar to the Monitor and Maintainer roles respectively but have some additional special permissions and restrictions.
	</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Monitor</span></dt><dd><div class="para"><p><!--Empty--></p>
					Users of the Monitor role have the fewest permissions and can only read the current configuration and state of the server. This role is intended for users who need to track and report on the performance of the server.
				</div><div class="para"><p><!--Empty--></p>
					Monitors cannot modify server configuration nor can they access sensitive data or operations.
				</div></dd><dt><span class="term">Operator</span></dt><dd><div class="para"><p><!--Empty--></p>
					The Operator role extends the Monitor role by adding the ability to modify the runtime state of the server. This means that Operators can reload and shutdown the server as well as pause and resume JMS destinations. The Operator role is ideal for users who are responsible for the physical or virtual hosts of the application server so they can ensure that servers can be shutdown and restarted corrected when needed.
				</div><div class="para"><p><!--Empty--></p>
					Operators cannot modify server configuration or access sensitive data or operations.
				</div></dd><dt><span class="term">Maintainer</span></dt><dd><div class="para"><p><!--Empty--></p>
					The Maintainer role has access to view and modify runtime state and all configuration except sensitive data and operations. The Maintainer role is the general purpose role that doesn't have access to sensitive data and operation. The Maintainer role allows users to be granted almost complete access to administer the server without giving those users access to passwords and other sensitive information.
				</div><div class="para"><p><!--Empty--></p>
					Maintainers cannot access sensitive data or operations.
				</div></dd><dt><span class="term">Administrator</span></dt><dd><div class="para"><p><!--Empty--></p>
					The Administrator role has unrestricted access to all resources and operations on the server except the audit logging system. Administrator is the only role (except SuperUser) that has access to sensitive data and operations. This role can also configure the access control system. The Administrator role is only required when handling sensitive data or configuring users and roles.
				</div></dd></dl></div><div class="para"><p><!--Empty--></p>
		Administrators cannot access the audit logging system and cannot change themselves to the Auditor or SuperUser role.
	</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">SuperUser</span></dt><dd><div class="para"><p><!--Empty--></p>
					The SuperUser role has no restrictions and has complete access to all resources and operations of the server including the audit logging system. This role is equivalent to the administrator users of earlier versions of JBoss EAP 6 (6.0 and 6.1). If RBAC is disabled, all management users have permissions equivalent to the SuperUser role.
				</div></dd><dt><span class="term">Deployer</span></dt><dd><div class="para"><p><!--Empty--></p>
					The Deployer role has the same permissions as the Monitor, but can modify configuration and state for deployments and any other resource type enabled as an application resource.
				</div></dd><dt><span class="term">Auditor</span></dt><dd><div class="para"><p><!--Empty--></p>
					The Auditor role has all the permissions of the Monitor role and can also view (but not modify) sensitive data, and has full access to the audit logging system. The Auditor role is the only role other than SuperUser that can access the audit logging system.
				</div><div class="para"><p><!--Empty--></p>
					Auditors cannot modify sensitive data or resources. Only read access is permitted.
				</div></dd></dl></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+23151-546772+%5BSpecified%5D&amp;comment=Title%3A+The+Standard+Roles%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=23151-546772+16+Oct+2013+17%3A42+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Role_Permissions_Matrix" lang="en-US"><div class="titlepage"><div><div><h2 class="title">11.5. About Role Permissions</h2></div></div></div><div class="para">
		What each role is allowed to do is defined by what permissions it has. Not every role has every permission. Notably SuperUser has every permission and Monitor has the least.
	</div><div class="para">
		Each permission can grant read and/or write access for a single category of resources.
	</div><div class="para">
		The categories are: runtime state, server configuration, sensitive data, the audit log, and the access control system.
	</div><div class="para">
		<a class="xref" href="#table-role-permission-matrix">Table 11.1, “Role Permissions Matrix”</a> summarizes the permissions of each role.
	</div><div class="table" id="table-role-permission-matrix"><p class="title"><strong>Table 11.1. Role Permissions Matrix</strong></p><div class="table-contents"><table class="gt-4-cols gt-7-rows" summary="Role Permissions Matrix"><colgroup><col width="22%" class="col_1"><!--Empty--></col><col width="11%" class="col_2"><!--Empty--></col><col width="11%" class="col_3"><!--Empty--></col><col width="11%" class="col_4"><!--Empty--></col><col width="11%" class="col_5"><!--Empty--></col><col width="11%" class="col_6"><!--Empty--></col><col width="11%" class="col_7"><!--Empty--></col><col width="11%" class="col_8"><!--Empty--></col></colgroup><tbody><tr><td> </td><td> <div class="para"><p><!--Empty--></p>
						Monitor
					</div>
					 </td><td> <div class="para"><p><!--Empty--></p>
						Operator
					</div>
					 </td><td> <div class="para"><p><!--Empty--></p>
						Maintainer
					</div>
					 </td><td> <div class="para"><p><!--Empty--></p>
						Deployer
					</div>
					 </td><td> <div class="para"><p><!--Empty--></p>
						Auditor
					</div>
					 </td><td> <div class="para"><p><!--Empty--></p>
						Administrator
					</div>
					 </td><td> <div class="para"><p><!--Empty--></p>
						SuperUser
					</div>
					 </td></tr><tr><td> <div class="para"><p><!--Empty--></p>
						Read Config and State
					</div>
					 </td><td> <div class="para"><p><!--Empty--></p>
						X
					</div>
					 </td><td> <div class="para"><p><!--Empty--></p>
						X
					</div>
					 </td><td> <div class="para"><p><!--Empty--></p>
						X
					</div>
					 </td><td> <div class="para"><p><!--Empty--></p>
						X
					</div>
					 </td><td> <div class="para"><p><!--Empty--></p>
						X
					</div>
					 </td><td> <div class="para"><p><!--Empty--></p>
						X
					</div>
					 </td><td> <div class="para"><p><!--Empty--></p>
						X
					</div>
					 </td></tr><tr><td> <div class="para"><p><!--Empty--></p>
						Read Sensitive Data [2]
					</div>
					 </td><td> </td><td> </td><td> </td><td> </td><td> <div class="para"><p><!--Empty--></p>
						X
					</div>
					 </td><td> <div class="para"><p><!--Empty--></p>
						X
					</div>
					 </td><td> <div class="para"><p><!--Empty--></p>
						X
					</div>
					 </td></tr><tr><td> <div class="para"><p><!--Empty--></p>
						Modify Sensitive Data [2]
					</div>
					 </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> <div class="para"><p><!--Empty--></p>
						X
					</div>
					 </td><td> <div class="para"><p><!--Empty--></p>
						X
					</div>
					 </td></tr><tr><td> <div class="para"><p><!--Empty--></p>
						Read/Modify Audit Log
					</div>
					 </td><td> </td><td> </td><td> </td><td> </td><td> <div class="para"><p><!--Empty--></p>
						X
					</div>
					 </td><td> </td><td> <div class="para"><p><!--Empty--></p>
						X
					</div>
					 </td></tr><tr><td> <div class="para"><p><!--Empty--></p>
						Modify Runtime State
					</div>
					 </td><td> </td><td> <div class="para"><p><!--Empty--></p>
						X
					</div>
					 </td><td> <div class="para"><p><!--Empty--></p>
						X
					</div>
					 </td><td> <div class="para"><p><!--Empty--></p>
						X[1]
					</div>
					 </td><td> </td><td> <div class="para"><p><!--Empty--></p>
						X
					</div>
					 </td><td> <div class="para"><p><!--Empty--></p>
						X
					</div>
					 </td></tr><tr><td> <div class="para"><p><!--Empty--></p>
						Modify Persistent Config
					</div>
					 </td><td> </td><td> </td><td> <div class="para"><p><!--Empty--></p>
						X
					</div>
					 </td><td> <div class="para"><p><!--Empty--></p>
						X[1]
					</div>
					 </td><td> </td><td> <div class="para"><p><!--Empty--></p>
						X
					</div>
					 </td><td> <div class="para"><p><!--Empty--></p>
						X
					</div>
					 </td></tr><tr><td> <div class="para"><p><!--Empty--></p>
						Read/Modify Access Control
					</div>
					 </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> <div class="para"><p><!--Empty--></p>
						X
					</div>
					 </td><td> <div class="para"><p><!--Empty--></p>
						X
					</div>
					 </td></tr></tbody></table></div></div><div class="para">
		[1] permissions are restricted to application resources.
	</div><div class="para">
		[2] What resources are considered to be "sensitive data" are configured using Sensitivity Constraints.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+23154-549927+%5BSpecified%5D&amp;comment=Title%3A+About+Role+Permissions%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=23154-549927+31+Oct+2013+15%3A49+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Application_Resources" lang="en-US"><div class="titlepage"><div><div><h2 class="title">11.6. About Constraints</h2></div></div></div><div class="para"><p><!--Empty--></p>
		Constraints are named sets of access-control configuration for a specified list of resources. The RBAC system uses the combination of constraints and role permissions to determine if any specific user can perform a management action.
	</div><div class="para"><p><!--Empty--></p>
		Constraints are divided into two classifications: application, sensitivity.
	</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Application Constraints</span></dt><dd><div class="para"><p><!--Empty--></p>
					Application Constraints define sets of resources and attributes that can be accessed by users of the Deployer role. By default the only enabled Application Constraint is core which includes deployments, deployment overlays. Application Constraints are also included (but not enabled by default) for datasources, logging, mail, messaging, naming, resource-adapters and security. These constraints allow Deployer users to not only deploy applications but also configure and maintain the resources that are required by those applications.
				</div><div class="para"><p><!--Empty--></p>
					Application constraint configuration is in the Management API at <code class="code">/core-service=management/access=authorization/constraint=application-classification</code>.
				</div></dd><dt><span class="term">Sensitivity Constraints</span></dt><dd><div class="para"><p><!--Empty--></p>
					Sensitivity Constraints define sets of resources that are considered "sensitive". A sensitive resource is generally one that is either secret, like a password, or one that will have serious impact on the operation of the server, like networking, JVM configuration, or system properties. The access control system itself is also considered sensitive.
				</div><div class="para"><p><!--Empty--></p>
					The only roles permitted to write to sensitive resources are Administrator and SuperUser. The Auditor role is only able to read sensitive resources. No other roles have access.
				</div><div class="para"><p><!--Empty--></p>
					Sensitivity constraint configuration is in the Management API at <code class="code">/core-service=management/access=authorization/constraint=sensitivity-classification</code>.
				</div></dd><dt><span class="term">Vault Expression Constraint</span></dt><dd><div class="para"><p><!--Empty--></p>
					The Vault Expression constraint defines if reading or writing vault expressions is consider a sensitive operation. By default both reading and writing vault expressions is a sensitive operation.
				</div><div class="para"><p><!--Empty--></p>
					Vault Expression constraint configuration is in the Management API at <code class="code">/core-service=management/access=authorization/constraint=vault-expression</code>.
				</div></dd></dl></div><div class="para"><p><!--Empty--></p>
		Constraints can not be configured in the Management Console at this time.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+23146-549958+%5BSpecified%5D&amp;comment=Title%3A+About+Constraints%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=23146-549958+31+Oct+2013+17%3A13+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="About_JMX_and_Role-Based_Access_Control" lang="en-US"><div class="titlepage"><div><div><h2 class="title">11.7. About JMX and Role-Based Access Control</h2></div></div></div><div class="para"><p><!--Empty--></p>
		Role-Based Access Control applies to JMX in three ways:
	</div><div class="orderedlist"><ol><li class="listitem"><div class="para"><p><!--Empty--></p>
				The Management API of JBoss EAP 6 is exposed as JMX Management Beans. These Management Beans are referred to as "core mbeans" and access to them is controlled and filtered exactly the same as the underlying Management API itself.
			</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
				The JMX subsystem is configured with write permissions being "sensitive". This means only users of the Administrator and SuperUser roles can make changes to that subsystem. Users of the Auditor role can also read this subsystem configuration.
			</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
				By default Management Beans registered by deployed applications and services (non-core mbeans) can be accessed by all management users, but only users of the Maintainer, Operator, Administrator, SuperUser roles can write to them.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24168-547075+%5BSpecified%5D&amp;comment=Title%3A+About+JMX+and+Role-Based+Access+Control%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24168-547075+17+Oct+2013+14%3A45+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div class="section" id="sect-Configuring_Role-Based_Access_Control"><div class="titlepage"><div><div><h2 class="title">11.8. Configuring Role-Based Access Control</h2></div></div></div><div xml:lang="en-US" class="section" id="Overview_of_RBAC_Configuration_Tasks" lang="en-US"><div class="titlepage"><div><div><h3 class="title">11.8.1. Overview of RBAC Configuration Tasks</h3></div></div></div><div class="para">
		When RBAC is enabled only users of the Administration or SuperUser role can view and make changes to the Access Control system.
	</div><div class="para">
		The Management Console provides an interface for the following common RBAC tasks:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				View and configure what roles are assigned to (or excluded from) each user
			</div></li><li class="listitem"><div class="para">
				View and configure what roles are assigned to (or excluded from) each group
			</div></li><li class="listitem"><div class="para">
				View group and user membership per role.
			</div></li><li class="listitem"><div class="para">
				Configure default membership per role.
			</div></li><li class="listitem"><div class="para">
				Create a scoped role
			</div></li></ul></div><div class="para">
		The CLI provides access to the complete access control system. This means that everything that can be done in the management console can be done there, but also a number of additional tasks can be performed with the CLI that cannot be done with the access control system.
	</div><div class="para">
		The following additional tasks can be performed in the CLI:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				Enable and disable RBAC
			</div></li><li class="listitem"><div class="para">
				Change permission combination policy
			</div></li><li class="listitem"><div class="para">
				Configuring Application Resource and Resource Sensitivity Constraints
			</div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+23748-550077+%5BSpecified%5D&amp;comment=Title%3A+Overview+of+RBAC+Configuration+Tasks%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=23748-550077+01+Nov+2013+10%3A34+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Enabling_Role-Based_Access_Control" lang="en-US"><div class="titlepage"><div><div><h3 class="title">11.8.2. Enabling Role-Based Access Control</h3></div></div></div><div class="para">
		By default the Role-Based Access Control (RABC) system is disabled. It is enabled by changing the provider attribute from <code class="literal">simple</code> to <code class="literal">rbac</code>. This can be done using the <code class="command">jboss-cli.sh</code> tool or by editing the server configuration XML file if the server is off-line. When RBAC is disabled or enabled on a running server, the server configuration must be reloaded before it takes effect.
	</div><div class="para">
		Once enabled it can only be disabled by a user of the Administrator or SuperUser roles. By default the <code class="command">jboss-cli.sh</code> runs as the SuperUser role if it is run on the same machine as the server.
	</div><div class="procedure"><p class="title"><strong>Procedure 11.1. Enabling RBAC</strong></p><ul><li class="step"><div class="para">
				To enable RBAC with <code class="command">jboss-cli.sh</code> use the <code class="command">write-attribute</code> operation of the access authorization resource to set the provider attribute to <code class="literal">rbac</code>.
			</div><pre class="synopsis">/core-service=management/access=authorization:write-attribute(name=provider, value=rbac)</pre><pre class="screen">[standalone@localhost:9999 /] /core-service=management/access=authorization:write-attribute(name=provider, value=rbac)
{
    "outcome" =&gt; "success",
    "response-headers" =&gt; {
        "operation-requires-reload" =&gt; true,
        "process-state" =&gt; "reload-required"
    }
}
[standalone@localhost:9999 /] /:reload
{
    "outcome" =&gt; "success",
    "result" =&gt; undefined
}
[standalone@localhost:9999 /]</pre></li></ul></div><div class="procedure"><p class="title"><strong>Procedure 11.2. Disabling RBAC</strong></p><ul><li class="step"><div class="para">
				To disable RBAC with <code class="command">jboss-cli.sh</code> use the <code class="command">write-attribute</code> operation of the access authorization resource to set the provider attribute to <code class="literal">simple</code>.
			</div><pre class="synopsis">/core-service=management/access=authorization:write-attribute(name=provider, value=simple)</pre><pre class="screen">[standalone@localhost:9999 /] /core-service=management/access=authorization:write-attribute(name=provider, value=simple)
{
    "outcome" =&gt; "success",
    "response-headers" =&gt; {
        "operation-requires-reload" =&gt; true,
        "process-state" =&gt; "reload-required"
    }
}
[standalone@localhost:9999 /] /:reload
{
    "outcome" =&gt; "success",
    "result" =&gt; undefined
}
[standalone@localhost:9999 /]</pre></li></ul></div><div class="para">
		If the server is off-line the XML configuration can be edited to enabled or disable RBAC. To do this, edit the <code class="code">provider</code> attribute of the access-control element of the management element. Set the value to <code class="literal">rbac</code> to enable, and <code class="literal">simple</code> to disable.
	</div><pre class="programlisting language-xml">&lt;management&gt;

        &lt;access-control provider="rbac"&gt;
            &lt;role-mapping&gt;
                &lt;role name="SuperUser"&gt;
                    &lt;include&gt;
                        &lt;user name="$local"/&gt;
                    &lt;/include&gt;
                &lt;/role&gt;
            &lt;/role-mapping&gt;
        &lt;/access-control&gt;

    &lt;/management&gt;</pre><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+23749-546778+%5BSpecified%5D&amp;comment=Title%3A+Enabling+Role-Based+Access+Control%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=23749-546778+16+Oct+2013+17%3A57+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Changing_the_Permission_Combination_Policy" lang="en-US"><div class="titlepage"><div><div><h3 class="title">11.8.3. Changing the Permission Combination Policy</h3></div></div></div><div class="para">
		Permission Combination Policy determines how permissions are determined if a user is assigned more than one role. This can be set to <code class="literal">permissive</code> or <code class="literal">rejecting</code>. The default is <code class="literal">permissive</code>.
	</div><div class="para">
		When set to <code class="literal">permissive</code>, if any role is assigned to the user that permits an action, then the action is allowed.
	</div><div class="para">
		When set to <code class="literal">rejecting</code>, if multiple roles are assigned to a user that permit an action, then the action is <span class="emphasis"><em>not</em></span> allowed.
	</div><div class="para">
		When the policy is set to rejecting each user should only be assigned one role. Users with multiple roles will not be able to use the management console or <code class="command">jboss-cli.sh</code> tool when the policy is set to <code class="literal">rejecting</code>.
	</div><div class="para">
		The Permission Combination Policy is configured by setting the <code class="code">permission-combination-policy</code> attribute to either <code class="literal">permissive</code> or <code class="literal">rejecting</code>. This can be done using the <code class="command">jboss-cli.sh</code> tool or by editing the server configuration XML file if the server is off-line.
	</div><div class="procedure"><p class="title"><strong>Procedure 11.3. Set the Permission Combination Policy</strong></p><ul><li class="step"><div class="para">
				Use the <code class="code">write-attribute</code> operation of the access authorization resource to set the <code class="code">permission-combination-policy</code> attribute to the required policy name.
			</div><pre class="synopsis">/core-service=management/access=authorization:write-attribute(name=permission-combination-policy, value=<em class="replaceable">POLICYNAME</em>)</pre><div class="para">
				The valid policy names are rejecting and permissive.
			</div><pre class="screen">[standalone@localhost:9999 /] /core-service=management/access=authorization:write-attribute(name=permission-combination-policy, value=rejecting)
{"outcome" =&gt; "success"}
[standalone@localhost:9999 access=authorization]
</pre></li></ul></div><div class="para">
		If the server is off-line the XML configuration can be edited to change the permission combination policy value. To do this, edit the <code class="code">permission-combination-policy</code> attribute of the access-control element.
	</div><pre class="programlisting language-xml">&lt;access-control provider="rbac" permission-combination-policy="rejecting"&gt;
  &lt;role-mapping&gt;
    &lt;role name="SuperUser"&gt;
      &lt;include&gt;
        &lt;user name="$local"/&gt;
      &lt;/include&gt;
    &lt;/role&gt;
  &lt;/role-mapping&gt;
&lt;/access-control&gt;</pre><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+23750-546775+%5BSpecified%5D&amp;comment=Title%3A+Changing+the+Permission+Combination+Policy%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=23750-546775+16+Oct+2013+17%3A55+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div class="section" id="sect-Managing_Roles"><div class="titlepage"><div><div><h2 class="title">11.9. Managing Roles</h2></div></div></div><div xml:lang="en-US" class="section" id="About_Role_Membership" lang="en-US"><div class="titlepage"><div><div><h3 class="title">11.9.1. About Role Membership</h3></div></div></div><div class="para"><p><!--Empty--></p>
		When Role-Based Access Control (RBAC) is enabled, what a management user is permitted to do is determined by the roles that the user is assigned to. JBoss EAP 6.2 uses a system of includes and excludes based on both the user and group membership to determine what role a user belongs to.
	</div><div class="para"><p><!--Empty--></p>
		A user is considered to be assigned to a role if:
	</div><div class="orderedlist"><ol><li class="listitem"><div class="para"><p><!--Empty--></p>
				The user is:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
						listed as a user to be included in the role, or
					</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
						a member of a group that is listed to be included in the role.
					</div></li></ul></div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
				The user is not:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
						listed as a user to exclude from the role, or
					</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
						a member of a group that is listed to be excluded from the role.
					</div></li></ul></div></li></ol></div><div class="para"><p><!--Empty--></p>
		Exclusions take priority over inclusions.
	</div><div class="para"><p><!--Empty--></p>
		Role include and exclude settings for users and groups can be configured using both the Management Console and the <code class="command">jboss-cli.sh</code> tool.
	</div><div class="para"><p><!--Empty--></p>
		Only users of the SuperUser or Administrator roles can perform this configuration.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+23751-546311+%5BSpecified%5D&amp;comment=Title%3A+About+Role+Membership%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=23751-546311+15+Oct+2013+15%3A50+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_User_Role_Assignment_using_the_Management_Console" lang="en-US"><div class="titlepage"><div><div><h3 class="title">11.9.2. Configure User Role Assignment</h3></div></div></div><div class="para">
		Roles for a user to be included in and excluded from can be configured in the Management Console and the <code class="command">jboss-cli.sh</code> tool. This topic only shows using the Management Console.
	</div><div class="para">
		Only users in the SuperUser or Administrator roles can perform this configuration.
	</div><div class="para"><p><!--Empty--></p>
		The User roles configuration in the management console can be found by following these steps:
	</div><div class="orderedlist"><ol><li class="listitem"><div class="para"><p><!--Empty--></p>
				Login to the Management Console.
			</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
				Click on the Administration tab.
			</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
				Expand the Access Control item on the left and select Role Assignment.
			</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
				Select the USERS tab.
			</div></li></ol></div><div class="figure" id="idm140707312508272"><div class="figure-contents"><div class="mediaobject"><img src="/webassets/avalon/d/JBoss_Enterprise_Application_Platform_Common_Criteria_Certification-6.2.2-Security_Guide-en-US/images/2ed5568fcd3f1e90bf5a61f89ae377c3/4141.png" width="640" alt="Screenshot of User Role Management in the Management Console" /></div></div><p class="title"><strong>Figure 11.1. User Role Management in the Management Console</strong></p></div><div class="procedure"><p class="title"><strong>Procedure 11.4. Create a new role assignment for a user</strong></p><ol class="1"><li class="step"><div class="para">
				Login to the Management console.
			</div></li><li class="step"><div class="para">
				Navigate to the Users tab of the Role Assignment section.
			</div></li><li class="step"><div class="para">
				Click the Add button at the top right of the user list. Add User dialog appears.
			</div><div class="figure" id="idm140707312921376"><div class="figure-contents"><div class="mediaobject"><img src="/webassets/avalon/d/JBoss_Enterprise_Application_Platform_Common_Criteria_Certification-6.2.2-Security_Guide-en-US/images/5239efb0052b04ffcfe7fe10e8fb7163/4215.png" alt="Screenshot of Add User Dialog" /></div></div><p class="title"><strong>Figure 11.2. Add User Dialog</strong></p></div></li><li class="step"><div class="para">
				Specify user name, and optionally realm.
			</div></li><li class="step"><div class="para">
				Set the type menu to include or exclude.
			</div></li><li class="step"><div class="para">
				Click the checkbox of the roles to include or exclude. You can use the Control key (Command key on OSX) to check multiple items.
			</div></li><li class="step"><div class="para">
				Click save.
			</div><div class="para">
				When successful, the Add User dialog closes, and the list of users is updated to reflect the changes made. If unsuccessful a "Failed to save role assignment" message is displayed.
			</div></li></ol></div><div class="procedure"><p class="title"><strong>Procedure 11.5. Update the role assignment for a user</strong></p><ol class="1"><li class="step"><div class="para">
				Login to the Management console.
			</div></li><li class="step"><div class="para">
				Navigate to the Users tab of the Role Assignment section.
			</div></li><li class="step"><div class="para">
				Select user from the list.
			</div></li><li class="step"><div class="para">
				Click Edit. The selection panel enters edit mode.
			</div><div class="figure" id="idm140707318436560"><div class="figure-contents"><div class="mediaobject"><img src="/webassets/avalon/d/JBoss_Enterprise_Application_Platform_Common_Criteria_Certification-6.2.2-Security_Guide-en-US/images/c6938c3c5cc1a14ba95a44594dd84595/4216.png" alt="Screenshot of Selection Edit View" /></div></div><p class="title"><strong>Figure 11.3. Selection Edit View</strong></p></div><div class="para">
				Here you can add and remove assigned and excluded roles for the user.
			</div><div class="orderedlist"><ol><li class="listitem"><div class="para"><p><!--Empty--></p>
						To add an assigned role, select the required role from the list of available roles on the left and click button with the right-facing arrow next to the assigned roles list. The role moves from the available list to the assigned list.
					</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
						To remove an assigned role, selected the required role from the assigned roles list on the right and click the button with the left-facing arrow next to the assigned roles list. The role moves from the assigned list to the available list.
					</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
						To add an excluded role, select the required role from the list of available roles on the left and click button with the right-facing arrow next to the excluded roles list. The role moves from the available list to the excluded list.
					</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
						To remove an excluded role, selected the required role from the excluded roles list on the right and click the button with the left-facing arrow next to the excluded roles list. The role moves from the excluded list to the available list.
					</div></li></ol></div></li><li class="step"><div class="para">
				Click save.
			</div><div class="para">
				When successful, the edit view closes, and the list of users is updated to reflect the changes made. If unsuccessful a "Failed to save role assignment" message is displayed.
			</div></li></ol></div><div class="procedure"><p class="title"><strong>Procedure 11.6. Remove role assignment for a user</strong></p><ol class="1"><li class="step"><div class="para">
				Login to the Management console.
			</div></li><li class="step"><div class="para">
				Navigate to the Users tab of the Role Assignment section.
			</div></li><li class="step"><div class="para">
				Select the user from list.
			</div></li><li class="step"><div class="para">
				Click the Remove button. The Remove Role Assignment confirmation prompt appears.
			</div></li><li class="step"><div class="para">
				Click the Confirm button.
			</div><div class="para">
				When successful, the user will no longer appear in the list of user role assignments.
			</div></li></ol></div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
			Removing the user from the list of role assignments does not remove the user from the system, nor does it guarantee that no roles will be assigned to the user. Roles might still be assigned from group membership.
		</div></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+23745-556862+%5BSpecified%5D&amp;comment=Title%3A+Configure+User+Role+Assignment%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=23745-556862+20+Nov+2013+12%3A58+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_User_Role_Assignment_using_jboss-cli.sh" lang="en-US"><div class="titlepage"><div><div><h3 class="title">11.9.3. Configure User Role Assignment using jboss-cli.sh</h3></div></div></div><div class="para">
		Roles for a user to be included in and excluded from can be configured in the Management Console and the <code class="command">jboss-cli.sh</code> tool. This topic only shows using the <code class="command">jboss-cli.sh</code> tool.
	</div><div class="para">
		The configuration of mapping users and groups to roles is located in the management API at: <code class="code">/core-service=management/access=authorization</code> as <code class="code">role-mapping</code> elements.
	</div><div class="para">
		Only users of the SuperUser or Administrator roles can perform this configuration.
	</div><div class="procedure"><p class="title"><strong>Procedure 11.7. Viewing Role Assignment Configuration</strong></p><ol class="1"><li class="step"><div class="para">
				Use the :read-children-names operation to get a complete list of the configured roles:
			</div><pre class="synopsis">/core-service=management/access=authorization:read-children-names(child-type=role-mapping)</pre><pre class="screen">[standalone@localhost:9999 access=authorization] :read-children-names(child-type=role-mapping)
{
    "outcome" =&gt; "success",
    "result" =&gt; [
        "ADMINISTRATOR",
        "DEPLOYER",
        "MAINTAINER",
        "MONITOR",
        "OPERATOR",
        "SuperUser"
    ]
}</pre></li><li class="step"><div class="para">
				Use the <code class="code">read-resource</code> operation of a specified role-mapping to get the full details of a specific role:
			</div><pre class="synopsis">/core-service=management/access=authorization/role-mapping=<em class="replaceable">ROLENAME</em>:read-resource(recursive=true)</pre><pre class="screen">[standalone@localhost:9999 access=authorization] ./role-mapping=ADMINISTRATOR:read-resource(recursive=true)
{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "include-all" =&gt; false,
        "exclude" =&gt; undefined,
        "include" =&gt; {
            "user-theboss" =&gt; {
                "name" =&gt; "theboss",
                "realm" =&gt; undefined,
                "type" =&gt; "USER"
            },
            "user-harold" =&gt; {
                "name" =&gt; "harold",
                "realm" =&gt; undefined,
                "type" =&gt; "USER"
            },
            "group-SysOps" =&gt; {
                "name" =&gt; "SysOps",
                "realm" =&gt; undefined,
                "type" =&gt; "GROUP"
            }
        }
    }
}
[standalone@localhost:9999 access=authorization]</pre></li></ol></div><div class="procedure"><p class="title"><strong>Procedure 11.8. Add a new role</strong></p><div class="para">
			This procedure shows how to add a role-mapping entry for a role. This must be done before the role can be configured.
		</div><ul><li class="step"><div class="para">
				Use the <code class="command">add</code> operation to add a new role configuration.
			</div><pre class="synopsis">/core-service=management/access=authorization/role-mapping=<em class="replaceable">ROLENAME</em>:add</pre><div class="para">
				<em class="replaceable">ROLENAME</em> is the name of the role that the new mapping is for.
			</div><pre class="screen">[standalone@localhost:9999 access=authorization] ./role-mapping=AUDITOR:add             
{"outcome" =&gt; "success"}
[standalone@localhost:9999 access=authorization]</pre></li></ul></div><div class="procedure"><p class="title"><strong>Procedure 11.9. Add a user as included in a role</strong></p><div class="para">
			This procedure shows how to add a user to the included list of a role.
		</div><div class="para">
			If no configuration for a role has been done, then a role-mapping entry for it must be done first.
		</div><ul><li class="step"><div class="para">
				Use the <code class="command">add</code> operation to add a user entry to the includes list of the role.
			</div><pre class="synopsis">/core-service=management/access=authorization/role-mapping=<em class="replaceable">ROLENAME</em>/include=<em class="replaceable">ALIAS</em>:add(name=<em class="replaceable">USERNAME</em>, type=USER)</pre><div class="para">
				<em class="replaceable">ROLENAME</em> is the name of the role being configured.
			</div><div class="para">
				<code class="code">ALIAS</code> is a unique name for this mapping. Red Hat recommends that you use a naming convention for your aliases such as <code class="code">user-<em class="replaceable">USERNAME</em></code>.
			</div><div class="para">
				<em class="replaceable">USERNAME</em> is the name of the user being added to the include list.
			</div><pre class="screen"> [standalone@localhost:9999 access=authorization] ./role-mapping=AUDITOR/include=user-max:add(name=max, type=USER)
{"outcome" =&gt; "success"}
[standalone@localhost:9999 access=authorization]</pre></li></ul></div><div class="procedure"><p class="title"><strong>Procedure 11.10. Add a user as excluded in a role</strong></p><div class="para">
			This procedure shows how to add a user to the excluded list of a role.
		</div><div class="para">
			If no configuration for a role has been done, then a role-mapping entry for it must be done first.
		</div><ul><li class="step"><div class="para">
				Use the <code class="command">add</code> operation to add a user entry to the excludes list of the role.
			</div><pre class="synopsis">/core-service=management/access=authorization/role-mapping=<em class="replaceable">ROLENAME</em>/exclude=<em class="replaceable">ALIAS</em>:add(name=<em class="replaceable">USERNAME</em>, type=USER)</pre><div class="para">
				<em class="replaceable">ROLENAME</em> is the name of the role being configured.
			</div><div class="para">
				<em class="replaceable">USERNAME</em> is the name of the user being added to the exclude list.
			</div><div class="para">
				<code class="code">ALIAS</code> is a unique name for this mapping. Red Hat recommends that you use a naming convention for your aliases such as <code class="code">user-<em class="replaceable">USERNAME</em></code>.
			</div><pre class="screen">[standalone@localhost:9999 access=authorization] ./role-mapping=AUDITOR/exclude=user-max:add(name=max, type=USER)
{"outcome" =&gt; "success"}
[standalone@localhost:9999 access=authorization]</pre></li></ul></div><div class="procedure"><p class="title"><strong>Procedure 11.11. Remove user role include configuration</strong></p><div class="para">
			This procedure shows how to remove a user include entry from a role mapping.
		</div><ul><li class="step"><div class="para">
				Use the <code class="command">remove</code> operation to remove the entry.
			</div><pre class="synopsis">/core-service=management/access=authorization/role-mapping=<em class="replaceable">ROLENAME</em>/include=<em class="replaceable">ALIAS</em>:remove</pre><div class="para">
				<em class="replaceable">ROLENAME</em> is the name of the role being configured
			</div><div class="para">
				<code class="code">ALIAS</code> is a unique name for this mapping. Red Hat recommends that you use a naming convention for your aliases such as <code class="code">user-<em class="replaceable">USERNAME</em></code>.
			</div><pre class="screen">[standalone@localhost:9999 access=authorization] ./role-mapping=AUDITOR/include=user-max:remove
{"outcome" =&gt; "success"}
[standalone@localhost:9999 access=authorization]</pre><div class="para">
				Removing the user from the list of includes does not remove the user from the system, nor does it guarantee that the role won't be assigned to the user. The role might still be assigned based on group membership.
			</div></li></ul></div><div class="procedure"><p class="title"><strong>Procedure 11.12. Remove user role exclude configuration</strong></p><div class="para">
			This procedure shows how to remove an user exclude entry from a role mapping.
		</div><ul><li class="step"><div class="para">
				Use the <code class="command">remove</code> operation to remove the entry.
			</div><pre class="synopsis">/core-service=management/access=authorization/role-mapping=<em class="replaceable">ROLENAME</em>/exclude=<em class="replaceable">ALIAS</em>:remove</pre><div class="para">
				<em class="replaceable">ROLENAME</em> is the name of the role being configured.
			</div><div class="para">
				<code class="code">ALIAS</code> is a unique name for this mapping. Red Hat recommends that you use a naming convention for your aliases such as <code class="code">user-<em class="replaceable">USERNAME</em></code>.
			</div><pre class="screen">[standalone@localhost:9999 access=authorization] ./role-mapping=AUDITOR/exclude=user-max:remove
{"outcome" =&gt; "success"}
[standalone@localhost:9999 access=authorization]</pre><div class="para">
				Removing the user from the list of excludes does not remove the user from the system, nor does it guarantee the role will be assigned to the user. Roles might still be excluded based on group membership.
			</div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+23746-549875+%5BSpecified%5D&amp;comment=Title%3A+Configure+User+Role+Assignment+using+jboss-cli.sh%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=23746-549875+31+Oct+2013+13%3A31+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="About_Roles_and_User_Groups" lang="en-US"><div class="titlepage"><div><div><h3 class="title">11.9.4. About Roles and User Groups</h3></div></div></div><div class="para">
		Users authenticated using either the <code class="filename">mgmt-users.properties</code> file or an LDAP server, can be members of user groups. A user group is an arbitrary label that can be assigned to one or more users.
	</div><div class="para">
		The RBAC system can be configured to automatically assign roles to users depending on what user groups they are members of. It can also exclude users from roles based on group membership.
	</div><div class="para">
		When using the <code class="filename">mgmt-users.properties</code> file, group information is stored in the <code class="filename">mgmt-groups.properties</code> file. When using LDAP the group information is stored in the LDAP sever and maintained by those responsible for the LDAP server.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24191-547371+%5BSpecified%5D&amp;comment=Title%3A+About+Roles+and+User+Groups%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24191-547371+17+Oct+2013+17%3A21+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_Group_Role_Assignment_with_the_Management_Console" lang="en-US"><div class="titlepage"><div><div><h3 class="title">11.9.5. Configure Group Role Assignment</h3></div></div></div><div class="para">
		Roles can be assigned to a user based on the user's membership of a user group.
	</div><div class="para">
		Groups to be included or excluded from a role can be configured in the Management Console and the <code class="command">jboss-cli.sh</code> tool. This topic only shows using the Management Console.
	</div><div class="para">
		Only users in the SuperUser or Administrator roles can perform this configuration.
	</div><div class="para">
		The Group roles configuration in the management console can be found by following these steps:
	</div><div class="orderedlist"><ol><li class="listitem"><div class="para">
				Login to the Management Console.
			</div></li><li class="listitem"><div class="para">
				Click on the Administration tab.
			</div></li><li class="listitem"><div class="para">
				Expand the Access Control item on the left and select Role Assignment.
			</div></li><li class="listitem"><div class="para">
				Select the GROUPS tab.
			</div></li></ol></div><div class="figure" id="idm140707340158864"><div class="figure-contents"><div class="mediaobject"><img src="/webassets/avalon/d/JBoss_Enterprise_Application_Platform_Common_Criteria_Certification-6.2.2-Security_Guide-en-US/images/01edeaef23b045bd83890a6561b435f1/4139.png" width="640" alt="Screenshot of Group Role Management in the Management Console" /></div></div><p class="title"><strong>Figure 11.4. Group Role Management in the Management Console</strong></p></div><div class="procedure"><p class="title"><strong>Procedure 11.13. Create a new role assignment for a group</strong></p><ol class="1"><li class="step"><div class="para">
				Login to the Management console
			</div></li><li class="step"><div class="para">
				Navigate to the GROUPS tab of the Role Assignment section.
			</div></li><li class="step"><div class="para">
				Click the Add button at the top right of the user list. Add Group dialog appears
			</div><div class="figure" id="idm140707317461696"><div class="figure-contents"><div class="mediaobject"><img src="/webassets/avalon/d/JBoss_Enterprise_Application_Platform_Common_Criteria_Certification-6.2.2-Security_Guide-en-US/images/a0b45fd0a99be9bb9a0eaa9746bb0517/4218.png" alt="Screenshot of Add Group dialog" /></div></div><p class="title"><strong>Figure 11.5. Add Group Dialog</strong></p></div></li><li class="step"><div class="para">
				Specify the group name, and optionally the realm.
			</div></li><li class="step"><div class="para">
				Set the type menu to include or exclude.
			</div></li><li class="step"><div class="para">
				Click the checkbox of the roles to include or exclude. You can use the Control key (Command key on OSX) to check multiple items.
			</div></li><li class="step"><div class="para">
				Click save.
			</div><div class="para">
				When successful, the Add Group dialog closes, and the list of groups is updated to reflect the changes made. If unsuccessful a "Failed to save role assignment" message is displayed.
			</div></li></ol></div><div class="procedure"><p class="title"><strong>Procedure 11.14. Update a role assignment for a group</strong></p><ol class="1"><li class="step"><div class="para">
				Login to the Management console.
			</div></li><li class="step"><div class="para">
				Navigate to the GROUPS tab of the Role Assignment section.
			</div></li><li class="step"><div class="para">
				Select the group from the list.
			</div></li><li class="step"><div class="para">
				Click Edit. The Selection view enters Edit mode.
			</div><div class="figure" id="idm140707318948048"><div class="figure-contents"><div class="mediaobject"><img src="/webassets/avalon/d/JBoss_Enterprise_Application_Platform_Common_Criteria_Certification-6.2.2-Security_Guide-en-US/images/659a9142a18c9345551e1641a533e1de/4219.png" alt="Screenshot of Selection View in Edit Mode" /></div></div><p class="title"><strong>Figure 11.6. Selection View Edit Mode</strong></p></div><div class="para">
				Here you can add and remove assigned and excluded roles from the group:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						To add assigned role, select the required role from the list of available roles on the left and click button with the right-facing arrow next to the assigned roles list. The role moves from the available list to the assigned list.
					</div></li><li class="listitem"><div class="para">
						To remove an assigned role, selected the required role from the assigned roles list on the right and click the button with the left-facing arrow next to the assigned roles list. The role moves from the assigned list to the available list.
					</div></li><li class="listitem"><div class="para">
						To add an excluded role, select the required role from the list of available roles on the left and click button with the right-facing arrow next to the excluded roles list. The role moves from the available list to the excluded list.
					</div></li><li class="listitem"><div class="para">
						To remove an excluded role, selected the required role from the excluded roles list on the right and click the button with the left-facing arrow next to the excluded roles list. The role moves from the excluded list to the available list.
					</div></li></ul></div></li><li class="step"><div class="para">
				Click save.
			</div><div class="para">
				When successful, the edit view closes, and the list of groups is updated to reflect the changes made. If unsuccessful a "Failed to save role assignment" message is displayed.
			</div></li></ol></div><div class="procedure"><p class="title"><strong>Procedure 11.15. Remove role assignment for a group</strong></p><ol class="1"><li class="step"><div class="para">
				Login to the Management console.
			</div></li><li class="step"><div class="para">
				Navigate to the GROUPS tab of the Role Assignment section.
			</div></li><li class="step"><div class="para">
				Select the group from list.
			</div></li><li class="step"><div class="para">
				Click the Remove button. The Remove Role Assignment confirmation prompt appears.
			</div></li><li class="step"><div class="para">
				Click the Confirm button.
			</div><div class="para">
				When successful, the role will no longer appear in the list of user role assignments.
			</div><div class="para">
				Removing the group from the list of role assignments does not remove the user group from the system, nor does it guarantee that no roles will be assigned to members of that group. Each group member might still have a role assigned to them directly.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+23747-556865+%5BSpecified%5D&amp;comment=Title%3A+Configure+Group+Role+Assignment%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=23747-556865+20+Nov+2013+13%3A04+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_Group_Role_Assignment_with_jboss-cli.sh" lang="en-US"><div class="titlepage"><div><div><h3 class="title">11.9.6. Configure Group Role Assignment with jboss-cli.sh</h3></div></div></div><div class="para">
		Groups to be included or excluded from a role can be configured in the Management Console and the <code class="command">jboss-cli.sh</code> tool. This topic only shows using the <code class="command">jboss-cli.sh</code> tool.
	</div><div class="para">
		The configuration of mapping users and groups to roles is located in the management API at: <code class="code">/core-service=management/access=authorization</code> as role-mapping elements.
	</div><div class="para">
		Only users in the SuperUser or Administrator roles can perform this configuration.
	</div><div class="procedure"><p class="title"><strong>Procedure 11.16. Viewing Group Role Assignment Configuration</strong></p><ol class="1"><li class="step"><div class="para">
				Use the <code class="code">read-children-names</code> operation to get a complete list of the configured roles:
			</div><pre class="synopsis">/core-service=management/access=authorization:read-children-names(child-type=role-mapping)</pre><pre class="screen">[standalone@localhost:9999 access=authorization] :read-children-names(child-type=role-mapping)
{
    "outcome" =&gt; "success",
    "result" =&gt; [
        "ADMINISTRATOR",
        "DEPLOYER",
        "MAINTAINER",
        "MONITOR",
        "OPERATOR",
        "SuperUser"
    ]
}</pre></li><li class="step"><div class="para">
				Use the <code class="code">read-resource</code> operation of a specified role-mapping to get the full details of a specific role:
			</div><pre class="synopsis">/core-service=management/access=authorization/role-mapping=<em class="replaceable">ROLENAME</em>:read-resource(recursive=true)</pre><pre class="screen">[standalone@localhost:9999 access=authorization] ./role-mapping=ADMINISTRATOR:read-resource(recursive=true)
{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "include-all" =&gt; false,
        "exclude" =&gt; undefined,
        "include" =&gt; {
            "user-theboss" =&gt; {
                "name" =&gt; "theboss",
                "realm" =&gt; undefined,
                "type" =&gt; "USER"
            },
            "user-harold" =&gt; {
                "name" =&gt; "harold",
                "realm" =&gt; undefined,
                "type" =&gt; "USER"
            },
            "group-SysOps" =&gt; {
                "name" =&gt; "SysOps",
                "realm" =&gt; undefined,
                "type" =&gt; "GROUP"
            }
        }
    }
}
[standalone@localhost:9999 access=authorization]</pre></li></ol></div><div class="procedure"><p class="title"><strong>Procedure 11.17. Add a new role</strong></p><div class="para">
			This procedure shows how to add a role-mapping entry for a role. This must be done before the role can be configured.
		</div><ul><li class="step"><div class="para">
				Use the <code class="command">add</code> operation to add a new role configuration.
			</div><pre class="synopsis">/core-service=management/access=authorization/role-mapping=<em class="replaceable">ROLENAME</em>:add</pre><pre class="screen">[standalone@localhost:9999 access=authorization] ./role-mapping=AUDITOR:add             
{"outcome" =&gt; "success"}
[standalone@localhost:9999 access=authorization]</pre></li></ul></div><div class="procedure"><p class="title"><strong>Procedure 11.18. Add a Group as included in a role</strong></p><div class="para">
			This procedure shows how to add a Group to the included list of a role.
		</div><div class="para">
			If no configuration for a role has been done, then a role-mapping entry for it must be done first.
		</div><ul><li class="step"><div class="para">
				Use the <code class="command">add</code> operation to add a Group entry to the includes list of the role.
			</div><pre class="synopsis">/core-service=management/access=authorization/role-mapping=<em class="replaceable">ROLENAME</em>/include=<em class="replaceable">ALIAS</em>:add(name=<em class="replaceable">GROUPNAME</em>, type=GROUP)</pre><div class="para">
				<em class="replaceable">ROLENAME</em> is the name of the role being configured.
			</div><div class="para">
				<em class="replaceable">GROUPNAME</em> is the name of the group being added to the include list.
			</div><div class="para">
				<code class="code">ALIAS</code> is a unique name for this mapping. Red Hat recommends that you use a naming convention for your aliases such as <code class="code">group-<em class="replaceable">GROUPNAME</em></code>.
			</div><pre class="screen">[standalone@localhost:9999 access=authorization] ./role-mapping=AUDITOR/include=group-investigators:add(name=investigators, type=GROUP)
{"outcome" =&gt; "success"}
[standalone@localhost:9999 access=authorization]</pre></li></ul></div><div class="procedure"><p class="title"><strong>Procedure 11.19. Add a group as excluded in a role</strong></p><div class="para">
			This procedure shows how to add a group to the excluded list of a role.
		</div><div class="para">
			If no configuration for a role has been done, then a role-mapping entry for it must be created first.
		</div><ul><li class="step"><div class="para">
				Use the <code class="command">add</code> operation to add a group entry to the excludes list of the role.
			</div><pre class="synopsis">/core-service=management/access=authorization/role-mapping=<em class="replaceable">ROLENAME</em>/exclude=<em class="replaceable">ALIAS</em>:add(name=<em class="replaceable">GROUPNAME</em>, type=GROUP)</pre><div class="para">
				<em class="replaceable">ROLENAME</em> is the name of the role being configured
			</div><div class="para">
				<em class="replaceable">GROUPNAME</em> is the name of the group being added to the include list
			</div><div class="para">
				<code class="code">ALIAS</code> is a unique name for this mapping. Red Hat recommends that you use a naming convention for your aliases such as <code class="code">group-<em class="replaceable">GROUPNAME</em></code>.
			</div><pre class="screen">[standalone@localhost:9999 access=authorization] ./role-mapping=AUDITOR/exclude=group-supervisors:add(name=supervisors, type=USER)
{"outcome" =&gt; "success"}
[standalone@localhost:9999 access=authorization]</pre></li></ul></div><div class="procedure"><p class="title"><strong>Procedure 11.20. Remove group role include configuration</strong></p><div class="para">
			This procedure shows how to remove a group include entry from a role mapping.
		</div><ul><li class="step"><div class="para">
				Use the <code class="command">remove</code> operation to remove the entry.
			</div><pre class="synopsis">/core-service=management/access=authorization/role-mapping=<em class="replaceable">ROLENAME</em>/include=<em class="replaceable">ALIAS</em>:remove</pre><div class="para">
				<em class="replaceable">ROLENAME</em> is the name of the role being configured
			</div><div class="para">
				<code class="code">ALIAS</code> is a unique name for this mapping. Red Hat recommends that you use a naming convention for your aliases such as <code class="code">group-<em class="replaceable">GROUPNAME</em></code>.
			</div><pre class="screen">[standalone@localhost:9999 access=authorization] ./role-mapping=AUDITOR/include=group-investigators:remove
{"outcome" =&gt; "success"}
[standalone@localhost:9999 access=authorization]</pre><div class="para">
				Removing the group from the list of includes does not remove the group from the system, nor does it guarantee that the role won't be assigned to users in this group. The role might still be assigned to users in the group individually.
			</div></li></ul></div><div class="procedure"><p class="title"><strong>Procedure 11.21. Remove a user group exclude entry</strong></p><div class="para">
			This procedure shows how to remove a group exclude entry from a role mapping.
		</div><ul><li class="step"><div class="para">
				Use the <code class="command">remove</code> operation to remove the entry.
			</div><pre class="synopsis">/core-service=management/access=authorization/role-mapping=<em class="replaceable">ROLENAME</em>/exclude=<em class="replaceable">ALIAS</em>:remove</pre><div class="para">
				<em class="replaceable">ROLENAME</em> is the name of the role being configured.
			</div><div class="para">
				<code class="code">ALIAS</code> is a unique name for this mapping. Red Hat recommends that you use a naming convention for your aliases such as <code class="code">group-<em class="replaceable">GROUPNAME</em></code>.
			</div><pre class="screen">[standalone@localhost:9999 access=authorization] ./role-mapping=AUDITOR/exclude=group-supervisors:remove
{"outcome" =&gt; "success"}
[standalone@localhost:9999 access=authorization]</pre><div class="para">
				Removing the group from the list of excludes does not remove the group from the system. It also does not guarantee the role will be assigned to members of the group. Roles might still be excluded based on group membership.
			</div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+23744-549881+%5BSpecified%5D&amp;comment=Title%3A+Configure+Group+Role+Assignment+with+jboss-cli.sh%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=23744-549881+31+Oct+2013+13%3A53+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="About_Authorization_and_Group_Loading_with_LDAP" lang="en-US"><div class="titlepage"><div><div><h3 class="title">11.9.7. About Authorization and Group Loading with LDAP</h3></div></div></div><div class="para"><p><!--Empty--></p>
		Within the LDAP directory it is expected that there are entries for the user accounts and that there are entries for the groups, these are then cross referenced by the use of attributes. The attributes used to cross reference between the two could be a reference from the user account over to the group entry or an attribute on the group referencing the users that are members of the group. On some servers both forms of cross reference exist.
	</div><div class="para"><p><!--Empty--></p>
		It is also common that a user would be authenticating against the server using a simple user name, when it comes to searching for the group membership information depending on the directory server in use searches could be performed using this simple name or it could be performed using the distinguished name of the users entry in the directory.
	</div><div class="para"><p><!--Empty--></p>
		The authentication step of a user connecting to the server would always happen first, only once it has been decided that the user is successfully authenticated does the server move onto loading a users groups. As the authentication step and the authorization step both use a connection to the LDAP server the realm contains an optimization that any connection used for authentication will be reused for the group loading step. As will be shown within the configuration steps below it is possible to define rules within the authorization section to convert a users simple user name to their distinguished name, this is potentially duplicating a search that would have occurred during the authentication step so if a user name to distinguished name search has already been performed the result of that search is cached and reused without requiring a repeat.
	</div><pre class="programlisting language-xml">&lt;authorization&gt;
    &lt;ldap connection="..."&gt;
       &lt;username-to-dn&gt; &lt;!-- OPTIONAL --&gt;
           &lt;!-- Only one of the following. --&gt;
           &lt;username-is-dn /&gt;
           &lt;username-filter base-dn="..." recursive="..." user-dn-attribute="..." attribute="..." /&gt;
           &lt;advanced-filter base-dn="..." recursive="..." user-dn-attribute="..." filter="..." /&gt;
        &lt;/username-to-dn&gt;
       &lt;group-search group-name="..." iterative="..." group-dn-attribute="..." group-name-attribute="..." &gt;
           &lt;!-- One of the following --&gt;
           &lt;group-to-principal base-dn="..." recursive="..." search-by="..."&gt;
               &lt;membership-filter principal-attribute="..." /&gt;
           &lt;/group-to-principal&gt;
           &lt;principal-to-group group-attribute="..." /&gt;
       &lt;/group-search&gt;
    &lt;/ldap&gt;
&lt;/authorization&gt;</pre><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para"><p><!--Empty--></p>
			Some of these examples specify attributes are using the default values. They are shown here for clarity. Attributes that contain the default values are removed from the configuration when it is persisted by the server.
		</div></div></div><h4 id="idm140707315349920"> username-to-dn </h4><div class="para"><p><!--Empty--></p>
		As mentioned above there may sometimes be a need to define within the authorization configuration how to map from the user name supplied by the user being authenticated to the distinguished name of their entry within the LDAP directory. The <code class="code">username-to-dn</code> element is how this is defined, this element is only required if both of the following are true:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
				The authentication step was not against LDAP.
			</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
				The group searching is using the distinguished name during the searching.
			</div></li></ul></div><div class="para"><p><!--Empty--></p>
		Do try and keep the first bullet point in mind, as you read the examples below this will feel as though the authentication configuration is being duplicated and it is true that it is - if you are only using LDAP for authentication this is not required as the distinguished name will be obtained during authentication.
	</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">1:1 username-to-dn</span></dt><dd><div class="para"><p><!--Empty--></p>
					This is the most basic form of the configuration and is used to specify that the user name entered by the remote user is actually the users distinguished name.
				</div><pre class="programlisting language-xml">&lt;username-to-dn&gt;
   &lt;username-is-dn /&gt;
&lt;/username-to-dn&gt;</pre><div class="para"><p><!--Empty--></p>
					As this is defining a 1:1 mapping there is no additional configuration possible.
				</div></dd><dt><span class="term">username-filter</span></dt><dd><div class="para"><p><!--Empty--></p>
					The next option is very similar to the simple option described above for the authentication step, quite simply an attribute is specified that is searched for a match against the supplied user name.
				</div><pre class="programlisting language-xml">&lt;username-to-dn&gt;
    &lt;username-filter base-dn="dc=people,dc=harold,dc=example,dc=com" recursive="false" attribute="sn" user-dn-attribute="dn" /&gt;
&lt;/username-to-dn&gt;</pre><div class="para"><p><!--Empty--></p>
					The attributes that can be set here are:
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							<code class="code">base-dn</code>: The distinguished name of the context to begin the search.
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							<code class="code">recursive</code>: Whether the search will extend to sub contexts. Defaults to <code class="literal">false</code>.
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							<code class="code">attribute</code>: The attribute of the users entry to try and match against the supplied user name. Defaults to <code class="literal">uid</code>.
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							<code class="code">user-dn-attribute</code>: The attribute to read to obtain the users distinguished name. Defaults to <code class="literal">dn</code>.
						</div></li></ul></div></dd><dt><span class="term">advanced-filter</span></dt><dd><div class="para"><p><!--Empty--></p>
					The final option is to specify an advanced filter, as in the authentication section this is an opportunity to use a custom filter to locate the users distinguished name.
				</div><pre class="programlisting language-xml">&lt;username-to-dn&gt;
    &lt;advanced-filter base-dn="dc=people,dc=harold,dc=example,dc=com" recursive="false" filter="sAMAccountName={0}" user-dn-attribute="dn" /&gt;
&lt;/username-to-dn&gt;</pre><div class="para"><p><!--Empty--></p>
					For the attributes that match the ones in the <span class="emphasis"><em>username-filter</em></span> the meaning and default values are the same so I will not list them here again, this leaves one new attribute:
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							<code class="code">filter</code>: Custom filter used to search for a users entry where the user name will be substituted in the <code class="literal">{0}</code> place holder.
						</div></li></ul></div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para"><p><!--Empty--></p>
						The XML must remain valid after the filter is defined so if any special characters are used such as <code class="code">&amp;</code> ensure the proper form is used. For example <code class="code">&amp;amp;</code> for the <code class="code">&amp;</code> character.
					</div></div></div></dd></dl></div><h4 id="idm140707325572256"> The Group Search </h4><div class="para"><p><!--Empty--></p>
		As described above there are two different styles that can be used when searching for group membership information. The first style is where the user's entry contains an attribute that references the groups the user is a member of. The second style is where the group contains an attribute referencing the users entry.
	</div><div class="para"><p><!--Empty--></p>
		When there is a choice of which style to use Red Hat recommends that the configuration for a user's entry referencing the group is used. This is because with this method group information can be loaded by reading attributes of known distinguished names without having to perform any searches. The other approach requires extensive searches to identify the groups that reference the user.
	</div><div class="para"><p><!--Empty--></p>
		Before describing the configuration here are a couple of LDIF examples to illustrate this.
	</div><div class="example" id="idm140707337603136"><p class="title"><strong>Example 11.1. Principal to Group - LDIF example.</strong></p><div class="example-contents"><div class="para"><p><!--Empty--></p>
			This example illustrates where we have a user <code class="literal">TestUserOne</code> who is a member of <code class="literal">GroupOne</code>, <code class="literal">GroupOne</code> is then in-turn a member of <code class="literal">GroupFive</code>. The group membership is shown by the use of a <code class="code">memberOf</code> attribute which is set to the distinguished name of the group the user (or group) is a member of.
		</div><div class="para"><p><!--Empty--></p>
			It is not shown here but a user could potentially have multiple <code class="code">memberOf</code> attributes set, one for each group the user is directly a member of.
		</div><pre class="programlisting">dn: uid=TestUserOne,ou=users,dc=principal-to-group,dc=example,dc=org
objectClass: extensibleObject
objectClass: top
objectClass: groupMember
objectClass: inetOrgPerson
objectClass: uidObject
objectClass: person
objectClass: organizationalPerson
cn: Test User One
sn: Test User One
uid: TestUserOne
distinguishedName: uid=TestUserOne,ou=users,dc=principal-to-group,dc=example,dc=org
memberOf: uid=GroupOne,ou=groups,dc=principal-to-group,dc=example,dc=org
memberOf: uid=Slashy/Group,ou=groups,dc=principal-to-group,dc=example,dc=org
userPassword:: e1NTSEF9WFpURzhLVjc4WVZBQUJNbEI3Ym96UVAva0RTNlFNWUpLOTdTMUE9PQ==

dn: uid=GroupOne,ou=groups,dc=principal-to-group,dc=example,dc=org
objectClass: extensibleObject
objectClass: top
objectClass: groupMember
objectClass: group
objectClass: uidObject
uid: GroupOne
distinguishedName: uid=GroupOne,ou=groups,dc=principal-to-group,dc=example,dc=org
memberOf: uid=GroupFive,ou=subgroups,ou=groups,dc=principal-to-group,dc=example,dc=org

dn: uid=GroupFive,ou=subgroups,ou=groups,dc=principal-to-group,dc=example,dc=org
objectClass: extensibleObject
objectClass: top
objectClass: groupMember
objectClass: group
objectClass: uidObject
uid: GroupFive
distinguishedName: uid=GroupFive,ou=subgroups,ou=groups,dc=principal-to-group,dc=example,dc=org</pre></div></div><div class="example" id="idm140707339066096"><p class="title"><strong>Example 11.2. Group to Principal - LDIF Example</strong></p><div class="example-contents"><div class="para"><p><!--Empty--></p>
			This example shows the same user <code class="literal">TestUserOne</code> who is a member of <code class="literal">GroupOne</code> which is in turn a member of <code class="literal">GroupFive</code> - however in this case it is an attribute <code class="code">uniqueMember</code> from the group to the user being used for the cross reference.
		</div><div class="para"><p><!--Empty--></p>
			Again the attribute used for the group membership cross reference can be repeated, if you look at <span class="emphasis"><em>GroupFive</em></span> there is also a reference to another user <span class="emphasis"><em>TestUserFive</em></span> which is not shown here.
		</div><pre class="programlisting">dn: uid=TestUserOne,ou=users,dc=group-to-principal,dc=example,dc=org
objectClass: top
objectClass: inetOrgPerson
objectClass: uidObject
objectClass: person
objectClass: organizationalPerson
cn: Test User One
sn: Test User One
uid: TestUserOne
userPassword:: e1NTSEF9SjR0OTRDR1ltaHc1VVZQOEJvbXhUYjl1dkFVd1lQTmRLSEdzaWc9PQ==

dn: uid=GroupOne,ou=groups,dc=group-to-principal,dc=example,dc=org
objectClass: top
objectClass: groupOfUniqueNames
objectClass: uidObject
cn: Group One
uid: GroupOne
uniqueMember: uid=TestUserOne,ou=users,dc=group-to-principal,dc=example,dc=org

dn: uid=GroupFive,ou=subgroups,ou=groups,dc=group-to-principal,dc=example,dc=org
objectClass: top
objectClass: groupOfUniqueNames
objectClass: uidObject
cn: Group Five
uid: GroupFive
uniqueMember: uid=TestUserFive,ou=users,dc=group-to-principal,dc=example,dc=org
uniqueMember: uid=GroupOne,ou=groups,dc=group-to-principal,dc=example,dc=org</pre></div></div><h4 id="idm140707311436416"> General Group Searching </h4><div class="para"><p><!--Empty--></p>
		Before looking at the examples for the two approaches shown above we first need to define the attributes common to both of these.
	</div><pre class="programlisting language-xml">&lt;group-search group-name="..." iterative="..." group-dn-attribute="..." group-name-attribute="..." &gt;
    ...
&lt;/group-search&gt;</pre><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
				<code class="code">group-name</code>: This attribute is used to specify the form that should be used for the group name returned as the list of groups the user is a member of, this can either be the simple form of the group name or the groups distinguished name, if the distinguished name is required this attribute can be set to <code class="literal">DISTINGUISHED_NAME</code>. Defaults to <code class="literal">SIMPLE</code>.
			</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
				<code class="code">iterative</code>: This attribute is used to indicate if after identifying the groups a user is a member of we should also iteratively search based on the groups to identify which groups the groups are a member of. If iterative searching is enabled we keep going until either we reach a group that is not a member if any other groups or a cycle is detected. Defaults to <code class="literal">false</code>.
			</div></li></ul></div><div class="para"><p><!--Empty--></p>
		Cyclic group membership is not a problem. A record of each search is kept to prevent groups that have already been searched from being searched again.
	</div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para"><p><!--Empty--></p>
			For iterative searching to work the group entries need to look the same as user entries, that is the same approach used to identify the groups a user is a member of is then used to identify the groups the group is a member of. This would not be possible if say once we are talking about group to group membership the name of the attribute used for the cross reference changes or if the direction of the reference changes.
		</div></div></div><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
				<code class="code">group-dn-attribute</code>: On an entry for a group which attribute is it's distinguished name. Defaults to <code class="literal">dn</code>.
			</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
				<code class="code">group-name-attribute</code>: On an entry for a group which attribute is it's simple name. Defaults to <code class="literal">uid</code>.
			</div></li></ul></div><div class="example" id="idm140707312734800"><p class="title"><strong>Example 11.3. Principal to Group Example Configuration</strong></p><div class="example-contents"><div class="para"><p><!--Empty--></p>
			Based on the example LDIF from above here is an example configuration iteratively loading a users groups where the attribute used to cross reference is the <code class="code">memberOf</code> attribute on the user.
		</div><pre class="programlisting language-xml">&lt;authorization&gt;
    &lt;ldap connection="LocalLdap"&gt;
        &lt;username-to-dn&gt;
            &lt;username-filter base-dn="ou=users,dc=principal-to-group,dc=example,dc=org" recursive="false" attribute="uid" user-dn-attribute="dn" /&gt;
        &lt;/username-to-dn&gt;
        &lt;group-search group-name="SIMPLE" iterative="true" group-dn-attribute="dn" group-name-attribute="uid"&gt;
            &lt;principal-to-group group-attribute="memberOf" /&gt;
        &lt;/group-search&gt;
    &lt;/ldap&gt;
&lt;/authorization&gt;</pre></div></div><div class="para"><p><!--Empty--></p>
		The most important aspect of this configuration is that the <code class="code">principal-to-group</code> element has been added with a single attribute.
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
				<code class="code">group-attribute</code>: The name of the attribute on the user entry that matches the distinguished name of the group the user is a member of. Defaults to <code class="literal">memberOf</code>.
			</div></li></ul></div><div class="example" id="idm140707317456880"><p class="title"><strong>Example 11.4. Group to Principal Example Configuration</strong></p><div class="example-contents"><div class="para"><p><!--Empty--></p>
			This example shows an iterative search for the group to principal LDIF example shown above.
		</div><pre class="programlisting language-xml">&lt;authorization&gt;
      &lt;ldap connection="LocalLdap"&gt;
          &lt;username-to-dn&gt;
              &lt;username-filter base-dn="ou=users,dc=group-to-principal,dc=example,dc=org" recursive="false" attribute="uid" user-dn-attribute="dn" /&gt;
          &lt;/username-to-dn&gt;
          &lt;group-search group-name="SIMPLE" iterative="true" group-dn-attribute="dn" group-name-attribute="uid"&gt;
              &lt;group-to-principal base-dn="ou=groups,dc=group-to-principal,dc=example,dc=org" recursive="true" search-by="DISTINGUISHED_NAME"&gt;
                  &lt;membership-filter principal-attribute="uniqueMember" /&gt;
              &lt;/group-to-principal&gt;
          &lt;/group-search&gt;
      &lt;/ldap&gt;
  &lt;/authorization&gt;</pre></div></div><div class="para"><p><!--Empty--></p>
		Here an element <code class="code">group-to-principal</code> is added, this element is used to define how searches for groups that reference the user entry will be performed, the following attributes are set:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
				<code class="code">base-dn</code>: The distinguished name of the context to use to begin the search.
			</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
				<code class="code">recursive</code>: Whether sub-contexts also be searched. Defaults to <code class="literal">false</code>.
			</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
				<code class="code">search-by</code>: The form of the role name used in searches. Valid valids are <code class="literal">SIMPLE</code> and <code class="literal">DISTINGUISHED_NAME</code>. Defaults to <code class="literal">DISTINGUISHED_NAME</code>.
			</div></li></ul></div><div class="para"><p><!--Empty--></p>
		Within the <span class="emphasis"><em>group-to-principal</em></span> element there is a <span class="emphasis"><em>membership-filter</em></span> element to define the cross reference.
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
				<code class="code">principal-attribute</code>: The name of the attribute on the group entry that references the user entry. Defaults to <code class="literal">member</code>.
			</div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24484-550824+%5BSpecified%5D&amp;comment=Title%3A+About+Authorization+and+Group+Loading+with+LDAP%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24484-550824+05+Nov+2013+16%3A16+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Scoped_Roles" lang="en-US"><div class="titlepage"><div><div><h3 class="title">11.9.8. About Scoped Roles</h3></div></div></div><div class="para"><p><!--Empty--></p>
		Scoped Roles are user-defined roles that grant the permissions of one of the standard roles but only for one or more specified server groups or hosts. Scoped roles allow for management users to be granted permissions that are limited to only those server groups or hosts that are required.
	</div><div class="para"><p><!--Empty--></p>
		Scoped roles can be created by users assigned the Administrator or SuperUser roles.
	</div><div class="para"><p><!--Empty--></p>
		They are defined by five characteristics:
	</div><div class="orderedlist"><ol class="arabic"><li class="listitem"><div class="para"><p><!--Empty--></p>
				A unique name.
			</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
				Which of the standard roles it is based on.
			</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
				If it applies to Server Groups or Hosts
			</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
				The list of server groups or hosts that it is restricted to.
			</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
				If all users are automatically include. This defaults to false.
			</div></li></ol></div><div class="para"><p><!--Empty--></p>
		Once created a scoped role can be assigned to users and groups the same way that the standard roles are.
	</div><div class="para"><p><!--Empty--></p>
		Creating a scoped role does not let you define new permissions. Scoped roles can only be used to apply the permissions of an existing role in a limited scope. For example, you could create a scoped role based on the Deployer role which is restricted to a single server group.
	</div><div class="para"><p><!--Empty--></p>
		There are only two scopes that roles can be limited to, host and server group.
	</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Host-scoped roles</span></dt><dd><div class="para"><p><!--Empty--></p>
					A role that is host-scoped restricts the permissions of that role to one or more hosts. This means access is provided to the relevant <code class="code">/host=*/</code> resource trees but resources that are specific to other hosts are hidden.
				</div></dd><dt><span class="term">Server-Group-scoped roles</span></dt><dd><div class="para"><p><!--Empty--></p>
					A role that is server-group-scoped restricts the permissions of that role to one or more server groups. Additionally the role permissions will also apply to the profile, socket binding group, server config and server resources that are associated with the specified server-groups. Any sub-resources within any of those that are not logically related to the server-group will not be visible to the user.
				</div></dd></dl></div><div class="para"><p><!--Empty--></p>
		Both host and server-group scoped roles have permissions of the Monitor role for the remainder of the managed domain configuration.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+23149-546783+%5BSpecified%5D&amp;comment=Title%3A+About+Scoped+Roles%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=23149-546783+16+Oct+2013+18%3A08+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Creating_Scoped_Roles" lang="en-US"><div class="titlepage"><div><div><h3 class="title">11.9.9. Creating Scoped Roles</h3></div></div></div><div class="para"><p><!--Empty--></p>
		Scoped Roles are user-defined roles that grant the permissions of one of the standard roles but only for one or more specified server groups or hosts. This topic shows how to create scoped roles.
	</div><div class="para"><p><!--Empty--></p>
		Only users in the SuperUser or Administrator roles can perform this configuration.
	</div><div class="para"><p><!--Empty--></p>
		Scoped Role configuration in the management console can be found by following these steps:
	</div><div class="orderedlist"><ol><li class="listitem"><div class="para"><p><!--Empty--></p>
				Login to the Management Console
			</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
				Click on the Administration tab
			</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
				Expand the Access Control item on the left and select Role Assignment
			</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
				Select ROLES tab, and then the Scoped Roles tab within it.
			</div></li></ol></div><div class="figure" id="idm140707318232224"><div class="figure-contents"><div class="mediaobject"><img src="/webassets/avalon/d/JBoss_Enterprise_Application_Platform_Common_Criteria_Certification-6.2.2-Security_Guide-en-US/images/ccb4b70141610a479a5c4620fd67b9c0/4165.png" alt="Scoped Role Configuration in the Management Console" /></div></div><p class="title"><strong>Figure 11.7. Scoped Role Configuration in the Management Console</strong></p></div><div class="para">
		The Scoped Roles section of the Management Console consists of two main areas, a table containing a list of the currently configured scoped roles, and the Selection panel which displays the details of the role currently selected in the table.
	</div><div class="para">
		The following procedures show how to perform configuration tasks for Scoped Roles.
	</div><div class="procedure"><p class="title"><strong>Procedure 11.22. Add a New Scoped Role</strong></p><ol class="1"><li class="step"><div class="para">
				Login to the Management Console
			</div></li><li class="step"><div class="para">
				Navigate tot he Scoped Roles area of the Roles tab.
			</div></li><li class="step"><div class="para">
				Click the Add button. The Add Scoped Role dialog appears.
			</div><div class="figure" id="idm140707318358832"><div class="figure-contents"><div class="mediaobject"><img src="/webassets/avalon/d/JBoss_Enterprise_Application_Platform_Common_Criteria_Certification-6.2.2-Security_Guide-en-US/images/3ff75ab14cded901404cdd039b55069a/4166.png" alt="Add Scoped Role Dialog" /></div></div><p class="title"><strong>Figure 11.8. Add Scoped Role Dialog</strong></p></div></li><li class="step"><div class="para">
				Specify the following details:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
						<span class="guilabel"><strong>Name</strong></span>, the unique name for the new scoped role.
					</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
						<span class="guilabel"><strong>Base Role</strong></span>, the role which this role will base its permissions on.
					</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
						<span class="guilabel"><strong>Type</strong></span>, whether this role will be restricted to hosts or server groups.
					</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
						<span class="guilabel"><strong>Scope</strong></span>, the list of hosts or server groups that the role is restricted to. Multiple entries can be selected.
					</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
						<span class="guilabel"><strong>Include All</strong></span>, should this role automatically include all users. Defaults to no.
					</div></li></ul></div></li><li class="step"><div class="para">
				Click the Save button and the dialog will close and the newly created role will appear in the table.
			</div></li></ol></div><div class="procedure"><p class="title"><strong>Procedure 11.23. Edit a Scoped Role</strong></p><ol class="1"><li class="step"><div class="para">
				Login to the Management Console
			</div></li><li class="step"><div class="para">
				Navigate to the Scoped Roles area of the Roles tab.
			</div></li><li class="step"><div class="para">
				Click on the scoped role you want to edit in the table. The details of that role appears in the Selection panel below the table.
			</div><div class="figure" id="idm140707317524720"><div class="figure-contents"><div class="mediaobject"><img src="/webassets/avalon/d/JBoss_Enterprise_Application_Platform_Common_Criteria_Certification-6.2.2-Security_Guide-en-US/images/d6834bc4e194cc62fec4d94958a5597a/4167.png" alt="Role Selected" /></div></div><p class="title"><strong>Figure 11.9. Role Selected</strong></p></div></li><li class="step"><div class="para">
				Click the Edit link in the Selection panel. The Selection panel enters edit mode.
			</div><div class="figure" id="idm140707315186784"><div class="figure-contents"><div class="mediaobject"><img src="/webassets/avalon/d/JBoss_Enterprise_Application_Platform_Common_Criteria_Certification-6.2.2-Security_Guide-en-US/images/bf4f69bd760c13a5cc1ca4a2eb09709d/4168.png" alt="Selection Panel in Edit Mode" /></div></div><p class="title"><strong>Figure 11.10. Selection Panel in Edit Mode</strong></p></div></li><li class="step"><div class="para">
				Update the details you need to change and click the Save button. The Selection panel returns to it's previous state. Both the Selection panel and table show the newly updated details.
			</div></li></ol></div><div class="procedure"><p class="title"><strong>Procedure 11.24. View Scoped Role Members</strong></p><ol class="1"><li class="step"><div class="para">
				Login to the Management Console
			</div></li><li class="step"><div class="para">
				Navigate to the Scoped Roles area of the Roles tab.
			</div></li><li class="step"><div class="para">
				Click on the scoped role in the table that you want to view the Members of, then click the Members button. The Members of role dialog appears. It shows users and groups that are included or excluded from the role.
			</div><div class="figure" id="idm140707314617728"><div class="figure-contents"><div class="mediaobject"><img src="/webassets/avalon/d/JBoss_Enterprise_Application_Platform_Common_Criteria_Certification-6.2.2-Security_Guide-en-US/images/2fc8c314512aa75de7f28278739577d8/4170.png" alt="Role Membership Dialog" /></div></div><p class="title"><strong>Figure 11.11. Role Membership Dialog</strong></p></div></li><li class="step"><div class="para">
				Click the Done button when you have finished reviewing this information.
			</div></li></ol></div><div class="procedure"><p class="title"><strong>Procedure 11.25. Delete a Scoped Role</strong></p><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
				A Scoped Role cannot be deleted if users or groups are assigned to it. Remove the role assignments first, and then delete it.
			</div></div></div><ol class="1"><li class="step"><div class="para">
				Login to the Management Console
			</div></li><li class="step"><div class="para">
				Navigate to the Scoped Roles area of the Roles tab.
			</div></li><li class="step"><div class="para">
				Select the scoped role to be removed in the table.
			</div></li><li class="step"><div class="para">
				Click the Remove button. The Remove Scoped Role dialog appears.
			</div></li><li class="step"><div class="para">
				Click the Confirm button.The dialog closes and the role is removed.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24152-556866+%5BSpecified%5D&amp;comment=Title%3A+Creating+Scoped+Roles%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24152-556866+20+Nov+2013+13%3A06+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div class="section" id="sect-Configuring_Constraints"><div class="titlepage"><div><div><h2 class="title">11.10. Configuring Constraints</h2></div></div></div><div xml:lang="en-US" class="section" id="Configure_Sensitivity_Constraints" lang="en-US"><div class="titlepage"><div><div><h3 class="title">11.10.1. Configure Sensitivity Constraints</h3></div></div></div><div class="para"><p><!--Empty--></p>
		Each Sensitivity Constraint defines a set of resources that are considered "sensitive". A sensitive resource is generally one that either should be secret, like passwords, or one that will have serious impact on the server, like networking, JVM configuration, or system properties. The access control system itself is also considered sensitive. Resource sensitivity limits which roles are able to read, write or address a specific resource.
	</div><div class="para"><p><!--Empty--></p>
		Sensitivity constraint configuration is in the Management API at <code class="code">/core-service=management/access=authorization/constraint=sensitivity-classification</code>.
	</div><div class="para"><p><!--Empty--></p>
		Within the management model each Sensitivity Constraint is identified as a <code class="code">classification</code>. The classifications are then grouped into <code class="code">types</code>. There are 39 included classifications that are arranged into 13 types.
	</div><div class="para"><p><!--Empty--></p>
		To configure a a sensitivity constraint, use the <code class="command">write-attribute</code> operation to set the <code class="code">configured-requires-read</code>, <code class="code">configured-requires-write</code>, or <code class="code">configured-requires-addressable</code> attribute. To make that type of operation sensitive set the value of the attribute to <code class="literal">true</code>, otherwise to make it nonsensitive set it to <code class="literal">false</code>. By default these attributes are not set and the values of <code class="code">default-requires-read</code>, <code class="code">default-requires-write</code>, and <code class="code">default-requires-addressable</code> are used. Once the configured attribute is set it is that value that is used instead of the default. The default values cannot be changed.
	</div><div class="example" id="idm140707340015184"><p class="title"><strong>Example 11.5. Make reading system properties a sensitive operation</strong></p><div class="example-contents"><pre class="screen">[domain@localhost:9999 /] cd /core-service=management/access=authorization/constraint=sensitivity-classification/type=core/classification=system-property
[domain@localhost:9999 classification=system-property] :write-attribute(name=configured-requires-read, value=true)
{
    "outcome" =&gt; "success",
    "result" =&gt; undefined,
    "server-groups" =&gt; {"main-server-group" =&gt; {"host" =&gt; {"master" =&gt; {
        "server-one" =&gt; {"response" =&gt; {"outcome" =&gt; "success"}},
        "server-two" =&gt; {"response" =&gt; {"outcome" =&gt; "success"}}
    }}}}
}
[domain@localhost:9999 classification=system-property] :read-resource
{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "configured-requires-addressable" =&gt; undefined,
        "configured-requires-read" =&gt; true,
        "configured-requires-write" =&gt; undefined,
        "default-requires-addressable" =&gt; false,
        "default-requires-read" =&gt; false,
        "default-requires-write" =&gt; true,
        "applies-to" =&gt; {
            "/host=master/system-property=*" =&gt; undefined,
            "/host=master/core-service=platform-mbean/type=runtime" =&gt; undefined,
            "/server-group=*/system-property=*" =&gt; undefined,
            "/host=master/server-config=*/system-property=*" =&gt; undefined,
            "/host=master" =&gt; undefined,
            "/system-property=*" =&gt; undefined,
            "/" =&gt; undefined
        }
    }
}
[domain@localhost:9999 classification=system-property]</pre></div></div><div class="para"><p><!--Empty--></p>
		What roles will be able to perform what operations depending on the configuration of these attributes is summarized in <a class="xref" href="#table-sensitivity-constraint-outcomes">Table 11.2, “Sensitivity Constraint Configuration outcomes”</a>.
	</div><div class="table" id="table-sensitivity-constraint-outcomes"><p class="title"><strong>Table 11.2. Sensitivity Constraint Configuration outcomes</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows" summary="Sensitivity Constraint Configuration outcomes"><colgroup><col width="10%" class="col_1"><!--Empty--></col><col width="30%" class="col_2"><!--Empty--></col><col width="30%" class="col_3"><!--Empty--></col><col width="30%" class="col_4"><!--Empty--></col></colgroup><thead><tr><th valign="top" id="idm140707337889504" scope="col"> Value </th><th align="left" valign="top" id="idm140707326621984" scope="col"> <code class="code">requires-read</code> </th><th align="left" valign="top" id="idm140707312105328" scope="col"> <code class="code">requires-write</code> </th><th align="left" valign="top" id="idm140707324829904" scope="col"> <code class="code">requires-addressable</code> </th></tr></thead><tbody><tr><td valign="top" headers="idm140707337889504"> <div class="para"><p><!--Empty--></p>
						<code class="literal">true</code>
					</div>
					 </td><td align="left" valign="top" headers="idm140707326621984"> <div class="para"><p><!--Empty--></p>
						Read is sensitive.
					</div>
					 <div class="para"><p><!--Empty--></p>
						Only Auditor, Administrator, SuperUser can read.
					</div>
					 </td><td align="left" valign="top" headers="idm140707312105328"> <div class="para"><p><!--Empty--></p>
						Write is sensitive.
					</div>
					 <div class="para"><p><!--Empty--></p>
						Only Administrator and SuperUser can write
					</div>
					 </td><td align="left" valign="top" headers="idm140707324829904"> <div class="para"><p><!--Empty--></p>
						Addressing is sensitive.
					</div>
					 <div class="para"><p><!--Empty--></p>
						Only Auditor, Administrator, SuperUser can address.
					</div>
					 </td></tr><tr><td valign="top" headers="idm140707337889504"> <div class="para"><p><!--Empty--></p>
						<code class="literal">false</code>
					</div>
					 <div class="para"><p><!--Empty--></p>

					</div>
					 </td><td align="left" valign="top" headers="idm140707326621984"> <div class="para"><p><!--Empty--></p>
						Read is not sensitive.
					</div>
					 <div class="para"><p><!--Empty--></p>
						Any management user can read.
					</div>
					 </td><td align="left" valign="top" headers="idm140707312105328"> <div class="para"><p><!--Empty--></p>
						Write is not sensitive.
					</div>
					 <div class="para"><p><!--Empty--></p>
						Only Maintainer, Administrator and SuperUser can write. Deployers can also write the resource is an application resource.
					</div>
					 </td><td align="left" valign="top" headers="idm140707324829904"> <div class="para"><p><!--Empty--></p>
						Addressing is not sensitive.
					</div>
					 <div class="para"><p><!--Empty--></p>
						Any management user can address.
					</div>
					 </td></tr></tbody></table></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24436-550356+%5BSpecified%5D&amp;comment=Title%3A+Configure+Sensitivity+Constraints%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24436-550356+04+Nov+2013+12%3A39+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_Application_Resource_Constraints" lang="en-US"><div class="titlepage"><div><div><h3 class="title">11.10.2. Configure Application Resource Constraints</h3></div></div></div><div class="para"><p><!--Empty--></p>
		Each Application Resource Constraint defines a set of resources, attributes and operations that are usually associated with the deployment of applications and services. When an application resource constraint is enabled management users of the Deployer role are granted access to the resources that it applies to.
	</div><div class="para"><p><!--Empty--></p>
		Application constraint configuration is in the Management Model at <code class="code">/core-service=management/access=authorization/constraint=application-classification/</code>.
	</div><div class="para"><p><!--Empty--></p>
		Within the management model each Application Resource Constraint is identified as a <code class="code">classification</code>. The classifications are then grouped into <code class="code">types</code>. There are 14 included classifications that are arranged into 8 types. Each classification has an <code class="code">applies-to</code> element which is a list of resource path patterns to which the classifications configuration applies.
	</div><div class="para"><p><!--Empty--></p>
		By default the only Application Resource classification that is enabled is <code class="systemitem">core</code>. Core includes deployments, deployment overlays, and the deployment operations.
	</div><div class="para"><p><!--Empty--></p>
		To enable an Application Resource, use the <code class="command">write-attribute</code> operation to set the <code class="code">configured-application attribute</code> of the classification to <code class="literal">true</code>. To disable an Application Resource, set this attribute to <code class="literal">false</code>. By default these attributes are not set and the value of <code class="code">default-application attribute</code> is used. The default value cannot be changed.
	</div><div class="example" id="idm140707325761296"><p class="title"><strong>Example 11.6. Enabling the logger-profile application resource classification</strong></p><div class="example-contents"><pre class="screen">[domain@localhost:9999 /] cd /core-service=management/access=authorization/constraint=application-classification/type=logging/classification=logging-profile
[domain@localhost:9999 classification=logging-profile] :write-attribute(name=configured-application, value=true)
{
    "outcome" =&gt; "success",
    "result" =&gt; undefined,
    "server-groups" =&gt; {"main-server-group" =&gt; {"host" =&gt; {"master" =&gt; {
        "server-one" =&gt; {"response" =&gt; {"outcome" =&gt; "success"}},
        "server-two" =&gt; {"response" =&gt; {"outcome" =&gt; "success"}}
    }}}}
}
[domain@localhost:9999 classification=logging-profile] :read-resource 
{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "configured-application" =&gt; true,
        "default-application" =&gt; false,
        "applies-to" =&gt; {"/profile=*/subsystem=logging/logging-profile=*" =&gt; undefined}
    }
}
[domain@localhost:9999 classification=logging-profile]</pre></div></div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
			Application Resource Constraints apply to all resources that match its configuration. For example, It is not possible to grant a Deployer user access to one datasource resource but not another. If this level of separation is required then it is recommended to configure the resources in different server groups and create different scoped Deployer roles for each group.
		</div></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24420-550356+%5BSpecified%5D&amp;comment=Title%3A+Configure+Application+Resource+Constraints%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24420-550356+04+Nov+2013+12%3A39+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_the_Vault_Expression_Constraint" lang="en-US"><div class="titlepage"><div><div><h3 class="title">11.10.3. Configure the Vault Expression Constraint</h3></div></div></div><div class="para"><p><!--Empty--></p>
		By default, reading and writing vault expressions are sensitive operations. Configuring the Vault Expression Constraint allows you to set either or both of those operations to being nonsensitive. Changing this constraint allows a greater number of roles to read and write vault expressions.
	</div><div class="para"><p><!--Empty--></p>
		The vault expression constraint is found in the management model at <code class="code">/core-service=management/access=authorization/constraint=vault-expression</code>.
	</div><div class="para"><p><!--Empty--></p>
		To configure the vault expression constraint, use the <code class="command">write-attribute</code> operation to set the attributes of <code class="code">configured-requires-write</code> and <code class="code">configured-requires-read</code> to <code class="literal">true</code> or <code class="literal">false</code>. By default these are not set and the values of <code class="code">default-requires-read</code> and <code class="code">default-requires-write</code> are used. The default values cannot be changed.
	</div><div class="example" id="idm140707321791840"><p class="title"><strong>Example 11.7. Making writing to vault expressions a nonsensitive operation</strong></p><div class="example-contents"><pre class="screen">[domain@localhost:9999 /] cd /core-service=management/access=authorization/constraint=vault-expression
[domain@localhost:9999 constraint=vault-expression] :write-attribute(name=configured-requires-write, value=false)
{
    "outcome" =&gt; "success",
    "result" =&gt; undefined,
    "server-groups" =&gt; {"main-server-group" =&gt; {"host" =&gt; {"master" =&gt; {
        "server-one" =&gt; {"response" =&gt; {"outcome" =&gt; "success"}},
        "server-two" =&gt; {"response" =&gt; {"outcome" =&gt; "success"}}
    }}}}
}
[domain@localhost:9999 constraint=vault-expression] :read-resource
{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "configured-requires-read" =&gt; undefined,
        "configured-requires-write" =&gt; false,
        "default-requires-read" =&gt; true,
        "default-requires-write" =&gt; true
    }
}
[domain@localhost:9999 constraint=vault-expression]</pre></div></div><div class="para"><p><!--Empty--></p>
		What roles will be able to read and write to vault expressions depending on this configuration is summarized in <a class="xref" href="#table-vault-expression-outcomes">Table 11.3, “Vault Expression Constraint Configuration outcomes”</a>.
	</div><div class="table" id="table-vault-expression-outcomes"><p class="title"><strong>Table 11.3. Vault Expression Constraint Configuration outcomes</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="Vault Expression Constraint Configuration outcomes"><colgroup><col width="11%" class="col_1"><!--Empty--></col><col width="44%" class="col_2"><!--Empty--></col><col width="44%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="center" valign="top" id="idm140707331611568" scope="col"> Value </th><th align="left" valign="top" id="idm140707316840496" scope="col"> <code class="literal">requires-read</code> </th><th align="left" valign="top" id="idm140707325342896" scope="col"> <code class="literal">requires-write</code> </th></tr></thead><tbody><tr><td align="center" valign="top" headers="idm140707331611568"> <div class="para"><p><!--Empty--></p>
						<code class="literal">true</code>
					</div>
					 </td><td align="left" valign="top" headers="idm140707316840496"> <div class="para"><p><!--Empty--></p>
						Read operation is sensitive.
					</div>
					 <div class="para"><p><!--Empty--></p>
						Only Auditor, Administrator, and SuperUser can read.
					</div>
					 </td><td align="left" valign="top" headers="idm140707325342896"> <div class="para"><p><!--Empty--></p>
						Write operation is sensitive.
					</div>
					 <div class="para"><p><!--Empty--></p>
						Only Administrator and SuperUser can write.
					</div>
					 </td></tr><tr><td align="center" valign="top" headers="idm140707331611568"> <div class="para"><p><!--Empty--></p>
						<code class="literal">false</code>
					</div>
					 </td><td align="left" valign="top" headers="idm140707316840496"> <div class="para"><p><!--Empty--></p>
						Read operation is not sensitive.
					</div>
					 <div class="para"><p><!--Empty--></p>
						All management users can read.
					</div>
					 </td><td align="left" valign="top" headers="idm140707325342896"> <div class="para"><p><!--Empty--></p>
						Write operation is not sensitive.
					</div>
					 <div class="para"><p><!--Empty--></p>
						Monitor, Administrator and SuperUser can write. Deployers can also write if the vault expression is in an Application Resource.
					</div>
					 </td></tr></tbody></table></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24406-550157+%5BSpecified%5D&amp;comment=Title%3A+Configure+the+Vault+Expression+Constraint%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24406-550157+01+Nov+2013+15%3A03+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div class="section" id="sect-Constraints_Reference"><div class="titlepage"><div><div><h2 class="title">11.11. Constraints Reference</h2></div></div></div><div xml:lang="en-US" class="section" id="Application_Resource_Constraints_Reference" lang="en-US"><div class="titlepage"><div><div><h3 class="title">11.11.1. Application Resource Constraints Reference</h3></div></div></div><div class="variablelist"><p class="title"><strong>Type: core</strong></p><dl class="variablelist"><dt><span class="term">Classification: deployment-overlay</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							default: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="67%" class="col_1"><!--Empty--></col><col width="16%" class="col_2"><!--Empty--></col><col width="16%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707316676128" scope="col"> PATH </th><th align="left" valign="top" id="idm140707316675040" scope="col"> Attributes </th><th align="left" valign="top" id="idm140707315348336" scope="col"> Operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707316676128"> <div class="para"><p><!--Empty--></p>
											/deployment-overlay=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707316675040"> </td><td align="left" valign="top" headers="idm140707315348336"> </td></tr><tr><td align="left" valign="top" headers="idm140707316676128"> <div class="para"><p><!--Empty--></p>
											/deployment=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707316675040"> </td><td align="left" valign="top" headers="idm140707315348336"> </td></tr><tr><td align="left" valign="top" headers="idm140707316676128"> <div class="para"><p><!--Empty--></p>
											/
										</div>
										 </td><td align="left" valign="top" headers="idm140707316675040"> </td><td align="left" valign="top" headers="idm140707315348336"> <div class="para"><p><!--Empty--></p>
											upload-deployment-stream, full-replace-deployment, upload-deployment-url, upload-deployment-bytes
										</div>
										 </td></tr></tbody></table></div></li></ul></div></dd></dl></div><div class="variablelist"><p class="title"><strong>Type: datasources</strong></p><dl class="variablelist"><dt><span class="term">Classification: datasource</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							default: false
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="67%" class="col_1"><!--Empty--></col><col width="16%" class="col_2"><!--Empty--></col><col width="16%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707314973856" scope="col"> PATH </th><th align="left" valign="top" id="idm140707314972768" scope="col"> Attributes </th><th align="left" valign="top" id="idm140707326342848" scope="col"> Operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707314973856"> <div class="para"><p><!--Empty--></p>
											/deployment=*/subdeployment=*/subsystem=datasources/data-source=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707314972768"> </td><td align="left" valign="top" headers="idm140707326342848"> </td></tr><tr><td align="left" valign="top" headers="idm140707314973856"> <div class="para"><p><!--Empty--></p>
											/subsystem=datasources/data-source=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707314972768"> </td><td align="left" valign="top" headers="idm140707326342848"> </td></tr><tr><td align="left" valign="top" headers="idm140707314973856"> <div class="para"><p><!--Empty--></p>
											/subsystem=datasources/data-source=ExampleDS
										</div>
										 </td><td align="left" valign="top" headers="idm140707314972768"> </td><td align="left" valign="top" headers="idm140707326342848"> </td></tr><tr><td align="left" valign="top" headers="idm140707314973856"> <div class="para"><p><!--Empty--></p>
											/deployment=*/subsystem=datasources/data-source=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707314972768"> </td><td align="left" valign="top" headers="idm140707326342848"> </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: jdbc-driver</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							default: false
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="67%" class="col_1"><!--Empty--></col><col width="16%" class="col_2"><!--Empty--></col><col width="16%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707337534192" scope="col"> PATH </th><th align="left" valign="top" id="idm140707314905440" scope="col"> Attributes </th><th align="left" valign="top" id="idm140707314904352" scope="col"> Operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707337534192"> <div class="para"><p><!--Empty--></p>
											/subsystem=datasources/jdbc-driver=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707314905440"> </td><td align="left" valign="top" headers="idm140707314904352"> </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: xa-data-source</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							default: false
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="67%" class="col_1"><!--Empty--></col><col width="16%" class="col_2"><!--Empty--></col><col width="16%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707313128272" scope="col"> PATH </th><th align="left" valign="top" id="idm140707313127184" scope="col"> Attributes </th><th align="left" valign="top" id="idm140707325694224" scope="col"> Operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707313128272"> <div class="para"><p><!--Empty--></p>
											/subsystem=datasources/xa-data-source=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707313127184"> </td><td align="left" valign="top" headers="idm140707325694224"> </td></tr><tr><td align="left" valign="top" headers="idm140707313128272"> <div class="para"><p><!--Empty--></p>
											/deployment=*/subsystem=datasources/xa-data-source=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707313127184"> </td><td align="left" valign="top" headers="idm140707325694224"> </td></tr><tr><td align="left" valign="top" headers="idm140707313128272"> <div class="para"><p><!--Empty--></p>
											/deployment=*/subdeployment=*/subsystem=datasources/xa-data-source=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707313127184"> </td><td align="left" valign="top" headers="idm140707325694224"> </td></tr></tbody></table></div></li></ul></div></dd></dl></div><div class="variablelist"><p class="title"><strong>Type: logging</strong></p><dl class="variablelist"><dt><span class="term">Classification: logger</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							default: false
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="67%" class="col_1"><!--Empty--></col><col width="16%" class="col_2"><!--Empty--></col><col width="16%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707321861456" scope="col"> PATH </th><th align="left" valign="top" id="idm140707320190848" scope="col"> Attributes </th><th align="left" valign="top" id="idm140707312706064" scope="col"> Operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707321861456"> <div class="para"><p><!--Empty--></p>
											/subsystem=logging/logger=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707320190848"> </td><td align="left" valign="top" headers="idm140707312706064"> </td></tr><tr><td align="left" valign="top" headers="idm140707321861456"> <div class="para"><p><!--Empty--></p>
											/subsystem=logging/logging-profile=*/logger=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707320190848"> </td><td align="left" valign="top" headers="idm140707312706064"> </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: logging-profile</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							default: false
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="67%" class="col_1"><!--Empty--></col><col width="16%" class="col_2"><!--Empty--></col><col width="16%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707311044688" scope="col"> PATH </th><th align="left" valign="top" id="idm140707313319392" scope="col"> Attributes </th><th align="left" valign="top" id="idm140707313318304" scope="col"> Operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707311044688"> <div class="para"><p><!--Empty--></p>
											/subsystem=logging/logging-profile=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707313319392"> </td><td align="left" valign="top" headers="idm140707313318304"> </td></tr></tbody></table></div></li></ul></div></dd></dl></div><div class="variablelist"><p class="title"><strong>Type: mail</strong></p><dl class="variablelist"><dt><span class="term">Classification: mail-session</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							default: false
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="67%" class="col_1"><!--Empty--></col><col width="16%" class="col_2"><!--Empty--></col><col width="16%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707325532912" scope="col"> PATH </th><th align="left" valign="top" id="idm140707326556320" scope="col"> Attributes </th><th align="left" valign="top" id="idm140707316768336" scope="col"> Operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707325532912"> <div class="para"><p><!--Empty--></p>
											/subsystem=mail/mail-session=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707326556320"> </td><td align="left" valign="top" headers="idm140707316768336"> </td></tr></tbody></table></div></li></ul></div></dd></dl></div><div class="variablelist"><p class="title"><strong>Type: naming</strong></p><dl class="variablelist"><dt><span class="term">Classification: binding</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							default: false
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="67%" class="col_1"><!--Empty--></col><col width="16%" class="col_2"><!--Empty--></col><col width="16%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707319073152" scope="col"> PATH </th><th align="left" valign="top" id="idm140707340465856" scope="col"> Attributes </th><th align="left" valign="top" id="idm140707340848000" scope="col"> Operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707319073152"> <div class="para"><p><!--Empty--></p>
											/subsystem=naming/binding=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707340465856"> </td><td align="left" valign="top" headers="idm140707340848000"> </td></tr></tbody></table></div></li></ul></div></dd></dl></div><div class="variablelist"><p class="title"><strong>Type: resource-adapters</strong></p><dl class="variablelist"><dt><span class="term">Classification: resource-adapters</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							default: false
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="67%" class="col_1"><!--Empty--></col><col width="16%" class="col_2"><!--Empty--></col><col width="16%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707325288960" scope="col"> PATH </th><th align="left" valign="top" id="idm140707325753680" scope="col"> Attributes </th><th align="left" valign="top" id="idm140707330784000" scope="col"> Operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707325288960"> <div class="para"><p><!--Empty--></p>
											/subsystem=resource-adapters/resource-adapter=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707325753680"> </td><td align="left" valign="top" headers="idm140707330784000"> </td></tr></tbody></table></div></li></ul></div></dd></dl></div><div class="variablelist"><p class="title"><strong>Type: security</strong></p><dl class="variablelist"><dt><span class="term">Classification: security-domain</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							default: false
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="67%" class="col_1"><!--Empty--></col><col width="16%" class="col_2"><!--Empty--></col><col width="16%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707330876368" scope="col"> PATH </th><th align="left" valign="top" id="idm140707312270080" scope="col"> Attributes </th><th align="left" valign="top" id="idm140707309131056" scope="col"> Operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707330876368"> <div class="para"><p><!--Empty--></p>
											/subsystem=security/security-domain=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707312270080"> </td><td align="left" valign="top" headers="idm140707309131056"> </td></tr></tbody></table></div></li></ul></div></dd></dl></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24684-562767+%5BSpecified%5D&amp;comment=Title%3A+Application+Resource+Constraints+Reference%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24684-562767+02+Dec+2013+16%3A37+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Sensitivity_Constraints_Reference" lang="en-US"><div class="titlepage"><div><div><h3 class="title">11.11.2. Sensitivity Constraints Reference</h3></div></div></div><div class="variablelist"><p class="title"><strong>Type: core</strong></p><dl class="variablelist"><dt><span class="term">Classification: access-control</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: true
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: true
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707315425728" scope="col"> PATH </th><th align="left" valign="top" id="idm140707339565312" scope="col"> attributes </th><th align="left" valign="top" id="idm140707324975712" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707315425728"> <div class="para"><p><!--Empty--></p>
											/core-service=management/access=authorization
										</div>
										 </td><td align="left" valign="top" headers="idm140707339565312"> </td><td align="left" valign="top" headers="idm140707324975712"> </td></tr><tr><td align="left" valign="top" headers="idm140707315425728"> <div class="para"><p><!--Empty--></p>
											/subsystem=jmx
										</div>
										 </td><td align="left" valign="top" headers="idm140707339565312"> <div class="para"><p><!--Empty--></p>
											non-core-mbean-sensitivity
										</div>
										 </td><td align="left" valign="top" headers="idm140707324975712"> </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: credential</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: true
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols gt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707339898960" scope="col"> PATH </th><th align="left" valign="top" id="idm140707318739648" scope="col"> attributes </th><th align="left" valign="top" id="idm140707318738560" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707339898960"> <div class="para"><p><!--Empty--></p>
											/subsystem=mail/mail-session=*/server=pop3
										</div>
										 </td><td align="left" valign="top" headers="idm140707318739648"> <div class="para"><p><!--Empty--></p>
											username , password
										</div>
										 </td><td align="left" valign="top" headers="idm140707318738560"> </td></tr><tr><td align="left" valign="top" headers="idm140707339898960"> <div class="para"><p><!--Empty--></p>
											/subsystem=mail/mail-session=*/server=imap
										</div>
										 </td><td align="left" valign="top" headers="idm140707318739648"> <div class="para"><p><!--Empty--></p>
											username, password
										</div>
										 </td><td align="left" valign="top" headers="idm140707318738560"> </td></tr><tr><td align="left" valign="top" headers="idm140707339898960"> <div class="para"><p><!--Empty--></p>
											/subsystem=datasources/xa-data-source=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707318739648"> <div class="para"><p><!--Empty--></p>
											user-name, recovery-username, password, recovery-password
										</div>
										 </td><td align="left" valign="top" headers="idm140707318738560"> </td></tr><tr><td align="left" valign="top" headers="idm140707339898960"> <div class="para"><p><!--Empty--></p>
											/subsystem=mail/mail-session=*/custom=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707318739648"> <div class="para"><p><!--Empty--></p>
											username, password
										</div>
										 </td><td align="left" valign="top" headers="idm140707318738560"> </td></tr><tr><td align="left" valign="top" headers="idm140707339898960"> <div class="para"><p><!--Empty--></p>
											/subsystem=datasources/data-source=*"
										</div>
										 </td><td align="left" valign="top" headers="idm140707318739648"> <div class="para"><p><!--Empty--></p>
											user-name, password
										</div>
										 </td><td align="left" valign="top" headers="idm140707318738560"> </td></tr><tr><td align="left" valign="top" headers="idm140707339898960"> <div class="para"><p><!--Empty--></p>
											/subsystem=remoting/remote-outbound-connection=*"
										</div>
										 </td><td align="left" valign="top" headers="idm140707318739648"> <div class="para"><p><!--Empty--></p>
											username
										</div>
										 </td><td align="left" valign="top" headers="idm140707318738560"> </td></tr><tr><td align="left" valign="top" headers="idm140707339898960"> <div class="para"><p><!--Empty--></p>
											/subsystem=mail/mail-session=*/server=smtp
										</div>
										 </td><td align="left" valign="top" headers="idm140707318739648"> <div class="para"><p><!--Empty--></p>
											username , password
										</div>
										 </td><td align="left" valign="top" headers="idm140707318738560"> </td></tr><tr><td align="left" valign="top" headers="idm140707339898960"> <div class="para"><p><!--Empty--></p>
											/subsystem=web/connector=*/configuration=ssl
										</div>
										 </td><td align="left" valign="top" headers="idm140707318739648"> <div class="para"><p><!--Empty--></p>
											key-alias, password
										</div>
										 </td><td align="left" valign="top" headers="idm140707318738560"> </td></tr><tr><td align="left" valign="top" headers="idm140707339898960"> <div class="para"><p><!--Empty--></p>
											/subsystem=resource-adapters/resource-adapter=*/connection-definitions=*"
										</div>
										 </td><td align="left" valign="top" headers="idm140707318739648"> <div class="para"><p><!--Empty--></p>
											recovery-username, recovery-password
										</div>
										 </td><td align="left" valign="top" headers="idm140707318738560"> </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: domain-controller</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707326514400" scope="col"> PATH </th><th align="left" valign="top" id="idm140707326513424" scope="col"> attributes </th><th align="left" valign="top" id="idm140707319106832" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707326514400"> </td><td align="left" valign="top" headers="idm140707326513424"> </td><td align="left" valign="top" headers="idm140707319106832"> </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: domain-names</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707340972944" scope="col"> PATH </th><th align="left" valign="top" id="idm140707316656752" scope="col"> attributes </th><th align="left" valign="top" id="idm140707312627216" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707340972944"> </td><td align="left" valign="top" headers="idm140707316656752"> </td><td align="left" valign="top" headers="idm140707312627216"> </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: extensions</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707319609088" scope="col"> PATH </th><th align="left" valign="top" id="idm140707318532576" scope="col"> attributes </th><th align="left" valign="top" id="idm140707318531488" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707319609088"> <div class="para"><p><!--Empty--></p>
											/extension=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707318532576"> </td><td align="left" valign="top" headers="idm140707318531488"> </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: jvm</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707325435440" scope="col"> PATH </th><th align="left" valign="top" id="idm140707325434352" scope="col"> attributes </th><th align="left" valign="top" id="idm140707325771248" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707325435440"> <div class="para"><p><!--Empty--></p>
											/core-service=platform-mbean/type=runtime
										</div>
										 </td><td align="left" valign="top" headers="idm140707325434352"> <div class="para"><p><!--Empty--></p>
											input-arguments, boot-class-path, class-path, boot-class-path-supported, library-path
										</div>
										 </td><td align="left" valign="top" headers="idm140707325771248"> </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: management-interfaces</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707325525088" scope="col"> PATH </th><th align="left" valign="top" id="idm140707320688784" scope="col"> attributes </th><th align="left" valign="top" id="idm140707320687696" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707325525088"> <div class="para"><p><!--Empty--></p>
											/core-service=management/management-interface=native-interface
										</div>
										 </td><td align="left" valign="top" headers="idm140707320688784"> </td><td align="left" valign="top" headers="idm140707320687696"> </td></tr><tr><td align="left" valign="top" headers="idm140707325525088"> <div class="para"><p><!--Empty--></p>
											/core-service=management/management-interface=http-interface
										</div>
										 </td><td align="left" valign="top" headers="idm140707320688784"> </td><td align="left" valign="top" headers="idm140707320687696"> </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: module-loading</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707338066032" scope="col"> PATH </th><th align="left" valign="top" id="idm140707338064944" scope="col"> attributes </th><th align="left" valign="top" id="idm140707319921952" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707338066032"> <div class="para"><p><!--Empty--></p>
											/core-service=module-loading
										</div>
										 </td><td align="left" valign="top" headers="idm140707338064944"> </td><td align="left" valign="top" headers="idm140707319921952"> </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: patching</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707317473792" scope="col"> PATH </th><th align="left" valign="top" id="idm140707317472704" scope="col"> attributes </th><th align="left" valign="top" id="idm140707325035248" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707317473792"> <div class="para"><p><!--Empty--></p>
											/core-service=patching/addon=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707317472704"> </td><td align="left" valign="top" headers="idm140707325035248"> </td></tr><tr><td align="left" valign="top" headers="idm140707317473792"> <div class="para"><p><!--Empty--></p>
											/core-service=patching/layer=*"
										</div>
										 </td><td align="left" valign="top" headers="idm140707317472704"> </td><td align="left" valign="top" headers="idm140707325035248"> </td></tr><tr><td align="left" valign="top" headers="idm140707317473792"> <div class="para"><p><!--Empty--></p>
											/core-service=patching
										</div>
										 </td><td align="left" valign="top" headers="idm140707317472704"> </td><td align="left" valign="top" headers="idm140707325035248"> </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: read-whole-config</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: true
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707325333984" scope="col"> PATH </th><th align="left" valign="top" id="idm140707325332896" scope="col"> attributes </th><th align="left" valign="top" id="idm140707315982352" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707325333984"> <div class="para"><p><!--Empty--></p>
											/
										</div>
										 </td><td align="left" valign="top" headers="idm140707325332896"> </td><td align="left" valign="top" headers="idm140707315982352"> <div class="para"><p><!--Empty--></p>
											read-config-as-xml
										</div>
										 </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: security-domain</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: true
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: true
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707321665520" scope="col"> PATH </th><th align="left" valign="top" id="idm140707321664432" scope="col"> attributes </th><th align="left" valign="top" id="idm140707321556448" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707321665520"> <div class="para"><p><!--Empty--></p>
											/subsystem=security/security-domain=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707321664432"> </td><td align="left" valign="top" headers="idm140707321556448"> </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: security-domain-ref</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: true
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: true
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707322294336" scope="col"> PATH </th><th align="left" valign="top" id="idm140707316524816" scope="col"> attributes </th><th align="left" valign="top" id="idm140707341628672" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707322294336"> <div class="para"><p><!--Empty--></p>
											/subsystem=datasources/xa-data-source=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707316524816"> <div class="para"><p><!--Empty--></p>
											security-domain
										</div>
										 </td><td align="left" valign="top" headers="idm140707341628672"> </td></tr><tr><td align="left" valign="top" headers="idm140707322294336"> <div class="para"><p><!--Empty--></p>
											/subsystem=datasources/data-source=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707316524816"> <div class="para"><p><!--Empty--></p>
											security-domain
										</div>
										 </td><td align="left" valign="top" headers="idm140707341628672"> </td></tr><tr><td align="left" valign="top" headers="idm140707322294336"> <div class="para"><p><!--Empty--></p>
											/subsystem=ejb3
										</div>
										 </td><td align="left" valign="top" headers="idm140707316524816"> <div class="para"><p><!--Empty--></p>
											default-security-domain
										</div>
										 </td><td align="left" valign="top" headers="idm140707341628672"> </td></tr><tr><td align="left" valign="top" headers="idm140707322294336"> <div class="para"><p><!--Empty--></p>
											/subsystem=resource-adapters/resource-adapter=*/connection-definitions=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707316524816"> <div class="para"><p><!--Empty--></p>
											security-domain, recovery-security-domain, security-application, security-domain-and-application
										</div>
										 </td><td align="left" valign="top" headers="idm140707341628672"> </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: security-realm</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: true
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: true
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707318025840" scope="col"> PATH </th><th align="left" valign="top" id="idm140707318024752" scope="col"> attributes </th><th align="left" valign="top" id="idm140707318137328" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707318025840"> <div class="para"><p><!--Empty--></p>
											/core-service=management/security-realm=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707318024752"> </td><td align="left" valign="top" headers="idm140707318137328"> </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: security-realm-ref</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: true
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: true
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707321031136" scope="col"> PATH </th><th align="left" valign="top" id="idm140707321030048" scope="col"> attributes </th><th align="left" valign="top" id="idm140707322021648" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707321031136"> <div class="para"><p><!--Empty--></p>
											/subsystem=remoting/connector=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707321030048"> <div class="para"><p><!--Empty--></p>
											security-realm
										</div>
										 </td><td align="left" valign="top" headers="idm140707322021648"> </td></tr><tr><td align="left" valign="top" headers="idm140707321031136"> <div class="para"><p><!--Empty--></p>
											/core-service=management/management-interface=native-interface
										</div>
										 </td><td align="left" valign="top" headers="idm140707321030048"> <div class="para"><p><!--Empty--></p>
											security-realm
										</div>
										 </td><td align="left" valign="top" headers="idm140707322021648"> </td></tr><tr><td align="left" valign="top" headers="idm140707321031136"> <div class="para"><p><!--Empty--></p>
											/core-service=management/management-interface=http-interface
										</div>
										 </td><td align="left" valign="top" headers="idm140707321030048"> <div class="para"><p><!--Empty--></p>
											security-realm
										</div>
										 </td><td align="left" valign="top" headers="idm140707322021648"> </td></tr><tr><td align="left" valign="top" headers="idm140707321031136"> <div class="para"><p><!--Empty--></p>
											/subsystem=remoting/remote-outbound-connection=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707321030048"> <div class="para"><p><!--Empty--></p>
											security-realm
										</div>
										 </td><td align="left" valign="top" headers="idm140707322021648"> </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: security-vault</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707343480976" scope="col"> PATH </th><th align="left" valign="top" id="idm140707312216112" scope="col"> attributes </th><th align="left" valign="top" id="idm140707312215056" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707343480976"> <div class="para"><p><!--Empty--></p>
											/core-service=vault
										</div>
										 </td><td align="left" valign="top" headers="idm140707312216112"> </td><td align="left" valign="top" headers="idm140707312215056"> </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: service-container</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707326618048" scope="col"> PATH </th><th align="left" valign="top" id="idm140707326616960" scope="col"> attributes </th><th align="left" valign="top" id="idm140707321815984" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707326618048"> <div class="para"><p><!--Empty--></p>
											/core-service=service-container
										</div>
										 </td><td align="left" valign="top" headers="idm140707326616960"> </td><td align="left" valign="top" headers="idm140707321815984"> </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: snapshots</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: false
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707314674528" scope="col"> PATH </th><th align="left" valign="top" id="idm140707314484672" scope="col"> attributes </th><th align="left" valign="top" id="idm140707319881856" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707314674528"> <div class="para"><p><!--Empty--></p>
											/
										</div>
										 </td><td align="left" valign="top" headers="idm140707314484672"> </td><td align="left" valign="top" headers="idm140707319881856"> <div class="para"><p><!--Empty--></p>
											take-snapshot, list-snapshots, delete-snapshot
										</div>
										 </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: socket-binding-ref</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: false
						</div><div class="informaltable"><table class="lt-4-cols gt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707321536672" scope="col"> PATH </th><th align="left" valign="top" id="idm140707330811664" scope="col"> attributes </th><th align="left" valign="top" id="idm140707312101056" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707321536672"> <div class="para"><p><!--Empty--></p>
											/subsystem=mail/mail-session=*/server=pop3
										</div>
										 </td><td align="left" valign="top" headers="idm140707330811664"> <div class="para"><p><!--Empty--></p>
											outbound-socket-binding-ref
										</div>
										 </td><td align="left" valign="top" headers="idm140707312101056"> </td></tr><tr><td align="left" valign="top" headers="idm140707321536672"> <div class="para"><p><!--Empty--></p>
											/subsystem=mail/mail-session=*/server=imap
										</div>
										 </td><td align="left" valign="top" headers="idm140707330811664"> <div class="para"><p><!--Empty--></p>
											outbound-socket-binding-ref
										</div>
										 </td><td align="left" valign="top" headers="idm140707312101056"> </td></tr><tr><td align="left" valign="top" headers="idm140707321536672"> <div class="para"><p><!--Empty--></p>
											/subsystem=remoting/connector=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707330811664"> <div class="para"><p><!--Empty--></p>
											socket-binding
										</div>
										 </td><td align="left" valign="top" headers="idm140707312101056"> </td></tr><tr><td align="left" valign="top" headers="idm140707321536672"> <div class="para"><p><!--Empty--></p>
											/subsystem=web/connector=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707330811664"> <div class="para"><p><!--Empty--></p>
											socket-binding
										</div>
										 </td><td align="left" valign="top" headers="idm140707312101056"> </td></tr><tr><td align="left" valign="top" headers="idm140707321536672"> <div class="para"><p><!--Empty--></p>
											/subsystem=remoting/local-outbound-connection=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707330811664"> <div class="para"><p><!--Empty--></p>
											outbound-socket-binding-ref
										</div>
										 </td><td align="left" valign="top" headers="idm140707312101056"> </td></tr><tr><td align="left" valign="top" headers="idm140707321536672"> <div class="para"><p><!--Empty--></p>
											/socket-binding-group=*/local-destination-outbound-socket-binding=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707330811664"> <div class="para"><p><!--Empty--></p>
											socket-binding-ref
										</div>
										 </td><td align="left" valign="top" headers="idm140707312101056"> </td></tr><tr><td align="left" valign="top" headers="idm140707321536672"> <div class="para"><p><!--Empty--></p>
											/subsystem=remoting/remote-outbound-connection=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707330811664"> <div class="para"><p><!--Empty--></p>
											outbound-socket-binding-ref
										</div>
										 </td><td align="left" valign="top" headers="idm140707312101056"> </td></tr><tr><td align="left" valign="top" headers="idm140707321536672"> <div class="para"><p><!--Empty--></p>
											/subsystem=mail/mail-session=*/server=smtp
										</div>
										 </td><td align="left" valign="top" headers="idm140707330811664"> <div class="para"><p><!--Empty--></p>
											outbound-socket-binding-ref
										</div>
										 </td><td align="left" valign="top" headers="idm140707312101056"> </td></tr><tr><td align="left" valign="top" headers="idm140707321536672"> <div class="para"><p><!--Empty--></p>
											/subsystem=transactions
										</div>
										 </td><td align="left" valign="top" headers="idm140707330811664"> <div class="para"><p><!--Empty--></p>
											process-id-socket-binding, status-socket-binding, socket-binding
										</div>
										 </td><td align="left" valign="top" headers="idm140707312101056"> </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: socket-config</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707330947536" scope="col"> PATH </th><th align="left" valign="top" id="idm140707314888288" scope="col"> attributes </th><th align="left" valign="top" id="idm140707314887200" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707330947536"> <div class="para"><p><!--Empty--></p>
											/interface=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707314888288"> </td><td align="left" valign="top" headers="idm140707314887200"> <div class="para"><p><!--Empty--></p>
											resolve-internet-address
										</div>
										 </td></tr><tr><td align="left" valign="top" headers="idm140707330947536"> <div class="para"><p><!--Empty--></p>
											/core-service=management/management-interface=native-interface
										</div>
										 </td><td align="left" valign="top" headers="idm140707314888288"> <div class="para"><p><!--Empty--></p>
											port, interface, socket-binding
										</div>
										 </td><td align="left" valign="top" headers="idm140707314887200"> </td></tr><tr><td align="left" valign="top" headers="idm140707330947536"> <div class="para"><p><!--Empty--></p>
											/socket-binding-group=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707314888288"> </td><td align="left" valign="top" headers="idm140707314887200"> </td></tr><tr><td align="left" valign="top" headers="idm140707330947536"> <div class="para"><p><!--Empty--></p>
											/core-service=management/management-interface=http-interface
										</div>
										 </td><td align="left" valign="top" headers="idm140707314888288"> <div class="para"><p><!--Empty--></p>
											port, secure-port, interface, secure-socket-binding, socket-binding
										</div>
										 </td><td align="left" valign="top" headers="idm140707314887200"> </td></tr><tr><td align="left" valign="top" headers="idm140707330947536"> <div class="para"><p><!--Empty--></p>
											/
										</div>
										 </td><td align="left" valign="top" headers="idm140707314888288"> </td><td align="left" valign="top" headers="idm140707314887200"> <div class="para"><p><!--Empty--></p>
											resolve-internet-address
										</div>
										 </td></tr><tr><td align="left" valign="top" headers="idm140707330947536"> <div class="para"><p><!--Empty--></p>
											/subsystem=transactions
										</div>
										 </td><td align="left" valign="top" headers="idm140707314888288"> <div class="para"><p><!--Empty--></p>
											process-id-socket-max-ports
										</div>
										 </td><td align="left" valign="top" headers="idm140707314887200"> </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: system-property</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707320876304" scope="col"> PATH </th><th align="left" valign="top" id="idm140707317626064" scope="col"> attributes </th><th align="left" valign="top" id="idm140707317624976" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707320876304"> <div class="para"><p><!--Empty--></p>
											/core-service=platform-mbean/type=runtime
										</div>
										 </td><td align="left" valign="top" headers="idm140707317626064"> <div class="para"><p><!--Empty--></p>
											system-properties
										</div>
										 </td><td align="left" valign="top" headers="idm140707317624976"> </td></tr><tr><td align="left" valign="top" headers="idm140707320876304"> <div class="para"><p><!--Empty--></p>
											/system-property=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707317626064"> </td><td align="left" valign="top" headers="idm140707317624976"> </td></tr><tr><td align="left" valign="top" headers="idm140707320876304"> <div class="para"><p><!--Empty--></p>
											/
										</div>
										 </td><td align="left" valign="top" headers="idm140707317626064"> </td><td align="left" valign="top" headers="idm140707317624976"> <div class="para"><p><!--Empty--></p>
											resolve-expression
										</div>
										 </td></tr></tbody></table></div></li></ul></div></dd></dl></div><div class="variablelist"><p class="title"><strong>Type: datasources</strong></p><dl class="variablelist"><dt><span class="term">Classification: data-source-security</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: true
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707315693408" scope="col"> PATH </th><th align="left" valign="top" id="idm140707320282384" scope="col"> attributes </th><th align="left" valign="top" id="idm140707320281296" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707315693408"> <div class="para"><p><!--Empty--></p>
											/subsystem=datasources/xa-data-source=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707320282384"> <div class="para"><p><!--Empty--></p>
											user-name, security-domain, password
										</div>
										 </td><td align="left" valign="top" headers="idm140707320281296"> </td></tr><tr><td align="left" valign="top" headers="idm140707315693408"> <div class="para"><p><!--Empty--></p>
											/subsystem=datasources/data-source=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707320282384"> <div class="para"><p><!--Empty--></p>
											user-name, security-domain, password
										</div>
										 </td><td align="left" valign="top" headers="idm140707320281296"> </td></tr></tbody></table></div></li></ul></div></dd></dl></div><div class="variablelist"><p class="title"><strong>Type: jdr</strong></p><dl class="variablelist"><dt><span class="term">Classification: jdr</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707319092752" scope="col"> PATH </th><th align="left" valign="top" id="idm140707319091696" scope="col"> attributes </th><th align="left" valign="top" id="idm140707329839952" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707319092752"> <div class="para"><p><!--Empty--></p>
											/subsystem=jdr
										</div>
										 </td><td align="left" valign="top" headers="idm140707319091696"> </td><td align="left" valign="top" headers="idm140707329839952"> <div class="para"><p><!--Empty--></p>
											generate-jdr-report
										</div>
										 </td></tr></tbody></table></div></li></ul></div></dd></dl></div><div class="variablelist"><p class="title"><strong>Type: jmx</strong></p><dl class="variablelist"><dt><span class="term">Classification: jmx</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707318312112" scope="col"> PATH </th><th align="left" valign="top" id="idm140707318311024" scope="col"> attributes </th><th align="left" valign="top" id="idm140707331737104" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707318312112"> <div class="para"><p><!--Empty--></p>
											/subsystem=jmx
										</div>
										 </td><td align="left" valign="top" headers="idm140707318311024"> </td><td align="left" valign="top" headers="idm140707331737104"> </td></tr></tbody></table></div></li></ul></div></dd></dl></div><div class="variablelist"><p class="title"><strong>Type: mail</strong></p><dl class="variablelist"><dt><span class="term">Classification: mail-server-security</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707318312752" scope="col"> PATH </th><th align="left" valign="top" id="idm140707334998000" scope="col"> attributes </th><th align="left" valign="top" id="idm140707334996912" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707318312752"> <div class="para"><p><!--Empty--></p>
											/subsystem=mail/mail-session=*/server=pop3
										</div>
										 </td><td align="left" valign="top" headers="idm140707334998000"> <div class="para"><p><!--Empty--></p>
											username, tls, ssl, password
										</div>
										 </td><td align="left" valign="top" headers="idm140707334996912"> </td></tr><tr><td align="left" valign="top" headers="idm140707318312752"> <div class="para"><p><!--Empty--></p>
											/subsystem=mail/mail-session=*/server=imap
										</div>
										 </td><td align="left" valign="top" headers="idm140707334998000"> <div class="para"><p><!--Empty--></p>
											username, tls, ssl, password
										</div>
										 </td><td align="left" valign="top" headers="idm140707334996912"> </td></tr><tr><td align="left" valign="top" headers="idm140707318312752"> <div class="para"><p><!--Empty--></p>
											/subsystem=mail/mail-session=*/custom=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707334998000"> <div class="para"><p><!--Empty--></p>
											username, tls, ssl, password
										</div>
										 </td><td align="left" valign="top" headers="idm140707334996912"> </td></tr><tr><td align="left" valign="top" headers="idm140707318312752"> <div class="para"><p><!--Empty--></p>
											/subsystem=mail/mail-session=*/server=smtp
										</div>
										 </td><td align="left" valign="top" headers="idm140707334998000"> <div class="para"><p><!--Empty--></p>
											username, tls, ssl, password
										</div>
										 </td><td align="left" valign="top" headers="idm140707334996912"> </td></tr></tbody></table></div></li></ul></div></dd></dl></div><div class="variablelist"><p class="title"><strong>Type: naming</strong></p><dl class="variablelist"><dt><span class="term">Classification: jndi-view</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: true
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707334352832" scope="col"> PATH </th><th align="left" valign="top" id="idm140707334351744" scope="col"> attributes </th><th align="left" valign="top" id="idm140707311704592" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707334352832"> <div class="para"><p><!--Empty--></p>
											/subsystem=naming
										</div>
										 </td><td align="left" valign="top" headers="idm140707334351744"> </td><td align="left" valign="top" headers="idm140707311704592"> <div class="para"><p><!--Empty--></p>
											jndi-view
										</div>
										 </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: naming-binding</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: false
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707337007360" scope="col"> PATH </th><th align="left" valign="top" id="idm140707325146352" scope="col"> attributes </th><th align="left" valign="top" id="idm140707325145264" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707337007360"> <div class="para"><p><!--Empty--></p>
											/subsystem=naming/binding=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707325146352"> </td><td align="left" valign="top" headers="idm140707325145264"> </td></tr></tbody></table></div></li></ul></div></dd></dl></div><div class="variablelist"><p class="title"><strong>Type: remoting</strong></p><dl class="variablelist"><dt><span class="term">Classification: remoting-security</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: true
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707340986128" scope="col"> PATH </th><th align="left" valign="top" id="idm140707340985040" scope="col"> attributes </th><th align="left" valign="top" id="idm140707317851888" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707340986128"> <div class="para"><p><!--Empty--></p>
											/subsystem=remoting/connector=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707340985040"> <div class="para"><p><!--Empty--></p>
											authentication-provider, security-realm
										</div>
										 </td><td align="left" valign="top" headers="idm140707317851888"> </td></tr><tr><td align="left" valign="top" headers="idm140707340986128"> <div class="para"><p><!--Empty--></p>
											/subsystem=remoting/remote-outbound-connection=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707340985040"> <div class="para"><p><!--Empty--></p>
											username, security-realm
										</div>
										 </td><td align="left" valign="top" headers="idm140707317851888"> </td></tr><tr><td align="left" valign="top" headers="idm140707340986128"> <div class="para"><p><!--Empty--></p>
											/subsystem=remoting/connector=*/security=sasl
										</div>
										 </td><td align="left" valign="top" headers="idm140707340985040"> </td><td align="left" valign="top" headers="idm140707317851888"> </td></tr></tbody></table></div></li></ul></div></dd></dl></div><div class="variablelist"><p class="title"><strong>Type: resource-adapters</strong></p><dl class="variablelist"><dt><span class="term">Classification: resource-adapter-security</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: true
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707314487200" scope="col"> PATH </th><th align="left" valign="top" id="idm140707314486112" scope="col"> attributes </th><th align="left" valign="top" id="idm140707315106912" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707314487200"> <div class="para"><p><!--Empty--></p>
											/subsystem=resource-adapters/resource-adapter=*/connection-definitions=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707314486112"> <div class="para"><p><!--Empty--></p>
											security-domain, recovery-username, recovery-security-domain, security-application, security-domain-and-application, recovery-password
										</div>
										 </td><td align="left" valign="top" headers="idm140707315106912"> </td></tr></tbody></table></div></li></ul></div></dd></dl></div><div class="variablelist"><p class="title"><strong>Type: security</strong></p><dl class="variablelist"><dt><span class="term">Classification: misc-security</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: true
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707321293376" scope="col"> PATH </th><th align="left" valign="top" id="idm140707321292288" scope="col"> attributes </th><th align="left" valign="top" id="idm140707337659600" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707321293376"> <div class="para"><p><!--Empty--></p>
											/subsystem=security
										</div>
										 </td><td align="left" valign="top" headers="idm140707321292288"> <div class="para"><p><!--Empty--></p>
											deep-copy-subject-mode
										</div>
										 </td><td align="left" valign="top" headers="idm140707337659600"> </td></tr></tbody></table></div></li></ul></div></dd></dl></div><div class="variablelist"><p class="title"><strong>Type: web</strong></p><dl class="variablelist"><dt><span class="term">Classification: web-access-log</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: false
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707330430432" scope="col"> PATH </th><th align="left" valign="top" id="idm140707312548016" scope="col"> attributes </th><th align="left" valign="top" id="idm140707311255904" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707330430432"> <div class="para"><p><!--Empty--></p>
											/subsystem=web/virtual-server=*/configuration=access-log
										</div>
										 </td><td align="left" valign="top" headers="idm140707312548016"> </td><td align="left" valign="top" headers="idm140707311255904"> </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: web-connector</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: false
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707317576592" scope="col"> PATH </th><th align="left" valign="top" id="idm140707312406352" scope="col"> attributes </th><th align="left" valign="top" id="idm140707311079728" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707317576592"> <div class="para"><p><!--Empty--></p>
											/subsystem=web/connector=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707312406352"> </td><td align="left" valign="top" headers="idm140707311079728"> </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: web-ssl</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: true
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707324607136" scope="col"> PATH </th><th align="left" valign="top" id="idm140707316872720" scope="col"> attributes </th><th align="left" valign="top" id="idm140707311983376" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707324607136"> <div class="para"><p><!--Empty--></p>
											/subsystem=web/connector=*/configuration=ssl
										</div>
										 </td><td align="left" valign="top" headers="idm140707316872720"> </td><td align="left" valign="top" headers="idm140707311983376"> </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: web-sso</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: true
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: true
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707317643024" scope="col"> PATH </th><th align="left" valign="top" id="idm140707325267936" scope="col"> attributes </th><th align="left" valign="top" id="idm140707321297840" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707317643024"> <div class="para"><p><!--Empty--></p>
											/subsystem=web/virtual-server=*/configuration=sso
										</div>
										 </td><td align="left" valign="top" headers="idm140707325267936"> </td><td align="left" valign="top" headers="idm140707321297840"> </td></tr></tbody></table></div></li></ul></div></dd><dt><span class="term">Classification: web-valve</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-addressable: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-read: false
						</div></li><li class="listitem"><div class="para"><p><!--Empty--></p>
							requires-write: false
						</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="col_1"><!--Empty--></col><col width="25%" class="col_2"><!--Empty--></col><col width="25%" class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm140707321927264" scope="col"> PATH </th><th align="left" valign="top" id="idm140707322639872" scope="col"> attributes </th><th align="left" valign="top" id="idm140707322638784" scope="col"> operations </th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140707321927264"> <div class="para"><p><!--Empty--></p>
											/subsystem=web/valve=*
										</div>
										 </td><td align="left" valign="top" headers="idm140707322639872"> </td><td align="left" valign="top" headers="idm140707322638784"> </td></tr></tbody></table></div></li></ul></div></dd></dl></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24685-562799+%5BSpecified%5D&amp;comment=Title%3A+Sensitivity+Constraints+Reference%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24685-562799+02+Dec+2013+17%3A22+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div></div><div xml:lang="en-US" class="chapter" id="chap-Web_HTTP_Connectors_and_HTTP_Clustering" lang="en-US"><div class="titlepage"><div><div><h2 class="title">Chapter 12. Web, HTTP Connectors, and HTTP Clustering</h2></div></div></div><div xml:lang="en-US" class="section" id="Configure_a_mod_cluster_Worker_Node" lang="en-US"><div class="titlepage"><div><div><h2 class="title">12.1. Configure a mod_cluster Worker Node</h2></div></div></div><div class="para"><div class="title">Summary</div><p>
			A mod_cluster worker node consists of an JBoss EAP server. This server can be part of a server group in a Managed Domain, or a standalone server. A separate process runs within JBoss EAP, which manages all of the nodes of the cluster. This is called the master. For more conceptual information about worker nodes, refer to <em class="citetitle">Worker Node</em> in the <em class="citetitle">Red Hat JBoss Enterprise Application Platform 6.1 Administration and Configuration Guide</em>. For an overview of HTTPD load balancing, refer to <em class="citetitle">Overview of HTTP Connectors</em> in the <em class="citetitle">Administration and Configuration Guide</em>.
		</p></div><div class="para">
		The master is only configured once, via the <code class="code">mod_cluster</code> subsystem. To configure the <code class="code">mod_cluster</code> subsystem, refer to <em class="citetitle">Configure the mod_cluster Subsystem</em> in the <em class="citetitle">Administration and Configuration Guide</em>. Each worker node is configured separately, so repeat this procedure for each node you wish to add to the cluster.
	</div><div class="para">
		If you use a managed domain, each server in a server group is a worker node which shares an identical configuration. Therefore, configuration is done to an entire server group. In a standalone server, configuration is done to a single JBoss EAP 6 instance. The configuration steps are otherwise identical.
	</div><div class="itemizedlist"><p class="title"><strong>Worker Node Configuration</strong></p><ul><li class="listitem"><div class="para">
				If you use a standalone server, it must be started with the <code class="code">standalone-ha</code> profile.
			</div></li><li class="listitem"><div class="para">
				If you use a managed domain, your server group must use the <code class="code">ha</code> or <code class="code">full-ha</code> profile, and the <code class="code">ha-sockets</code> or <code class="code">full-ha-sockets</code> socket binding group. JBoss EAP 6 ships with a cluster-enabled server group called <code class="code">other-server-group</code> which meets these requirements.
			</div></li></ul></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			Where Management CLI commands are given, they assume you use a managed domain. If you use a standalone server, remove the <code class="code">/profile=full-ha</code> portion of the commands.
		</div></div></div><div class="procedure"><p class="title"><strong>Procedure 12.1. Configure a Worker Node</strong></p><ol class="1"><li class="step"><p class="title"><strong>Configure the network interfaces.</strong></p><div class="para">
				By default, the network interfaces all default to <code class="literal">127.0.0.1</code>. Every physical host which hosts either a standalone server or one or more servers in a server group needs its interfaces to be configured to use its public IP address, which the other servers can see.
			</div><div class="para">
				To change the IP address of a JBoss EAP 6 host, you need to shut it down and edit its configuration file directly. This is because the Management API which drives the Management Console and Management CLI relies on a stable management address.
			</div><div class="para">
				Follow these steps to change the IP address on each server in your cluster to the master's public IP address.
			</div><ol class="substeps a"><li class="step"><div class="para">
						Shut down the server completely.
					</div></li><li class="step"><div class="para">
						Edit either the <code class="filename">host.xml</code>, which is in <code class="filename"><em class="replaceable">EAP_HOME</em>/domain/configuration/</code> for a managed domain, or the <code class="filename">standalone-ha.xml</code> file, which is in <code class="filename"><em class="replaceable">EAP_HOME</em>/standalone/configuration/</code> for a standalone server.
					</div></li><li class="step"><div class="para">
						Locate the <code class="sgmltag-element">&lt;interfaces&gt;</code> element. Three interfaces are configured, <code class="literal">management</code>, <code class="literal">public</code>, and <code class="literal">unsecured</code>. For each of these, change the value <code class="literal">127.0.0.1</code> to the external IP address of the host.
					</div></li><li class="step"><div class="para">
						For hosts that participate in a managed domain but are not the master, locate the <code class="sgmltag-element">&lt;host</code> element. Note that it does not have the closing <code class="literal">&gt;</code> symbol, because it contains attributes. Change the value of its name attribute from <code class="literal">master</code> to a unique name, a different one per slave. This name will also be used for the slave to identify to the cluster, so make a note of it.
					</div></li><li class="step"><div class="para">
						For newly-configured hosts which need to join a managed domain, find the <code class="sgmltag-element">&lt;domain-controller&gt;</code> element. Comment out or remove the <code class="sgmltag-element">&lt;local /&gt;</code> element, and add the following line, changing the IP address (<code class="literal">X.X.X.X</code>) to the address of the domain controller. This step does not apply for a standalone server.
					</div><pre class="screen">
&lt;remote host="X.X.X.X" port="${jboss.domain.master.port:9999}" security-realm="ManagementRealm"/&gt;</pre></li><li class="step"><div class="para">
						Save the file and exit.
					</div></li></ol></li><li class="step"><p class="title"><strong>Configure authentication for each slave server.</strong></p><div class="para">
				Each slave server needs a username and password created in the domain controller's or standalone master's <code class="literal">ManagementRealm</code>. On the domain controller or standalone master, run the <code class="filename"><em class="replaceable">EAP_HOME</em>/bin/add-user.sh</code> command. Add a user with the same username as the slave, to the <code class="literal">ManagementRealm</code>. When asked if this user will need to authenticate to an external JBoss AS instance, answer <code class="literal">yes</code>. An example of the input and output of the command is below, for a slave called <code class="literal">slave1</code>, with password <code class="literal">changeme</code>.
			</div><pre class="screen">
user:bin user$ ./add-user.sh

What type of user do you wish to add? 
 a) Management User (mgmt-users.properties) 
 b) Application User (application-users.properties)
(a): <code class="prompt">a</code>

Enter the details of the new user to add.
Realm (ManagementRealm) : 
Username : <code class="prompt">slave1</code>
Password : <code class="prompt">changeme</code>
Re-enter Password : <code class="prompt">changeme</code>
About to add user 'slave1' for realm 'ManagementRealm'
Is this correct yes/no? <code class="prompt">yes</code>
Added user 'slave1' to file '/home/user/jboss-eap-6.0/standalone/configuration/mgmt-users.properties'
Added user 'slave1' to file '/home/user/jboss-eap-6.0/domain/configuration/mgmt-users.properties'
Is this new user going to be used for one AS process to connect to another AS process e.g. slave domain controller?
yes/no? yes
To represent the user add the following to the server-identities definition &lt;secret value="Y2hhbmdlbWU=" /&gt;
</pre></li><li class="step"><p class="title"><strong>Copy the Base64-encoded <code class="code">&lt;secret&gt;</code> element from the <code class="code">add-user.sh</code> output.</strong></p><div class="para">
				If you plan to specify the Base64-encoded password value for authentication, copy the <code class="code">&lt;secret&gt;</code> element value from the last line of the <code class="code">add-user.sh</code> output as you will need it in the step below.
			</div></li><li class="step"><p class="title"><strong>Modify the slave host's security realm to use the new authentication.</strong></p><ol class="substeps a"><li class="step"><div class="para">
						Re-open the slave host's <code class="filename">host.xml</code> or <code class="filename">standalone-ha.xml</code> file.
					</div></li><li class="step"><div class="para">
						Locate the <code class="sgmltag-element">&lt;security-realms&gt;</code> element. This is where you configure the security realm.
					</div></li><li class="step"><div class="para">
						You can specify the secret value in one of the following ways:
					</div><ul class="stepalternatives">
						<li class="step"><p class="title"><strong>Specify the Base64-encoded password value in the configuration file.</strong></p><ol class="substeps i"><li class="step"><div class="para">
										Add the following block of XML code directly below the <code class="sgmltag-element">&lt;security-realm name="ManagementRealm"&gt;</code> line,
									</div><pre class="screen">
&lt;server-identities&gt;
    &lt;secret value="Y2hhbmdlbWU="/&gt;
&lt;/server-identities&gt;

</pre></li><li class="step"><div class="para">
										Replace the "Y2hhbmdlbWU=" with the secret value returned from the <code class="command">add-user.sh</code> output in the previous step.
									</div></li></ol></li>
						 <li class="step"><p class="title"><strong>Configure the host to get the password from the vault.</strong></p><ol class="substeps i"><li class="step"><div class="para">
										Use the <code class="filename">vault.sh</code> script to generate a masked password. It will generate a string like the following: <code class="literal">VAULT::secret::password::ODVmYmJjNGMtZDU2ZC00YmNlLWE4ODMtZjQ1NWNmNDU4ZDc1TElORV9CUkVBS3ZhdWx0</code>.
									</div><div class="para">
										You can find more information on the vault in the Password Vaults for Sensitive Strings section of this guide starting here: <a class="xref" href="#About_Securing_Sensitive_Strings_in_Clear-Text_Files1">Section 10.11.1, “About Securing Sensitive Strings in Clear-Text Files”</a>.
									</div></li><li class="step"><div class="para">
										Add the following block of XML code directly below the <code class="sgmltag-element">&lt;security-realm name="ManagementRealm"&gt;</code> line.
									</div><pre class="screen">
&lt;server-identities&gt;
    &lt;secret value="${VAULT::secret::password::ODVmYmJjNGMtZDU2ZC00YmNlLWE4ODMtZjQ1NWNmNDU4ZDc1TElORV9CUkVBS3ZhdWx0}"/&gt;
&lt;/server-identities&gt;

</pre><div class="para">
										Be sure to replace the secret value with the masked password generated in the previous step.
									</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
											When creating a password in the vault, it must be specified in plain text, not Base64-encoded.
										</div></div></div></li></ol><div class="para">

							</div></li>
						 <li class="step"><p class="title"><strong>Specify the password as a system property.</strong></p><ol class="substeps i"><li class="step"><div class="para">
										Add the following block of XML code directly below the <code class="sgmltag-element">&lt;security-realm name="ManagementRealm"&gt;</code> line
									</div><pre class="screen">
&lt;server-identities&gt;
    &lt;secret value="${server.identity.password}"/&gt;
&lt;/server-identities&gt;

</pre></li><li class="step"><div class="para">
										When you specify the password as a system property, you can configure the host in either of the following ways:
									</div><ul class="stepalternatives">
										<li class="step"><div class="para">
												Start the server entering the password in plain text as a command line argument, for example: 
<pre class="screen">-Dserver.identity.password=changeme</pre>

											</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
													The password must be entered in plain text and will be visible to anyone who issues a <code class="command">ps -ef</code> command.
												</div></div></div></li>
										 <li class="step"><div class="para">
												Place the password in a properties file and pass the properties file URL as a command line argument.
											</div><ol class="substeps A"><li class="step"><div class="para">
														Add the key/value pair to a properties file. For example:
													</div><pre class="screen">
server.identity.password=changeme
</pre></li><li class="step"><div class="para">
														Start the server with the command line arguments 
<pre class="screen">--properties=<em class="replaceable">URL_TO_PROPERTIES_FILE</em></pre>
														 .
													</div></li></ol></li>

									</ul></li></ol><div class="para">

							</div></li>

					</ul></li><li class="step"><div class="para">
						Save and exit the file.
					</div></li></ol></li><li class="step"><p class="title"><strong>Restart the server.</strong></p><div class="para">
				The slave will now authenticate to the master using its host name as the username and the encrypted string as its password.
			</div></li></ol></div><div class="para"><div class="title">Result</div><p>
			Your standalone server, or servers within a server group of a managed domain, are now configured as mod_cluster worker nodes. If you deploy a clustered application, its sessions are replicated to all cluster nodes for failover, and it can accept requests from an external HTTPD server or load balancer. Each node of the cluster discovers the other nodes using automatic discovery, by default.To configure automatic discovery, and the other specific settings of the <code class="code">mod_cluster</code> subsystem, refer to <em class="citetitle">Configure the mod_cluster Subsystem</em> in the <em class="citetitle">Administration and Configuration Guide</em>. To configure the Apache HTTPD server, refer to <em class="citetitle">Use an External HTTPD as the Web Front-end for JBoss EAP 6 Applications</em> in the <em class="citetitle">Administration and Configuration Guide</em>.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+5223-545582+%5BSpecified%5D&amp;comment=Title%3A+Configure+a+mod_cluster+Worker+Node%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5223-545582+11+Oct+2013+11%3A26+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div xml:lang="en-US" class="chapter" id="chap-Patch_Installation" lang="en-US"><div class="titlepage"><div><div><h2 class="title">Chapter 13. Patch Installation</h2></div></div></div><div xml:lang="en-US" class="section" id="About_Patches_and_Upgrades" lang="en-US"><div class="titlepage"><div><div><h2 class="title">13.1. About Patches and Upgrades</h2></div></div></div><div class="para">
		The patching mechanism in JBoss EAP 6 applies updates which are made available to a specific 'minor' version of JBoss EAP 6, for example JBoss EAP 6.2. Patches can contain one-off, security, or cumulative updates.
	</div><div class="para">
		Upgrading between major and minor releases of JBoss EAP (for example, from 6.1 to 6.2) requires a different process.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24385-550310+%5BSpecified%5D&amp;comment=Title%3A+About+Patches+and+Upgrades%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24385-550310+04+Nov+2013+09%3A24+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="About_Patching_Mechanisms" lang="en-US"><div class="titlepage"><div><div><h2 class="title">13.2. About Patching Mechanisms</h2></div></div></div><div class="para">
		JBoss patches are released in two forms.
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				Asynchronous updates: one-off patches which are released outside the normal update cycle of the existing product. These may include security patches, as well as other one-off patches provided by Red Hat Global Support Services (GSS) to fix specific issues.
			</div></li><li class="listitem"><div class="para">
				Planned updates: These include cumulative patches, as well as micro, minor or major upgrades of an existing product. Cumulative patches include all previously developed asynchronous updates for that version of the product.
			</div></li></ul></div><div class="para">
		Deciding whether a patch is released as part of a planned update or an asynchronous update depends on the severity of the issue being fixed. An issue of low impact is typically deferred, and is resolved in the next cumulative patch or minor release of the affected product. Issues of moderate or higher impact are typically addressed in order of importance as an asynchronous update to the affected product, and contain a fix for only a specific issue.
	</div><div class="para">
		Cumulative and security patches for JBoss products are distributed in two forms: zip (for all products) and RPM (for a subset of products).
	</div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
			A JBoss product installation must always only be updated using one patch method: either zip or RPM patches.
		</div></div></div><div class="para">
		Security updates for JBoss products are provided by an erratum (for both zip and RPM methods). The erratum encapsulates a list of the resolved flaws, their severity ratings, the affected products, textual description of the flaws, and a reference to the patches. Bug fix updates are not announced via an erratum.
	</div><div class="para">
		For more information on how Red Hat rates JBoss security flaws, refer to: <a class="xref" href="#Severity_and_Impact_Rating_of_JBoss_Security_Patches">Section 13.6, “Severity and Impact Rating of JBoss Security Patches”</a>
	</div><div class="para">
		Red Hat maintains a mailing list for notifying subscribers about security related flaws. See <a class="xref" href="#Subscribe_to_Patch_Mailing_Lists">Section 13.3, “Subscribe to Patch Mailing Lists”</a>
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+13441-545448+%5BSpecified%5D&amp;comment=Title%3A+About+Patching+Mechanisms%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=13441-545448+10+Oct+2013+14%3A41+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Subscribe_to_Patch_Mailing_Lists" lang="en-US"><div class="titlepage"><div><div><h2 class="title">13.3. Subscribe to Patch Mailing Lists</h2></div></div></div><div class="para"><div class="title">Summary</div><p>
			The JBoss team at Red Hat maintains a mailing list for security announcements for Red Hat JBoss Enterprise Middleware products. This topic covers what you need to do to subscribe to this list.
		</p></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul><li class="listitem"><div class="para">
				None
			</div></li></ul></div><div class="procedure"><p class="title"><strong>Procedure 13.1. Subscribe to the JBoss Watch List</strong></p><ol class="1"><li class="step"><div class="para">
				Click the following link to go to the JBoss Watch mailing list page: <a href="http://www.redhat.com/mailman/listinfo/jboss-watch-list" class="mimir-link-warn" title="Mimir does not include content from: www.redhat.com">JBoss Watch Mailing List</a>.
			</div></li><li class="step"><div class="para">
				Enter your email address in the <span class="guilabel"><strong>Subscribing to Jboss-watch-list</strong></span> section.
			</div></li><li class="step"><div class="para">
				[<span class="optional">You may also wish to enter your name and select a password. Doing so is optional but recommended.</span>]
			</div></li><li class="step"><div class="para">
				Press the <span class="guibutton"><strong>Subscribe</strong></span> button to start the subscription process.
			</div></li><li class="step"><div class="para">
				You can browse the archives of the mailing list by going to: <a href="https://www.redhat.com/archives/jboss-watch-list/" class="mimir-link-warn" title="Mimir does not include content from: www.redhat.com">JBoss Watch Mailing List Archives</a>.
			</div></li></ol></div><div class="para"><div class="title">Result</div><p>
			After confirmation of your email address, you will be subscribed to receive security related announcements from the JBoss patch mailing list.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+13442-545448+%5BSpecified%5D&amp;comment=Title%3A+Subscribe+to+Patch+Mailing+Lists%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=13442-545448+10+Oct+2013+14%3A41+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div class="section" id="sect-Install_Patches_in_Zip_Form"><div class="titlepage"><div><div><h2 class="title">13.4. Install Patches in Zip Form</h2></div></div></div><div xml:lang="en-US" class="section" id="The_patch_Command" lang="en-US"><div class="titlepage"><div><div><h3 class="title">13.4.1. The <code class="command">patch</code> Command</h3></div></div></div><div class="para">
		The <code class="command">patch</code> command is used to apply downloaded zip patches to a single JBoss EAP 6 server instance. It cannot be used to automatically patch JBoss EAP 6 server instances across a managed domain, but individual server instances in a managed domain can be patched independently.
	</div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
			JBoss EAP 6 server instances which have been installed using the RPM method cannot be updated using the <code class="command">patch</code> command. Refer to <a class="xref" href="#Install_Patches_in_RPM_form">Section 13.5, “Install Patches in RPM form”</a> to update RPM-installed JBoss EAP 6 servers.
		</div></div></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			The <code class="command">patch</code> command can only be used with patches produced for versions of JBoss EAP 6.2 and later. For patches for versions of JBoss EAP prior to 6.2, you should instead refer to the relevant version's documentation available at <a href="/products/">https://access.redhat.com/site/documentation/</a>.
		</div></div></div><div class="para">
		In addition to applying patches, the <code class="command">patch</code> command can give basic information on the state of installed patches, and also provides a way to immediately rollback the application of a patch.
	</div><div class="para">
		Before starting a patch application or rollback operation, the <code class="command">patch</code> tool will check the modules and other miscellaneous files that it is changing for any user modifications. If a user modification is detected, and a conflict-handling switch has not been specified, the <code class="command">patch</code> tool will abort the operation and warn that there is a conflict. The warning will include a list of the modules and other files that are in conflict. To complete the operation, the <code class="command">patch</code> command must be re-run with a switch specifying how to resolve the conflict: either to preserve the user modifications, or to override them.
	</div><div class="table" id="idm140707314722016"><p class="title"><strong>Table 13.1. <code class="command">patch</code> Command Arguments and Switches</strong></p><div class="table-contents"><table class="lt-4-cols gt-7-rows" summary="patch Command Arguments and Switches"><colgroup><col align="left" class="c1"><!--Empty--></col><col align="left" class="c2"><!--Empty--></col></colgroup><thead><tr><th align="left" id="idm140707325489904" scope="col"> Argument or Switch </th><th align="left" id="idm140707309147488" scope="col"> Description </th></tr></thead><tbody><tr><td align="left" headers="idm140707325489904"> <code class="code">apply</code> </td><td align="left" headers="idm140707309147488"> Applies a patch. </td></tr><tr><td align="left" headers="idm140707325489904"> <code class="code">--override-all</code> </td><td align="left" headers="idm140707309147488"> If there is a conflict, the patch operation overrides any user modifications. </td></tr><tr><td align="left" headers="idm140707325489904"> <code class="code">--override-modules</code> </td><td align="left" headers="idm140707309147488"> If there is a conflict as a result of any modified modules, this switch overrides those modifications with the contents of the patch operation. </td></tr><tr><td align="left" headers="idm140707325489904"> <code class="code">--override=<em class="replaceable">path</em>(,<em class="replaceable">path</em>)</code> </td><td align="left" headers="idm140707309147488"> For specified miscellaneous files only, this will override the conflicting modified files with the files in the patch operation. </td></tr><tr><td align="left" headers="idm140707325489904"> <code class="code">--preserve=<em class="replaceable">path</em>(,<em class="replaceable">path</em>)</code> </td><td align="left" headers="idm140707309147488"> For specified miscellaneous files only, this will preserve the conflicting modified files. </td></tr><tr><td align="left" headers="idm140707325489904"> <code class="code">info</code> </td><td align="left" headers="idm140707309147488"> Returns information on currently installed patches. </td></tr><tr><td align="left" headers="idm140707325489904"> <code class="code">rollback</code> </td><td align="left" headers="idm140707309147488"> Rollsback the application of a patch. </td></tr><tr><td align="left" headers="idm140707325489904"> <code class="code">--reset-configuration=<em class="replaceable">TRUE</em>|<em class="replaceable">FALSE</em></code> </td><td align="left" headers="idm140707309147488"> Required for rollback, this specifies whether to restore the server configuration files as part of the rollback operation. </td></tr></tbody></table></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+21440-545448+%5BSpecified%5D&amp;comment=Title%3A+The+%3Ccommand%3Epatch%3C%2Fcommand%3E+Command%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=21440-545448+10+Oct+2013+14%3A41+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Installing_Patches_in_Zip_Form_Using_the_patch_Command" lang="en-US"><div class="titlepage"><div><div><h3 class="title">13.4.2. Installing Patches in Zip Form Using the <code class="command">patch</code> Command</h3></div></div></div><div class="para"><div class="title">Summary</div><p>
			This task describes how to use the <code class="command">patch</code> command to install patches for JBoss EAP 6 that are in the zip format.
		</p></div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
			The <code class="command">patch</code> command is a feature that was added in JBoss EAP 6.2. For versions of JBoss EAP prior to 6.2, the process to install patches in zip form is different, and you should instead refer to the relevant version's documentation available at <a href="/products/">https://access.redhat.com/site/documentation/</a>.
		</div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul><li class="listitem"><div class="para">
				Valid access and subscription to the Red Hat Customer Portal.
			</div></li><li class="listitem"><div class="para">
				A current subscription to a JBoss product installed in zip format.
			</div></li><li class="listitem"><div class="para">
				Access to the Management CLI for the server instance to be updated. Refer to <em class="citetitle">Launch the Management CLI</em> in the <em class="citetitle">Administration and Configuration Guide</em>.
			</div></li></ul></div><div class="procedure"><p class="title"><strong>Procedure 13.2. Apply a zip patch to a JBoss EAP 6 server instance using the <code class="command">patch</code> command</strong></p><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
				Before installing a patch, you should backup your JBoss product along with all customized configuration files.
			</div></div></div><ol class="1"><li class="step"><div class="para">
				Download the patch zip file from the Customer Portal at <a href="https://access.redhat.com/downloads/" class="mimir-link-warn" title="This content is not included in Mimir.">https://access.redhat.com/downloads/</a>
			</div></li><li class="step"><div class="para">
				From the Management CLI, apply the patch with the following command with the appropriate path to the patch file:
			</div><pre class="screen">[standalone@localhost:9999 /] <code class="command">patch apply <em class="replaceable">/path/to/downloaded-patch.zip</em></code></pre><div class="para">
				The <code class="command">patch</code> tool will warn if there are any conflicts in attempting the apply the patch. Refer to <a class="xref" href="#The_patch_Command">Section 13.4.1, “The <code class="command">patch</code> Command”</a> for available switches to re-run the command to resolve any conflicts.
			</div></li><li class="step"><div class="para">
				Restart the JBoss EAP 6 server instance for the patch to take effect:
			</div><pre class="screen">[standalone@localhost:9999 /] <code class="command">shutdown --restart=true</code></pre></li></ol></div><div class="para"><div class="title">Result</div><p>
			The JBoss EAP 6 server instance is patched with the latest update.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+21405-545448+%5BSpecified%5D&amp;comment=Title%3A+Installing+Patches+in+Zip+Form+Using+the+%3Ccommand%3Epatch%3C%2Fcommand%3E+Command%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=21405-545448+10+Oct+2013+14%3A41+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Rollback_the_Application_of_a_Patch_in_Zip_Form_Using_the_patch_Command" lang="en-US"><div class="titlepage"><div><div><h3 class="title">13.4.3. Rollback the Application of a Patch in Zip Form Using the <code class="command">patch</code> Command</h3></div></div></div><div class="para">

	</div><div class="para"><div class="title">Summary</div><p>
			This task describes how to use the <code class="command">patch</code> command to rollback the application of a previously applied zip patch in JBoss EAP 6.
		</p></div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
			Rolling back the application of a patch using the <code class="command">patch</code> command is not intended as a general uninstall functionality. It is only intended to be used immediately after the application of a patch which had undesirable consequences.
		</div></div></div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
			The <code class="command">patch</code> command is a feature that was added in JBoss EAP 6.2. For versions of JBoss EAP prior to 6.2, the process to rollback patches in zip form is different, and you should instead refer to the relevant version's documentation available at <a href="/products/">https://access.redhat.com/site/documentation/</a>.
		</div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul><li class="listitem"><div class="para">
				A patch that was previously applied using the <code class="command">patch</code> command.
			</div></li><li class="listitem"><div class="para">
				Access to the Management CLI for the server instance. Refer to <em class="citetitle">Launch the Management CLI</em> in the <em class="citetitle">Administration and Configuration Guide</em>.
			</div></li></ul></div><div class="procedure"><p class="title"><strong>Procedure 13.3. Rollback a patch from a JBoss EAP 6 server instance using the <code class="command">patch</code> command</strong></p><ol class="1"><li class="step"><div class="para">
				From the Management CLI, use the <code class="command">patch info</code> command to find the ID of the patch that is to be rolled back.
			</div><ul class="stepalternatives">
				<li class="step"><div class="para">
						For cumulative patches, the patch ID is the value of the first <code class="varname">cumulative-patch-id</code> shown in the <code class="command">patch info</code> output.
					</div></li>
				 <li class="step"><div class="para">
						One-off security or bug fix patch IDs are listed as the value of the first <code class="varname">patches</code> shown in the <code class="command">patch info</code> output, with the most recently applied one-off patch listed first.
					</div></li>

			</ul></li><li class="step"><div class="para">
				From the Management CLI, rollback the patch with the appropriate patch ID from the previous step.
			</div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
					Use caution when specifying the value of the <code class="command">--reset-configuration</code> switch.
				</div><div class="para">
					If set to <code class="literal">TRUE</code>, the patch rollback process will also rollback the JBoss EAP 6 server configuration files to their pre-patch state. Any changes that were made to the JBoss EAP 6 server configuration files after the patch was applied will be lost.
				</div><div class="para">
					If set to <code class="literal">FALSE</code>, the server configuration files will not be rolled back. In this situation, it is possible that the server will not start after the rollback, as the patch may have altered configurations, such as namespaces, which may no longer be valid and have to be fixed manually.
				</div></div></div><pre class="screen">[standalone@localhost:9999 /] <code class="command">patch rollback <em class="replaceable">PATCH_ID</em> --reset-configuration=<em class="replaceable">TRUE</em></code></pre><div class="para">
				The <code class="command">patch</code> tool will warn if there are any conflicts in attempting the rollback the patch. Refer to <a class="xref" href="#The_patch_Command">Section 13.4.1, “The <code class="command">patch</code> Command”</a> for available switches to re-run the command to resolve any conflicts.
			</div></li><li class="step"><div class="para">
				Restart the JBoss EAP 6 server instance for the patch rollback to take effect:
			</div><pre class="screen">[standalone@localhost:9999 /] <code class="command">shutdown --restart=true</code></pre></li></ol></div><div class="para"><div class="title">Result</div><p>
			The patch, and optionally also the server configuration files, are rolled back on the JBoss EAP 6 server instance.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+21470-545448+%5BSpecified%5D&amp;comment=Title%3A+Rollback+the+Application+of+a+Patch+in+Zip+Form+Using+the+%3Ccommand%3Epatch%3C%2Fcommand%3E+Command%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=21470-545448+10+Oct+2013+14%3A41+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div xml:lang="en-US" class="section" id="Install_Patches_in_RPM_form" lang="en-US"><div class="titlepage"><div><div><h2 class="title">13.5. Install Patches in RPM form</h2></div></div></div><div class="para"><div class="title">Summary</div><p>
			JBoss patches are distributed in two forms: ZIP (for all products) and RPM (for a subset of products). This task describes the steps you need to take to install the patches via the RPM format.
		</p></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul><li class="listitem"><div class="para">
				A valid subscription to the Red Hat Network.
			</div></li><li class="listitem"><div class="para">
				A current subscription to a JBoss product installed via an RPM package.
			</div></li></ul></div><div class="procedure"><p class="title"><strong>Procedure 13.4. Apply a patch to a JBoss product via the RPM method</strong></p><div class="para">
			Security updates for JBoss products are provided by errata (for both zip and RPM methods). The errata encapsulates a list of the resolved flaws, their severity ratings, the affected products, textual description of the flaws, and a reference to the patches.
		</div><div class="para">
			For RPM distributions of JBoss products, the errata include references to the updated RPM packages. The patch can be installed by using <code class="code">yum</code>.
		</div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
				Before installing a patch, you must backup your JBoss product along with all customized configuration files.
			</div></div></div><ol class="1"><li class="step"><div class="para">
				Get notified about the security patch either via being a subscriber to the JBoss watch mailing list or by browsing the JBoss watch mailing list archives.
			</div></li><li class="step"><div class="para">
				Read the errata for the security patch and confirm that it applies to a JBoss product in your environment.
			</div></li><li class="step"><div class="para">
				If the security patch applies to a JBoss product in your environment, then follow the link to download the updated RPM package which is included in the errata.
			</div></li><li class="step"><div class="para">
				Use 
<pre class="screen"><code class="command">yum update</code></pre>
				 to install the patch.
			</div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
					When updating an RPM installation, your JBoss product is updated cumulatively with all RPM-released fixes.
				</div></div></div></li></ol></div><div class="para"><div class="title">Result</div><p>
			The JBoss product is patched with the latest update using the RPM format.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+13444-548478+%5BSpecified%5D&amp;comment=Title%3A+Install+Patches+in+RPM+form%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=13444-548478+23+Oct+2013+14%3A55+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Severity_and_Impact_Rating_of_JBoss_Security_Patches" lang="en-US"><div class="titlepage"><div><div><h2 class="title">13.6. Severity and Impact Rating of JBoss Security Patches</h2></div></div></div><div class="para">
		To communicate the risk of each JBoss security flaw, Red Hat uses a four-point severity scale of low, moderate, important and critical, in addition to Common Vulnerability Scoring System (CVSS) version 2 base scores which can be used to identify the impact of the flaw.
	</div><div class="table" id="idm140707316836080"><p class="title"><strong>Table 13.2. Severity Ratings of JBoss Security Patches</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="Severity Ratings of JBoss Security Patches"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707325733424" scope="col"> Severity </th><th id="idm140707322657584" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140707325733424"> Critical </td><td headers="idm140707322657584"> <div class="para">
						This rating is given to flaws that could be easily exploited by a remote unauthenticated attacker and lead to system compromise (arbitrary code execution) without requiring user interaction. These are the types of vulnerabilities that can be exploited by worms. Flaws that require an authenticated remote user, a local user, or an unlikely configuration are not classed as critical impact.
					</div>
					 </td></tr><tr><td headers="idm140707325733424"> Important </td><td headers="idm140707322657584"> <div class="para">
						This rating is given to flaws that can easily compromise the confidentiality, integrity, or availability of resources. These are the types of vulnerabilities that allow local users to gain privileges, allow unauthenticated remote users to view resources that should otherwise be protected by authentication, allow authenticated remote users to execute arbitrary code, or allow local or remote users to cause a denial of service.
					</div>
					 </td></tr><tr><td headers="idm140707325733424"> Moderate </td><td headers="idm140707322657584"> <div class="para">
						This rating is given to flaws that may be more difficult to exploit but could still lead to some compromise of the confidentiality, integrity, or availability of resources, under certain circumstances. These are the types of vulnerabilities that could have had a critical impact or important impact but are less easily exploited based on a technical evaluation of the flaw, or affect unlikely configurations.
					</div>
					 </td></tr><tr><td headers="idm140707325733424"> Low </td><td headers="idm140707322657584"> <div class="para">
						This rating is given to all other issues that have a security impact. These are the types of vulnerabilities that are believed to require unlikely circumstances to be able to be exploited, or where a successful exploit would give minimal consequences.
					</div>
					 </td></tr></tbody></table></div></div><div class="para">
		The impact component of a CVSS v2 score is based on a combined assessment of three potential impacts: Confidentiality (C), Integrity (I) and Availability (A). Each of these can be rated as None (N), Partial (P) or Complete (C).
	</div><div class="para">
		Because the JBoss server process runs as an unprivileged user and is isolated from the host operating system, JBoss security flaws are only rated as having impacts of either None (N) or Partial (P).
	</div><div class="example" id="idm140707320791504"><p class="title"><strong>Example 13.1. CVSS v2 Impact Score</strong></p><div class="example-contents"><div class="para">
			The example below shows a CVSS v2 impact score, where exploiting the flaw would have no impact on system confidentiality, partial impact on system integrity and complete impact on system availability (that is, the system would become completely unavailable for any use, for example, via a kernel crash).
		</div><pre class="screen"><code class="command">C:N/I:P/A:C</code></pre></div></div><div class="para">
		Combined with the severity rating and the CVSS score, organizations can make informed decisions on the risk each issue places on their unique environment and schedule upgrades accordingly.
	</div><div class="para">
		For more information about CVSS2, please see: <a href="https://access.redhat.com/security/updates/classification/" class="mimir-link-warn" title="This content is not included in Mimir.">CVSS2 Guide</a>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+13447-545448+%5BSpecified%5D&amp;comment=Title%3A+Severity+and+Impact+Rating+of+JBoss+Security+Patches%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=13447-545448+10+Oct+2013+14%3A41+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Manage_Security_Updates_for_Dependencies_Bundled_Inside_the_Applications_Deployed_on_JBoss_EAP" lang="en-US"><div class="titlepage"><div><div><h2 class="title">13.7. Manage Security Updates for Dependencies Bundled Inside the Applications Deployed on JBoss EAP</h2></div></div></div><div class="para">
		Red Hat provides security patches for all components that are part of the JBoss EAP distribution. However, many users of JBoss EAP deploy applications which bundle their own dependencies, rather than exclusively using components provided as part of the JBoss EAP distribution. For example, a deployed WAR file may include dependency JARs in the WEB-INF/lib/ directory. These JARs are out of scope for security patches provided by Red Hat. Managing security updates for dependencies bundled inside the applications deployed on JBoss EAP is the responsibility of the applications' maintainers. The following tools and data sources may assist in this effort, and are provided without any support or warranty.
	</div><div class="variablelist"><p class="title"><strong>Tools and Data Sources</strong></p><dl class="variablelist"><dt><span class="term">JBoss patch mailing lists</span></dt><dd><div class="para">
					Subscribing to the JBoss patch mailing lists will keep you informed regarding security flaws that have been fixed in JBoss products, allowing you to check whether your deployed applications are bundling vulnerable versions of the affected components.
				</div></dd><dt><span class="term">Security advisory page for bundled components.</span></dt><dd><div class="para">
					Many open source components have their own security advisory page. For example, struts 2 is a commonly-used component with many known security issues that is not provided as part of the JBoss EAP distribution. The struts 2 project maintains an upstream security advisory page, which should be monitored if your deployed applications bundle struts 2. Many commercially-provided components also maintain security advisory pages.
				</div></dd><dt><span class="term">Regularly scan your deployed applications for known vulnerabilities</span></dt><dd><div class="para">
					There are several commercial tools available to do this. There is also an open source tool called Victims, which is developed by Red Hat employees, but comes with no support or warranty. Victims provides plugins for several build and integration tools, which automatically scan applications for bundling known-vulnerable dependencies. Plugins are available for Maven, Ant and Jenkins. For more information about the Victims tool, see <a href="https://victi.ms/about.html" class="mimir-link-warn" title="Mimir does not include content from: victi.ms">https://victi.ms/about.html</a>.
				</div></dd></dl></div><div class="itemizedlist see-also-list"><p class="title"><strong>See Also:</strong></p><ul class="see-also-list see-also-list"><li class="listitem"><div class="para">
				<a class="xref" href="#Subscribe_to_Patch_Mailing_Lists">Section 13.3, “Subscribe to Patch Mailing Lists”</a>
			</div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+24114-559109+%5BSpecified%5D&amp;comment=Title%3A+Manage+Security+Updates+for+Dependencies+Bundled+Inside+the+Applications+Deployed+on+JBoss+EAP%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=24114-559109+26+Nov+2013+08%3A08+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div></div><div xml:lang="en-US" class="part" id="part-Securing_Applications" lang="en-US"><div class="titlepage"><div><div><h1 class="title">Part III. Securing Applications</h1></div></div></div><div xml:lang="en-US" class="chapter" id="chap-Application_Security" lang="en-US"><div class="titlepage"><div><div><h2 class="title">Chapter 14. Application Security</h2></div></div></div><div xml:lang="en-US" class="section" id="About_Application_Security" lang="en-US"><div class="titlepage"><div><div><h2 class="title">14.1. About Application Security</h2></div></div></div><div class="para">
		Securing your applications is a multi-faceted and important concern for every application developer. JBoss EAP 6 provides all the tools you need to write secure applications, including the following abilities:
	</div><div class="para">
		<div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<a class="xref" href="#About_Authentication1">Section 5.9.1, “About Authentication”</a>
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#About_Authorization1">Section 5.11.1, “About Authorization”</a>
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#About_Security_Auditing1">Section 5.13.1, “About Security Auditing”</a>
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#About_Security_Mapping1">Section 5.14.1, “About Security Mapping”</a>
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#sect-About_Declarative_Security">Section 2.1, “About Declarative Security”</a>
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#About_EJB_Method_Permissions">Section 14.4.2.1, “About EJB Method Permissions”</a>
				</div></li><li class="listitem"><div class="para">
					<a class="xref" href="#About_EJB_Security_Annotations">Section 14.4.3.1, “About EJB Security Annotations”</a>
				</div></li></ul></div>

	</div><div class="para">
		See also <a class="xref" href="#Use_a_Security_Domain_in_Your_Application">Section 17.3, “Use a Security Domain in Your Application”</a>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4771-547607+%5BSpecified%5D&amp;comment=Title%3A+About+Application+Security%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4771-547607+18+Oct+2013+13%3A22+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="EnablingDisabling_Descriptor_Based_Property_Replacement1" lang="en-US"><div class="titlepage"><div><div><h2 class="title">14.2. Enabling/Disabling Descriptor Based Property Replacement</h2></div></div></div><div class="para"><div class="title">Summary</div><p>
			Finite control over descriptor property replacement was introduced in <code class="filename">jboss-as-ee_1_1.xsd</code>. This task covers the steps required to configure descriptor based property replacement.
		</p></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul><li class="listitem"><div class="para">
				Start the JBoss Enterprise Application Platform instance.
			</div></li><li class="listitem"><div class="para">
				Launch the Management CLI.
			</div></li></ul></div><div class="para">
		Descriptor based property replacement flags have boolean values:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				When set to <code class="code">true</code>, property replacements are enabled.
			</div></li><li class="listitem"><div class="para">
				When set to <code class="code">false</code>, property replacements are disabled.
			</div></li></ul></div><div class="procedure"><p class="title"><strong>Procedure 14.1. <code class="code">jboss-descriptor-property-replacement</code></strong></p><div class="para">
			<code class="code">jboss-descriptor-property-replacement</code> is used to enable or disable property replacement in the following descriptors:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<code class="filename">jboss-ejb3.xml</code>
				</div></li><li class="listitem"><div class="para">
					<code class="filename">jboss-app.xml</code>
				</div></li><li class="listitem"><div class="para">
					<code class="filename">jboss-web.xml</code>
				</div></li><li class="listitem"><div class="para">
					<code class="filename">*-jms.xml</code>
				</div></li><li class="listitem"><div class="para">
					<code class="filename">*-ds.xml</code>
				</div></li></ul></div><div class="para">
			The default value for <code class="code">jboss-descriptor-property-replacement</code> is <code class="code">true</code>.
		</div><ol class="1"><li class="step"><div class="para">
				In the Management CLI, run the following command to determine the value of <code class="code">jboss-descriptor-property-replacement</code>:
			</div><pre class="screen">/subsystem=ee:read-attribute(name="jboss-descriptor-property-replacement")</pre></li><li class="step"><div class="para">
				Run the following command to configure the behavior:
			</div><pre class="screen">/subsystem=ee:write-attribute(name="jboss-descriptor-property-replacement",value=<em class="replaceable">VALUE</em>)</pre></li></ol></div><div class="procedure"><p class="title"><strong>Procedure 14.2. <code class="code">spec-descriptor-property-replacement</code></strong></p><div class="para">
			<code class="code">spec-descriptor-property-replacement</code> is used to enable or disable property replacement in the following descriptors:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<code class="filename">ejb-jar.xml</code>
				</div></li><li class="listitem"><div class="para">
					<code class="filename">persistence.xml</code>
				</div></li></ul></div><div class="para">
			The default value for <code class="code">spec-descriptor-property-replacement</code> is <code class="code">false</code>.
		</div><ol class="1"><li class="step"><div class="para">
				In the Management CLI, run the following command to confirm the value of <code class="code">spec-descriptor-property-replacement</code>:
			</div><pre class="screen">/subsystem=ee:read-attribute(name="spec-descriptor-property-replacement")</pre></li><li class="step"><div class="para">
				Run the following command to configure the behavior:
			</div><pre class="screen">/subsystem=ee:write-attribute(name="spec-descriptor-property-replacement",value=<em class="replaceable">VALUE</em>)</pre></li></ol></div><div class="para"><div class="title">Result</div><p>
			The descriptor based property replacement tags have been successfully configured.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+9089-431229+%5BSpecified%5D&amp;comment=Title%3A+Enabling%2FDisabling+Descriptor+Based+Property+Replacement%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=9089-431229+04+Apr+2013+11%3A31+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div class="section" id="sect-Datasource_Security"><div class="titlepage"><div><div><h2 class="title">14.3. Datasource Security</h2></div></div></div><div xml:lang="en-US" class="section" id="About_Datasource_Security" lang="en-US"><div class="titlepage"><div><div><h3 class="title">14.3.1. About Datasource Security</h3></div></div></div><div class="para">
		The preferred solution for datasource security is the use of either security domains or password vaults. Examples of each are included below. For more information, refer to:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				Security domains: <a class="xref" href="#About_Security_Domains">Section 4.3.3.1, “About Security Domains”</a>.
			</div></li><li class="listitem"><div class="para">
				Password vaults: <a class="xref" href="#About_Securing_Sensitive_Strings_in_Clear-Text_Files1">Section 10.11.1, “About Securing Sensitive Strings in Clear-Text Files”</a>.
			</div></li></ul></div><div class="example" id="idm140707319404880"><p class="title"><strong>Example 14.1. Security Domain Example</strong></p><div class="example-contents"><pre class="programlisting">&lt;security&gt;
   &lt;security-domain&gt;mySecurityDomain&lt;/security-domain&gt;
&lt;/security&gt;</pre></div></div><div class="example" id="idm140707326662912"><p class="title"><strong>Example 14.2. Password Vault Example</strong></p><div class="example-contents"><pre class="programlisting">
&lt;security&gt;
  &lt;user-name&gt;admin&lt;/user-name&gt;
  &lt;password&gt;${VAULT::ds_ExampleDS::password::N2NhZDYzOTMtNWE0OS00ZGQ0LWE4MmEtMWNlMDMyNDdmNmI2TElORV9CUkVBS3ZhdWx0}&lt;/password&gt;
&lt;/security&gt;
</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+9096-330818+%5BSpecified%5D&amp;comment=Title%3A+About+Datasource+Security%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=9096-330818+07+Nov+2012+00%3A07+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div class="section" id="sect-EJB_Application_Security"><div class="titlepage"><div><div><h2 class="title">14.4. EJB Application Security</h2></div></div></div><div class="section" id="sect-Security_Identity"><div class="titlepage"><div><div><h3 class="title">14.4.1. Security Identity</h3></div></div></div><div xml:lang="en-US" class="section" id="About_EJB_Security_Identity" lang="en-US"><div class="titlepage"><div><div><h4 class="title">14.4.1.1. About EJB Security Identity</h4></div></div></div><div class="para">
		The <em class="firstterm">security identity</em>, which is also known as <em class="firstterm">invocation identity</em>, refers to the <code class="sgmltag-element">&lt;security-identity&gt;</code> tag in the security configuration. It refers to the identity another EJB must use when it invokes methods on components.
	</div><div class="para">
		The invocation identity can be either the current caller, or it can be a specific role. In the first case, the <code class="sgmltag-element">&lt;use-caller-identity&gt;</code> tag is present, and in the second case, the <code class="sgmltag-element">&lt;run-as&gt;</code> tag is used.
	</div><div class="para">
		For information about setting the security identity of an EJB, refer to <a class="xref" href="#Set_the_Security_Identity_of_an_EJB">Section 14.4.1.2, “Set the Security Identity of an EJB”</a>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4713-328592+%5BSpecified%5D&amp;comment=Title%3A+About+EJB+Security+Identity%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4713-328592+05+Nov+2012+14%3A51+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Set_the_Security_Identity_of_an_EJB" lang="en-US"><div class="titlepage"><div><div><h4 class="title">14.4.1.2. Set the Security Identity of an EJB</h4></div></div></div><div class="example" id="idm140707307574976"><p class="title"><strong>Example 14.3. Set the security identity of an EJB to be the same as its caller</strong></p><div class="example-contents"><div class="para">
			This example sets the security identity for method invocations made by an EJB to be the same as the current caller's identity. This behavior is the default if you do not specify a <code class="sgmltag-element">&lt;security-identity&gt;</code> element declaration.
		</div><pre class="programlisting language-xml XML XML">
&lt;ejb-jar&gt;
  &lt;enterprise-beans&gt;
	 &lt;session&gt;
		&lt;ejb-name&gt;ASessionBean&lt;/ejb-name&gt;
		&lt;!-- ... --&gt;
		&lt;security-identity&gt;
		  &lt;use-caller-identity/&gt;
		&lt;/security-identity&gt;
	 &lt;/session&gt;
	 &lt;!-- ... --&gt;
  &lt;/enterprise-beans&gt;
&lt;/ejb-jar&gt;
</pre></div></div><div class="example" id="idm140707329766960"><p class="title"><strong>Example 14.4. Set the security identity of an EJB to a specific role</strong></p><div class="example-contents"><div class="para">
			To set the security identity to a specific role, use the <code class="sgmltag-element">&lt;run-as&gt;</code> and <code class="sgmltag-element">&lt;role-name&gt;</code> tags inside the <code class="sgmltag-element">&lt;security-identity&gt;</code> tag.
		</div><pre class="programlisting language-xml XML XML">
&lt;ejb-jar&gt;
  &lt;enterprise-beans&gt;
	 &lt;session&gt;
		&lt;ejb-name&gt;RunAsBean&lt;/ejb-name&gt;
		&lt;!-- ... --&gt;
		&lt;security-identity&gt;
		  &lt;run-as&gt;
			 &lt;description&gt;A private internal role&lt;/description&gt;
			 &lt;role-name&gt;InternalRole&lt;/role-name&gt;
		  &lt;/run-as&gt;
		&lt;/security-identity&gt;
	 &lt;/session&gt;
  &lt;/enterprise-beans&gt;
  &lt;!-- ... --&gt;
&lt;/ejb-jar&gt;
</pre><div class="para">
			By default, when you use <code class="sgmltag-element">&lt;run-as&gt;</code>, a principal named <code class="literal">anonymous</code> is assigned to outgoing calls. To assign a different principal, uses the <code class="sgmltag-element">&lt;run-as-principal&gt;</code>.
		</div><pre class="programlisting language-xml XML XML">
&lt;session&gt;
    &lt;ejb-name&gt;RunAsBean&lt;/ejb-name&gt;
    &lt;security-identity&gt;
        &lt;run-as-principal&gt;internal&lt;/run-as-principal&gt;
    &lt;/security-identity&gt;
&lt;/session&gt;
</pre></div></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			You can also use the <code class="sgmltag-element">&lt;run-as&gt;</code> and <code class="sgmltag-element">&lt;run-as-principal&gt;</code> elements inside a servlet element.
		</div></div></div><div class="itemizedlist"><p class="title"><strong>See also:</strong></p><ul><li class="listitem"><div class="para">
				<a class="xref" href="#About_EJB_Security_Identity">Section 14.4.1.1, “About EJB Security Identity”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#EJB_Security_Parameter_Reference">Section A.6, “EJB Security Parameter Reference”</a>
			</div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+5052-448698+%5BSpecified%5D&amp;comment=Title%3A+Set+the+Security+Identity+of+an+EJB%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5052-448698+13+May+2013+11%3A10+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div class="section" id="sect-EJB_Method_Permissions"><div class="titlepage"><div><div><h3 class="title">14.4.2. EJB Method Permissions</h3></div></div></div><div xml:lang="en-US" class="section" id="About_EJB_Method_Permissions" lang="en-US"><div class="titlepage"><div><div><h4 class="title">14.4.2.1. About EJB Method Permissions</h4></div></div></div><div class="para">
		EJB provides a <code class="sgmltag-element">&lt;method-permisison&gt;</code> element declaration. This declaration sets the roles which are allowed to invoke an EJB's interface methods. You can specify permissions for the following combinations:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				All home and component interface methods of the named EJB
			</div></li><li class="listitem"><div class="para">
				A specified method of the home or component interface of the named EJB
			</div></li><li class="listitem"><div class="para">
				A specified method within a set of methods with an overloaded name
			</div></li></ul></div><div class="para">
		For examples, see <a class="xref" href="#Use_EJB_Method_Permissions">Section 14.4.2.2, “Use EJB Method Permissions”</a>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4767-432892+%5BSpecified%5D&amp;comment=Title%3A+About+EJB+Method+Permissions%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4767-432892+11+Apr+2013+10%3A47+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Use_EJB_Method_Permissions" lang="en-US"><div class="titlepage"><div><div><h4 class="title">14.4.2.2. Use EJB Method Permissions</h4></div></div></div><div class="para"><div class="title">Overview</div><p>
			The <code class="sgmltag-element">&lt;method-permission&gt;</code> element defines the logical roles that are allowed to access the EJB methods defined by <code class="sgmltag-element">&lt;method&gt;</code> elements. Several examples demonstrate the syntax of the XML. Multiple method permission statements may be present, and they have a cumulative effect. The <code class="sgmltag-element">&lt;method-permission&gt;</code> element is a child of the <code class="sgmltag-element">&lt;assembly-descriptor&gt;</code> element of the <code class="sgmltag-element">&lt;ejb-jar&gt;</code> descriptor.
		</p></div><div class="para">
		The XML syntax is an alternative to using annotations for EJB method permissions.
	</div><div class="example" id="idm140707330932672"><p class="title"><strong>Example 14.5. Allow roles to access all methods of an EJB</strong></p><div class="example-contents"><pre class="programlisting language-xml XML XML">
&lt;method-permission&gt;
  &lt;description&gt;The employee and temp-employee roles may access any method
  of the EmployeeService bean &lt;/description&gt;
  &lt;role-name&gt;employee&lt;/role-name&gt;
  &lt;role-name&gt;temp-employee&lt;/role-name&gt;
  &lt;method&gt;
    &lt;ejb-name&gt;EmployeeService&lt;/ejb-name&gt;
    &lt;method-name&gt;*&lt;/method-name&gt;
  &lt;/method&gt;
&lt;/method-permission&gt;

</pre></div></div><div class="example" id="idm140707318845280"><p class="title"><strong>Example 14.6. Allow roles to access only specific methods of an EJB, and limiting which method parameters can be passed.</strong></p><div class="example-contents"><pre class="programlisting language-xml XML XML">
&lt;method-permission&gt;
  &lt;description&gt;The employee role may access the findByPrimaryKey,
  getEmployeeInfo, and the updateEmployeeInfo(String) method of
  the AcmePayroll bean &lt;/description&gt;
  &lt;role-name&gt;employee&lt;/role-name&gt;
  &lt;method&gt;
	&lt;ejb-name&gt;AcmePayroll&lt;/ejb-name&gt;
	&lt;method-name&gt;findByPrimaryKey&lt;/method-name&gt;
  &lt;/method&gt;
  &lt;method&gt;
	&lt;ejb-name&gt;AcmePayroll&lt;/ejb-name&gt;
	&lt;method-name&gt;getEmployeeInfo&lt;/method-name&gt;
  &lt;/method&gt;
  &lt;method&gt;
	&lt;ejb-name&gt;AcmePayroll&lt;/ejb-name&gt;
	&lt;method-name&gt;updateEmployeeInfo&lt;/method-name&gt;
	&lt;method-params&gt;
	  &lt;method-param&gt;java.lang.String&lt;/method-param&gt;
	&lt;/method-params&gt;
  &lt;/method&gt;
&lt;/method-permission&gt;
</pre></div></div><div class="example" id="idm140707311238704"><p class="title"><strong>Example 14.7. Allow any authenticated user to access methods of EJBs</strong></p><div class="example-contents"><div class="para">
			Using the <code class="sgmltag-element">&lt;unchecked/&gt;</code> element allows any authenticated user to use the specified methods.
		</div><pre class="programlisting language-xml XML XML">
&lt;method-permission&gt;
  &lt;description&gt;Any authenticated user may access any method of the
  EmployeeServiceHelp bean&lt;/description&gt;
  &lt;unchecked/&gt;
  &lt;method&gt;
	&lt;ejb-name&gt;EmployeeServiceHelp&lt;/ejb-name&gt;
	&lt;method-name&gt;*&lt;/method-name&gt;
  &lt;/method&gt;
&lt;/method-permission&gt;
</pre></div></div><div class="example" id="idm140707330863680"><p class="title"><strong>Example 14.8. Completely exclude specific EJB methods from being used</strong></p><div class="example-contents"><pre class="programlisting language-xml XML XML">
&lt;exclude-list&gt;
  &lt;description&gt;No fireTheCTO methods of the EmployeeFiring bean may be
  used in this deployment&lt;/description&gt;
  &lt;method&gt;
	&lt;ejb-name&gt;EmployeeFiring&lt;/ejb-name&gt;
	&lt;method-name&gt;fireTheCTO&lt;/method-name&gt;
  &lt;/method&gt;
&lt;/exclude-list&gt;
</pre></div></div><div class="example" id="idm140707310993632"><p class="title"><strong>Example 14.9. A complete <code class="sgmltag-element">&lt;assembly-descriptor&gt;</code> containing several <code class="sgmltag-element">&lt;method-permission&gt;</code> blocks</strong></p><div class="example-contents"><pre class="programlisting language-xml XML XML">
&lt;ejb-jar&gt;
    &lt;assembly-descriptor&gt;
        &lt;method-permission&gt;
            &lt;description&gt;The employee and temp-employee roles may access any
                method of the EmployeeService bean &lt;/description&gt;
            &lt;role-name&gt;employee&lt;/role-name&gt;
            &lt;role-name&gt;temp-employee&lt;/role-name&gt;
            &lt;method&gt;
                &lt;ejb-name&gt;EmployeeService&lt;/ejb-name&gt;
                &lt;method-name&gt;*&lt;/method-name&gt;
            &lt;/method&gt;
        &lt;/method-permission&gt;
        &lt;method-permission&gt;
            &lt;description&gt;The employee role may access the findByPrimaryKey,
                getEmployeeInfo, and the updateEmployeeInfo(String) method of
                the AcmePayroll bean &lt;/description&gt;
            &lt;role-name&gt;employee&lt;/role-name&gt;
            &lt;method&gt;
                &lt;ejb-name&gt;AcmePayroll&lt;/ejb-name&gt;
                &lt;method-name&gt;findByPrimaryKey&lt;/method-name&gt;
            &lt;/method&gt;
            &lt;method&gt;
                &lt;ejb-name&gt;AcmePayroll&lt;/ejb-name&gt;
                &lt;method-name&gt;getEmployeeInfo&lt;/method-name&gt;
            &lt;/method&gt;
            &lt;method&gt;
                &lt;ejb-name&gt;AcmePayroll&lt;/ejb-name&gt;
                &lt;method-name&gt;updateEmployeeInfo&lt;/method-name&gt;
                &lt;method-params&gt;
                    &lt;method-param&gt;java.lang.String&lt;/method-param&gt;
                &lt;/method-params&gt;
            &lt;/method&gt;
        &lt;/method-permission&gt;
        &lt;method-permission&gt;
            &lt;description&gt;The admin role may access any method of the
                EmployeeServiceAdmin bean &lt;/description&gt;
            &lt;role-name&gt;admin&lt;/role-name&gt;
            &lt;method&gt;
                &lt;ejb-name&gt;EmployeeServiceAdmin&lt;/ejb-name&gt;
                &lt;method-name&gt;*&lt;/method-name&gt;
            &lt;/method&gt;
        &lt;/method-permission&gt;
        &lt;method-permission&gt;
            &lt;description&gt;Any authenticated user may access any method of the
                EmployeeServiceHelp bean&lt;/description&gt;
            &lt;unchecked/&gt;
            &lt;method&gt;
                &lt;ejb-name&gt;EmployeeServiceHelp&lt;/ejb-name&gt;
                &lt;method-name&gt;*&lt;/method-name&gt;
            &lt;/method&gt;
        &lt;/method-permission&gt;
        &lt;exclude-list&gt;
            &lt;description&gt;No fireTheCTO methods of the EmployeeFiring bean may be
                used in this deployment&lt;/description&gt;
            &lt;method&gt;
                &lt;ejb-name&gt;EmployeeFiring&lt;/ejb-name&gt;
                &lt;method-name&gt;fireTheCTO&lt;/method-name&gt;
            &lt;/method&gt;
        &lt;/exclude-list&gt;
    &lt;/assembly-descriptor&gt;
&lt;/ejb-jar&gt;
</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4794-455574+%5BSpecified%5D&amp;comment=Title%3A+Use+EJB+Method+Permissions%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4794-455574+29+May+2013+13%3A14+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div class="section" id="sect-EJB_Security_Annotations"><div class="titlepage"><div><div><h3 class="title">14.4.3. EJB Security Annotations</h3></div></div></div><div xml:lang="en-US" class="section" id="About_EJB_Security_Annotations" lang="en-US"><div class="titlepage"><div><div><h4 class="title">14.4.3.1. About EJB Security Annotations</h4></div></div></div><div class="para">
		EJBs use security annotations to pass information about security to the deployer. These include:
	</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">@DeclareRoles</span></dt><dd><div class="para">
					Declares which roles are available.
				</div></dd><dt><span class="term">@RolesAllowed, @PermitAll, @DenyAll</span></dt><dd><div class="para">
					Specifies which method permissions are allowed. For information about method permissions, refer to <a class="xref" href="#About_EJB_Method_Permissions">Section 14.4.2.1, “About EJB Method Permissions”</a>.
				</div></dd><dt><span class="term">@RunAs</span></dt><dd><div class="para">
					Configures the propagated security identify of a component.
				</div></dd></dl></div><div class="para">
		For more information, refer to <a class="xref" href="#Use_EJB_Security_Annotations">Section 14.4.3.2, “Use EJB Security Annotations”</a>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4768-481778+%5BSpecified%5D&amp;comment=Title%3A+About+EJB+Security+Annotations%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4768-481778+25+Jul+2013+13%3A36+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Use_EJB_Security_Annotations" lang="en-US"><div class="titlepage"><div><div><h4 class="title">14.4.3.2. Use EJB Security Annotations</h4></div></div></div><div class="para"><div class="title">Overview</div><p>
			You can use either XML descriptors or annotations to control which security roles are able to call methods in your Enterprise JavaBeans (EJBs). For information on using XML descriptors, refer to <a class="xref" href="#Use_EJB_Method_Permissions">Section 14.4.2.2, “Use EJB Method Permissions”</a>.
		</p></div><div class="variablelist"><p class="title"><strong>Annotations for Controlling Security Permissions of EJBs</strong></p><dl class="variablelist"><dt><span class="term">@DeclareRoles</span></dt><dd><div class="para">
					Use @DeclareRoles to define which security roles to check permissions against. If no @DeclareRoles is present, the list is built automatically from the @RolesAllowed annotation.
				</div></dd><dt><span class="term">@SecurityDomain</span></dt><dd><div class="para">
					Specifies the security domain to use for the EJB. If the EJB is annotated for authorization with <code class="literal">@RolesAllowed</code>, authorization will only apply if the EJB is annotated with a security domain.
				</div></dd><dt><span class="term">@RolesAllowed, @PermitAll, @DenyAll</span></dt><dd><div class="para">
					Use @RolesAllowed to list which roles are allowed to access a method or methods. Use @PermitAll or @DenyAll to either permit or deny all roles from using a method or methods.
				</div></dd><dt><span class="term">@RunAs</span></dt><dd><div class="para">
					Use @RunAs to specify a role a method will always be run as.
				</div></dd></dl></div><div class="example" id="idm140707314496880"><p class="title"><strong>Example 14.10. Security Annotations Example</strong></p><div class="example-contents"><pre class="programlisting language-java JAVA JAVA">
@Stateless
@RolesAllowed({"admin"})
@SecurityDomain("other")
public class WelcomeEJB implements Welcome {
	@PermitAll
	public String WelcomeEveryone(String msg) {
		return "Welcome to " + msg;
	}
	@RunAs("tempemployee")
	public String GoodBye(String msg) {
	    return "Goodbye, " + msg;
	}
	public String GoodbyeAdmin(String msg) {
		return "See you later, " + msg;
	}
}
</pre><div class="para">
			In this code, all roles can access method <code class="code">WelcomeEveryone</code>. The <code class="code">GoodBye</code> method uses the <code class="code">tempemployee</code> role when making calls. Only the <code class="code">admin</code> role can access method <code class="code">GoodbyeAdmin</code>, and any other methods with no security annotation.
		</div></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4795-545453+%5BSpecified%5D&amp;comment=Title%3A+Use+EJB+Security+Annotations%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4795-545453+10+Oct+2013+14%3A44+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div class="section" id="sect-Remote_Access_to_EJBs"><div class="titlepage"><div><div><h3 class="title">14.4.4. Remote Access to EJBs</h3></div></div></div><div xml:lang="en-US" class="section" id="About_Remoting" lang="en-US"><div class="titlepage"><div><div><h4 class="title">14.4.4.1. About Remote Method Access</h4></div></div></div><div class="para">
		JBoss Remoting is the framework which provides remote access to EJBs, JMX MBeans, and other similar services. It works within the following transport types, with or without SSL:
	</div><div class="itemizedlist"><p class="title"><strong>Supported Transport Types</strong></p><ul><li class="listitem"><div class="para">
				Socket / Secure Socket
			</div></li><li class="listitem"><div class="para">
				RMI / RMI over SSL
			</div></li><li class="listitem"><div class="para">
				HTTP / HTTPS
			</div></li><li class="listitem"><div class="para">
				Servlet / Secure Servlet
			</div></li><li class="listitem"><div class="para">
				Bisocket / Secure Bisocket
			</div></li></ul></div><div class="para">
		JBoss Remoting also provides automatic discovery via Multicast or JNDI.
	</div><div class="para">
		It is used by many of the subsystems within JBoss EAP 6, and also enables you to design, implement, and deploy services that can be remotely invoked by clients over several different transport mechanisms. It also allows you to access existing services in JBoss EAP 6.
	</div><div class="para"><div class="title">Data Marshalling</div><p>
			The Remoting system also provides data marshalling and unmarshalling services. Data marshalling refers to the ability to safely move data across network and platform boundaries, so that a separate system can perform work on it. The work is then sent back to the original system and behaves as though it were handled locally.
		</p></div><div class="para"><div class="title">Architecture Overview</div><p>
			When you design a client application which uses Remoting, you direct your application to communicate with the server by configuring it to use a special type of resource locator called an <code class="literal">InvokerLocator</code>, which is a simple String with a URL-type format. The server listens for requests for remote resources on a <code class="literal">connector</code>, which is configured as part of the <code class="literal">remoting</code> subsystem. The <code class="literal">connector</code> hands the request off to a configured <code class="literal">ServerInvocationHandler</code>. Each <code class="literal">ServerInvocationHandler</code> implements a method <code class="code">invoke(InvocationRequest)</code>, which knows how to handle the request.
		</p></div><div class="para">
		The JBoss Remoting framework contains three layers that mirror each other on the client and server side.
	</div><div class="itemizedlist"><p class="title"><strong>JBoss Remoting Framework Layers</strong></p><ul><li class="listitem"><div class="para">
				The user interacts with the outer layer. On the client side, the outer layer is the <code class="code">Client</code> class, which sends invocation requests. On the server side, it is the InvocationHandler, which is implemented by the user and receives invocation requests.
			</div></li><li class="listitem"><div class="para">
				The transport is controlled by the invoker layer.
			</div></li><li class="listitem"><div class="para">
				The lowest layer contains the marshaller and unmarshaller, which convert data formats to wire formats.
			</div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+7882-466868+%5BSpecified%5D&amp;comment=Title%3A+About+Remote+Method+Access%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7882-466868+20+Jun+2013+01%3A42+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="About_Remoting_Callbacks" lang="en-US"><div class="titlepage"><div><div><h4 class="title">14.4.4.2. About Remoting Callbacks</h4></div></div></div><div class="para">
		When a Remoting client requests information from the server, it can block and wait for the server to reply, but this is often not the ideal behavior. To allow the client to listen for asynchronous events on the server, and continue doing other work while waiting for the server to finish the request, your application can ask the server to send a notification when it has finished. This is referred to as a callback. One client can add itself as a listener for asynchronous events generated on behalf of another client, as well. There are two different choices for how to receive callbacks: pull callbacks or push callbacks. Clients check for pull callbacks synchronously, but passively listen for push callbacks.
	</div><div class="para">
		In essence, a callback works by the server sending an <code class="code">InvocationRequest</code> to the client. Your server-side code works the same regardless of whether the callback is synchronous or asynchronous. Only the client needs to know the difference. The server's InvocationRequest sends a <code class="code">responseObject</code> to the client. This is the payload that the client has requested. This may be a direct response to a request or an event notification.
	</div><div class="para">
		Your server also tracks listeners using an <code class="code">m_listeners</code> object. It contains a list of all listeners that have been added to your server handler. The <code class="code">ServerInvocationHandler</code> interface includes methods that allow you to manage this list.
	</div><div class="para">
		The client handles pull and push callback in different ways. In either case, it must implement a callback handler. A callback handler is an implementation of interface <code class="code">org.jboss.remoting.InvokerCallbackHandler</code>, which processes the callback data. After implementing the callback handler, you either add yourself as a listener for a pull callback, or implement a callback server for a push callback.
	</div><div class="para"><div class="title">Pull Callbacks</div><p>
			For a pull callback, your client adds itself to the server's list of listeners using the <code class="code">Client.addListener()</code> method. It then polls the server periodically for synchronous delivery of callback data. This poll is performed using the <code class="code">Client.getCallbacks()</code>.
		</p></div><div class="para"><div class="title">Push Callback</div><p>
			A push callback requires your client application to run its own InvocationHandler. To do this, you need to run a Remoting service on the client itself. This is referred to as a <em class="firstterm">callback server</em>. The callback server accepts incoming requests asynchronously and processes them for the requester (in this case, the server). To register your client's callback server with the main server, pass the callback server's <code class="code">InvokerLocator</code> as the second argument to the <code class="code">addListener</code> method.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+7883-432927+%5BSpecified%5D&amp;comment=Title%3A+About+Remoting+Callbacks%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7883-432927+11+Apr+2013+10%3A48+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="About_Remoting_Server_Detection" lang="en-US"><div class="titlepage"><div><div><h4 class="title">14.4.4.3. About Remoting Server Detection</h4></div></div></div><div class="para">
		Remoting servers and clients can automatically detect each other using JNDI or Multicast. A Remoting Detector is added to both the client and server, and a NetworkRegistry is added to the client.
	</div><div class="para">
		The Detector on the server side periodically scans the InvokerRegistry and pulls all server invokers it has created. It uses this information to publish a detection message which contains the locator and subsystems supported by each server invoker. It publishes this message via a multicast broadcast or a binding into a JNDI server.
	</div><div class="para">
		On the client side, the Detector receives the multicast message or periodically polls the JNDI server to retrieve detection messages. If the Detector notices that a detection message is for a newly-detected remoting server, it registers it into the NetworkRegistry. The Detector also updates the NetworkRegistry if it detects that a server is no longer available.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+7890-432929+%5BSpecified%5D&amp;comment=Title%3A+About+Remoting+Server+Detection%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7890-432929+11+Apr+2013+10%3A48+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_the_Remoting_Subsystem" lang="en-US"><div class="titlepage"><div><div><h4 class="title">14.4.4.4. Configure the Remoting Subsystem</h4></div></div></div><div class="para"><div class="title">Overview</div><p>
			JBoss Remoting has three top-level configurable elements: the worker thread pool, one or more connectors, and a series of local and remote connection URIs. This topic presents an explanation of each configurable item, example CLI commands for how to configure each item, and an XML example of a fully-configured subsystem. This configuration only applies to the server. Most people will not need to configure the Remoting subsystem at all, unless they use custom connectors for their own applications. Applications which act as Remoting clients, such as EJBs, need separate configuration to connect to a specific connector.
		</p></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			The Remoting subsystem configuration is not exposed to the web-based Management Console, but it is fully configurable from the command-line based Management CLI. Editing the XML by hand is not recommended.
		</div></div></div><div class="para"><div class="title">Adapting the CLI Commands</div><p>
			The CLI commands are formulated for a managed domain, when configuring the <code class="literal">default</code> profile. To configure a different profile, substitute its name. For a standalone server, omit the <code class="literal">/profile=default</code> part of the command.
		</p></div><div class="para"><div class="title">Configuration Outside the Remoting Subsystem</div><p>
			There are a few configuration aspects which are outside of the <code class="literal">remoting</code> subsystem:
		</p></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Network Interface</span></dt><dd><div class="para">
					The network interface used by the <code class="literal">remoting</code> subsystem is the <code class="literal">unsecure</code> interface defined in the <code class="filename">domain/configuration/domain.xml</code> or <code class="filename">standalone/configuration/standalone.xml</code>.
				</div><pre class="programlisting language-xml XML XML">
&lt;interfaces&gt;
   &lt;interface name="management"/&gt;
   &lt;interface name="public"/&gt;
   &lt;interface name="unsecure"/&gt;
&lt;/interfaces&gt;        

</pre><div class="para">
					The per-host definition of the <code class="literal">unsecure</code> interface is defined in the <code class="filename">host.xml</code> in the same directory as the <code class="filename">domain.xml</code> or <code class="filename">standalone.xml</code>. This interface is also used by several other subsystems. Exercise caution when modifying it.
				</div><pre class="programlisting language-xml XML XML">
&lt;interfaces&gt;
   &lt;interface name="management"&gt;
      &lt;inet-address value="${jboss.bind.address.management:127.0.0.1}"/&gt;
   &lt;/interface&gt;
   &lt;interface name="public"&gt;
      &lt;inet-address value="${jboss.bind.address:127.0.0.1}"/&gt;
   &lt;/interface&gt;
   &lt;interface name="unsecure"&gt;
      &lt;!-- Used for IIOP sockets in the standard configuration.
         To secure JacORB you need to setup SSL --&gt;
      &lt;inet-address value="${jboss.bind.address.unsecure:127.0.0.1}"/&gt;
   &lt;/interface&gt;
&lt;/interfaces&gt;             

</pre></dd><dt><span class="term">socket-binding</span></dt><dd><div class="para">
					The default socket-binding used by the <code class="literal">remoting</code> subsystem binds to TCP port 4777. Refer to the documentation about socket bindings and socket binding groups for more information if you need to change this.
				</div></dd><dt><span class="term">Remoting Connector Reference for EJB</span></dt><dd><div class="para">
					The EJB subsystem contains a reference to the remoting connector for remote method invocations. The following is the default configuration:
				</div><pre class="programlisting language-xml XML XML">
&lt;remote connector-ref="remoting-connector" thread-pool-name="default"/&gt;            

</pre></dd><dt><span class="term">Secure Transport Configuration</span></dt><dd><div class="para">
					Remoting transports use StartTLS to use a secure (HTTPS, Secure Servlet, etc) connection if the client requests it. The same socket binding (network port) is used for secured and unsecured connections, so no additional server-side configuration is necessary. The client requests the secure or unsecured transport, as its needs dictate. JBoss EAP 6 components which use Remoting, such as EJBs, the ORB, and the JMS provider, request secured interfaces by default.
				</div></dd></dl></div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
			StartTLS works by activating a secure connection if the client requests it, and otherwise defaulting to an unsecured connection. It is inherently susceptible to a <em class="firstterm">Man in the Middle</em> style exploit, wherein an attacker intercepts the client's request and modifies it to request an unsecured connection. Clients must be written to fail appropriately if they do not receive a secure connection, unless an unsecured connection actually is an appropriate fall-back.
		</div></div></div><div class="para"><div class="title">Worker Thread Pool</div><p>
			The worker thread pool is the group of threads which are available to process work which comes in through the Remoting connectors. It is a single element <code class="sgmltag-element">&lt;worker-thread-pool&gt;</code>, and takes several attributes. Tune these attributes if you get network timeouts, run out of threads, or need to limit memory usage. Specific recommendations depend on your specific situation. Contact Red Hat Global Support Services for more information.
		</p></div><div class="table" id="idm140707309170656"><p class="title"><strong>Table 14.1. Worker Thread Pool Attributes</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="Worker Thread Pool Attributes"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707341330400" scope="col"> Attribute </th><th id="idm140707309989744" scope="col"> Description </th><th id="idm140707309989264" scope="col"> CLI Command </th></tr></thead><tbody><tr><td headers="idm140707341330400"> read-threads </td><td headers="idm140707309989744"> <div class="para">
						The number of read threads to create for the remoting worker. Defaults to <code class="literal">1</code>.
					</div>
					 </td><td headers="idm140707309989264"> <div class="para">
						<code class="literal">/profile=default/subsystem=remoting/:write-attribute(name=worker-read-threads,value=1)</code>
					</div>
					 </td></tr><tr><td headers="idm140707341330400"> write-threads </td><td headers="idm140707309989744"> <div class="para">
						The number of write threads to create for the remoting worker. Defaults to <code class="literal">1</code>.
					</div>
					 </td><td headers="idm140707309989264"> <div class="para">
						<code class="literal">/profile=default/subsystem=remoting/:write-attribute(name=worker-write-threads,value=1)</code>
					</div>
					 </td></tr><tr><td headers="idm140707341330400"> task-keepalive </td><td headers="idm140707309989744"> <div class="para">
						The number of milliseconds to keep non-core remoting worker task threads alive. Defaults to <code class="literal">60</code>.
					</div>
					 </td><td headers="idm140707309989264"> <div class="para">
						<code class="literal">/profile=default/subsystem=remoting/:write-attribute(name=worker-task-keepalive,value=60)</code>
					</div>
					 </td></tr><tr><td headers="idm140707341330400"> task-max-threads </td><td headers="idm140707309989744"> <div class="para">
						The maximum number of threads for the remoting worker task thread pool. Defaults to <code class="literal">16</code>.
					</div>
					 </td><td headers="idm140707309989264"> <div class="para">
						<code class="literal">/profile=default/subsystem=remoting/:write-attribute(name=worker-task-max-threads,value=16)</code>
					</div>
					 </td></tr><tr><td headers="idm140707341330400"> task-core-threads </td><td headers="idm140707309989744"> <div class="para">
						The number of core threads for the remoting worker task thread pool. Defaults to <code class="literal">4</code>.
					</div>
					 </td><td headers="idm140707309989264"> <div class="para">
						<code class="literal">/profile=default/subsystem=remoting/:write-attribute(name=worker-task-core-threads,value=4)</code>
					</div>
					 </td></tr><tr><td headers="idm140707341330400"> task-limit </td><td headers="idm140707309989744"> <div class="para">
						The maximum number of remoting worker tasks to allow before rejecting. Defaults to <code class="literal">16384</code>.
					</div>
					 </td><td headers="idm140707309989264"> <div class="para">
						<code class="literal">/profile=default/subsystem=remoting/:write-attribute(name=worker-task-limit,value=16384)</code>
					</div>
					 </td></tr></tbody></table></div></div><div class="para"><div class="title">Connector</div><p>
			The connector is the main Remoting configuration element. Multiple connectors are allowed. Each consists of a element <code class="sgmltag-element">&lt;connector&gt;</code> element with several sub-elements, as well as a few possible attributes. The default connector is used by several subsystems of JBoss EAP 6. Specific settings for the elements and attributes of your custom connectors depend on your applications, so contact Red Hat Global Support Services for more information.
		</p></div><div class="table" id="idm140707317149232"><p class="title"><strong>Table 14.2. Connector Attributes</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="Connector Attributes"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707329791360" scope="col"> Attribute </th><th id="idm140707324580304" scope="col"> Description </th><th id="idm140707324579824" scope="col"> CLI Command </th></tr></thead><tbody><tr><td headers="idm140707329791360"> socket-binding </td><td headers="idm140707324580304"> The name of the socket binding to use for this connector. </td><td headers="idm140707324579824"> <div class="para">
						<code class="literal">/profile=default/subsystem=remoting/connector=remoting-connector/:write-attribute(name=socket-binding,value=remoting)</code>
					</div>
					 </td></tr><tr><td headers="idm140707329791360"> authentication-provider </td><td headers="idm140707324580304"> <div class="para">
						The Java Authentication Service Provider Interface for Containers (JASPIC) module to use with this connector. The module must be in the classpath.
					</div>
					 </td><td headers="idm140707324579824"> <div class="para">
						<code class="literal">/profile=default/subsystem=remoting/connector=remoting-connector/:write-attribute(name=authentication-provider,value=myProvider)</code>
					</div>
					 </td></tr><tr><td headers="idm140707329791360"> security-realm </td><td headers="idm140707324580304"> <div class="para">
						Optional. The security realm which contains your application's users, passwords, and roles. An EJB or Web Application can authenticate against a security realm. <code class="literal">ApplicationRealm</code> is available in a default JBoss EAP 6 installation.
					</div>
					 </td><td headers="idm140707324579824"> <div class="para">
						<code class="literal">/profile=default/subsystem=remoting/connector=remoting-connector/:write-attribute(name=security-realm,value=ApplicationRealm)</code>
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="idm140707318752496"><p class="title"><strong>Table 14.3. Connector Elements</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="Connector Elements"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707309822928" scope="col"> Attribute </th><th id="idm140707334876240" scope="col"> Description </th><th id="idm140707316591616" scope="col"> CLI Command </th></tr></thead><tbody><tr><td headers="idm140707309822928"> sasl </td><td headers="idm140707334876240"> <div class="para">
						Enclosing element for Simple Authentication and Security Layer (SASL) authentication mechanisms
					</div>
					 </td><td headers="idm140707316591616"> <div class="para">
						<code class="literal">N/A</code>
					</div>
					 </td></tr><tr><td headers="idm140707309822928"> properties </td><td headers="idm140707334876240"> <div class="para">
						Contains one or more <code class="sgmltag-element">&lt;property&gt;</code> elements, each with a <code class="literal">name</code> attribute and an optional <code class="literal">value</code> attribute.
					</div>
					 </td><td headers="idm140707316591616"> <div class="para">
						<code class="literal">/profile=default/subsystem=remoting/connector=remoting-connector/property=myProp/:add(value=myPropValue)</code>
					</div>
					 </td></tr></tbody></table></div></div><div class="para"><div class="title">Outbound Connections</div><p>
			You can specify three different types of outbound connection:
		</p></div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				Outbound connection to a URI.
			</div></li><li class="listitem"><div class="para">
				Local outbound connection – connects to a local resource such as a socket.
			</div></li><li class="listitem"><div class="para">
				Remote outbound connection – connects to a remote resource and authenticates using a security realm.
			</div></li></ul></div><div class="para">
		All of the outbound connections are enclosed in an <code class="sgmltag-element">&lt;outbound-connections&gt;</code> element. Each of these connection types takes an <code class="literal">outbound-socket-binding-ref</code> attribute. The outbound-connection takes a <code class="literal">uri</code> attribute. The remote outbound connection takes optional <code class="literal">username</code> and <code class="literal">security-realm</code> attributes to use for authorization.
	</div><div class="table" id="idm140707318066432"><p class="title"><strong>Table 14.4. Outbound Connection Elements</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="Outbound Connection Elements"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707337727760" scope="col"> Attribute </th><th id="idm140707313407584" scope="col"> Description </th><th id="idm140707325788864" scope="col"> CLI Command </th></tr></thead><tbody><tr><td headers="idm140707337727760"> outbound-connection </td><td headers="idm140707313407584"> Generic outbound connection. </td><td headers="idm140707325788864"> <div class="para">
						<code class="literal">/profile=default/subsystem=remoting/outbound-connection=my-connection/:add(uri=http://my-connection)</code>
					</div>
					 </td></tr><tr><td headers="idm140707337727760"> local-outbound-connection </td><td headers="idm140707313407584"> Outbound connection with a implicit local:// URI scheme. </td><td headers="idm140707325788864"> <div class="para">
						<code class="literal">/profile=default/subsystem=remoting/local-outbound-connection=my-connection/:add(outbound-socket-binding-ref=remoting2)</code>
					</div>
					 </td></tr><tr><td headers="idm140707337727760"> remote-outbound-connection </td><td headers="idm140707313407584"> <div class="para">
						Outbound connections for remote:// URI scheme, using basic/digest authentication with a security realm.
					</div>
					 </td><td headers="idm140707325788864"> <div class="para">
						<code class="literal">/profile=default/subsystem=remoting/remote-outbound-connection=my-connection/:add(outbound-socket-binding-ref=remoting,username=myUser,security-realm=ApplicationRealm)</code>
					</div>
					 </td></tr></tbody></table></div></div><div class="para"><div class="title">SASL Elements</div><p>
			Before defining the SASL child elements, you need to create the initial SASL element. Use the following command:
		</p></div><pre class="screen">/profile=default/subsystem=remoting/connector=remoting-connector/security=sasl:add</pre><div class="para">
		The child elements of the SASL element are described in the table below.
	</div><div class="informaltable"><table class="lt-4-cols gt-7-rows"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707312950064" scope="col"> Attribute </th><th id="idm140707312949584" scope="col"> Description </th><th id="idm140707308819536" scope="col"> CLI Command </th></tr></thead><tbody><tr><td headers="idm140707312950064"> include-mechanisms </td><td headers="idm140707312949584"> <div class="para">
						Contains a <code class="literal">value</code> attribute, which is a space-separated list of SASL mechanisms.
					</div>
					 </td><td headers="idm140707308819536">
<pre class="screen">/profile=default/subsystem=remoting/connector=remoting-connector/security=sasl:write-attribute(name=include-mechanisms,value=["DIGEST","PLAIN","GSSAPI"])</pre>
					 </td></tr><tr><td headers="idm140707312950064"> qop </td><td headers="idm140707312949584"> <div class="para">
						Contains a <code class="literal">value</code> attribute, which is a space-separated list of SASL Quality of protection values, in decreasing order of preference.
					</div>
					 </td><td headers="idm140707308819536">
<pre class="screen">/profile=default/subsystem=remoting/connector=remoting-connector/security=sasl:write-attribute(name=qop,value=["auth"])</pre>
					 </td></tr><tr><td headers="idm140707312950064"> strength </td><td headers="idm140707312949584"> <div class="para">
						Contains a <code class="literal">value</code> attribute, which is a space-separated list of SASL cipher strength values, in decreasing order of preference.
					</div>
					 </td><td headers="idm140707308819536">
<pre class="screen">/profile=default/subsystem=remoting/connector=remoting-connector/security=sasl:write-attribute(name=strength,value=["medium"])</pre>
					 </td></tr><tr><td headers="idm140707312950064"> reuse-session </td><td headers="idm140707312949584"> <div class="para">
						Contains a <code class="literal">value</code> attribute which is a boolean value. If true, attempt to reuse sessions.
					</div>
					 </td><td headers="idm140707308819536">
<pre class="screen">/profile=default/subsystem=remoting/connector=remoting-connector/security=sasl:write-attribute(name=reuse-session,value=false)</pre>
					 </td></tr><tr><td headers="idm140707312950064"> server-auth </td><td headers="idm140707312949584"> <div class="para">
						Contains a <code class="literal">value</code> attribute which is a boolean value. If true, the server authenticates to the client.
					</div>
					 </td><td headers="idm140707308819536">
<pre class="screen">/profile=default/subsystem=remoting/connector=remoting-connector/security=sasl:write-attribute(name=server-auth,value=false)</pre>
					 </td></tr><tr><td headers="idm140707312950064"> policy </td><td headers="idm140707312949584"> <div class="para">
						An enclosing element which contains zero or more of the following elements, which each take a single <code class="literal">value</code>.
					</div>
					 <div class="itemizedlist"><ul><li class="listitem"><div class="para">
								forward-secrecy – whether mechanisms are required to implement forward secrecy (breaking into one session will not automatically provide information for breaking into future sessions)
							</div></li><li class="listitem"><div class="para">
								no-active – whether mechanisms susceptible to non-dictionary attacks are permitted. A value of <code class="literal">false</code> permits, and <code class="literal">true</code> denies.
							</div></li><li class="listitem"><div class="para">
								no-anonymous – whether mechanisms that accept anonymous login are permitted. A value of <code class="literal">false</code> permits, and <code class="literal">true</code> denies.
							</div></li><li class="listitem"><div class="para">
								no-dictionary – whether mechanisms susceptible to passive dictionary attacks are allowed. A value of <code class="literal">false</code> permits, and <code class="literal">true</code> denies.
							</div></li><li class="listitem"><div class="para">
								no-plain-text – whether mechanisms which are susceptible to simple plain passive attacks are allowed. A value of <code class="literal">false</code> permits, and <code class="literal">true</code> denies.
							</div></li><li class="listitem"><div class="para">
								pass-credentials – whether mechanisms which pass client credentials are allowed.
							</div></li></ul></div>
					 </td><td headers="idm140707308819536">
<pre class="screen">/profile=default/subsystem=remoting/connector=remoting-connector/security=sasl/sasl-policy=policy:add</pre>
					 
<pre class="screen">/profile=default/subsystem=remoting/connector=remoting-connector/security=sasl/sasl-policy=policy:write-attribute(name=forward-secrecy,value=true)</pre>
					 
<pre class="screen">/profile=default/subsystem=remoting/connector=remoting-connector/security=sasl/sasl-policy=policy:write-attribute(name=no-active,value=false)</pre>
					 
<pre class="screen">/profile=default/subsystem=remoting/connector=remoting-connector/security=sasl/sasl-policy=policy:write-attribute(name=no-anonymous,value=false)</pre>
					 
<pre class="screen">/profile=default/subsystem=remoting/connector=remoting-connector/security=sasl/sasl-policy=policy:write-attribute(name=no-dictionary,value=true)</pre>
					 
<pre class="screen">/profile=default/subsystem=remoting/connector=remoting-connector/security=sasl/sasl-policy=policy:write-attribute(name=no-plain-text,value=false)</pre>
					 
<pre class="screen">/profile=default/subsystem=remoting/connector=remoting-connector/security=sasl/sasl-policy=policy:write-attribute(name=pass-credentials,value=true)</pre>
					 </td></tr><tr><td headers="idm140707312950064"> properties </td><td headers="idm140707312949584"> <div class="para">
						Contains one or more <code class="sgmltag-element">&lt;property&gt;</code> elements, each with a <code class="literal">name</code> attribute and an optional <code class="literal">value</code> attribute.
					</div>
					 </td><td headers="idm140707308819536">
<pre class="screen">/profile=default/subsystem=remoting/connector=remoting-connector/security=sasl/property=myprop:add(value=1)</pre>
					 
<pre class="screen">/profile=default/subsystem=remoting/connector=remoting-connector/security=sasl/property=myprop2:add(value=2)</pre>
					 </td></tr></tbody></table></div><div class="example" id="idm140707321099952"><p class="title"><strong>Example 14.11. Example Configurations</strong></p><div class="example-contents"><div class="para">
			This example shows the default remoting subsystem that ships with JBoss EAP 6.
		</div><pre class="programlisting language-xml XML XML">
&lt;subsystem xmlns="urn:jboss:domain:remoting:1.1"&gt;
    &lt;connector name="remoting-connector" socket-binding="remoting" security-realm="ApplicationRealm"/&gt;
&lt;/subsystem&gt;    

</pre><div class="para">
			This example contains many hypothetical values, and is presented to put the elements and attributes discussed previously into context.
		</div><pre class="programlisting language-xml XML XML">
&lt;subsystem xmlns="urn:jboss:domain:remoting:1.1"&gt;
    &lt;worker-thread-pool read-threads="1" task-keepalive="60' task-max-threads="16" task-core-thread="4" task-limit="16384" write-threads="1" /&gt;
    &lt;connector name="remoting-connector" socket-binding="remoting" security-realm="ApplicationRealm"&gt;
        &lt;sasl&gt;
            &lt;include-mechanisms value="GSSAPI PLAIN DIGEST-MD5" /&gt;
            &lt;qop value="auth" /&gt;
            &lt;strength value="medium" /&gt;
            &lt;reuse-session value="false" /&gt;
            &lt;server-auth value="false" /&gt;
            &lt;policy&gt;
                &lt;forward-secrecy value="true" /&gt;
                &lt;no-active value="false" /&gt;
                &lt;no-anonymous value="false" /&gt;
                &lt;no-dictionary value="true" /&gt;
                &lt;no-plain-text value="false" /&gt;
                &lt;pass-credentials value="true" /&gt;
            &lt;/policy&gt;
            &lt;properties&gt;
                &lt;property name="myprop1" value="1" /&gt;
                &lt;property name="myprop2" value="2" /&gt;
            &lt;/properties&gt;
        &lt;/sasl&gt;
        &lt;authentication-provider name="myprovider" /&gt;
        &lt;properties&gt;
            &lt;property name="myprop3" value="propValue" /&gt;
        &lt;/properties&gt;
    &lt;/connector&gt;
    &lt;outbound-connections&gt;
        &lt;outbound-connection name="my-outbound-connection" uri="http://myhost:7777/"/&gt;
        &lt;remote-outbound-connection name="my-remote-connection" outbound-socket-binding-ref="my-remote-socket" username="myUser" security-realm="ApplicationRealm"/&gt;
        &lt;local-outbound-connection name="myLocalConnection" outbound-socket-binding-ref="my-outbound-socket"/&gt;
    &lt;/outbound-connections&gt;
&lt;/subsystem&gt;    

</pre></div></div><div class="itemizedlist"><p class="title"><strong>Configuration Aspects Not Yet Documented</strong></p><ul><li class="listitem"><div class="para">
				JNDI and Multicast Automatic Detection
			</div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+7884-460018+%5BSpecified%5D&amp;comment=Title%3A+Configure+the+Remoting+Subsystem%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7884-460018+14+Jun+2013+14%3A37+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Use_Security_Realms_with_Remote_EJB_Clients" lang="en-US"><div class="titlepage"><div><div><h4 class="title">14.4.4.5. Use Security Realms with Remote EJB Clients</h4></div></div></div><div class="para">
		One way to add security to clients which invoke EJBs remotely is to use security realms. A security realm is a simple database of username/password pairs and username/role pairs. The terminology is also used in the context of web containers, with a slightly different meaning.
	</div><div class="para">
		To authenticate an EJB to a specific username and password which exists in a security realm, follow these steps:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				Add a new security realm to the domain controller or standalone server.
			</div></li><li class="listitem"><div class="para">
				Add the following parameters to the <code class="filename">jboss-ejb-client.properties</code> file, which is in the classpath of the application. This example assumes the connection is referred to as <code class="literal">default</code> by the other parameters in the file.
			</div><pre class="programlisting">
remote.connection.default.username=appuser
remote.connection.default.password=apppassword
</pre></li><li class="listitem"><div class="para">
				Create a custom Remoting connector on the domain or standalone server, which uses your new security realm.
			</div></li><li class="listitem"><div class="para">
				Deploy your EJB to the server group which is configured to use the profile with the custom Remoting connector, or to your standalone server if you are not using a managed domain.
			</div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+8270-432931+%5BSpecified%5D&amp;comment=Title%3A+Use+Security+Realms+with+Remote+EJB+Clients%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=8270-432931+11+Apr+2013+10%3A48+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Add_a_New_Security_Realm1" lang="en-US"><div class="titlepage"><div><div><h4 class="title">14.4.4.6. Add a New Security Realm</h4></div></div></div><div class="procedure"><ol class="1"><li class="step"><p class="title"><strong>Run the Management CLI.</strong></p><div class="para">
				Start the <code class="filename">jboss-cli.sh</code> or <code class="filename">jboss-cli.bat</code> command and connect to the server.
			</div></li><li class="step"><p class="title"><strong>Create the new security realm itself.</strong></p><div class="para">
				Run the following command to create a new security realm named <code class="literal">MyDomainRealm</code> on a domain controller or a standalone server.
			</div><pre class="screen">/host=master/core-service=management/security-realm=MyDomainRealm:add()</pre></li><li class="step"><p class="title"><strong>Create the references to the properties file which will store information about the new role.</strong></p><div class="para">
				Run the following command to create a pointer a file named <code class="filename">myfile.properties</code>, which will contain the properties pertaining to the new role.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					The newly-created properties file is not managed by the included <code class="filename">add-user.sh</code> and <code class="filename">add-user.bat</code> scripts. It must be managed externally.
				</div></div></div><pre class="screen">/host=master/core-service=management/security-realm=MyDomainRealm/authentication=properties:add(path=myfile.properties)</pre></li></ol></div><div class="para"><div class="title">Result</div><p>
			Your new security realm is created. When you add users and roles to this new realm, the information will be stored in a separate file from the default security realms. You can manage this new file using your own applications or procedures.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+8272-455581+%5BSpecified%5D&amp;comment=Title%3A+Add+a+New+Security+Realm%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=8272-455581+29+May+2013+13%3A28+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Add_a_User_to_a_Security_Realm1" lang="en-US"><div class="titlepage"><div><div><h4 class="title">14.4.4.7. Add a User to a Security Realm</h4></div></div></div><div class="procedure"><ol class="1"><li class="step"><p class="title"><strong>Run the <code class="filename">add-user.sh</code> or <code class="filename">add-user.bat</code> command.</strong></p><div class="para">
				Open a terminal and change directories to the <code class="filename"><em class="replaceable">EAP_HOME</em>/bin/</code> directory. If you run Red Hat Enterprise Linux or another UNIX-like operating system, run <code class="filename">add-user.sh</code>. If you run Microsoft Windows Server, run <code class="filename">add-user.bat</code>.
			</div></li><li class="step"><p class="title"><strong>Choose whether to add a Management User or Application User.</strong></p><div class="para">
				For this procedure, type <code class="literal">b</code> to add an Application User.
			</div></li><li class="step"><p class="title"><strong>Choose the realm the user will be added to.</strong></p><div class="para">
				By default, the only available realm is <code class="literal">ApplicationRealm</code>. If you have added a custom realm, you can type its name instead.
			</div></li><li class="step"><p class="title"><strong>Type the username, password, and roles, when prompted.</strong></p><div class="para">
				Type the desired username, password, and optional roles when prompted. Verify your choice by typing <code class="literal">yes</code>, or type <code class="literal">no</code> to cancel the changes. The changes are written to each of the properties files for the security realm.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+8271-450875+%5BSpecified%5D&amp;comment=Title%3A+Add+a+User+to+a+Security+Realm%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=8271-450875+21+May+2013+14%3A28+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="About_Remote_EJB_Access_Using_SSL_Encryption" lang="en-US"><div class="titlepage"><div><div><h4 class="title">14.4.4.8. About Remote EJB Access Using SSL Encryption</h4></div></div></div><div class="para">
		By default, the network traffic for Remote Method Invocation (RMI) of EJB2 and EJB3 Beans is not encrypted. In instances where encryption is required, Secure Sockets Layer (SSL) can be utilized so that the connection between the client and server is encrypted. Using SSL also has the added benefit of allowing the network traffic to traverse firewalls that block the RMI port.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4786-432898+%5BSpecified%5D&amp;comment=Title%3A+About+Remote+EJB+Access+Using+SSL+Encryption%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4786-432898+11+Apr+2013+10%3A47+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div></div><div class="section" id="sect-JAX-RS_Application_Security"><div class="titlepage"><div><div><h2 class="title">14.5. JAX-RS Application Security</h2></div></div></div><div xml:lang="en-US" class="section" id="Enable_Role-Based_Security_for_a_RESTEasy_JAX-RS_Web_Service" lang="en-US"><div class="titlepage"><div><div><h3 class="title">14.5.1. Enable Role-Based Security for a RESTEasy JAX-RS Web Service</h3></div></div></div><div class="para"><div class="title">Summary</div><p>
			RESTEasy supports the @RolesAllowed, @PermitAll, and @DenyAll annotations on JAX-RS methods. However, it does not recognize these annotations by default. Follow these steps to configure the <code class="filename">web.xml</code> file and enable role-based security.
		</p></div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
			Do not activate role-based security if the application uses EJBs. The EJB container will provide the functionality, instead of RESTEasy.
		</div></div></div><div class="procedure"><p class="title"><strong>Procedure 14.3. Enable Role-Based Security for a RESTEasy JAX-RS Web Service</strong></p><ol class="1"><li class="step"><div class="para">
				Open the <code class="filename">web.xml</code> file for the application in a text editor.
			</div></li><li class="step"><div class="para">
				Add the following &lt;context-param&gt; to the file, within the <code class="code">web-app</code> tags:
			</div><pre class="screen">
&lt;context-param&gt;
    &lt;param-name&gt;resteasy.role.based.security&lt;/param-name&gt;
    &lt;param-value&gt;true&lt;/param-value&gt;
&lt;/context-param&gt;
</pre></li><li class="step"><div class="para">
				Declare all roles used within the RESTEasy JAX-RS WAR file, using the &lt;security-role&gt; tags:
			</div><pre class="screen">&lt;security-role&gt;
    &lt;role-name&gt;<em class="replaceable">ROLE_NAME</em>&lt;/role-name&gt;
&lt;/security-role&gt;
&lt;security-role&gt;
    &lt;role-name&gt;<em class="replaceable">ROLE_NAME</em>&lt;/role-name&gt;
&lt;/security-role&gt;</pre></li><li class="step"><div class="para">
				Authorize access to all URLs handled by the JAX-RS runtime for all roles:
			</div><pre class="screen">&lt;security-constraint&gt;
    &lt;web-resource-collection&gt;
	&lt;web-resource-name&gt;Resteasy&lt;/web-resource-name&gt;
	&lt;url-pattern&gt;/<em class="replaceable">PATH</em>&lt;/url-pattern&gt;
    &lt;/web-resource-collection&gt;
    &lt;auth-constraint&gt;
	&lt;role-name&gt;<em class="replaceable">ROLE_NAME</em>&lt;/role-name&gt;
	&lt;role-name&gt;<em class="replaceable">ROLE_NAME</em>&lt;/role-name&gt;
    &lt;/auth-constraint&gt;
&lt;/security-constraint&gt;</pre></li></ol></div><div class="para"><div class="title">Result</div><p>
			Role-based security has been enabled within the application, with a set of defined roles.
		</p></div><div class="example" id="idm140707308321952"><p class="title"><strong>Example 14.12. Example Role-Based Security Configuration</strong></p><div class="example-contents"><pre class="programlisting">
&lt;web-app&gt;

    &lt;context-param&gt;
	&lt;param-name&gt;resteasy.role.based.security&lt;/param-name&gt;
	&lt;param-value&gt;true&lt;/param-value&gt;
    &lt;/context-param&gt;

    &lt;servlet-mapping&gt;
	&lt;servlet-name&gt;Resteasy&lt;/servlet-name&gt;
	&lt;url-pattern&gt;/*&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;

    &lt;security-constraint&gt;
	&lt;web-resource-collection&gt;
	    &lt;web-resource-name&gt;Resteasy&lt;/web-resource-name&gt;
	    &lt;url-pattern&gt;/security&lt;/url-pattern&gt;
	&lt;/web-resource-collection&gt;
	&lt;auth-constraint&gt;
	    &lt;role-name&gt;admin&lt;/role-name&gt;
	    &lt;role-name&gt;user&lt;/role-name&gt;
	&lt;/auth-constraint&gt;
    &lt;/security-constraint&gt;

    &lt;security-role&gt;
	&lt;role-name&gt;admin&lt;/role-name&gt;
    &lt;/security-role&gt;
    &lt;security-role&gt;
	&lt;role-name&gt;user&lt;/role-name&gt;
    &lt;/security-role&gt;
    
&lt;/web-app&gt;
</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+5945-431989+%5BSpecified%5D&amp;comment=Title%3A+Enable+Role-Based+Security+for+a+RESTEasy+JAX-RS+Web+Service%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5945-431989+08+Apr+2013+16%3A03+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Secure_a_JAX-RS_Web_Service_using_Annotations" lang="en-US"><div class="titlepage"><div><div><h3 class="title">14.5.2. Secure a JAX-RS Web Service using Annotations</h3></div></div></div><div class="para"><div class="title">Summary</div><p>
			This topic covers the steps to secure a JAX-RS web service using the supported security annotations
		</p></div><div class="procedure"><p class="title"><strong>Procedure 14.4. Secure a JAX-RS Web Service using Supported Security Annotations</strong></p><ol class="1"><li class="step"><div class="para">
				Enable role-based security. For more information, refer to: <a class="xref" href="#Enable_Role-Based_Security_for_a_RESTEasy_JAX-RS_Web_Service">Section 14.5.1, “Enable Role-Based Security for a RESTEasy JAX-RS Web Service”</a>
			</div></li><li class="step"><div class="para">
				Add security annotations to the JAX-RS web service. RESTEasy supports the following annotations:
			</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">@RolesAllowed</span></dt><dd><div class="para">
							Defines which roles can access the method. All roles should be defined in the <code class="filename">web.xml</code> file.
						</div></dd><dt><span class="term">@PermitAll</span></dt><dd><div class="para">
							Allows all roles defined in the <code class="filename">web.xml</code> file to access the method.
						</div></dd><dt><span class="term">@DenyAll</span></dt><dd><div class="para">
							Denies all access to the method.
						</div></dd></dl></div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+6095-431984+%5BSpecified%5D&amp;comment=Title%3A+Secure+a+JAX-RS+Web+Service+using+Annotations%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=6095-431984+08+Apr+2013+15%3A59+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div></div><div xml:lang="en-US" class="chapter" id="chap-Login_Modules" lang="en-US"><div class="titlepage"><div><div><h2 class="title">Chapter 15. Login Modules</h2></div></div></div><div class="para">

	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+IDs%3A%0A28308-608934+%5BSpecified%5D&amp;comment=Title%3A+Login+Modules%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div><div class="section" id="sect-Using_Modules"><div class="titlepage"><div><div><h2 class="title">15.1. Using Modules</h2></div></div></div><div class="para">
			JBoss EAP 6 includes several bundled login modules suitable for most user management needs. JBoss EAP 6 can read user information from a relational database, an LDAP server, or flat files. In addition to these core login modules, JBoss EAP 6 provides other login modules that provide user information for very customized needs.
		</div><div class="para">
			More login modules and their options can be found in Appendix A.1.
		</div><div class="para RoleCreateBugPara">
			<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+IDs%3A%0A28309-638876+%5BSpecified%5D&amp;comment=Title%3A+Using+Modules%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
		</div><div xml:lang="en-US" class="section" id="Password_Stacking" lang="en-US"><div class="titlepage"><div><div><h3 class="title">15.1.1. Password Stacking</h3></div></div></div><div class="para">
		Multiple login modules can be chained together in a stack, with each login module providing both the credentials verification and role assignment during authentication. This works for many use cases, but sometimes credentials verification and role assignment are split across multiple user management stores.
	</div><div class="para">
		<a class="xref" href="#LdapLoginModule1">Section 15.1.4, “Ldap Login Module”</a> describes how to combine LDAP and a relational database, allowing a user to be authenticated by either system. Consider the case where users are managed in a central LDAP server but application-specific roles are stored in the application's relational database. The password-stacking module option captures this relationship.
	</div><div class="para">
		To use password stacking, each login module should set the <span class="markup">&lt;module-option&gt;</span> <code class="literal">password-stacking</code> attribute to <code class="literal">useFirstPass</code>. If a previous module configured for password stacking has authenticated the user, all the other stacking modules will consider the user authenticated and only attempt to provide a set of roles for the authorization step.
	</div><div class="para">
		When <code class="literal">password-stacking</code> option is set to <code class="literal">useFirstPass</code>, this module first looks for a shared user name and password under the property names <span class="property">javax.security.auth.login.name</span> and <span class="property">javax.security.auth.login.password</span> respectively in the login module shared state map.
	</div><div class="para">
		If found, these properties are used as the principal name and password. If not found, the principal name and password are set by this login module and stored under the property names <span class="property">javax.security.auth.login.name</span> and <span class="property">javax.security.auth.login.password</span> respectively.
	</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			When using password stacking, set all modules to be required. This ensures that all modules are considered, and have the chance to contribute roles to the authorization process.
		</div></div></div><div class="example" id="exam-Password_Stacking_Example"><p class="title"><strong>Example 15.1. Password Stacking Sample</strong></p><div class="example-contents"><div class="para">
			This management CLI example shows how password stacking could be used.
		</div><pre class="programlisting">/subsystem=security/security-domain=pwdStack/authentication=classic/login-module=Ldap:add( \
  code=Ldap, \
  flag=required, \
  module-options=[ \
    ("password-stacking"=&gt;"useFirstPass"), \
    ... Ldap login module configuration
  ])
/subsystem=security/security-domain=pwdStack/authentication=classic/login-module=Database:add( \
  code=Database, \
  flag=required, \
  module-options=[ \
    ("password-stacking"=&gt;"useFirstPass"), \
    ... Database login module configuration
  ])</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+28312-638661+%5BSpecified%5D&amp;comment=Title%3A+Password+Stacking%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=28312-638661+07+May+2014+10%3A55+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Password_Hashing" lang="en-US"><div class="titlepage"><div><div><h3 class="title">15.1.2. Password Hashing</h3></div></div></div><div class="para">
		Most login modules must compare a client-supplied password to a password stored in a user management system. These modules generally work with plain text passwords, but can be configured to support hashed passwords to prevent plain text passwords from being stored on the server side.
	</div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
			Red Hat JBoss Enterprise Application Platform Common Criteria certified release only supports SHA-256 for password hashing.
		</div></div></div><div class="example" id="idm140707313800608"><p class="title"><strong>Example 15.2. Password Hashing</strong></p><div class="example-contents"><div class="para">
			The following is a login module configuration that assigns unauthenticated users the principal name <code class="literal">nobody</code> and contains based64-encoded, SHA-256 hashes of the passwords in a <code class="filename">usersb64.properties</code> file. The <code class="filename">usersb64.properties</code> file is part of the deployment classpath.
		</div><pre class="programlisting">
/subsystem=security/security-domain=testUsersRoles:add
/subsystem=security/security-domain=testUsersRoles/authentication=classic:add
/subsystem=security/security-domain=testUsersRoles/authentication=classic/login-module=UsersRoles:add( \
  code=UsersRoles, \
  flag=required, \
  module-options=[ \
    ("usersProperties"=&gt;"usersb64.properties"), \
    ("rolesProperties"=&gt;"test-users-roles.properties"), \
    ("unauthenticatedIdentity"=&gt;"nobody"), \
    ("hashAlgorithm"=&gt;"SHA-256"), \
    ("hashEncoding"=&gt;"base64") \
  ])
</pre></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">hashAlgorithm</span></dt><dd><div class="para">
					Name of the <code class="literal">java.security.MessageDigest</code> algorithm to use to hash the password. There is no default so this option must be specified to enable hashing. Typical values are <code class="literal">SHA-256</code>, <code class="literal">SHA-1</code> and <code class="literal">MD5</code>.
				</div></dd><dt><span class="term">hashEncoding</span></dt><dd><div class="para">
					String that specifies one of three encoding types: <code class="literal">base64</code>, <code class="literal">hex</code> or <code class="literal">rfc2617</code>. The default is <code class="literal">base64</code>.
				</div></dd><dt><span class="term">hashCharset</span></dt><dd><div class="para">
					Encoding character set used to convert the clear text password to a byte array. The platform default encoding is the default.
				</div></dd><dt><span class="term">hashUserPassword</span></dt><dd><div class="para">
					Specifies the hashing algorithm must be applied to the password the user submits. The hashed user password is compared against the value in the login module, which is expected to be a hash of the password. The default is <code class="literal">true</code>.
				</div></dd><dt><span class="term">hashStorePassword</span></dt><dd><div class="para">
					Specifies the hashing algorithm must be applied to the password stored on the server side. This is used for digest authentication, where the user submits a hash of the user password along with a request-specific tokens from the server to be compare. The hash algorithm (for digest, this would be <code class="literal">rfc2617</code>) is utilized to compute a server-side hash, which should match the hashed value sent from the client.
				</div></dd></dl></div><div class="para">
		If you must generate passwords in code, the <code class="classname">org.jboss.security.auth.spi.Util</code> class provides a static helper method that will hash a password using the specified encoding. The following example produces a base64-encoded, MD5 hashed password.
	</div><pre class="programlisting language-java">
String hashedPassword = Util.createPasswordHash("SHA-256",
 Util.BASE64_ENCODING, null, null, "password");
</pre><div class="para">
		OpenSSL provides an alternative way to quickly generate hashed passwords at the command-line. The following example also produces a base64-encoded, SHA-256 hashed password. Here the password in plain text - <code class="literal">password</code> - is piped into the OpenSSL digest function then piped into another OpenSSL function to convert into base64-encoded format.
	</div><pre class="programlisting">echo -n password | openssl dgst -sha256 -binary | openssl base64</pre><div class="para">
		In both cases, the hashed version of the password is the same: <code class="literal"> XohImNooBHFR0OVvjcYpJ3NgPQ1qq73WKhHvch0VQtg=</code>. This value must be stored in the users' properties file specified in the security domain - <code class="filename">usersb64.properties</code> - in the example above.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+28313-638664+%5BSpecified%5D&amp;comment=Title%3A+Password+Hashing%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=28313-638664+07+May+2014+10%3A59+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Unauthenticated_Identity" lang="en-US"><div class="titlepage"><div><div><h3 class="title">15.1.3. Unauthenticated Identity</h3></div></div></div><div class="para">
		Not all requests are received in an authenticated format. <code class="literal">unauthenticatedIdentity</code> is a login module configuration option that assigns a specific identity (guest, for example) to requests that are made with no associated authentication information. This can be used to allow unprotected servlets to invoke methods on EJBs that do not require a specific role. Such a principal has no associated roles and so can only access either unsecured EJBs or EJB methods that are associated with the unchecked permission constraint.
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				<span class="bold bold"><strong>unauthenticatedIdentity</strong></span>: This defines the principal name that should be assigned to requests that contain no authentication information.
			</div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+28314-592747+%5BSpecified%5D&amp;comment=Title%3A+Unauthenticated+Identity%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=28314-592747+24+Feb+2014+08%3A00+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="LdapLoginModule1" lang="en-US"><div class="titlepage"><div><div><h3 class="title">15.1.4. Ldap Login Module</h3></div></div></div><div class="para">
		<code class="literal">Ldap</code> login module is a <code class="literal">LoginModule</code> implementation that authenticates against a Lightweight Directory Access Protocol (LDAP) server. Use the <code class="literal">Ldap</code> login module if your user name and credentials are stored in an LDAP server that is accessible using a Java Naming and Directory Interface (JNDI) LDAP provider.
	</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			If you wish to use LDAP with the SPNEGO authentication or skip some of the authentication phases while using an LDAP server, consider using the <code class="literal">AdvancedLdap</code> login module chained with the SPNEGOUsers login module or only the <code class="literal">AdvancedLdap</code> login module.
		</div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Distinguished Name (DN)</span></dt><dd><div class="para">
					In Lightweight Directory Access Protocol (LDAP), the distinguished name uniquely identifies an object in a directory. Each distinguished name must have a unique name and location from all other objects, which is achieved using a number of attribute-value pairs (AVPs). The AVPs define information such as common names, organization unit, among others. The combination of these values results in a unique string required by the LDAP.
				</div></dd></dl></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			This login module also supports unauthenticated identity and password stacking.
		</div></div></div><div class="para">
		The LDAP connectivity information is provided as configuration options that are passed through to the environment object used to create JNDI initial context. The standard LDAP JNDI properties used include the following:
	</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="property">java.naming.factory.initial</span></span></dt><dd><div class="para">
					<code class="classname">InitialContextFactory</code> implementation class name. This defaults to the Sun LDAP provider implementation <code class="literal">com.sun.jndi.ldap.LdapCtxFactory</code>.
				</div></dd><dt><span class="term"><span class="property">java.naming.provider.url</span></span></dt><dd><div class="para">
					LDAP URL for the LDAP server.
				</div></dd><dt><span class="term"><span class="property">java.naming.security.authentication</span></span></dt><dd><div class="para">
					Security protocol level to use. The available values include <code class="literal">none</code>, <code class="literal">simple</code>, and <code class="literal">strong</code>. If the property is undefined, the behavior is determined by the service provider.
				</div></dd><dt><span class="term"><span class="property">java.naming.security.protocol</span></span></dt><dd><div class="para">
					Transport protocol to use for secure access. Set this configuration option to the type of service provider (for example, SSL). If the property is undefined, the behavior is determined by the service provider.
				</div></dd><dt><span class="term"><span class="property">java.naming.security.principal</span></span></dt><dd><div class="para">
					Specifies the identity of the Principal for authenticating the caller to the service. This is built from other properties as described below.
				</div></dd><dt><span class="term"><span class="property">java.naming.security.credentials</span></span></dt><dd><div class="para">
					Specifies the credentials of the Principal for authenticating the caller to the service. Credentials can take the form of a hashed password, a clear-text password, a key, or a certificate. If the property is undefined, the behavior is determined by the service provider.
				</div></dd></dl></div><div class="para">
		For details of Ldap login module configuration options see <a class="xref" href="#Included_Authentication_Modules1">Section A.1, “Included Authentication Modules”</a>.
	</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			In certain directory schemas (e.g., Microsoft Active Directory), role attributes in the user object are stored as DNs to role objects instead of simple names. For implementations that use this schema type, <span class="property">roleAttributeIsDN</span> must be set to <code class="literal">true</code>.
		</div></div></div><div class="para">
		User authentication is performed by connecting to the LDAP server, based on the login module configuration options. Connecting to the LDAP server is done by creating an <code class="literal">InitialLdapContext</code> with an environment composed of the LDAP JNDI properties described previously in this section.
	</div><div class="para">
		The <span class="property">Context.SECURITY_PRINCIPAL</span> is set to the distinguished name of the user obtained by the callback handler in combination with the <span class="property">principalDNPrefix</span> and <span class="property">principalDNSuffix</span> option values, and the <span class="property">Context.SECURITY_CREDENTIALS</span> property is set to the respective <span class="property">String</span> password.
	</div><div class="para">
		Once authentication has succeeded (<code class="literal">InitialLdapContext</code> instance is created), the user's roles are queried by performing a search on the <code class="literal">rolesCtxDN</code> location with search attributes set to the <span class="property">roleAttributeName</span> and <span class="property">uidAttributeName</span> option values. The roles names are obtaining by invoking the <code class="methodname"> toString </code> method on the role attributes in the search result set.
	</div><div class="example" id="idm140707322841792"><p class="title"><strong>Example 15.3. LDAP Login Module Security Domain</strong></p><div class="example-contents"><div class="para">
			This management CLI example shows how to use the parameters in a security domain authentication configuration.
		</div><pre class="programlisting">
/subsystem=security/security-domain=testLDAP:add(cache-type=default)
/subsystem=security/security-domain=testLDAP/authentication=classic:add
/subsystem=security/security-domain=testLDAP/authentication=classic/login-module=Ldap:add( \
  code=Ldap, \
  flag=required, \
  module-options=[ \
    ("java.naming.factory.initial"=&gt;"com.sun.jndi.ldap.LdapCtxFactory"), \
    ("java.naming.provider.url"=&gt;"ldap://ldaphost.jboss.org:1389/"), \
    ("java.naming.security.authentication"=&gt;"simple"), \
    ("principalDNPrefix"=&gt;"uid="), \
    ("principalDNSuffix"=&gt;",ou=People,dc=jboss,dc=org"), \
    ("rolesCtxDN"=&gt;"ou=Roles,dc=jboss,dc=org"), \
    ("uidAttributeID"=&gt;"member"), \
    ("matchOnUserDN"=&gt;true), \
    ("roleAttributeID"=&gt;"cn"), \
    ("roleAttributeIsDN"=&gt;false) \
  ])
</pre></div></div><div class="para">
		The <em class="parameter"><code>java.naming.factory.initial</code></em>, <em class="parameter"><code>java.naming.factory.url</code></em> and <em class="parameter"><code>java.naming.security</code></em> options in the <span class="property">testLDAP</span> security domain configuration indicate the following conditions:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				The Sun LDAP JNDI provider implementation will be used
			</div></li><li class="listitem"><div class="para">
				The LDAP server is located on host <code class="literal">ldaphost.jboss.org</code> on port 1389
			</div></li><li class="listitem"><div class="para">
				The LDAP simple authentication method will be use to connect to the LDAP server.
			</div></li></ul></div><div class="para">
		The login module attempts to connect to the LDAP server using a Distinguished Name (DN) representing the user it is trying to authenticate. This DN is constructed from the passed <span class="property">principalDNPrefix</span>, the user name of the user and the <span class="property">principalDNSuffix</span> as described above. In <a class="xref" href="#exam-LDIF_File_Example">Example 15.4, “LDIF File Example”</a>, the user name <code class="literal">jsmith</code> would map to <code class="literal">uid=jsmith,ou=People,dc=jboss,dc=org</code>.
	</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			The example assumes the LDAP server authenticates users using the <code class="literal">userPassword</code> attribute of the user's entry (<code class="literal">theduke</code> in this example). Most LDAP servers operate in this manner, however if your LDAP server handles authentication differently you must ensure LDAP is configured according to your production environment requirements.
		</div></div></div><div class="para">
		Once authentication succeeds, the roles on which authorization will be based are retrieved by performing a subtree search of the <code class="literal">rolesCtxDN</code> for entries whose <span class="property">uidAttributeID</span> match the user. If <span class="property">matchOnUserDN</span> is true, the search will be based on the full DN of the user. Otherwise the search will be based on the actual user name entered. In this example, the search is under <code class="literal">ou=Roles,dc=jboss,dc=org</code> for any entries that have a <code class="literal">member</code> attribute equal to <code class="literal">uid=jsmith,ou=People,dc=jboss,dc=org</code>. The search would locate <code class="literal">cn=JBossAdmin</code> under the roles entry.
	</div><div class="para">
		The search returns the attribute specified in the <span class="property">roleAttributeID</span> option. In this example, the attribute is <code class="literal">cn</code>. The value returned would be <code class="literal">JBossAdmin</code>, so the <code class="literal">jsmith</code> user is assigned to the <code class="literal">JBossAdmin</code> role.
	</div><div class="para">
		A local LDAP server often provides identity and authentication services, but is unable to use authorization services. This is because application roles do not always map well onto LDAP groups, and LDAP administrators are often hesitant to allow external application-specific data in central LDAP servers. The LDAP authentication module is often paired with another login module, such as the database login module, that can provide roles more suitable to the application being developed.
	</div><div class="para">
		An LDAP Data Interchange Format (LDIF) file representing the structure of the directory this data operates against is shown in <a class="xref" href="#exam-LDIF_File_Example">Example 15.4, “LDIF File Example”</a>.
	</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">LDAP Data Interchange Format (LDIF)</span></dt><dd><div class="para">
					Plain text data interchange format used to represent LDAP directory content and update requests. Directory content is represented as one record for each object or update request. Content consists of add, modify, delete, and rename requests.
				</div></dd></dl></div><div class="example" id="exam-LDIF_File_Example"><p class="title"><strong>Example 15.4. LDIF File Example</strong></p><div class="example-contents"><pre class="programlisting">dn: dc=jboss,dc=org
objectclass: top
objectclass: dcObject
objectclass: organization
dc: jboss
o: JBoss

dn: ou=People,dc=jboss,dc=org
objectclass: top
objectclass: organizationalUnit
ou: People

dn: uid=jsmith,ou=People,dc=jboss,dc=org
objectclass: top
objectclass: uidObject
objectclass: person
uid: jsmith
cn: John
sn: Smith
userPassword: theduke

dn: ou=Roles,dc=jboss,dc=org
objectclass: top
objectclass: organizationalUnit
ou: Roles

dn: cn=JBossAdmin,ou=Roles,dc=jboss,dc=org
objectclass: top
objectclass: groupOfNames
cn: JBossAdmin
member: uid=jsmith,ou=People,dc=jboss,dc=org
description: the JBossAdmin group
</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+28310-640431+%5BSpecified%5D&amp;comment=Title%3A+Ldap+Login+Module%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=28310-640431+13+May+2014+08%3A42+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="LdapExtLoginModule" lang="en-US"><div class="titlepage"><div><div><h3 class="title">15.1.5. LdapExtended Login Module</h3></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Distinguished Name (DN)</span></dt><dd><div class="para">
					In Lightweight Directory Access Protocol (LDAP), the distinguished name uniquely identifies an object in a directory. Each distinguished name must have a unique name and location from all other objects, which is achieved using a number of attribute-value pairs (AVPs). The AVPs define information such as common names, organization unit, among others. The combination of these values results in a unique string required by the LDAP.
				</div></dd></dl></div><div class="para">
		The LdapExtended (<code class="classname">org.jboss.security.auth.spi.LdapExtLoginModule)</code> searches for the user to bind, as well as the associated roles, for authentication. The roles query recursively follows DNs to navigate a hierarchical role structure.
	</div><div class="para">
		The LoginModule options include whatever options are supported by the chosen LDAP JNDI provider supports. Examples of standard property names are:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				<span class="property">Context.INITIAL_CONTEXT_FACTORY</span> = "java.naming.factory.initial"
			</div></li><li class="listitem"><div class="para">
				<span class="property">Context.SECURITY_PROTOCOL</span> = "java.naming.security.protocol"
			</div></li><li class="listitem"><div class="para">
				<span class="property">Context.PROVIDER_URL</span> = "java.naming.provider.url"
			</div></li><li class="listitem"><div class="para">
				<span class="property">Context.SECURITY_AUTHENTICATION</span> = "java.naming.security.authentication"
			</div></li><li class="listitem"><div class="para">
				<span class="property">Context.REFERRAL</span> = "java.naming.referral"
			</div></li></ul></div><div class="para">
		Login module implementation logic follows the order below:
	</div><div class="orderedlist"><ol><li class="listitem"><div class="para">
				The initial LDAP server bind is authenticated using the <span class="property">bindDN</span> and <span class="property">bindCredential</span> properties. The <span class="property">bindDN</span> is a user with permissions to search both the <span class="property">baseCtxDN</span> and <span class="property">rolesCtxDN</span> trees for the user and roles. The <span class="property">user DN</span> to authenticate against is queried using the filter specified by the <span class="property">baseFilter</span> property.
			</div></li><li class="listitem"><div class="para">
				The resulting <span class="property">userDN</span> is authenticated by binding to the LDAP server using the <span class="property">userDN</span> as the InitialLdapContext environment <span class="property">Context.SECURITY_PRINCIPAL</span>. The <span class="property">Context.SECURITY_CREDENTIALS</span> property is either set to the String password obtained by the callback handler.
			</div></li><li class="listitem"><div class="para">
				If this is successful, the associated user roles are queried using the rolesCtxDN, roleAttributeID, roleAttributeIsDN, roleNameAttributeID, and roleFilter options.
			</div></li></ol></div><div class="para">
		For details of LdapExtended login module options see <a class="xref" href="#Included_Authentication_Modules1">Section A.1, “Included Authentication Modules”</a>.
	</div><div class="figure" id="idm140707323824800"><div class="figure-contents"><div class="mediaobject"><img src="/webassets/avalon/d/JBoss_Enterprise_Application_Platform_Common_Criteria_Certification-6.2.2-Security_Guide-en-US/images/3882521e27adb5b14c8a93468be470a3/4764.png" alt="LDAP Structure Example" /></div></div><p class="title"><strong>Figure 15.1. LDAP Structure Example</strong></p></div><div class="example" id="idm140707339219504"><p class="title"><strong>Example 15.5. Example 2 LDAP Configuration</strong></p><div class="example-contents"><pre class="programlisting">
version: 1
dn: o=example2,dc=jboss,dc=org
objectClass: top
objectClass: organization
o: example2

dn: ou=People,o=example2,dc=jboss,dc=org
objectClass: top
objectClass: organizationalUnit
ou: People

dn: uid=jduke,ou=People,o=example2,dc=jboss,dc=org
objectClass: top
objectClass: uidObject
objectClass: person
objectClass: inetOrgPerson
cn: Java Duke
employeeNumber: judke-123
sn: Duke
uid: jduke
userPassword:: dGhlZHVrZQ==

dn: uid=jduke2,ou=People,o=example2,dc=jboss,dc=org
objectClass: top
objectClass: uidObject
objectClass: person
objectClass: inetOrgPerson
cn: Java Duke2
employeeNumber: judke2-123
sn: Duke2
uid: jduke2
userPassword:: dGhlZHVrZTI=

dn: ou=Roles,o=example2,dc=jboss,dc=org
objectClass: top
objectClass: organizationalUnit
ou: Roles

dn: uid=jduke,ou=Roles,o=example2,dc=jboss,dc=org
objectClass: top
objectClass: groupUserEx
memberOf: cn=Echo,ou=Roles,o=example2,dc=jboss,dc=org
memberOf: cn=TheDuke,ou=Roles,o=example2,dc=jboss,dc=org
uid: jduke

dn: uid=jduke2,ou=Roles,o=example2,dc=jboss,dc=org
objectClass: top
objectClass: groupUserEx
memberOf: cn=Echo2,ou=Roles,o=example2,dc=jboss,dc=org
memberOf: cn=TheDuke2,ou=Roles,o=example2,dc=jboss,dc=org
uid: jduke2

dn: cn=Echo,ou=Roles,o=example2,dc=jboss,dc=org
objectClass: top
objectClass: groupOfNames
cn: Echo
description: the echo role
member: uid=jduke,ou=People,dc=jboss,dc=org

dn: cn=TheDuke,ou=Roles,o=example2,dc=jboss,dc=org
objectClass: groupOfNames
objectClass: top
cn: TheDuke
description: the duke role
member: uid=jduke,ou=People,o=example2,dc=jboss,dc=org

dn: cn=Echo2,ou=Roles,o=example2,dc=jboss,dc=org
objectClass: top
objectClass: groupOfNames
cn: Echo2
description: the Echo2 role
member: uid=jduke2,ou=People,dc=jboss,dc=org

dn: cn=TheDuke2,ou=Roles,o=example2,dc=jboss,dc=org
objectClass: groupOfNames
objectClass: top
cn: TheDuke2
description: the duke2 role
member: uid=jduke2,ou=People,o=example2,dc=jboss,dc=org

dn: cn=JBossAdmin,ou=Roles,o=example2,dc=jboss,dc=org
objectClass: top
objectClass: groupOfNames
cn: JBossAdmin
description: the JBossAdmin group
member: uid=jduke,ou=People,dc=jboss,dc=org</pre><div class="para">
			The module configuration for this LDAP structure example is outlined in the following management CLI command.
		</div><pre class="programlisting">

/subsystem=security/security-domain=testLdapExample2/authentication=classic/login-module=LdapExtended:add( \
  code=LdapExtended, \
  flag=required, \
  module-options=[ \
    ("java.naming.factory.initial"=&gt;"com.sun.jndi.ldap.LdapCtxFactory"), \
    ("java.naming.provider.url"=&gt;"ldap://ldaphost.jboss.org"), \
    ("java.naming.security.authentication"=&gt;"simple"), \
    ("bindDN"=&gt;"cn=Root,dc=jboss,dc=org"), \
    ("bindCredential"=&gt;"secret1"), \
    ("baseCtxDN"=&gt;"ou=People,o=example2,dc=jboss,dc=org"), \
    ("baseFilter"=&gt;"(uid={0})"), \
    ("rolesCtxDN"=&gt;"ou=Roles,o=example2,dc=jboss,dc=org"), \
    ("roleFilter"=&gt;"(uid={0})"), \
    ("roleAttributeIsDN"=&gt;"true"), \
    ("roleAttributeID"=&gt;"memberOf"), \
    ("roleNameAttributeID"=&gt;"cn") \
  ])
</pre></div></div><div class="example" id="idm140707315768800"><p class="title"><strong>Example 15.6. Example 3 LDAP Configuration</strong></p><div class="example-contents"><pre class="programlisting">

dn: o=example3,dc=jboss,dc=org
objectclass: top
objectclass: organization
o: example3

dn: ou=People,o=example3,dc=jboss,dc=org
objectclass: top
objectclass: organizationalUnit
ou: People

dn: uid=jduke,ou=People,o=example3,dc=jboss,dc=org
objectclass: top
objectclass: uidObject
objectclass: person
objectClass: inetOrgPerson
uid: jduke
employeeNumber: judke-123
cn: Java Duke
sn: Duke
userPassword: theduke

dn: ou=Roles,o=example3,dc=jboss,dc=org
objectClass: top
objectClass: organizationalUnit
ou: Roles

dn: uid=jduke,ou=Roles,o=example3,dc=jboss,dc=org
objectClass: top
objectClass: groupUserEx
memberOf: cn=Echo,ou=Roles,o=example3,dc=jboss,dc=org
memberOf: cn=TheDuke,ou=Roles,o=example3,dc=jboss,dc=org
uid: jduke

dn: cn=Echo,ou=Roles,o=example3,dc=jboss,dc=org
objectClass: top
objectClass: groupOfNames
cn: Echo
description: the JBossAdmin group
member: uid=jduke,ou=People,o=example3,dc=jboss,dc=org

dn: cn=TheDuke,ou=Roles,o=example3,dc=jboss,dc=org
objectClass: groupOfNames
objectClass: top
cn: TheDuke
member: uid=jduke,ou=People,o=example3,dc=jboss,dc=org

</pre></div></div><div class="para">
		The module configuration for this LDAP structure example is outlined in the following management CLI command.
	</div><pre class="programlisting">

/subsystem=security/security-domain=testLdapExample3/authentication=classic/login-module=LdapExtended:add( \
  code=LdapExtended, \
  flag=required, \
  module-options=[ \
    ("java.naming.factory.initial"=&gt;"com.sun.jndi.ldap.LdapCtxFactory"), \
    ("java.naming.provider.url"=&gt;"ldap://ldaphost.jboss.org"), \
    ("java.naming.security.authentication"=&gt;"simple"), \
    ("bindDN"=&gt;"cn=Root,dc=jboss,dc=org"), \
    ("bindCredential"=&gt;"secret1"), \
    ("baseCtxDN"=&gt;"ou=People,o=example3,dc=jboss,dc=org"), \
    ("baseFilter"=&gt;"(cn={0})"), \
    ("rolesCtxDN"=&gt;"ou=Roles,o=example3,dc=jboss,dc=org"), \
    ("roleFilter"=&gt;"(member={1})"), \
    ("roleAttributeID"=&gt;"cn") \
  ])

</pre><div class="example" id="idm140707321383392"><p class="title"><strong>Example 15.7. Example 4 LDAP Configuration</strong></p><div class="example-contents"><pre class="programlisting">

dn: o=example4,dc=jboss,dc=org
objectclass: top
objectclass: organization
o: example4

dn: ou=People,o=example4,dc=jboss,dc=org
objectclass: top
objectclass: organizationalUnit
ou: People

dn: uid=jduke,ou=People,o=example4,dc=jboss,dc=org
objectClass: top
objectClass: uidObject
objectClass: person
objectClass: inetOrgPerson
cn: Java Duke
employeeNumber: jduke-123
sn: Duke
uid: jduke
userPassword:: dGhlZHVrZQ==

dn: ou=Roles,o=example4,dc=jboss,dc=org
objectClass: top
objectClass: organizationalUnit
ou: Roles

dn: cn=RG1,ou=Roles,o=example4,dc=jboss,dc=org
objectClass: groupOfNames
objectClass: top
cn: RG1
member: cn=empty

dn: cn=RG2,cn=RG1,ou=Roles,o=example4,dc=jboss,dc=org
objectClass: groupOfNames
objectClass: top
cn: RG2
member: cn=RG1,ou=Roles,o=example4,dc=jboss,dc=org
member: uid=jduke,ou=People,o=example4,dc=jboss,dc=org

dn: cn=RG3,cn=RG1,ou=Roles,o=example4,dc=jboss,dc=org
objectClass: groupOfNames
objectClass: top
cn: RG3
member: cn=RG1,ou=Roles,o=example4,dc=jboss,dc=org

dn: cn=R1,ou=Roles,o=example4,dc=jboss,dc=org
objectClass: groupOfNames
objectClass: top
cn: R1
member: cn=RG2,cn=RG1,ou=Roles,o=example4,dc=jboss,dc=org

dn: cn=R2,ou=Roles,o=example4,dc=jboss,dc=org
objectClass: groupOfNames
objectClass: top
cn: R2
member: cn=RG2,cn=RG1,ou=Roles,o=example4,dc=jboss,dc=org

dn: cn=R3,ou=Roles,o=example4,dc=jboss,dc=org
objectClass: groupOfNames
objectClass: top
cn: R3
member: cn=RG2,cn=RG1,ou=Roles,o=example4,dc=jboss,dc=org
member: cn=RG3,cn=RG1,ou=Roles,o=example4,dc=jboss,dc=org

dn: cn=R4,ou=Roles,o=example4,dc=jboss,dc=org
objectClass: groupOfNames
objectClass: top
cn: R4
member: cn=RG3,cn=RG1,ou=Roles,o=example4,dc=jboss,dc=org

dn: cn=R5,ou=Roles,o=example4,dc=jboss,dc=org
objectClass: groupOfNames
objectClass: top
cn: R5
member: cn=RG3,cn=RG1,ou=Roles,o=example4,dc=jboss,dc=org
member: uid=jduke,ou=People,o=example4,dc=jboss,dc=org
</pre><div class="para">
			The module configuration for this LDAP structure example is outlined in the code sample.
		</div><pre class="programlisting">

/subsystem=security/security-domain=testLdapExample4/authentication=classic/login-module=LdapExtended:add( \
  code=LdapExtended, \
  flag=required, \
  module-options=[ \
    ("java.naming.factory.initial"=&gt;"com.sun.jndi.ldap.LdapCtxFactory"), \
    ("java.naming.provider.url"=&gt;"ldap://ldaphost.jboss.org"), \
    ("java.naming.security.authentication"=&gt;"simple"), \
    ("bindDN"=&gt;"cn=Root,dc=jboss,dc=org"), \
    ("bindCredential"=&gt;"secret1"), \
    ("baseCtxDN"=&gt;"ou=People,o=example4,dc=jboss,dc=org"), \
    ("baseFilter"=&gt;"(cn={0})"), \
    ("rolesCtxDN"=&gt;"ou=Roles,o=example4,dc=jboss,dc=org"), \
    ("roleFilter"=&gt;"(member={1})"), \
    ("roleRecursion"=&gt;"1"), \
    ("roleAttributeID"=&gt;"memberOf") \
  ])

</pre></div></div><div class="example" id="exam-Default_ActiveDirectory_Configuration"><p class="title"><strong>Example 15.8. Default Active Directory Configuration</strong></p><div class="example-contents"><div class="para">
			The example below represents the configuration for a default Active Directory configuration.
		</div><div class="para">
			Some Active Directory configurations may require searching against the Global Catalog on port 3268 instead of the usual port 389. This is most likely when the Active Directory forest includes multiple domains.
		</div><pre class="programlisting">

/subsystem=security/security-domain=AD_Default/authentication=classic/login-module=LdapExtended:add( \
  code=LdapExtended, \
  flag=required, \
  module-options=[ \
    ("java.naming.provider.url"=&gt;"ldap://ldaphost.jboss.org"), \
    ("bindDN"=&gt;"JBOSS\searchuser"), \
    ("bindCredential"=&gt;"password"), \
    ("baseCtxDN"=&gt;"CN=Users,DC=jboss,DC=org"), \
    ("baseFilter"=&gt;"(sAMAccountName={0})"), \
    ("rolesCtxDN"=&gt;"CN=Users,DC=jboss,DC=org"), \
    ("roleFilter"=&gt;"(sAMAccountName={0})"), \
    ("roleAttributeID"=&gt;"memberOf"), \
    ("roleAttributeIsDN"=&gt;"true"), \
    ("roleNameAttributeID"=&gt;"cn"), \
    ("searchScope"=&gt;"ONELEVEL_SCOPE"), \
    ("allowEmptyPasswords"=&gt;"false") \
  ])

</pre></div></div><div class="example" id="idm140707338367232"><p class="title"><strong>Example 15.9. Recursive Roles Active Directory Configuration</strong></p><div class="example-contents"><div class="para">
			The example below implements a recursive role search within Active Directory. The key difference between this example and the default Active Directory example is that the role search has been replaced to search the member attribute using the DN of the user. The login module then uses the DN of the role to find groups of which the group is a member.
		</div><pre class="programlisting">

/subsystem=security/security-domain=AD_Recursive/authentication=classic/login-module=LdapExtended:add( \
  code=LdapExtended, \
  flag=required, \
  module-options=[ \
    ("java.naming.provider.url"=&gt;"ldap://ldaphost.jboss.org"), \
    ("java.naming.referral"=&gt;"follow"), \
    ("bindDN"=&gt;"JBOSS\searchuser"), \
    ("bindCredential"=&gt;"password"), \
    ("baseCtxDN"=&gt;"CN=Users,DC=jboss,DC=org"), \
    ("baseFilter"=&gt;"(sAMAccountName={0})"), \
    ("rolesCtxDN"=&gt;"CN=Users,DC=jboss,DC=org"), \
    ("roleFilter"=&gt;"(member={1})"), \
    ("roleAttributeID"=&gt;"cn"), \
    ("roleAttributeIsDN"=&gt;"false"), \
    ("roleRecursion"=&gt;"2"), \
    ("searchScope"=&gt;"ONELEVEL_SCOPE"), \
    ("allowEmptyPasswords"=&gt;"false") \
  ])

</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+28311-640432+%5BSpecified%5D&amp;comment=Title%3A+LdapExtended+Login+Module%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=28311-640432+13+May+2014+08%3A44+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="UsersRolesLoginModule" lang="en-US"><div class="titlepage"><div><div><h3 class="title">15.1.6. UsersRoles Login Module</h3></div></div></div><div class="para">
		<code class="literal">UsersRoles</code> login module is a simple login module that supports multiple users and user roles loaded from Java properties files. The default username-to-password mapping filename is <code class="filename">users.properties</code> and the default username-to-roles mapping filename is <code class="filename">roles.properties</code>.
	</div><div class="para">
		For details of UsersRoles login module options see <a class="xref" href="#Included_Authentication_Modules1">Section A.1, “Included Authentication Modules”</a> .
	</div><div class="para">
		This login module supports password stacking, password hashing, and unauthenticated identity.
	</div><div class="para">
		The properties files are loaded during initialization using the initialize method thread context class loader. This means that these files can be placed on the classpath of the Java EE deployment (for example, into the <code class="filename">WEB-INF/classes</code> folder in the <code class="literal">WAR</code> archive), or into any directory on the server classpath. The primary purpose of this login module is to easily test the security settings of multiple users and roles using properties files deployed with the application.
	</div><div class="example" id="exam-UsersRoleLoginModule"><p class="title"><strong>Example 15.10. UserRoles Login Module</strong></p><div class="example-contents"><pre class="programlisting">
/subsystem=security/security-domain=ejb3-sampleapp/authentication=classic/login-module=UsersRoles:add( \
  code=UsersRoles, \
  flag=required, \
  module-options=[ \
    ("usersProperties"=&gt;"ejb3-sampleapp-users.properties"), \
    ("rolesProperties"=&gt;"ejb3-sampleapp-roles.properties") \
  ])
</pre></div></div><div class="para">
		In <a class="xref" href="#exam-UsersRoleLoginModule">Example 15.10, “UserRoles Login Module”</a>, the <code class="filename">ejb3-sampleapp-users.properties</code> file uses a <code class="filename">username=password</code> format with each user entry on a separate line:
	</div><pre class="programlisting">
username1=password1
username2=password2
...
</pre><div class="para">
		The <code class="filename">ejb3-sampleapp-roles.properties</code> file referenced in <a class="xref" href="#exam-UsersRoleLoginModule">Example 15.10, “UserRoles Login Module”</a> uses the pattern <code class="literal">username=role1,role2,</code> with an optional group name value. For example:
	</div><pre class="programlisting">
username1=role1,role2,...
username1.RoleGroup1=role3,role4,...
username2=role1,role3,...
</pre><div class="para">
		The <span class="property">user name.XXX</span> property name pattern present in <code class="filename">ejb3-sampleapp-roles.properties</code> is used to assign the user name roles to a particular named group of roles where the <code class="literal">XXX</code> portion of the property name is the group name. The <span class="property">user name=...</span> form is an abbreviation for <span class="property">user name.Roles=...</span>, where the <code class="literal">Roles</code> group name is the standard name the <code class="literal">JBossAuthorizationManager</code> expects to contain the roles which define the permissions of users.
	</div><div class="para">
		The following would be equivalent definitions for the <code class="literal">jduke</code> user name:
	</div><pre class="programlisting">
jduke=TheDuke,AnimatedCharacter
jduke.Roles=TheDuke,AnimatedCharacter
</pre><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+28315-638931+%5BSpecified%5D&amp;comment=Title%3A+UsersRoles+Login+Module%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=28315-638931+08+May+2014+07%3A18+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="DatabaseServerLoginModule" lang="en-US"><div class="titlepage"><div><div><h3 class="title">15.1.7. Database Login Module</h3></div></div></div><div class="para">
		The <code class="literal">Database</code> login module is a Java Database Connectivity-based (JDBC) login module that supports authentication and role mapping. Use this login module if you have your user name, password and role information stored in a relational database.
	</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			This module supports password stacking, password hashing and unauthenticated identity.
		</div></div></div><div class="para">
		The <code class="literal">Database</code> login module is based on two logical tables:
	</div><pre class="programlisting">
Table Principals(PrincipalID text, Password text)
Table Roles(PrincipalID text, Role text, RoleGroup text)
</pre><div class="para">
		The <code class="literal">Principals</code> table associates the user <code class="literal">PrincipalID</code> with the valid password and the <code class="literal">Roles</code> table associates the user <code class="literal">PrincipalID</code> with its role sets. The roles used for user permissions must be contained in rows with a <code class="literal">RoleGroup</code> column value of <code class="literal">Roles</code>.
	</div><div class="para">
		The tables are logical in that you can specify the SQL query that the login module uses. The only requirement is that the <code class="literal">java.sql.ResultSet</code> has the same logical structure as the <code class="literal">Principals</code> and <code class="literal">Roles</code> tables described previously. The actual names of the tables and columns are not relevant as the results are accessed based on the column index.
	</div><div class="para">
		To clarify this notion, consider a database with two tables, <code class="literal">Principals</code> and <code class="literal">Roles</code>, as already declared. The following statements populate the tables with the following data:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				<code class="literal">PrincipalID</code> <code class="literal">java</code> with a <code class="literal">Password</code> of <code class="literal">echoman</code> in the <code class="literal">Principals</code> table
			</div></li><li class="listitem"><div class="para">
				<code class="literal">PrincipalID</code> <code class="literal">java</code> with a role named <code class="literal">Echo</code> in the <code class="literal">Roles</code><code class="literal">RoleGroup</code> in the <code class="literal">Roles</code> table
			</div></li><li class="listitem"><div class="para">
				<code class="literal">PrincipalID</code> <code class="literal">java</code> with a role named <code class="literal">caller_java</code> in the <code class="literal">CallerPrincipal</code><code class="literal">RoleGroup</code> in the <code class="literal">Roles</code> table
			</div></li></ul></div><pre class="programlisting">INSERT INTO Principals VALUES('java', 'echoman')
INSERT INTO Roles VALUES('java', 'Echo', 'Roles')
INSERT INTO Roles VALUES('java', 'caller_java', 'CallerPrincipal')
</pre><div class="para">
		For details of Database login module options see <a class="xref" href="#Included_Authentication_Modules1">Section A.1, “Included Authentication Modules”</a>.
	</div><div class="para">
		An example <code class="literal">Database login module</code> configuration could be constructed as follows:
	</div><pre class="programlisting">
CREATE TABLE Users(username VARCHAR(64) PRIMARY KEY, passwd VARCHAR(64))
CREATE TABLE UserRoles(username VARCHAR(64), role VARCHAR(32))
</pre><div class="para">
		A corresponding login module configuration in a security domain:
	</div><pre class="programlisting">
/subsystem=security/security-domain=testDB/authentication=classic/login-module=Database:add( \
  code=Database, \
  flag=required, \
  module-options=[ \
    ("dsJndiName"=&gt;"java:/MyDatabaseDS"), \
    ("principalsQuery"=&gt;"select passwd from Users where username=?"), \
    ("rolesQuery"=&gt;"select role, 'Roles' from UserRoles where username=?") \
  ])
</pre><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+28316-638932+%5BSpecified%5D&amp;comment=Title%3A+Database+Login+Module%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=28316-638932+08+May+2014+07%3A21+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="BaseCertLoginModule" lang="en-US"><div class="titlepage"><div><div><h3 class="title">15.1.8. Certificate Login Module</h3></div></div></div><div class="para">
		<code class="literal">Certificate</code> login module authenticates users based on X509 certificates. A typical use case for this login module is <code class="literal">CLIENT-CERT</code> authentication in the web tier.
	</div><div class="para">
		This login module only performs authentication: you must combine it with another login module capable of acquiring authorization roles to completely define access to a secured web or EJB component. Two subclasses of this login module, <code class="literal">CertRolesLoginModule</code> and <code class="literal">DatabaseCertLoginModule</code> extend the behavior to obtain the authorization roles from either a properties file or database.
	</div><div class="para">
		For details of <code class="literal">Certificate</code> login module options see <a class="xref" href="#Included_Authentication_Modules1">Section A.1, “Included Authentication Modules”</a>.
	</div><div class="para">
		The <code class="literal">Certificate</code> login module needs a <code class="literal">KeyStore</code> to perform user validation. This is obtained from a JSSE configuration of linked security domain as shown in the following configuration fragment:
	</div><pre class="programlisting">
/subsystem=security/security-domain=trust-domain:add
/subsystem=security/security-domain=trust-domain/jsse=classic:add( \
  truststore={ \
    password=&gt;pass1234, \
    url=&gt;/home/jbosseap/trusted-clients.jks \
  })

/subsystem=security/security-domain=testCert:add
/subsystem=security/security-domain=testCert/authentication=classic:add
/subsystem=security/security-domain=testCert/authentication=classic/login-module=Certificate:add( \
  code=Certificate, \
  flag=required, \
  module-options=[ \
    ("securityDomain"=&gt;"trust-domain"), \
  ])
</pre><div class="procedure"><p class="title"><strong>Procedure 15.1. Secure Web Applications with Certificates and Role-based Authorization</strong></p><div class="para">
			This procedure describes how to secure a web application, such as the <code class="filename">user-app.war</code>, using client certificates and role-based authorization. In this example the <code class="literal">CertificateRoles</code> login module is used for authentication and authorization. Both the <code class="literal">trusted-clients.keystore</code> and the <code class="literal">app-roles.properties</code> require an entry that maps to the principal associated with the client certificate.
		</div><div class="para">
			By default, the principal is created using the client certificate distinguished name, such as the DN specified in <a class="xref" href="#exam-Certificate_Example">Example 15.11, “Certificate Example”</a>.
		</div><ol class="1"><li class="step"><p class="title"><strong>Declare Resources and Roles</strong></p><div class="para">
				Modify <code class="filename">web.xml</code> to declare the resources to be secured along with the allowed roles and security domain to be used for authentication and authorization.
			</div><pre class="programlisting">

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
        version="3.0"&gt;

        &lt;security-constraint&gt;
                &lt;web-resource-collection&gt;
                        &lt;web-resource-name&gt;Protect App&lt;/web-resource-name&gt;
                        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
                &lt;/web-resource-collection&gt;
                &lt;auth-constraint&gt;
                        &lt;role-name&gt;Admin&lt;/role-name&gt;
                &lt;/auth-constraint&gt;
        &lt;/security-constraint&gt;

        &lt;login-config&gt;
                &lt;auth-method&gt;CLIENT-CERT&lt;/auth-method&gt;
                &lt;realm-name&gt;Secured area&lt;/realm-name&gt;
        &lt;/login-config&gt;

        &lt;security-role&gt;
                &lt;role-name&gt;Admin&lt;/role-name&gt;
        &lt;/security-role&gt;
&lt;/web-app&gt;

</pre></li><li class="step"><p class="title"><strong>Specify the Security Domain</strong></p><div class="para">
				In the <code class="literal">jboss-web.xml</code> file, specify the required security domain.
			</div><pre class="programlisting language-xml">

&lt;jboss-web&gt;
  &lt;security-domain&gt;app-sec-domain&lt;/security-domain&gt;
&lt;/jboss-web&gt;

</pre></li><li class="step"><p class="title"><strong>Configure Login Module</strong></p><div class="para">
				Define the login module configuration for the <code class="literal">app-sec-domain</code> domain you just specified using the management CLI.
			</div><pre class="programlisting">[
/subsystem=security/security-domain=trust-domain:add
/subsystem=security/security-domain=trust-domain/jsse=classic:add( \
  truststore={ \
    password=&gt;pass1234, \
    url=&gt;/home/jbosseap/trusted-clients.jks \
  })

/subsystem=security/security-domain=app-sec-domain:add
/subsystem=security/security-domain=app-sec-domain/authentication=classic:add
/subsystem=security/security-domain=app-sec-domain/authentication=classic/login-module=CertificateRoles:add( \
  code=CertificateRoles, \
  flag=required, \
  module-options=[ \
    ("securityDomain"=&gt;"trust-domain"), \
    ("rolesProperties"=&gt;"app-roles.properties") \
  ])
</pre></li></ol></div><div class="example" id="exam-Certificate_Example"><p class="title"><strong>Example 15.11. Certificate Example</strong></p><div class="example-contents"><pre class="screen">
[conf]$ keytool -printcert -file valid-client-cert.crt
Owner: CN=valid-client, OU=Security QE, OU=JBoss, O=Red Hat, C=CZ
Issuer: CN=EAP Certification Authority, OU=Security QE, OU=JBoss, O=Red Hat, C=CZ
Serial number: 2
Valid from: Mon Mar 24 18:21:55 CET 2014 until: Tue Mar 24 18:21:55 CET 2015
Certificate fingerprints:
         MD5:  0C:54:AE:6E:29:ED:E4:EF:46:B5:14:30:F2:E0:2A:CB
         SHA1: D6:FB:19:E7:11:28:6C:DE:01:F2:92:2F:22:EF:BB:5D:BF:73:25:3D
         SHA256: CD:B7:B1:72:A3:02:42:55:A3:1C:30:E1:A6:F0:20:B0:2C:0F:23:4F:7A:8E:2F:2D:FA:AF:55:3E:A7:9B:2B:F4
         Signature algorithm name: SHA1withRSA
         Version: 3
</pre></div></div><div class="para">
		The <code class="literal">trusted-clients.keystore</code> would need the certificate in <a class="xref" href="#exam-Certificate_Example">Example 15.11, “Certificate Example”</a> stored with an alias of <code class="literal">CN=valid-client, OU=Security QE, OU=JBoss, O=Red Hat, C=CZ</code>. The <code class="literal">app-roles.properties</code> must have the same entry. Since the DN contains characters that are normally treated as delimiters, you must escape the problem characters using a backslash ('<code class="literal">\</code>') as illustrated below.
	</div><pre class="screen">
# A sample app-roles.properties file
CN\=valid-client,\ OU\=Security\ QE,\ OU\=JBoss,\ O\=Red\ Hat,\ C\=CZ
</pre><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+28317-638933+%5BSpecified%5D&amp;comment=Title%3A+Certificate+Login+Module%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=28317-638933+08+May+2014+07%3A31+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="IdentityLoginModule" lang="en-US"><div class="titlepage"><div><div><h3 class="title">15.1.9. Identity Login Module</h3></div></div></div><div class="para">
		<code class="literal">Identity</code> login module is a simple login module that associates a hard-coded user name to any subject authenticated against the module. It creates a <code class="literal">SimplePrincipal</code> instance using the name specified by the <code class="literal">principal</code> option.
	</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			This module supports password stacking.
		</div></div></div><div class="para">
		This login module is useful when you need to provide a fixed identity to a service, and in development environments when you want to test the security associated with a given principal and associated roles.
	</div><div class="para">
		For details of Identity login module options see <a class="xref" href="#Included_Authentication_Modules1">Section A.1, “Included Authentication Modules”</a>.
	</div><div class="para">
		A sample security domain configuration is described below. It authenticates all users as the principal named <code class="literal">jduke</code> and assigns role names of <code class="literal">TheDuke</code>, and <code class="literal">AnimatedCharacter</code>:.
	</div><pre class="programlisting">
/subsystem=security/security-domain=testIdentity:add
/subsystem=security/security-domain=testIdentity/authentication=classic:add
/subsystem=security/security-domain=testIdentity/authentication=classic/login-module=Identity:add( \
  code=Identity, \
  flag=required, \
  module-options=[ \
    ("principal"=&gt;"jduke"), \
    ("roles"=&gt;"TheDuke,AnimatedCharacter") \
  ])

</pre><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+28318-638670+%5BSpecified%5D&amp;comment=Title%3A+Identity+Login+Module%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=28318-638670+07+May+2014+11%3A38+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div class="section" id="sect-RunAs_Login_Module"><div class="titlepage"><div><div><h3 class="title">15.1.10. RunAs Login Module</h3></div></div></div><div class="para">
				<code class="literal">RunAs</code> login module is a helper module that pushes a <code class="literal">run as</code> role onto the stack for the duration of the login phase of authentication, then pops the <code class="literal">run as</code> role from the stack in either the commit or abort phase.
			</div><div class="para">
				The purpose of this login module is to provide a role for other login modules that must access secured resources in order to perform their authentication (for example, a login module that accesses a secured EJB). <code class="literal">RunAs</code> login module must be configured ahead of the login modules that require a <code class="literal">run as</code> role established.
			</div><div class="para">
				For details of RunAs login module options see <a class="xref" href="#Included_Authentication_Modules1">Section A.1, “Included Authentication Modules”</a>.
			</div><div class="para RoleCreateBugPara">
				<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+IDs%3A%0A28319-638671+%5BSpecified%5D&amp;comment=Title%3A+RunAs+Login+Module%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
			</div><div xml:lang="en-US" class="section" id="RunAsIdentity_Creation" lang="en-US"><div class="titlepage"><div><div><h4 class="title">15.1.10.1. RunAsIdentity Creation</h4></div></div></div><div class="para">
		In order for JBoss EAP 6 to secure access to EJB methods, the identity of the user must be known at the time the method call is made.
	</div><div class="para">
		A user's identity in the server is represented either by a <code class="classname">javax.security.auth.Subject</code> instance or an <code class="classname">org.jboss.security.RunAsIdentity</code> instance. Both these classes store one or more principals that represent the identity and a list of roles that the identity possesses. In the case of the <code class="classname">javax.security.auth.Subject</code> a list of credentials is also stored.
	</div><div class="para">
		In the <span class="markup">&lt;assembly-descriptor&gt;</span> section of the <code class="filename">ejb-jar.xml</code> deployment descriptor, you specify one or more roles that a user must have to access the various EJB methods. A comparison of these lists reveals whether the user has one of the roles necessary to access the EJB method.
	</div><div class="example" id="exam-RunAsIdentity_Creation"><p class="title"><strong>Example 15.12. org.jboss.security.RunAsIdentity Creation</strong></p><div class="example-contents"><div class="para">
			In the <code class="filename">ejb-jar.xml</code> file, you specify a <span class="markup">&lt;security-identity&gt;</span> element with a <span class="markup">&lt;run-as&gt;</span> role defined as a child of the &lt;session&gt; element.
		</div><pre class="programlisting language-xml">&lt;session&gt;
   ...
   &lt;security-identity&gt;
      &lt;run-as&gt;
         &lt;role-name&gt;Admin&lt;/role-name&gt;
      &lt;/run-as&gt;
   &lt;/security-identity&gt;
   ...
&lt;/session&gt;</pre><div class="para">
			This declaration signifies that an <code class="literal">Admin</code> RunAsIdentity role must be created.
		</div><div class="para">
			To name a principal for the <code class="literal">Admin</code> role, you define a <code class="sgmltag-element">&lt;run-as-principal&gt;</code> element in the <code class="filename">jboss-ejb3.xml</code> file.
		</div><pre class="programlisting language-xml">

&lt;jboss:ejb-jar
        xmlns="http://java.sun.com/xml/ns/javaee"
        xmlns:jboss="http://www.jboss.com/xml/ns/javaee"
        xmlns:s="urn:security:1.1"
        version="3.1" impl-version="2.0"&gt;
    &lt;assembly-descriptor&gt;
        &lt;s:security&gt;
            &lt;ejb-name&gt;WhoAmIBean&lt;/ejb-name&gt;
            &lt;s:run-as-principal&gt;John&lt;/s:run-as-principal&gt;
        &lt;/s:security&gt;
    &lt;/assembly-descriptor&gt;
&lt;/jboss:ejb-jar&gt;

</pre><div class="para">
			The <code class="sgmltag-element">&lt;security-identity&gt;</code> element in both the <code class="filename">ejb-jar.xml</code> and <code class="sgmltag-element">&lt;security&gt;</code> element in the <code class="filename">jboss-ejb3.xml</code> files are parsed at deployment time. The <code class="sgmltag-element">&lt;run-as&gt;</code> role name and the <code class="sgmltag-element">&lt;run-as-principal&gt;</code> name are then stored in the <code class="classname">org.jboss.metadata.ejb.spec.SecurityIdentityMetaData</code> class.
		</div></div></div><div class="example" id="idm140707308744720"><p class="title"><strong>Example 15.13. Assigning multiple roles to a RunAsIdentity</strong></p><div class="example-contents"><div class="para">
			You can assign more roles to RunAsIdentity by mapping roles to principals in the <code class="filename">jboss-ejb3.xml</code> deployment descriptor <code class="sgmltag-element">&lt;assembly-descriptor&gt;</code> element group.
		</div><pre class="programlisting language-xml">

&lt;jboss:ejb-jar xmlns:sr="urn:security-role"
        ...&gt;
        &lt;assembly-descriptor&gt;
            ...
                &lt;sr:security-role&gt;
                        &lt;sr:role-name&gt;Support&lt;/sr:role-name&gt;
                        &lt;sr:principal-name&gt;John&lt;/sr:principal-name&gt;
                        &lt;sr:principal-name&gt;Jill&lt;/sr:principal-name&gt;
                        &lt;sr:principal-name&gt;Tony&lt;/sr:principal-name&gt;
                &lt;/sr:security-role&gt;
        &lt;/assembly-descriptor&gt;
&lt;/jboss:ejb-jar&gt;

</pre><div class="para">
			In <a class="xref" href="#exam-RunAsIdentity_Creation">Example 15.12, “org.jboss.security.RunAsIdentity Creation”</a>, the <code class="sgmltag-element">&lt;run-as-principal&gt;</code> of <code class="literal">John</code> was created. The configuration in this example extends the <code class="literal">Admin</code> role, by adding the <code class="literal">Support</code> role. The new role contains extra principals, including the originally defined principal <code class="literal">John</code>.
		</div><div class="para">
			The <code class="sgmltag-element">&lt;security-role&gt;</code> element in both the <code class="filename">ejb-jar.xml</code> and <code class="filename">jboss-ejb3.xml</code> files are parsed at deployment time. The <code class="sgmltag-element">&lt;role-name&gt;</code> and the <code class="sgmltag-element">&lt;principal-name&gt;</code> data is stored in the <code class="classname">org.jboss.metadata.ejb.spec.SecurityIdentityMetaData</code> class.
		</div></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+28320-640429+%5BSpecified%5D&amp;comment=Title%3A+RunAsIdentity+Creation%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=28320-640429+13+May+2014+08%3A32+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div xml:lang="en-US" class="section" id="ClientLoginModule" lang="en-US"><div class="titlepage"><div><div><h3 class="title">15.1.11. Client Login Module</h3></div></div></div><div class="para">
		<code class="literal">Client </code> login module (<code class="classname">org.jboss.security.ClientLoginModule</code>) is an implementation of <code class="literal">LoginModule</code> for use by JBoss clients when establishing caller identity and credentials. This creates a new <code class="literal">SecurityContext</code> assigns it a principal and a credential and sets the <code class="literal">SecurityContext</code> to the <code class="literal">ThreadLocal</code> security context.
	</div><div class="para">
		<code class="literal">Client</code> login module is the only supported mechanism for a client to establish the current thread's caller. Both stand-alone client applications, and server environments (acting as JBoss EJB clients where the security environment has not been configured to use PicketBox transparently) must use <code class="literal">Client</code> login module.
	</div><div class="para">
		Note that this login module does not perform any authentication. It merely copies the login information provided to it into the server EJB invocation layer for subsequent authentication on the server. If you need to perform client-side authentication of users you would need to configure another login module in addition to the <code class="literal">Client</code> login module.
	</div><div class="para">
		For details of Client login module options see <a class="xref" href="#Included_Authentication_Modules1">Section A.1, “Included Authentication Modules”</a>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+28321-638462+%5BSpecified%5D&amp;comment=Title%3A+Client+Login+Module%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=28321-638462+06+May+2014+11%3A57+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="SPNEGOLoginModule" lang="en-US"><div class="titlepage"><div><div><h3 class="title">15.1.12. SPNEGO Login Module</h3></div></div></div><div class="para">
		<code class="literal">SPNEGO</code> login module (<code class="classname">org.jboss.security.negotiation.spnego.SPNEGOLoginModule</code>) is an implementation of <code class="literal">LoginModule</code> that establishes caller identity and credentials with a KDC. The module implements SPNEGO (Simple and Protected GSSAPI Negotiation mechanism) and is a part of the JBoss Negotiation project. This authentication can be used in the chained configuration with the <code class="code">AdvancedLdap</code> login module to allow cooperation with an LDAP server.
	</div><div class="para">
		For details of SPNEGO login module options see <a class="xref" href="#Included_Authentication_Modules1">Section A.1, “Included Authentication Modules”</a>.
	</div><div class="para">
		The JBoss Negotiation module is not included as a standard dependency for deployed applications. To use the <code class="code">SPNEGO</code> or <code class="code">AdvancedLdap</code> login modules in your project, then you must add the dependency manually by editing <code class="filename">META-INF/jboss-deployment-structure.xml</code> deployment descriptor.
	</div><div class="example" id="idm140707338652384"><p class="title"><strong>Example 15.14. Add JBoss Negotiation Module as a Dependency</strong></p><div class="example-contents"><pre class="programlisting language-xml">

&lt;jboss-deployment-structure&gt;
  &lt;deployment&gt;
    &lt;dependencies&gt;
      &lt;module name="org.jboss.security.negotiation" /&gt;
    &lt;/dependencies&gt;
  &lt;/deployment&gt;
&lt;/jboss-deployment-structure&gt;

</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+28322-640738+%5BSpecified%5D&amp;comment=Title%3A+SPNEGO+Login+Module%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=28322-640738+14+May+2014+09%3A39+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="RoleMappingLoginModule" lang="en-US"><div class="titlepage"><div><div><h3 class="title">15.1.13. RoleMapping Login Module</h3></div></div></div><div class="para">
		<code class="literal">RoleMapping</code> login module supports mapping roles, that are the end result of the authentication process, to one or more declarative roles. For example, if the authentication process has determined that the user "A" has the roles "ldapAdmin" and "testAdmin", and the declarative role defined in the <code class="filename">web.xml</code> or <code class="filename">ejb-jar.xml</code> file for access is <code class="literal">admin</code>, then this login module maps the <code class="literal">admin</code> roles to the user <code class="literal">A</code>.
	</div><div class="para">
		For details of <code class="literal">RoleMapping</code> login module options see <a class="xref" href="#Included_Authentication_Modules1">Section A.1, “Included Authentication Modules”</a>.
	</div><div class="para">
		The <code class="literal">RoleMapping</code> login module must be defined as an optional module to a login module configuration as it alters mapping of the previously mapped roles.
	</div><div class="example" id="idm140707318098960"><p class="title"><strong>Example 15.15. Defining mapped roles</strong></p><div class="example-contents"><pre class="programlisting">
/subsystem=security/security-domain=test-domain-2/:add
/subsystem=security/security-domain=test-domain-2/authentication=classic:add
/subsystem=security/security-domain=test-domain-2/authentication=classic/login-module=test-2-lm/:add(\
flag=required,\
code=UsersRoles,\
module-options=[("usersProperties"=&gt;"users.properties"),("rolesProperties"=&gt;"roles.properties")]\
)
/subsystem=security/security-domain=test-domain-2/authentication=classic/login-module=test2-map/:add(\
flag=optional,\
code=RoleMapping,\
module-options=[("rolesProperties"=&gt;"rolesMapping-roles.properties")]\
)
</pre></div></div><div class="para">
		Another example achieving the same result, but using the mapping module. This is the preferred method of role mapping:
	</div><div class="example" id="idm140707317100144"><p class="title"><strong>Example 15.16. Preferred method of defining mapped roles</strong></p><div class="example-contents"><pre class="programlisting">
/subsystem=security/security-domain=test-domain-2/:add
/subsystem=security/security-domain=test-domain-2/authentication=classic:add
/subsystem=security/security-domain=test-domain-2/authentication=classic/login-module=test-2-lm/:add(\
flag=required,\
code=UsersRoles,\
module-options=[("usersProperties"=&gt;"users.properties"),("rolesProperties"=&gt;"roles.properties")]\
)
/subsystem=security/security-domain=test-domain-2/mapping=classic/mapping-module=test2-map/:add(\
code=PropertiesRoles,type=role,\
module-options=[("rolesProperties"=&gt;"rolesMapping-roles.properties")]\
)
</pre></div></div><div class="example" id="exam-PropertiesFile_RoleMappingLoginModule"><p class="title"><strong>Example 15.17. Properties File used by a RoleMappingLoginModule</strong></p><div class="example-contents"><pre class="programlisting">
ldapAdmin=admin, testAdmin
</pre><div class="para">
			If the authenticated subject contains role <code class="literal">ldapAdmin</code>, then the roles <code class="literal">admin</code> and <code class="literal">testAdmin</code> are added to or substitute the authenticated subject depending on the <span class="property">replaceRole</span> property value.
		</div></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+28323-638683+%5BSpecified%5D&amp;comment=Title%3A+RoleMapping+Login+Module%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=28323-638683+07+May+2014+12%3A40+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div class="section" id="sect-Custom_Modules"><div class="titlepage"><div><div><h2 class="title">15.2. Custom Modules</h2></div></div></div><div class="para">
			If the login modules bundled with the PicketBox framework do not work with your security environment, you can write your own custom login module implementation. The <code class="literal">AuthenticationManager</code> requires a particular usage pattern of the <code class="literal">Subject</code> principals set. You must understand the JAAS Subject class's information storage features and the expected usage of these features to write a login module that works with the <code class="literal">AuthenticationManager</code>.
		</div><div class="para">
			This section examines this requirement and introduces two abstract base <code class="literal">LoginModule</code> implementations that can help you implement custom login modules.
		</div><div class="para">
			You can obtain security information associated with a <code class="literal">Subject</code> by using the following methods:
		</div><pre class="programlisting language-java">java.util.Set getPrincipals()
java.util.Set getPrincipals(java.lang.Class c)
java.util.Set getPrivateCredentials()
java.util.Set getPrivateCredentials(java.lang.Class c)
java.util.Set getPublicCredentials()
java.util.Set getPublicCredentials(java.lang.Class c)</pre><div class="para">
			For <code class="literal">Subject</code> identities and roles, PicketBox has selected the most logical choice: the principals sets obtained via <code class="literal">getPrincipals()</code> and <code class="literal">getPrincipals(java.lang.Class)</code>. The usage pattern is as follows:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					User identities (for example; user name, social security number, employee ID) are stored as <code class="literal">java.security.Principal</code> objects in the <code class="literal">Subject</code><code class="literal">Principals</code> set. The <code class="literal">Principal</code> implementation that represents the user identity must base comparisons and equality on the name of the principal. A suitable implementation is available as the <code class="literal">org.jboss.security.SimplePrincipal</code> class. Other <code class="literal">Principal</code> instances may be added to the <code class="literal">Subject</code><code class="literal">Principals</code> set as needed.
				</div></li><li class="listitem"><div class="para">
					Assigned user roles are also stored in the <code class="literal">Principals</code> set, and are grouped in named role sets using <code class="literal">java.security.acl.Group</code> instances. The <code class="literal">Group</code> interface defines a collection of <code class="literal">Principal</code>s and/or <code class="literal">Group</code>s, and is a subinterface of <code class="literal">java.security.Principal</code>.
				</div></li><li class="listitem"><div class="para">
					Any number of role sets can be assigned to a <code class="literal">Subject</code>.
				</div></li></ul></div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					The PicketBox framework uses two well-known role sets with the names <code class="literal">Roles</code> and <code class="literal">CallerPrincipal</code>.
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							The <code class="literal">Roles</code> group is the collection of <code class="literal">Principal</code>s for the named roles as known in the application domain under which the <code class="literal">Subject</code> has been authenticated. This role set is used by methods like the <code class="literal">EJBContext.isCallerInRole(String)</code>, which EJBs can use to see if the current caller belongs to the named application domain role. The security interceptor logic that performs method permission checks also uses this role set.
						</div></li><li class="listitem"><div class="para">
							The <code class="literal">CallerPrincipal</code> <code class="literal">Group</code> consists of the single <code class="literal">Principal</code> identity assigned to the user in the application domain. The <code class="literal">EJBContext.getCallerPrincipal() </code>method uses the <code class="literal">CallerPrincipal</code> to allow the application domain to map from the operation environment identity to a user identity suitable for the application. If a <code class="literal">Subject</code> does not have a <code class="literal">CallerPrincipal</code> <code class="literal">Group</code>, the application identity is the same as operational environment identity.
						</div></li></ul></div></li></ul></div><div class="para RoleCreateBugPara">
			<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+IDs%3A%0A28324-638471+%5BSpecified%5D&amp;comment=Title%3A+Custom+Modules%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
		</div><div xml:lang="en-US" class="section" id="Subject_Usage_Pattern_Support" lang="en-US"><div class="titlepage"><div><div><h3 class="title">15.2.1. Subject Usage Pattern Support</h3></div></div></div><div class="para">
		To simplify correct implementation of the <code class="literal">Subject</code> usage patterns described in <a class="xref" href="#sect-Custom_Modules">Section 15.2, “Custom Modules”</a>, PicketBox includes login modules that populate the authenticated <code class="literal">Subject</code> with a template pattern that enforces correct <code class="literal">Subject</code> usage.
	</div><div class="para"><div class="title">AbstractServerLoginModule</div><p>
			The most generic of the two is the <code class="literal">org.jboss.security.auth.spi.AbstractServerLoginModule</code> class.
		</p></div><div class="para">
		It provides an implementation of the <code class="literal">javax.security.auth.spi.LoginModule</code> interface and offers abstract methods for the key tasks specific to an operation environment security infrastructure. The key details of the class are highlighted in <a class="xref" href="#exam-AbstractServerLoginModule_Class_Fragment">Example 15.18, “AbstractServerLoginModule Class Fragment”</a>. The JavaDoc comments detail the responsibilities of subclasses.
	</div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
			The <code class="literal">loginOk</code> instance variable is pivotal. This must be set to <code class="literal">true</code> if the log in succeeds, or <code class="literal">false</code> by any subclasses that override the log in method. If this variable is incorrectly set, the commit method will not correctly update the subject.
		</div></div></div><div class="para">
		Tracking the log in phase outcomes allows login modules to be chained together with control flags. These control flags do not require the login modules to succeed as part of the authentication process.
	</div><div class="example" id="exam-AbstractServerLoginModule_Class_Fragment"><p class="title"><strong>Example 15.18. AbstractServerLoginModule Class Fragment</strong></p><div class="example-contents"><pre class="programlisting language-java">package org.jboss.security.auth.spi;
/**
 *  This class implements the common functionality required for a JAAS
 *  server-side LoginModule and implements the PicketBox standard
 *  Subject usage pattern of storing identities and roles. Subclass
 *  this module to create your own custom LoginModule and override the
 *  login(), getRoleSets(), and getIdentity() methods.
 */
public abstract class AbstractServerLoginModule
    implements javax.security.auth.spi.LoginModule
{
    protected Subject subject;
    protected CallbackHandler callbackHandler;
    protected Map sharedState;
    protected Map options;
    protected Logger log;

    /** Flag indicating if the shared credential should be used */
    protected boolean useFirstPass;
    /** 
     * Flag indicating if the login phase succeeded. Subclasses that
     * override the login method must set this to true on successful
     * completion of login
     */
    protected boolean loginOk;
                
    // ...
    /**
     * Initialize the login module. This stores the subject,
     * callbackHandler and sharedState and options for the login
     * session. Subclasses should override if they need to process
     * their own options. A call to super.initialize(...)  must be
     * made in the case of an override.
     *
     * &lt;p&gt;
     * The options are checked for the  &lt;em&gt;password-stacking&lt;/em&gt; parameter.
     * If this is set to "useFirstPass", the login identity will be taken from the
     * &lt;code&gt;javax.security.auth.login.name&lt;/code&gt; value of the sharedState map,
     * and the proof of identity from the
     * &lt;code&gt;javax.security.auth.login.password&lt;/code&gt; value of the sharedState map.
     *
     * @param subject the Subject to update after a successful login.
     * @param callbackHandler the CallbackHandler that will be used to obtain the
     * the user identity and credentials.
     * @param sharedState a Map shared between all configured login module instances
     * @param options the parameters passed to the login module.
     */
    public void initialize(Subject subject,
                           CallbackHandler callbackHandler,
                           Map sharedState,
                           Map options)
    {
        // ...
    }
    

    /**
     *  Looks for javax.security.auth.login.name and
     *  javax.security.auth.login.password values in the sharedState
     *  map if the useFirstPass option was true and returns true if
     *  they exist. If they do not or are null this method returns
     *  false.  
     *  Note that subclasses that override the login method
     *  must set the loginOk var to true if the login succeeds in
     *  order for the commit phase to populate the Subject. This
     *  implementation sets loginOk to true if the login() method
     *  returns true, otherwise, it sets loginOk to false.
     */
    public boolean login() 
        throws LoginException
    {
        // ...
    }
    
    /**
     *  Overridden by subclasses to return the Principal that
     *  corresponds to the user primary identity.
     */
    abstract protected Principal getIdentity();
                
    /**
     *  Overridden by subclasses to return the Groups that correspond
     *  to the role sets assigned to the user. Subclasses should
     *  create at least a Group named "Roles" that contains the roles
     *  assigned to the user.  A second common group is
     *  "CallerPrincipal," which provides the application identity of
     *  the user rather than the security domain identity.
     * 
     *  @return Group[] containing the sets of roles
     */
    abstract protected Group[] getRoleSets() throws LoginException;
}
</pre></div></div><div class="para"><div class="title">UsernamePasswordLoginModule</div><p>
			The second abstract base login module suitable for custom login modules is the <code class="literal">org.jboss.security.auth.spi.UsernamePasswordLoginModule</code>.
		</p></div><div class="para">
		This login module further simplifies custom login module implementation by enforcing a string-based user name as the user identity and a <code class="literal">char[]</code> password as the authentication credentials. It also supports the mapping of anonymous users (indicated by a null user name and password) to a principal with no roles. The key details of the class are highlighted in the following class fragment. The JavaDoc comments detail the responsibilities of subclasses.
	</div><div class="example" id="exam-UsernamePasswordLoginModule_Class_Fragment"><p class="title"><strong>Example 15.19. UsernamePasswordLoginModule Class Fragment</strong></p><div class="example-contents"><pre class="programlisting language-java">package org.jboss.security.auth.spi;

/**
 *  An abstract subclass of AbstractServerLoginModule that imposes a
 *  an identity == String username, credentials == String password
 *  view on the login process. Subclasses override the
 *  getUsersPassword() and getUsersRoles() methods to return the
 *  expected password and roles for the user.
 */
public abstract class UsernamePasswordLoginModule
    extends AbstractServerLoginModule
{
    /** The login identity */
    private Principal identity;
    /** The proof of login identity */
    private char[] credential;
    /** The principal to use when a null username and password are seen */
    private Principal unauthenticatedIdentity;

    /**
     * The message digest algorithm used to hash passwords. If null then
     * plain passwords will be used. */
    private String hashAlgorithm = null;

    /**
     *  The name of the charset/encoding to use when converting the
     * password String to a byte array. Default is the platform's
     * default encoding.
     */
     private String hashCharset = null;

    /** The string encoding format to use. Defaults to base64. */
    private String hashEncoding = null;
                
    // ...
                
    /** 
     *  Override the superclass method to look for an
     *  unauthenticatedIdentity property. This method first invokes
     *  the super version.
     *
     *  @param options,
     *  @option unauthenticatedIdentity: the name of the principal to
     *  assign and authenticate when a null username and password are
     *  seen.
     */
    public void initialize(Subject subject,
                           CallbackHandler callbackHandler,
                           Map sharedState,
                           Map options)
    {
        super.initialize(subject, callbackHandler, sharedState,
                         options);
        // Check for unauthenticatedIdentity option.
        Object option = options.get("unauthenticatedIdentity");
        String name = (String) option;
        if (name != null) {
            unauthenticatedIdentity = new SimplePrincipal(name);
        }
    }
                
    // ...
                
    /**
     *  A hook that allows subclasses to change the validation of the
     *  input password against the expected password. This version
     *  checks that neither inputPassword or expectedPassword are null
     *  and that inputPassword.equals(expectedPassword) is true;
     *
     *  @return true if the inputPassword is valid, false otherwise.
     */
    protected boolean validatePassword(String inputPassword,
                                       String expectedPassword)
    {
        if (inputPassword == null || expectedPassword == null) {
            return false;
        }
        return inputPassword.equals(expectedPassword);
    }
    
    /**
     *  Get the expected password for the current username available
     * via the getUsername() method. This is called from within the
     * login() method after the CallbackHandler has returned the
     * username and candidate password.
     *
     * @return the valid password String
     */
    abstract protected String getUsersPassword()
        throws LoginException;
}
</pre></div></div><div class="para"><div class="title">Subclassing Login Modules</div><p>
			The choice of sub-classing the <code class="literal">AbstractServerLoginModule</code> versus <code class="literal">UsernamePasswordLoginModule</code> is based on whether a string-based user name and credentials are usable for the authentication technology you are writing the login module for. If the string-based semantic is valid, then subclass <code class="literal">UsernamePasswordLoginModule</code>, otherwise subclass <code class="literal">AbstractServerLoginModule</code>.
		</p></div><div class="para"><div class="title">Subclassing Steps</div><p>
			The steps your custom login module must execute depend on which base login module class you choose. When writing a custom login module that integrates with your security infrastructure, you should start by sub-classing <code class="literal">AbstractServerLoginModule</code> or <code class="literal">UsernamePasswordLoginModule</code> to ensure that your login module provides the authenticated <code class="literal">Principal</code> information in the form expected by the PicketBox security manager.
		</p></div><div class="para">
		When sub-classing the <code class="literal">AbstractServerLoginModule</code>, you must override the following:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				<code class="literal">void initialize(Subject, CallbackHandler, Map, Map)</code>: if you have custom options to parse.
			</div></li><li class="listitem"><div class="para">
				<code class="literal">boolean login()</code>: to perform the authentication activity. Be sure to set the <code class="literal">loginOk</code> instance variable to true if log in succeeds, false if it fails.
			</div></li><li class="listitem"><div class="para">
				<code class="literal">Principal getIdentity()</code>: to return the <code class="literal">Principal</code> object for the user authenticated by the <code class="literal">log()</code> step.
			</div></li><li class="listitem"><div class="para">
				<code class="literal">Group[] getRoleSets()</code>: to return at least one <code class="literal">Group</code> named <code class="literal">Roles</code> that contains the roles assigned to the <code class="literal">Principal</code> authenticated during <code class="literal">login()</code>. A second common <code class="literal">Group</code> is named <code class="literal">CallerPrincipal</code> and provides the user's application identity rather than the security domain identity.
			</div></li></ul></div><div class="para">
		When sub-classing the <code class="literal">UsernamePasswordLoginModule</code>, you must override the following:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				<code class="literal">void initialize(Subject, CallbackHandler, Map, Map)</code>: if you have custom options to parse.
			</div></li><li class="listitem"><div class="para">
				<code class="literal">Group[] getRoleSets()</code>: to return at least one <code class="literal">Group</code> named <code class="literal">Roles</code> that contains the roles assigned to the <code class="literal">Principal</code> authenticated during <code class="literal">login()</code>. A second common <code class="literal">Group</code> is named <code class="literal">CallerPrincipal</code> and provides the user's application identity rather than the security domain identity.
			</div></li><li class="listitem"><div class="para">
				<code class="literal">String getUsersPassword()</code>: to return the expected password for the current user name available via the <code class="literal">getUsername()</code> method. The <code class="literal">getUsersPassword()</code> method is called from within <code class="literal">login()</code> after the <code class="literal">callbackhandler</code> returns the user name and candidate password.
			</div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+28325-592748+%5BSpecified%5D&amp;comment=Title%3A+Subject+Usage+Pattern+Support%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=28325-592748+24+Feb+2014+08%3A00+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Custom_LoginModule_Example" lang="en-US"><div class="titlepage"><div><div><h3 class="title">15.2.2. Custom LoginModule Example</h3></div></div></div><div class="para">
		The following information will help you to create a custom Login Module example that extends the <code class="literal">UsernamePasswordLoginModule</code> and obtains a user's password and role names from a JNDI lookup.
	</div><div class="para">
		At the end of this section you will have created a custom JNDI context login module that will return a user's password if you perform a lookup on the context using a name of the form <code class="literal">password/&lt;username&gt;</code> (where <code class="literal">&lt;username&gt;</code> is the current user being authenticated). Similarly, a lookup of the form <code class="literal">roles/&lt;username&gt;</code> returns the requested user's roles. In <a class="xref" href="#A_Custom_LoginModule_Example-_A_JndiUserAndPass_custom_login_module">Example 15.20, “JndiUserAndPassLoginModule Custom Login Module”</a> is the source code for the <code class="literal">JndiUserAndPassLoginModule</code> custom login module.
	</div><div class="para">
		Note that because this extends the JBoss <code class="literal">UsernamePasswordLoginModule</code>, the <code class="literal">JndiUserAndPassLoginModule</code> obtains the user's password and roles from the JNDI store. The <code class="literal">JndiUserAndPassLoginModule</code> does not interact with the JAAS LoginModule operations.
	</div><div class="example" id="A_Custom_LoginModule_Example-_A_JndiUserAndPass_custom_login_module"><p class="title"><strong>Example 15.20. JndiUserAndPassLoginModule Custom Login Module</strong></p><div class="example-contents"><pre class="programlisting language-java">package org.jboss.book.security.ex2;
                    
import java.security.acl.Group;
import java.util.Map;
import javax.naming.InitialContext;
import javax.naming.NamingException;
import javax.security.auth.Subject;
import javax.security.auth.callback.CallbackHandler;
import javax.security.auth.login.LoginException;
import org.jboss.logging.Logger;
import org.jboss.security.SimpleGroup;
import org.jboss.security.SimplePrincipal;
import org.jboss.security.auth.spi.UsernamePasswordLoginModule;
/**
 * An example custom login module that obtains passwords and roles for a user from a JNDI lookup.
 * 
 * @author Scott.Stark@jboss.org
 */
public class JndiUserAndPassLoginModule extends UsernamePasswordLoginModule {
  /** The JNDI name to the context that handles the password/username lookup */
  private String userPathPrefix;
  /** The JNDI name to the context that handles the roles/username lookup */
  private String rolesPathPrefix;
  private static Logger log = Logger.getLogger(JndiUserAndPassLoginModule.class);
  /**
   * Override to obtain the userPathPrefix and rolesPathPrefix options.
   */
  @Override
  public void initialize(Subject subject, CallbackHandler callbackHandler, Map sharedState, Map options) {
    super.initialize(subject, callbackHandler, sharedState, options);
    userPathPrefix = (String) options.get("userPathPrefix");
    rolesPathPrefix = (String) options.get("rolesPathPrefix");
  }
  /**
   * Get the roles the current user belongs to by querying the rolesPathPrefix + '/' + super.getUsername() JNDI location.
   */
  @Override
  protected Group[] getRoleSets() throws LoginException {
    try {
      InitialContext ctx = new InitialContext();
      String rolesPath = rolesPathPrefix + '/' + super.getUsername();
      String[] roles = (String[]) ctx.lookup(rolesPath);
      Group[] groups = { new SimpleGroup("Roles") };
      log.info("Getting roles for user=" + super.getUsername());
      for (int r = 0; r &lt; roles.length; r++) {
        SimplePrincipal role = new SimplePrincipal(roles[r]);
        log.info("Found role=" + roles[r]);
        groups[0].addMember(role);
      }
      return groups;
    } catch (NamingException e) {
      log.error("Failed to obtain groups for user=" + super.getUsername(), e);
      throw new LoginException(e.toString(true));
    }
  }
  /**
   * Get the password of the current user by querying the userPathPrefix + '/' + super.getUsername() JNDI location.
   */
  @Override
  protected String getUsersPassword() throws LoginException {
    try {
      InitialContext ctx = new InitialContext();
      String userPath = userPathPrefix + '/' + super.getUsername();
      log.info("Getting password for user=" + super.getUsername());
      String passwd = (String) ctx.lookup(userPath);
      log.info("Found password=" + passwd);
      return passwd;
    } catch (NamingException e) {
      log.error("Failed to obtain password for user=" + super.getUsername(), e);
      throw new LoginException(e.toString(true));
    }
  }
}</pre></div></div><div class="example" id="idm140707315799872"><p class="title"><strong>Example 15.21. Definition of security-ex2 security domain with the newly-created custom login module</strong></p><div class="example-contents"><pre class="programlisting">
/subsystem=security/security-domain=security-ex2/:add
/subsystem=security/security-domain=security-ex2/authentication=classic:add
/subsystem=security/security-domain=security-ex2/authentication=classic/login-module=ex2/:add(\
flag=required,\
code=org.jboss.book.security.ex2.JndiUserAndPassLoginModule,\
module-options=[("userPathPrefix"=&gt;"/security/store/password"),\
("rolesPathPrefix"=&gt;"/security/store/roles")]\
)

</pre></div></div><div class="para">
		The choice of using the <code class="literal">JndiUserAndPassLoginModule</code> custom login module for the server side authentication of the user is determined by the login configuration for the example security domain. The EJB JAR <code class="filename">META-INF/jboss-ejb3.xml</code> descriptor sets the security domain. For a web application it is part of the <code class="filename">WEB-INF/jboss-web.xml</code> file.
	</div><div class="example" id="idm140707318068048"><p class="title"><strong>Example 15.22. <code class="filename">jboss-ejb3.xml</code> Example</strong></p><div class="example-contents"><pre class="programlisting language-xml">&lt;?xml version="1.0"?&gt;
&lt;jboss:ejb-jar xmlns:jboss="http://www.jboss.com/xml/ns/javaee" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:s="urn:security" version="3.1" impl-version="2.0"&gt;
  &lt;assembly-descriptor&gt;
    &lt;s:security&gt;
      &lt;ejb-name&gt;*&lt;/ejb-name&gt;
      &lt;s:security-domain&gt;security-ex2&lt;/s:security-domain&gt;
    &lt;/s:security&gt;
  &lt;/assembly-descriptor&gt;
&lt;/jboss:ejb-jar&gt;
</pre></div></div><div class="example" id="idm140707340994480"><p class="title"><strong>Example 15.23. <code class="filename">jboss-web.xml example</code></strong></p><div class="example-contents"><pre class="programlisting language-xml">&lt;?xml version="1.0"?&gt;
&lt;jboss-web&gt;
    &lt;security-domain&gt;security-ex2&lt;/security-domain&gt;
&lt;/jboss-web&gt;
</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+28326-638684+%5BSpecified%5D&amp;comment=Title%3A+Custom+LoginModule+Example%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=28326-638684+07+May+2014+12%3A50+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div></div><div xml:lang="en-US" class="chapter" id="chap-Single_Sign_On_SSO" lang="en-US"><div class="titlepage"><div><div><h2 class="title">Chapter 16. Single Sign On (SSO)</h2></div></div></div><div xml:lang="en-US" class="section" id="About_Single_Sign_On_SSO_for_Web_Applications" lang="en-US"><div class="titlepage"><div><div><h2 class="title">16.1. About Single Sign On (SSO) for Web Applications</h2></div></div></div><div class="para"><div class="title">Overview</div><p>
			<em class="firstterm">Single Sign On (SSO)</em> allows authentication to one resource to implicitly authorize access to other resources.
		</p></div><div class="para"><div class="title">Clustered and Non-Clustered SSO</div><p>
			Non-clustered SSO limits the sharing of authorization information to applications on the same virtual host. In addition, there is no resiliency in the event of a host failure. Clustered SSO data can be shared between applications in multiple virtual hosts, and is resilient to failover. In addition, clustered SSO is able to receive requests from a load balancer.
		</p></div><div class="para"><div class="title">How SSO Works</div><p>
			If a resource is unprotected, a user is not challenged to authenticate at all. If a user accesses a protected resource, the user is required to authenticate.
		</p></div><div class="para">
		Upon successful authentication, the roles associated with the user are stored and used for authorization of all other associated resources.
	</div><div class="para">
		If the user logs out of an application, or an application invalidates the session programmatically, all persisted authorization data is removed, and the process starts over.
	</div><div class="para">
		A session timeout does not invalidate the SSO session if other sessions are still valid.
	</div><div class="variablelist"><p class="title"><strong>Limitations of SSO</strong></p><dl class="variablelist"><dt><span class="term">No propagation across third-party boundaries.</span></dt><dd><div class="para">
					SSO can only be used between applications deployed within JBoss EAP 6 containers.
				</div></dd><dt><span class="term">Container-managed authentication only.</span></dt><dd><div class="para">
					You must use container-managed authentication elements such as <code class="sgmltag-element">&lt;login-config&gt;</code> in your application's <code class="filename">web.xml</code>.
				</div></dd><dt><span class="term">Requires cookies.</span></dt><dd><div class="para">
					SSO is maintained via browser cookies and URL rewriting is not supported.
				</div></dd><dt><span class="term">Realm and security-domain limitations</span></dt><dd><div class="para">
					Unless the <code class="literal">requireReauthentication</code> parameter is set to <code class="literal">true</code>, all web applications configured for the same SSO valve must share the same Realm configuration in <code class="filename">web.xml</code> and the same security domain.
				</div><div class="para">
					You can nest the Realm element inside the Host element or the surrounding Engine element, but not inside a context.xml element for one of the involved web applications.
				</div><div class="para">
					The <code class="sgmltag-element">&lt;security-domain&gt;</code> configured in the <code class="filename">jboss-web.xml</code> must be consistent across all web applications.
				</div><div class="para">
					All security integrations must accept the same credentials (for instance, username and password).
				</div></dd></dl></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4694-460020+%5BSpecified%5D&amp;comment=Title%3A+About+Single+Sign+On+%28SSO%29+for+Web+Applications%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4694-460020+14+Jun+2013+14%3A38+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="About_Clustered_Single_Sign_On_SSO_for_Web_Applications" lang="en-US"><div class="titlepage"><div><div><h2 class="title">16.2. About Clustered Single Sign On (SSO) for Web Applications</h2></div></div></div><div class="para">
		Single Sign On (SSO) is the ability for users to authenticate to a single web application, and by means of a successful authentication, to be granted authorization to multiple other applications. Clustered SSO stores the authentication and authorization information in a clustered cache. This allows for applications on multiple different servers to share the information, and also makes the information resilient to a failure of one of the hosts.
	</div><div class="para">
		A SSO configuration is called a valve. A valve is connected to a security domain, which is configured at the level of the server or server group. Each application which should share the same cached authentication information is configured to use the same valve. This configuration is done in the application's <code class="filename">jboss-web.xml</code>.
	</div><div class="para">
		Some common SSO valves supported by the web subsystem of JBoss EAP 6 include:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				Apache Tomcat ClusteredSingleSignOn
			</div></li><li class="listitem"><div class="para">
				Apache Tomcat IDPWebBrowserSSOValve
			</div></li><li class="listitem"><div class="para">
				SPNEGO-based SSO provided by PicketLink
			</div></li></ul></div><div class="para">
		Depending on the specific type of valve, you may need to do some additional configuration in your security domain, in order for your valve to work properly.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4696-460022+%5BSpecified%5D&amp;comment=Title%3A+About+Clustered+Single+Sign+On+%28SSO%29+for+Web+Applications%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4696-460022+14+Jun+2013+14%3A39+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Choose_the_Right_SSO_Implementation" lang="en-US"><div class="titlepage"><div><div><h2 class="title">16.3. Choose the Right SSO Implementation</h2></div></div></div><div class="para">
		JBoss EAP 6 runs Java Enterprise Edition (EE) applications, which may be web applications, EJB applications, web services, or other types. Single Sign On (SSO) allows you to propagate security context and identity information between these applications. Several SSO solutions are available but choosing the right solution depends on your requirements.
	</div><div class="para">
		Note that there is a distinct difference between clustered web application sessions and clustered web application SSO. Clustered web application sessions ensures that client sessions of distributable applications are distributed across the nodes in a cluster. Clustered web application SSO ensures that SSO sessions are distributed across the nodes in a cluster. Although they are separate, they are commonly used together.
	</div><div class="para"><div class="title">Kerberos-Based Desktop SSO</div><p>
			If your organization already uses a Kerberos-based authentication and authorization system, such as Microsoft Active Directory, you can use the same systems to transparently authenticate to your enterprise applications running on JBoss EAP 6.
		</p></div><div class="para"><div class="title">Non-Clustered Web Application SSO</div><p>
			If you are running multiple applications on a single instance and need to enable SSO session replication for those applications, non-clustered SSO will meet your requirements.
		</p></div><div class="para"><div class="title">Clustered Web Application SSO</div><p>
			If you are running either a single application, or multiple applications, across a cluster and need to enable SSO session replication for those applications, clustered SSO will meet your requirements.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+7502-633111+%5BSpecified%5D&amp;comment=Title%3A+Choose+the+Right+SSO+Implementation%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7502-633111+23+Apr+2014+12%3A20+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Use_Single_Sign_On_SSO_In_A_Web_Application" lang="en-US"><div class="titlepage"><div><div><h2 class="title">16.4. Use Single Sign On (SSO) In A Web Application</h2></div></div></div><div class="para"><div class="title">Overview</div><p>
			Single Sign On (SSO) capabilities are provided by the web and Infinispan subsystems. Use this procedure to configure SSO in web applications.
		</p></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul><li class="listitem"><div class="para">
				You need to have a configured security domain which handles authentication and authorization.
			</div></li><li class="listitem"><div class="para">
				The <code class="code">infinispan</code> subsystem needs to be present. It is present in the <code class="code">full-ha</code> profile for a managed domain, or by using the <code class="code">standalone-full-ha.xml</code> configuration in a standalone server.
			</div></li><li class="listitem"><div class="para">
				The <code class="code">web</code> <code class="code">cache-container</code> and SSO cache-container must each be present. The initial configuration files already contain the <code class="code">web</code> cache-container, and some of the configurations already contain the SSO cache-container as well. Use the following commands to check for and enable the SSO cache container. Note that these commands modify the <code class="code">ha</code> profile of a managed domain. You can change the commands to use a different profile, or remove the <code class="literal">/profile=ha</code> portion of the command, for a standalone server.
			</div><div class="example" id="idm140707322680800"><p class="title"><strong>Example 16.1. Check for the <code class="code">web</code> cache-container</strong></p><div class="example-contents"><div class="para">
					The profiles and configurations mentioned above include the <code class="code">web</code> cache-container by default. Use the following command to verify its presence. If you use a different profile, substitute its name instead of <code class="literal">ha</code>.
				</div><pre class="screen">/profile=ha/subsystem=infinispan/cache-container=web/:read-resource(recursive=false,proxies=false,include-runtime=false,include-defaults=true)</pre><div class="para">
					If the result is <code class="literal">success</code> the subsystem is present. Otherwise, you need to add it.
				</div></div></div><div class="example" id="idm140707321371824"><p class="title"><strong>Example 16.2. Add the <code class="code">web</code> cache-container</strong></p><div class="example-contents"><div class="para">
					Use the following three commands to enable the <code class="code">web</code> cache-container to your configuration. Modify the name of the profile as appropriate, as well as the other parameters. The parameters here are the ones used in a default configuration.
				</div><pre class="screen">/profile=ha/subsystem=infinispan/cache-container=web:add(aliases=["standard-session-cache"],default-cache="repl",module="org.jboss.as.clustering.web.infinispan")</pre><pre class="screen">/profile=ha/subsystem=infinispan/cache-container=web/transport=TRANSPORT:add(lock-timeout=60000)</pre><pre class="screen">/profile=ha/subsystem=infinispan/cache-container=web/replicated-cache=repl:add(mode="ASYNC",batching=true)</pre></div></div><div class="example" id="idm140707326174896"><p class="title"><strong>Example 16.3. Check for the <code class="code">SSO</code> cache-container</strong></p><div class="example-contents"><div class="para">
					Run the following Management CLI command:
				</div><pre class="screen">/profile=ha/subsystem=infinispan/cache-container=web/:read-resource(recursive=true,proxies=false,include-runtime=false,include-defaults=true)</pre><div class="para">
					Look for output like the following: <code class="code">"sso" =&gt; {</code>
				</div><div class="para">
					If you do not find it, the SSO cache-container is not present in your configuration.
				</div></div></div><div class="example" id="idm140707313704320"><p class="title"><strong>Example 16.4. Add the <code class="code">SSO</code> cache-container</strong></p><div class="example-contents"><pre class="screen">/profile=ha/subsystem=infinispan/cache-container=web/replicated-cache=sso:add(mode="SYNC", batching=true)</pre></div></div></li><li class="listitem"><div class="para">
				The <code class="code">web</code> subsystem needs to be configured to use SSO. The following command enables SSO on the virtual server called <code class="literal">default-host</code>, and the cookie domain <code class="literal">domain.com</code>. The cache name is <code class="literal">sso</code>, and reauthentication is disabled.
			</div><pre class="screen">/profile=ha/subsystem=web/virtual-server=<em class="replaceable">default-host</em>/sso=configuration:add(cache-container="web",cache-name=<em class="replaceable">"sso"</em>,reauthenticate=<em class="replaceable">"false"</em>,domain=<em class="replaceable">"domain.com"</em>)</pre></li><li class="listitem"><div class="para">
				Each application which will share the SSO information needs to be configured to use the same &lt;security-domain&gt; in its <code class="filename">jboss-web.xml</code> deployment descriptor and the same Realm in its <code class="filename">web.xml</code> configuration file.
			</div></li></ul></div><div class="para"><div class="title">Differences Between Clustered and Non-Clustered SSO Valves</div><p>
			The SSO Valves are configured automatically when <code class="literal">sso</code> is configured under the web subsystem in a server profile. The <code class="code">ClusteredSingleSignOn</code> version is used when attribute <code class="code">cache-container</code> is present, otherwise standard <code class="code">SingleSignOn</code> class is used.
		</p></div><div class="example" id="idm140707338252864"><p class="title"><strong>Example 16.5. Example Clustered SSO Configuration</strong></p><div class="example-contents"><pre class="screen">/subsystem=web/virtual-server=<em class="replaceable">default-host</em>/sso=configuration:add(cache-container="web",cache-name="sso",reauthenticate="<em class="replaceable">false</em>",domain="<em class="replaceable">domain.com</em>")</pre></div></div><div class="example" id="idm140707320116400"><p class="title"><strong>Example 16.6. Example Non-Clustered SSO Configuration</strong></p><div class="example-contents"><pre class="screen">/subsystem=web/virtual-server=<em class="replaceable">default-host</em>/sso=configuration:add(reauthenticate="<em class="replaceable">false</em>")</pre></div></div><div class="para"><div class="title">Invalidate a Session</div><p>
			An application can programmatically invalidate a session by invoking method <code class="code">javax.servlet.http.HttpSession.invalidate()</code>.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4695-633059+%5BSpecified%5D&amp;comment=Title%3A+Use+Single+Sign+On+%28SSO%29+In+A+Web+Application%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4695-633059+23+Apr+2014+04%3A06+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="About_Kerberos" lang="en-US"><div class="titlepage"><div><div><h2 class="title">16.5. About Kerberos</h2></div></div></div><div class="para">
		Kerberos is a network authentication protocol for client/server applications. It allows authentication across a non-secure network in a secure way, using secret-key symmetric cryptography.
	</div><div class="para">
		Kerberos uses security tokens called tickets. To use a secured service, you need to obtain a ticket from the Ticket Granting Service (TGS), which is a service running on a server on your network. After obtaining the ticket, you request a Service Ticket (ST) from an Authentication Service (AS), which is another service running on your network. You then use the ST to authenticate to the service you want to use. The TGS and the AS both run inside an enclosing service called the Key Distribution Center (KDC).
	</div><div class="para">
		Kerberos is designed to be used in a client-server environment, and is rarely used in Web applications or thin client environments. However, many organizations already use a Kerberos system for desktop authentication, and prefer to reuse their existing system rather than create a second one for their Web Applications. Kerberos is an integral part of Microsoft Active Directory, and is also used in many Red Hat Enterprise Linux environments.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+7816-328401+%5BSpecified%5D&amp;comment=Title%3A+About+Kerberos%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7816-328401+05+Nov+2012+14%3A02+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="About_SPNEGO" lang="en-US"><div class="titlepage"><div><div><h2 class="title">16.6. About SPNEGO</h2></div></div></div><div class="para">
		Simple and Protected GSS_API Negotiation Mechanism (SPNEGO) provides a mechanism for extending a Kerberos-based Single Sign On (SSO) environment for use in Web applications.
	</div><div class="para">
		When an application on a client computer, such as a web browser, attempts to access a protect page on the web server, the server responds that authorization is required. The application then requests a service ticket from the Kerberos Key Distribution Center (KDC). After the ticket is obtained, the application wraps it in a request formatted for SPNEGO, and sends it back to the Web application, via the browser. The web container running the deployed Web application unpacks the request and authenticates the ticket. Upon successful authentication, access is granted.
	</div><div class="para">
		SPNEGO works with all types of Kerberos providers, including the Kerberos service included in Red Hat Enterprise Linux and the Kerberos server which is an integral part of Microsoft Active Directory.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+7817-328449+%5BSpecified%5D&amp;comment=Title%3A+About+SPNEGO%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7817-328449+05+Nov+2012+14%3A14+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="About_Microsoft_Active_Directory" lang="en-US"><div class="titlepage"><div><div><h2 class="title">16.7. About Microsoft Active Directory</h2></div></div></div><div class="para">
		Microsoft Active Directory is a directory service developed by Microsoft to authenticate users and computers in a Microsoft Windows domain. It is included as part of Microsoft Windows Server. The computer in the Microsoft Windows Server is referred to as the domain controller. Red Hat Enterprise Linux servers running the Samba service can also act as the domain controller in this type of network.
	</div><div class="para">
		Active Directory relies on three core technologies which work together:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				Lightweight Directory Access Protocol (LDAP), for storing information about users, computers, passwords, and other resources.
			</div></li><li class="listitem"><div class="para">
				Kerberos, for providing secure authentication over the network.
			</div></li><li class="listitem"><div class="para">
				Domain Name Service (DNS) for providing mappings between IP addresses and host names of computers and other devices on the network.
			</div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+7818-328400+%5BSpecified%5D&amp;comment=Title%3A+About+Microsoft+Active+Directory%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7818-328400+05+Nov+2012+14%3A02+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Configure_Kerberos_or_Microsoft_Active_Directory_Desktop_SSO_for_Web_Applications" lang="en-US"><div class="titlepage"><div><div><h2 class="title">16.8. Configure Kerberos or Microsoft Active Directory Desktop SSO for Web Applications</h2></div></div></div><div class="para"><div class="title">Introduction</div><p>
			To authenticate your web or EJB applications using your organization's existing Kerberos-based authentication and authorization infrastructure, such as Microsoft Active Directory, you can use the JBoss Negotation capabilities built into JBoss EAP 6. If you configure your web application properly, a successful desktop or network login is sufficient to transparently authenticate against your web application, so no additional login prompt is required.
		</p></div><div class="para"><div class="title">Difference from Previous Versions of the Platform</div><p>
			There are a few noticeable differences between JBoss EAP 6 and earlier versions:
		</p></div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				Security domains are configured centrally, for each profile of a managed domain, or for each standalone server. They are not part of the deployment itself. The security domain a deployment should use is named in the deployment's <code class="filename">jboss-web.xml</code> or <code class="filename">jboss-ejb3.xml</code> file.
			</div></li><li class="listitem"><div class="para">
				Security properties are configured as part of the security domain, as part of its central configuration. They are not part of the deployment.
			</div></li><li class="listitem"><div class="para">
				You can no longer override the authenticators as part of your deployment. However, you can add a NegotiationAuthenticator valve to your <code class="filename">jboss-web.xml</code> descriptor to achieve the same effect. The valve still requires the <code class="sgmltag-element">&lt;security-constraint&gt;</code> and <code class="sgmltag-element">&lt;login-config&gt;</code> elements to be defined in the <code class="filename">web.xml</code>. These are used to decide which resources are secured. However, the chosen auth-method will be overridden by the NegotiationAuthenticator valve in the <code class="filename">jboss-web.xml</code>.
			</div></li><li class="listitem"><div class="para">
				The <code class="literal">CODE</code> attributes in security domains now use a simple name instead of a fully-qualified class name. The following table shows the mappings between the classes used for JBoss Negotiation, and their classes.
			</div></li></ul></div><div class="table" id="idm140707321301504"><p class="title"><strong>Table 16.1. Login Module Codes and Class Names</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="Login Module Codes and Class Names"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707331574960" scope="col"> Simple Name </th><th id="idm140707331574480" scope="col"> Class Name </th><th id="idm140707331574000" scope="col"> Purpose </th></tr></thead><tbody><tr><td headers="idm140707331574960"> Kerberos </td><td headers="idm140707331574480"> com.sun.security.auth.module.Krb5LoginModule </td><td headers="idm140707331574000"> Kerberos login module </td></tr><tr><td headers="idm140707331574960"> SPNEGO </td><td headers="idm140707331574480"> org.jboss.security.negotiation.spnego.SPNEGOLoginModule </td><td headers="idm140707331574000"> The mechanism which enables your Web applications to authenticate to your Kerberos authentication server. </td></tr><tr><td headers="idm140707331574960"> AdvancedLdap </td><td headers="idm140707331574480"> org.jboss.security.negotiation.AdvancedLdapLoginModule </td><td headers="idm140707331574000"> Used with LDAP servers other than Microsoft Active Directory. </td></tr><tr><td headers="idm140707331574960"> AdvancedAdLdap </td><td headers="idm140707331574480"> org.jboss.security.negotiation.AdvancedADLoginModule </td><td headers="idm140707331574000"> Used with Microsoft Active Directory LDAP servers. </td></tr></tbody></table></div></div><div class="para"><div class="title">Jboss Negotiation Toolkit</div><p>
			The <code class="filename">JBoss Negotiation Toolkit</code> is a debugging tool which is available for download from <a href="https://community.jboss.org/servlet/JiveServlet/download/16876-2-34629/jboss-negotiation-toolkit.war" class="mimir-link-warn" title="Mimir does not include content from: community.jboss.org">https://community.jboss.org/servlet/JiveServlet/download/16876-2-34629/jboss-negotiation-toolkit.war</a>. It is provided as an extra tool to help you to debug and test the authentication mechanisms before introducing your application into production. It is an unsupported tool, but is considered to be very helpful, as SPNEGO can be difficult to configure for web applications.
		</p></div><div class="procedure"><p class="title"><strong>Procedure 16.1. Setup SSO Authentication for your Web or EJB Applications</strong></p><ol class="1"><li class="step"><p class="title"><strong>Configure one security domain to represent the identity of the server. Set system properties if necessary.</strong></p><div class="para">
				The first security domain authenticates the container itself to the directory service. It needs to use a login module which accepts some type of static login mechanism, because a real user is not involved. This example uses a static principal and references a keytab file which contains the credential.
			</div><div class="para">
				The XML code is given here for clarity, but you should use the Management Console or Management CLI to configure your security domains.
			</div><pre class="programlisting language-xml XML XML">
&lt;security-domain name="host" cache-type="default"&gt;
   &lt;authentication&gt;
      &lt;login-module code="Kerberos" flag="required"&gt;
         &lt;module-option name="storeKey" value="true"/&gt;
         &lt;module-option name="useKeyTab" value="true"/&gt;
         &lt;module-option name="principal" value="host/testserver@MY_REALM"/&gt;
         &lt;module-option name="keyTab" value="/home/username/service.keytab"/&gt;
         &lt;module-option name="doNotPrompt" value="true"/&gt;
         &lt;module-option name="debug" value="false"/&gt;
      &lt;/login-module&gt;
   &lt;/authentication&gt;
&lt;/security-domain&gt;		

</pre></li><li class="step"><p class="title"><strong>Configure a second security domain to secure the web application or applications. Set system properties if necessary.</strong></p><div class="para">
				The second security domain is used to authenticate the individual user to the Kerberos or SPNEGO authentication server. You need at least one login module to authenticate the user, and another to search for the roles to apply to the user. The following XML code shows an example SPNEGO security domain. It includes an authorization module to map roles to individual users. You can also use a module which searches for the roles on the authentication server itself.
			</div><pre class="programlisting language-xml XML XML">
&lt;security-domain name="SPNEGO" cache-type="default"&gt;
   &lt;authentication&gt;
      &lt;!-- Check the username and password --&gt;
      &lt;login-module code="SPNEGO"  flag="requisite"&gt;
         &lt;module-option name="password-stacking" value="useFirstPass"/&gt;
         &lt;module-option name="serverSecurityDomain" value="host"/&gt;
      &lt;/login-module&gt;
      &lt;!-- Search for roles --&gt;
      &lt;login-module code="UsersRoles" flag="required"&gt;
         &lt;module-option name="password-stacking" value="useFirstPass" /&gt;
         &lt;module-option name="usersProperties" value="spnego-users.properties" /&gt;
         &lt;module-option name="rolesProperties" value="spnego-roles.properties" /&gt;
      &lt;/login-module&gt; 
   &lt;/authentication&gt;
&lt;/security-domain&gt;		

</pre></li><li class="step"><p class="title"><strong>Specify the security-constraint and login-config in the <code class="filename">web.xml</code></strong></p><div class="para">
				The <code class="filename">web.xml</code> descriptor contain information about security constraints and login configuration. The following are example values for each.
			</div><pre class="programlisting language-xml XML XML">
&lt;security-constraint&gt;
   &lt;display-name&gt;Security Constraint on Conversation&lt;/display-name&gt;
   &lt;web-resource-collection&gt;
      &lt;web-resource-name&gt;examplesWebApp&lt;/web-resource-name&gt;
      &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
   &lt;/web-resource-collection&gt;
   &lt;auth-constraint&gt;
   &lt;role-name&gt;RequiredRole&lt;/role-name&gt;
   &lt;/auth-constraint&gt;
&lt;/security-constraint&gt;

&lt;login-config&gt;
   &lt;auth-method&gt;SPNEGO&lt;/auth-method&gt;
   &lt;realm-name&gt;SPNEGO&lt;/realm-name&gt;
&lt;/login-config&gt;
 
&lt;security-role&gt;
   &lt;description&gt; role required to log in to the Application&lt;/description&gt;
   &lt;role-name&gt;RequiredRole&lt;/role-name&gt;
&lt;/security-role&gt;		

</pre></li><li class="step"><p class="title"><strong>Specify the security domain and other settings in the <code class="filename">jboss-web.xml</code> descriptor.</strong></p><div class="para">
				Specify the name of the client-side security domain (the second one in this example) in the <code class="filename">jboss-web.xml</code> descriptor of your deployment, to direct your application to use this security domain.
			</div><div class="para">
				You can no longer override authenticators directly. Instead, you can add the NegotiationAuthenticator as a valve to your <code class="filename">jboss-web.xml</code> descriptor, if you need to. The <code class="sgmltag-element">&lt;jacc-star-role-allow&gt;</code> allows you to use the asterisk (*) character to match multiple role names, and is optional.
			</div><pre class="programlisting language-xml XML XML">
&lt;jboss-web&gt;
   &lt;security-domain&gt;java:/jaas/SPNEGO&lt;/security-domain&gt;
   &lt;valve&gt;
      &lt;class-name&gt;org.jboss.security.negotiation.NegotiationAuthenticator&lt;/class-name&gt;
   &lt;/valve&gt;
   &lt;jacc-star-role-allow&gt;true&lt;/jacc-star-role-allow&gt;
&lt;/jboss-web&gt;		

</pre></li><li class="step"><p class="title"><strong>Add a dependency to your application's <code class="filename">MANIFEST.MF</code>, to locate the Negotiation classes.</strong></p><div class="para">
				The web application needs a dependency on class <code class="code">org.jboss.security.negotiation</code> to be added to the deployment's <code class="filename">META-INF/MANIFEST.MF</code> manifest, in order to locate the JBoss Negotiation classes. The following shows a properly-formatted entry.
			</div><pre class="programlisting">
Manifest-Version: 1.0
Build-Jdk: 1.6.0_24
Dependencies: org.jboss.security.negotiation
</pre></li></ol></div><div class="para"><div class="title">Result</div><p>
			Your web application accepts and authenticates credentials against your Kerberos, Microsoft Active Directory, or other SPNEGO-compatible directory service. If the user runs the application from a system which is already logged into the directory service, and where the required roles are already applied to the user, the web application does not prompt for authentication, and SSO capabilities are achieved.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4937-481766+%5BSpecified%5D&amp;comment=Title%3A+Configure+Kerberos+or+Microsoft+Active+Directory+Desktop+SSO+for+Web+Applications%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4937-481766+25+Jul+2013+13%3A02+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div xml:lang="en-US" class="chapter" id="chap-Role-Based_Security_in_Applications" lang="en-US"><div class="titlepage"><div><div><h2 class="title">Chapter 17. Role-Based Security in Applications</h2></div></div></div><div xml:lang="en-US" class="section" id="Java_Authentication_and_Authorization_Service_JAAS" lang="en-US"><div class="titlepage"><div><div><h2 class="title">17.1. Java Authentication and Authorization Service (JAAS)</h2></div></div></div><div class="para">
		<em class="firstterm">Java Authentication and Authorization Service (JAAS)</em> is a security API which consists of a set of Java packages designed for user authentication and authorization. The API is a Java implementation of the standard Pluggable Authentication Modules (PAM) framework. It extends the Java Enterprise Edition access control architecture to support user-based authorization.
	</div><div class="para">
		In JBoss EAP 6, JAAS only provides declarative role-based security. For more information about declarative security, refer to <a class="xref" href="#sect-About_Declarative_Security">Section 2.1, “About Declarative Security”</a>.
	</div><div class="para">
		JAAS is independent of any underlying authentication technologies, such as Kerberos or LDAP. You can change your underlying security structure without changing your application. You only need to change the JAAS configuration.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4769-460006+%5BSpecified%5D&amp;comment=Title%3A+Java+Authentication+and+Authorization+Service+%28JAAS%29%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4769-460006+14+Jun+2013+14%3A30+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="About_Java_Authentication_and_Authorization_Service_JAAS" lang="en-US"><div class="titlepage"><div><div><h2 class="title">17.2. About Java Authentication and Authorization Service (JAAS)</h2></div></div></div><div class="para">
		The security architecture of JBoss EAP 6 is comprised of the security configuration subsystem, and application-specific security configurations which are included in several configuration files within the application.
	</div><div class="para"><div class="title">Domain, Server Group, and Server Specific Configuration</div><p>
			Server groups (in a managed domain) and servers (in a standalone server) include the configuration for security domains. A security domain includes information about a combination of authentication, authorization, mapping, and auditing modules, with configuration details. An application specifies which security domain it requires, by name, in its <code class="filename">jboss-web.xml</code>.
		</p></div><div class="para"><div class="title">Application-specific Configuration</div><p>
			Application-specific configuration takes place in one or more of the following four files.
		</p></div><div class="table" id="idm140707337318576"><p class="title"><strong>Table 17.1. Application-Specific Configuration Files</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="Application-Specific Configuration Files"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707315184896" scope="col"> File </th><th id="idm140707315184416" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140707315184896"> ejb-jar.xml </td><td headers="idm140707315184416"> <div class="para">
						The deployment descriptor for an Enterprise JavaBean (EJB) application, located in the <code class="filename">META-INF</code> directory of the archive. Use the <code class="filename">ejb-jar.xml</code> to specify roles and map them to principals, at the application level. You can also limit specific methods and classes to certain roles. It is also used for other EJB-specific configuration not related to security.
					</div>
					 </td></tr><tr><td headers="idm140707315184896"> web.xml </td><td headers="idm140707315184416"> <div class="para">
						The deployment descriptor for a Java Enterprise Edition (EE) web application. Use the <code class="filename">web.xml</code> to declare the security domain the application uses for authentication and authorization, as well as resource and transport constraints for the application, such as limiting which types of HTTP requests are allowed. You can also configure simple web-based authentication in this file. It is also used for other application-specific configuration not related to security.
					</div>
					 </td></tr><tr><td headers="idm140707315184896"> jboss-ejb3.xml </td><td headers="idm140707315184416"> <div class="para">
						Contains JBoss-specific extensions to the <code class="filename">ejb-jar.xml</code> descriptor.
					</div>
					 </td></tr><tr><td headers="idm140707315184896"> jboss-web.xml </td><td headers="idm140707315184416"> <div class="para">
						Contains JBoss-specific extensions to the <code class="filename">web.xml</code> descriptor.
					</div>
					 </td></tr></tbody></table></div></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			The <code class="filename">ejb-jar.xml</code> and <code class="filename">web.xml</code> are defined in the Java Enterprise Edition (Java EE) specification. The <code class="filename">jboss-ejb3.xml</code> provides JBoss-specific extensions for the <code class="filename">ejb-jar.xml</code>, and the <code class="filename">jboss-web.xml</code> provides JBoss-specific extensions for the <code class="filename">web.xml</code>.
		</div></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4797-632561+%5BSpecified%5D&amp;comment=Title%3A+About+Java+Authentication+and+Authorization+Service+%28JAAS%29%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4797-632561+22+Apr+2014+10%3A26+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Use_a_Security_Domain_in_Your_Application" lang="en-US"><div class="titlepage"><div><div><h2 class="title">17.3. Use a Security Domain in Your Application</h2></div></div></div><div class="para"><div class="title">Overview</div><p>
			To use a security domain in your application, first you need to define the security domain in the server's configuration and then enable it for an application in the application's deployment descriptor. Then you must add the required annotations to the EJB that uses it. This topic covers the steps required to use a security domain in your application.
		</p></div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
			If an application is part of a security domain that uses an authentication cache, user authentications for that application will also be available to other applications in that security domain.
		</div></div></div><div class="procedure"><p class="title"><strong>Procedure 17.1. Configure Your Application to Use a Security Domain</strong></p><ol class="1"><li class="step"><p class="title"><strong>Define the Security Domain</strong></p><div class="para">
				You need to define the security domain in the server's configuration file, and then enable it for an application in the application's descriptor file.
			</div><ol class="substeps a"><li class="step"><p class="title"><strong>Configure the security domain in the server's configuration file</strong></p><div class="para">
						The security domain is configured in the <code class="literal">security</code> subsystem of the server's configuration file. If the JBoss EAP 6 instance is running in a managed domain, this is the <code class="filename">domain/configuration/domain.xml</code> file. If the JBoss EAP 6 instance is running as a standalone server, this is the <code class="filename">standalone/configuration/standalone.xml</code> file.
					</div><div class="para">
						The <code class="literal">other</code>, <code class="literal">jboss-web-policy</code>, and <code class="literal">jboss-ejb-policy</code> security domains are provided by default in JBoss EAP 6. The following XML example was copied from the <code class="literal">security</code> subsystem in the server's configuration file. 
<pre class="programlisting language-xml XML XML">&lt;subsystem xmlns="urn:jboss:domain:security:1.2"&gt;
    &lt;security-domains&gt;
        &lt;security-domain name="other" cache-type="default"&gt;
            &lt;authentication&gt;
                &lt;login-module code="Remoting" flag="optional"&gt;
                    &lt;module-option name="password-stacking" value="useFirstPass"/&gt;
                &lt;/login-module&gt;
                &lt;login-module code="RealmDirect" flag="required"&gt;
                    &lt;module-option name="password-stacking" value="useFirstPass"/&gt;
                &lt;/login-module&gt;
            &lt;/authentication&gt;
        &lt;/security-domain&gt;
        &lt;security-domain name="jboss-web-policy" cache-type="default"&gt;
            &lt;authorization&gt;
                &lt;policy-module code="Delegating" flag="required"/&gt;
            &lt;/authorization&gt;
        &lt;/security-domain&gt;
        &lt;security-domain name="jboss-ejb-policy" cache-type="default"&gt;
            &lt;authorization&gt;
                &lt;policy-module code="Delegating" flag="required"/&gt;
            &lt;/authorization&gt;
        &lt;/security-domain&gt;
    &lt;/security-domains&gt;
&lt;/subsystem&gt;</pre>

					</div><div class="para">
						You can configure additional security domains as needed using the Management Console or CLI.
					</div></li><li class="step"><p class="title"><strong>Enable the security domain in the application's descriptor file</strong></p><div class="para">
						The security domain is specified in the <code class="sgmltag-element">&lt;security-domain&gt;</code> child element of the <code class="sgmltag-element">&lt;jboss-web&gt;</code> element in the application's <code class="filename">WEB-INF/jboss-web.xml</code> file. The following example configures a security domain named <code class="literal">my-domain</code>. 
<pre class="programlisting language-xml XML XML">&lt;jboss-web&gt;
    &lt;security-domain&gt;my-domain&lt;/security-domain&gt;
&lt;/jboss-web&gt;</pre>

					</div><div class="para">
						This is only one of many settings which you can specify in the <code class="filename">WEB-INF/jboss-web.xml</code> descriptor.
					</div></li></ol></li><li class="step"><p class="title"><strong>Add the Required Annotation to the EJB</strong></p><div class="para">
				You configure security in the EJB using the <code class="literal">@SecurityDomain</code> and <code class="literal">@RolesAllowed</code> annotations. The following EJB code example limits access to the <code class="literal">other</code> security domain by users in the <code class="literal">guest</code> role.
			</div><pre class="programlisting language-java JAVA JAVA">package example.ejb3;

import java.security.Principal;

import javax.annotation.Resource;
import javax.annotation.security.RolesAllowed;
import javax.ejb.SessionContext;
import javax.ejb.Stateless;

import org.jboss.ejb3.annotation.SecurityDomain;

/**
 * Simple secured EJB using EJB security annotations
 * Allow access to "other" security domain by users in a "guest" role.
 */
@Stateless
@RolesAllowed({ "guest" })
@SecurityDomain("other")
public class SecuredEJB {

   // Inject the Session Context
   @Resource
   private SessionContext ctx;

   /**
    * Secured EJB method using security annotations
    */
   public String getSecurityInfo() {
      // Session context injected using the resource annotation
      Principal principal = ctx.getCallerPrincipal();
      return principal.toString();
   }
}</pre><div class="para">
				For more code examples, see the <code class="literal">ejb-security</code> quickstart in the JBoss EAP 6 Quickstarts bundle, which is available from the Red Hat Customer Portal.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4765-633062+%5BSpecified%5D&amp;comment=Title%3A+Use+a+Security+Domain+in+Your+Application%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4765-633062+23+Apr+2014+04%3A12+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Use_Role-Based_Security_In_Servlets" lang="en-US"><div class="titlepage"><div><div><h2 class="title">17.4. Use Role-Based Security In Servlets</h2></div></div></div><div class="para">
		To add security to a servlet, you map each servlet to a URL pattern, and create security constraints on the URL patterns which need to be secured. The security constraints limit access to the URLs to roles. The authentication and authorization are handled by the security domain specified in the WAR's <code class="filename">jboss-web.xml</code>.
	</div><div class="para"><div class="title">Prerequisites</div><p>
			Before you use role-based security in a servlet, the security domain used to authenticate and authorize access needs to be configured in the JBoss EAP 6 container.
		</p></div><div class="procedure"><p class="title"><strong>Procedure 17.2. Add Role-Based Security to Servlets</strong></p><ol class="1"><li class="step"><p class="title"><strong>Add mappings between servlets and URL patterns.</strong></p><div class="para">
				Use <code class="sgmltag-element">&lt;servlet-mapping&gt;</code> elements in the <code class="filename">web.xml</code> to map individual servlets to URL patterns. The following example maps the servlet called <code class="literal">DisplayOpResult</code> to the URL pattern <code class="literal">/DisplayOpResult</code>.
			</div><pre class="programlisting language-xml XML XML">
&lt;servlet-mapping&gt;
    &lt;servlet-name&gt;DisplayOpResult&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/DisplayOpResult&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;		

</pre></li><li class="step"><p class="title"><strong>Add security constraints to the URL patterns.</strong></p><div class="para">
				To map the URL pattern to a security constraint, use a <code class="sgmltag-element">&lt;security-constraint&gt;</code>. The following example constrains access from the URL pattern <code class="literal">/DisplayOpResult</code> to be accessed by principals with the role <code class="literal">eap_admin</code>. The role needs to be present in the security domain.
			</div><pre class="programlisting language-xml XML XML">
&lt;security-constraint&gt;
	&lt;display-name&gt;Restrict access to role eap_admin&lt;/display-name&gt;
	&lt;web-resource-collection&gt;
		&lt;web-resource-name&gt;Restrict access to role eap_admin&lt;/web-resource-name&gt;
		&lt;url-pattern&gt;/DisplayOpResult/*&lt;/url-pattern&gt;
	&lt;/web-resource-collection&gt;
	&lt;auth-constraint&gt;
		&lt;role-name&gt;eap_admin&lt;/role-name&gt;
	&lt;/auth-constraint&gt;	
&lt;/security-constraint&gt;	

&lt;security-role&gt;
  &lt;role-name&gt;eap_admin&lt;/role-name&gt;
&lt;/security-role&gt;


&lt;login-config&gt;
    &lt;auth-method&gt;BASIC&lt;/auth-method&gt;
&lt;/login-config&gt;

</pre><div class="para">
				You need to specify the authentication method, which can be any of the following: <code class="literal">BASIC, FORM, DIGEST, CLIENT-CERT, SPNEGO.</code> This example uses <code class="literal">BASIC</code> authentication.
			</div></li><li class="step"><p class="title"><strong>Specify the security domain in the WAR's <code class="filename">jboss-web.xml</code></strong></p><div class="para">
				Add the security domain to the WAR's <code class="filename">jboss-web.xml</code> in order to connect the servlets to the configured security domain, which knows how to authenticate and authorize principals against the security constraints. The following example uses the security domain called <code class="literal">acme_domain</code>.
			</div><pre class="programlisting language-xml XML XML">
&lt;jboss-web&gt;
	...
	&lt;security-domain&gt;acme_domain&lt;/security-domain&gt;
	...
&lt;/jboss-web&gt;

</pre></li></ol></div><div class="example" id="idm140707338291344"><p class="title"><strong>Example 17.1. Example <code class="filename">web.xml</code> with Role-Based Security Configured</strong></p><div class="example-contents"><pre class="programlisting language-xml XML XML">
&lt;web-app xmlns="http://java.sun.com/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
         version="3.0"&gt;

&lt;display-name&gt;Use Role-Based Security In Servlets&lt;/display-name&gt;

&lt;welcome-file-list&gt;
  &lt;welcome-file&gt;/index.jsp&lt;/welcome-file&gt;
&lt;/welcome-file-list&gt;

&lt;servlet-mapping&gt;
    &lt;servlet-name&gt;DisplayOpResult&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/DisplayOpResult&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;

&lt;security-constraint&gt;
  &lt;display-name&gt;Restrict access to role eap_admin&lt;/display-name&gt;
    &lt;web-resource-collection&gt;
      &lt;web-resource-name&gt;Restrict access to role eap_admin&lt;/web-resource-name&gt;
      &lt;url-pattern&gt;/DisplayOpResult/*&lt;/url-pattern&gt;
      &lt;/web-resource-collection&gt;
      &lt;auth-constraint&gt;
        &lt;role-name&gt;eap_admin&lt;/role-name&gt;
      &lt;/auth-constraint&gt;
    &lt;/security-constraint&gt;

    &lt;security-role&gt;
      &lt;role-name&gt;eap_admin&lt;/role-name&gt;
    &lt;/security-role&gt;

    &lt;login-config&gt;
        &lt;auth-method&gt;BASIC&lt;/auth-method&gt;
    &lt;/login-config&gt;

&lt;/web-app&gt;
</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4927-471360+%5BSpecified%5D&amp;comment=Title%3A+Use+Role-Based+Security+In+Servlets%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4927-471360+26+Jun+2013+16%3A01+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Use_A_Third-Party_Authentication_System_In_Your_Application" lang="en-US"><div class="titlepage"><div><div><h2 class="title">17.5. Use A Third-Party Authentication System In Your Application</h2></div></div></div><div class="para">
		You can integrate third-party security systems with JBoss EAP 6. These types of systems are usually token-based. The external system performs the authentication and passes a token back to the Web application through the request headers. This is often referred to as <em class="firstterm">perimeter authentication</em>. To configure perimeter authentication in your application, add a custom authentication valve. If you have a valve from a third-party provider, be sure it is in your classpath and follow the examples below, along with the documentation for your third-party authentication module.
	</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			The location for configuring valves has changed in JBoss EAP 6. There is no longer a <code class="filename">context.xml</code> deployment descriptor. Valves are configured directly in the <code class="filename">jboss-web.xml</code> descriptor instead. The <code class="filename">context.xml</code> is now ignored.
		</div></div></div><div class="example" id="idm140707321230192"><p class="title"><strong>Example 17.2. Basic Authentication Valve</strong></p><div class="example-contents"><pre class="programlisting language-xml XML XML">&lt;jboss-web&gt;
  &lt;valve&gt;
    &lt;class-name&gt;org.jboss.security.negotiation.NegotiationAuthenticator&lt;/class-name&gt;
  &lt;/valve&gt;
&lt;/jboss-web&gt;
</pre><div class="para">
			This valve is used for Kerberos-based SSO. It also shows the most simple pattern for specifying a third-party authenticator for your Web application.
		</div></div></div><div class="example" id="idm140707317909824"><p class="title"><strong>Example 17.3. Custom Valve With Header Attributes Set</strong></p><div class="example-contents"><pre class="programlisting language-xml XML XML">&lt;jboss-web&gt;
  &lt;valve&gt;
    &lt;class-name&gt;org.jboss.web.tomcat.security.GenericHeaderAuthenticator&lt;/class-name&gt;
    &lt;param&gt;
      &lt;param-name&gt;httpHeaderForSSOAuth&lt;/param-name&gt;
      &lt;param-value&gt;sm_ssoid,ct-remote-user,HTTP_OBLIX_UID&lt;/param-value&gt;
    &lt;/param&gt;
    &lt;param&gt;
      &lt;param-name&gt;sessionCookieForSSOAuth&lt;/param-name&gt;
      &lt;param-value&gt;SMSESSION,CTSESSION,ObSSOCookie&lt;/param-value&gt;
    &lt;/param&gt;
  &lt;/valve&gt;
&lt;/jboss-web&gt;
</pre><div class="para">
			This example shows how to set custom attributes on your valve. The authenticator checks for the presence of the header ID and the session key, and passes them into the JAAS framework which drives the security layer, as the username and password value. You need a custom JAAS login module which can process the username and password and populate the subject with the correct roles. If no header values match the configured values, regular form-based authentication semantics apply.
		</div></div></div><div class="para"><div class="title">Writing a Custom Authenticator</div><p>
			Writing your own authenticator is out of scope of this document. However, the following Java code is provided as an example.
		</p></div><div class="example" id="idm140707330467024"><p class="title"><strong>Example 17.4. GenericHeaderAuthenticator.java</strong></p><div class="example-contents"><pre class="programlisting language-java JAVA JAVA">/*
 * JBoss, Home of Professional Open Source.
 * Copyright 2006, Red Hat Middleware LLC, and individual contributors
 * as indicated by the @author tags. See the copyright.txt file in the
 * distribution for a full listing of individual contributors.
 *
 * This is free software; you can redistribute it and/or modify it
 * under the terms of the GNU Lesser General Public License as
 * published by the Free Software Foundation; either version 2.1 of
 * the License, or (at your option) any later version.
 *
 * This software is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this software; if not, write to the Free
 * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA
 * 02110-1301 USA, or see the FSF site: http://www.fsf.org.
 */
 
package org.jboss.web.tomcat.security;

import java.io.IOException;
import java.security.Principal;
import java.util.StringTokenizer;

import javax.management.JMException;
import javax.management.ObjectName;
import javax.servlet.http.Cookie;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.catalina.Realm;
import org.apache.catalina.Session;
import org.apache.catalina.authenticator.Constants;
import org.apache.catalina.connector.Request;
import org.apache.catalina.connector.Response;
import org.apache.catalina.deploy.LoginConfig;
import org.jboss.logging.Logger;

import org.jboss.as.web.security.ExtendedFormAuthenticator;

/**
 * JBAS-2283: Provide custom header based authentication support
 * 
 * Header Authenticator that deals with userid from the request header Requires
 * two attributes configured on the Tomcat Service - one for the http header
 * denoting the authenticated identity and the other is the SESSION cookie
 * 
 * @author &lt;a href="mailto:Anil.Saldhana@jboss.org"&gt;Anil Saldhana&lt;/a&gt;
 * @author &lt;a href="mailto:sguilhen@redhat.com"&gt;Stefan Guilhen&lt;/a&gt;
 * @version $Revision$
 * @since Sep 11, 2006
 */
public class GenericHeaderAuthenticator extends ExtendedFormAuthenticator {
  protected static Logger log = Logger
      .getLogger(GenericHeaderAuthenticator.class);

  protected boolean trace = log.isTraceEnabled();

  // JBAS-4804: GenericHeaderAuthenticator injection of ssoid and
  // sessioncookie name.
  private String httpHeaderForSSOAuth = null;

  private String sessionCookieForSSOAuth = null;

  /**
   * &lt;p&gt;
   * Obtain the value of the &lt;code&gt;httpHeaderForSSOAuth&lt;/code&gt; attribute. This
   * attribute is used to indicate the request header ids that have to be
   * checked in order to retrieve the SSO identity set by a third party
   * security system.
   * &lt;/p&gt;
   * 
   * @return a &lt;code&gt;String&lt;/code&gt; containing the value of the
   *         &lt;code&gt;httpHeaderForSSOAuth&lt;/code&gt; attribute.
   */
  public String getHttpHeaderForSSOAuth() {
    return httpHeaderForSSOAuth;
  }

  /**
   * &lt;p&gt;
   * Set the value of the &lt;code&gt;httpHeaderForSSOAuth&lt;/code&gt; attribute. This
   * attribute is used to indicate the request header ids that have to be
   * checked in order to retrieve the SSO identity set by a third party
   * security system.
   * &lt;/p&gt;
   * 
   * @param httpHeaderForSSOAuth
   *            a &lt;code&gt;String&lt;/code&gt; containing the value of the
   *            &lt;code&gt;httpHeaderForSSOAuth&lt;/code&gt; attribute.
   */
  public void setHttpHeaderForSSOAuth(String httpHeaderForSSOAuth) {
    this.httpHeaderForSSOAuth = httpHeaderForSSOAuth;
  }

  /**
   * &lt;p&gt;
   * Obtain the value of the &lt;code&gt;sessionCookieForSSOAuth&lt;/code&gt; attribute.
   * This attribute is used to indicate the names of the SSO cookies that may
   * be present in the request object.
   * &lt;/p&gt;
   * 
   * @return a &lt;code&gt;String&lt;/code&gt; containing the names (separated by a
   *         &lt;code&gt;','&lt;/code&gt;) of the SSO cookies that may have been set by a
   *         third party security system in the request.
   */
  public String getSessionCookieForSSOAuth() {
    return sessionCookieForSSOAuth;
  }

  /**
   * &lt;p&gt;
   * Set the value of the &lt;code&gt;sessionCookieForSSOAuth&lt;/code&gt; attribute. This
   * attribute is used to indicate the names of the SSO cookies that may be
   * present in the request object.
   * &lt;/p&gt;
   * 
   * @param sessionCookieForSSOAuth
   *            a &lt;code&gt;String&lt;/code&gt; containing the names (separated by a
   *            &lt;code&gt;','&lt;/code&gt;) of the SSO cookies that may have been set by
   *            a third party security system in the request.
   */
  public void setSessionCookieForSSOAuth(String sessionCookieForSSOAuth) {
    this.sessionCookieForSSOAuth = sessionCookieForSSOAuth;
  }

  /**
   * &lt;p&gt;
   * Creates an instance of &lt;code&gt;GenericHeaderAuthenticator&lt;/code&gt;.
   * &lt;/p&gt;
   */
  public GenericHeaderAuthenticator() {
    super();
  }

  public boolean authenticate(Request request, HttpServletResponse response,
      LoginConfig config) throws IOException {
    log.trace("Authenticating user");

    Principal principal = request.getUserPrincipal();
    if (principal != null) {
      if (trace)
        log.trace("Already authenticated '" + principal.getName() + "'");
      return true;
    }

    Realm realm = context.getRealm();
    Session session = request.getSessionInternal(true);

    String username = getUserId(request);
    String password = getSessionCookie(request);

    // Check if there is sso id as well as sessionkey
    if (username == null || password == null) {
      log.trace("Username is null or password(sessionkey) is null:fallback to form auth");
      return super.authenticate(request, response, config);
    }
    principal = realm.authenticate(username, password);

    if (principal == null) {
      forwardToErrorPage(request, response, config);
      return false;
    }

    session.setNote(Constants.SESS_USERNAME_NOTE, username);
    session.setNote(Constants.SESS_PASSWORD_NOTE, password);
    request.setUserPrincipal(principal);

    register(request, response, principal, HttpServletRequest.FORM_AUTH,
        username, password);
    return true;
  }

  /**
   * Get the username from the request header
   * 
   * @param request
   * @return
   */
  protected String getUserId(Request request) {
    String ssoid = null;
    // We can have a comma-separated ids
    String ids = "";
    try {
      ids = this.getIdentityHeaderId();
    } catch (JMException e) {
      if (trace)
        log.trace("getUserId exception", e);
    }
    if (ids == null || ids.length() == 0)
      throw new IllegalStateException(
          "Http headers configuration in tomcat service missing");

    StringTokenizer st = new StringTokenizer(ids, ",");
    while (st.hasMoreTokens()) {
      ssoid = request.getHeader(st.nextToken());
      if (ssoid != null)
        break;
    }
    if (trace)
      log.trace("SSOID-" + ssoid);
    return ssoid;
  }

  /**
   * Obtain the session cookie from the request
   * 
   * @param request
   * @return
   */
  protected String getSessionCookie(Request request) {
    Cookie[] cookies = request.getCookies();
    log.trace("Cookies:" + cookies);
    int numCookies = cookies != null ? cookies.length : 0;

    // We can have comma-separated ids
    String ids = "";
    try {
      ids = this.getSessionCookieId();
      log.trace("Session Cookie Ids=" + ids);
    } catch (JMException e) {
      if (trace)
        log.trace("checkSessionCookie exception", e);
    }
    if (ids == null || ids.length() == 0)
      throw new IllegalStateException(
          "Session cookies configuration in tomcat service missing");

    StringTokenizer st = new StringTokenizer(ids, ",");
    while (st.hasMoreTokens()) {
      String cookieToken = st.nextToken();
      String val = getCookieValue(cookies, numCookies, cookieToken);
      if (val != null)
        return val;
    }
    if (trace)
      log.trace("Session Cookie not found");
    return null;
  }

  /**
   * Get the configured header identity id in the tomcat service
   * 
   * @return
   * @throws JMException
   */
  protected String getIdentityHeaderId() throws JMException {
    if (this.httpHeaderForSSOAuth != null)
      return this.httpHeaderForSSOAuth;
    return (String) mserver.getAttribute(new ObjectName(
        "jboss.web:service=WebServer"), "HttpHeaderForSSOAuth");
  }

  /**
   * Get the configured session cookie id in the tomcat service
   * 
   * @return
   * @throws JMException
   */
  protected String getSessionCookieId() throws JMException {
    if (this.sessionCookieForSSOAuth != null)
      return this.sessionCookieForSSOAuth;
    return (String) mserver.getAttribute(new ObjectName(
        "jboss.web:service=WebServer"), "SessionCookieForSSOAuth");
  }

  /**
   * Get the value of a cookie if the name matches the token
   * 
   * @param cookies
   *            array of cookies
   * @param numCookies
   *            number of cookies in the array
   * @param token
   *            Key
   * @return value of cookie
   */
  protected String getCookieValue(Cookie[] cookies, int numCookies,
      String token) {
    for (int i = 0; i &lt; numCookies; i++) {
      Cookie cookie = cookies[i];
      log.trace("Matching cookieToken:" + token + " with cookie name="
          + cookie.getName());
      if (token.equals(cookie.getName())) {
        if (trace)
          log.trace("Cookie-" + token + " value=" + cookie.getValue());
        return cookie.getValue();
      }
    }
    return null;
  }
}
</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+7825-468477+%5BSpecified%5D&amp;comment=Title%3A+Use+A+Third-Party+Authentication+System+In+Your+Application%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7825-468477+24+Jun+2013+09%3A46+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div xml:lang="en-US" class="chapter" id="chap-Migration" lang="en-US"><div class="titlepage"><div><div><h2 class="title">Chapter 18. Migration</h2></div></div></div><div xml:lang="en-US" class="section" id="Configure_Application_Security_Changes" lang="en-US"><div class="titlepage"><div><div><h2 class="title">18.1. Configure Application Security Changes</h2></div></div></div><div class="para"><div class="title">Configure security for basic authentication</div><p>
			In previous versions of JBoss EAP, properties files placed in the <code class="filename"><em class="replaceable">EAP_HOME</em>/server/<em class="replaceable">SERVER_NAME</em>/conf/</code> directory were on classpath and could be easily found by the <code class="code">UsersRolesLoginModule</code>. In JBoss EAP 6, the directory structure has changed. Properties files must be packaged within the application to make them available in the classpath.
		</p></div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
			You must stop the server before editing the server configuration file for your change to be persisted on server restart.
		</div></div></div><div class="para">
		To configure security for basic authentication, add a new security domain under <code class="code">security-domains</code> to the <code class="filename">standalone/configuration/standalone.xml</code> or the <code class="filename">domain/configuration/domain.xml</code> server configuration file: 
<pre class="programlisting language-xml XML XML">&lt;security-domain name="example"&gt;
    &lt;authentication&gt;
        &lt;login-module code="UsersRoles" flag="required"&gt;
            &lt;module-option name="usersProperties" 
                    value="${jboss.server.config.dir}/example-users.properties"/&gt;
            &lt;module-option name="rolesProperties" 
                    value="${jboss.server.config.dir}/example-roles.properties"/&gt;
        &lt;/login-module&gt;
    &lt;/authentication&gt;
&lt;/security-domain&gt;</pre>

	</div><div class="para">
		If the JBoss EAP 6 instance is running as a standalone server, <code class="varname"> ${jboss.server.config.dir}</code> refers to the <code class="filename"><em class="replaceable">EAP_HOME</em>/standalone/configuration/</code> directory. If the instance is running in a managed domain, <code class="varname"> ${jboss.server.config.dir}</code> refers to the <code class="filename"><em class="replaceable">EAP_HOME</em>/domain/configuration/</code> directory.
	</div><div class="para"><div class="title">Modify security domain names</div><p>
			In JBoss EAP 6, security domains no longer use the prefix <code class="code">java:/jaas/</code> in their names. 
			<div class="itemizedlist"><ul><li class="listitem"><div class="para">
						For Web applications, you must remove this prefix from the security domain configurations in the <code class="filename">jboss-web.xml</code>.
					</div></li><li class="listitem"><div class="para">
						For Enterprise applications, you must remove this prefix from the security domain configurations in the <code class="filename">jboss-ejb3.xml</code> file. This file has replaced the <code class="filename">jboss.xml</code> in JBoss EAP 6.
					</div></li></ul></div>

		</p></div><div class="para">

	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4945-480349+%5BSpecified%5D&amp;comment=Title%3A+Configure+Application+Security+Changes%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4945-480349+22+Jul+2013+22%3A38+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div></div><div xml:lang="en-US" class="appendix" id="appe-Reference" lang="en-US"><div class="titlepage"><div><div><h1 class="title">Appendix A. Reference</h1></div></div></div><div xml:lang="en-US" class="section" id="Included_Authentication_Modules1" lang="en-US"><div class="titlepage"><div><div><h2 class="title">A.1. Included Authentication Modules</h2></div></div></div><div class="para">
		The following authentication modules are included in JBoss EAP 6. Some of these handle authorization as well as authentication. These usually include the word <code class="literal">Role</code> within the <code class="code">Code</code> name.
	</div><div class="para">
		When you configure these modules, use the <code class="code">Code</code> value or the full (package qualified) name to refer to the module.
	</div><div class="itemizedlist"><p class="title"><strong>Authentication Modules</strong></p><ul><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_realmdirect">Table A.1, “<code class="code">RealmDirect</code>”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_realmdirectmoduleoptions">Table A.2, “<code class="code">RealmDirect</code> Module Options”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_client">Table A.3, “<code class="code">Client</code>”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_clientmoduleoptions">Table A.4, “<code class="code">Client</code> Module Options”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_remoting">Table A.5, “<code class="code">Remoting</code>”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_remotingmoduleoptions">Table A.6, “Remoting Module Options”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_certificate">Table A.7, “<code class="code">Certificate</code>”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_certificatemoduleoptions">Table A.8, “<code class="code">Certificate</code> Module Options”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_certificateroles">Table A.9, “<code class="code">CertificateRoles</code>”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_certificaterolesmoduleoptions">Table A.10, “<code class="code">CertificateRoles</code> Module Options”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_database">Table A.11, “<code class="code">Database</code>”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_databasemoduleoptions">Table A.12, “<code class="code">Database</code> Module Options”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_databasecertificate">Table A.13, “<code class="code">DatabaseCertificate</code>”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_databasecertificatemoduleoptions">Table A.14, “<code class="code">DatabaseCertificate</code> Module Options”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_identity">Table A.15, “<code class="code">Identity</code>”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_identitymoduleoptions">Table A.16, “<code class="code">Identity</code> Module Options”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_ldap">Table A.17, “<code class="code">Ldap</code>”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_ldapmoduleoptions">Table A.18, “<code class="code">Ldap</code> Module Options”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_ldapextended">Table A.19, “<code class="code">LdapExtended</code>”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_ldapextendedmoduleoptions">Table A.20, “<code class="code">LdapExtended</code> Module Options”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_rolemapping">Table A.21, “<code class="code">RoleMapping</code>”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_rolemappingmoduleoptions">Table A.22, “<code class="code">RoleMapping</code> Module Options”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_runas">Table A.23, “<code class="code">RunAs</code>”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_runasoptions">Table A.24, “<code class="code">RunAs</code> Options”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_simple">Table A.25, “<code class="code">Simple</code>”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_configuredidentity">Table A.26, “<code class="code">ConfiguredIdentity</code>”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_configuredidentitymoduleoptions">Table A.27, “<code class="code">ConfiguredIdentity</code> Module Options”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_secureidentity">Table A.28, “<code class="code">SecureIdentity</code>”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_secureidentitymoduleoptions">Table A.29, “<code class="code">SecureIdentity</code> Module Options”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_propertiesusers">Table A.30, “<code class="code">PropertiesUsers</code>”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_simpleusers">Table A.31, “<code class="code">SimpleUsers</code>”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_ldapusers">Table A.32, “<code class="code">LdapUsers</code>”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_kerberos">Table A.33, “<code class="code">Kerberos</code>”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_kerberosmoduleoptions">Table A.34, “<code class="code">Kerberos</code> Module Options”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_spnego">Table A.35, “<code class="code">SPNEGO</code>”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_spnegomoduleoptions">Table A.36, “<code class="code">SPNEGO</code> Module Options”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_advancedldap">Table A.37, “<code class="code">AdvancedLdap</code>”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_advancedldapmoduleoptions">Table A.38, “<code class="code">AdvancedLdap</code> Module Options”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_advancedadldap">Table A.39, “<code class="code">AdvancedADLdap</code>”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_usersroles">Table A.40, “<code class="code">UsersRoles</code>”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_usersrolesmoduleoptions">Table A.41, “<code class="code">UsersRoles</code> Module Options”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="#topic4732_custom">Custom Authentication Modules</a>
			</div></li></ul></div><div class="table" id="topic4732_realmdirect"><p class="title"><strong>Table A.1. <code class="code">RealmDirect</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="RealmDirect"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><tbody><tr><td> Code </td><td> <div class="para">
						<code class="code">RealmDirect</code>
					</div>
					 </td></tr><tr><td> Class </td><td> <div class="para">
						<code class="code">org.jboss.as.security.RealmDirectLoginModule</code>
					</div>
					 </td></tr><tr><td> Description </td><td> <div class="para">
						A login module implementation to interface directly with the security realm. This login module allows all interactions with the backing store to be delegated to the realm removing the need for any duplicate and synchronized definitions. Used for remoting calls and management interface.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_realmdirectmoduleoptions"><p class="title"><strong>Table A.2. <code class="code">RealmDirect</code> Module Options</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows" summary="RealmDirect Module Options"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707307175504" scope="col"> Option </th><th id="idm140707325028800" scope="col"> Type </th><th id="idm140707313922576" scope="col"> Default </th><th id="idm140707312378384" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140707307175504"> <code class="code">realm</code> </td><td headers="idm140707325028800"> <div class="para">
						string
					</div>
					 </td><td headers="idm140707313922576"> <div class="para">
						<code class="literal">ApplicationRealm</code>
					</div>
					 </td><td headers="idm140707312378384"> <div class="para">
						Name of the desired realm.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_client"><p class="title"><strong>Table A.3. <code class="code">Client</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="Client"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><tbody><tr><td> Code </td><td> <div class="para">
						<code class="code">Client</code>
					</div>
					 </td></tr><tr><td> Class </td><td> <div class="para">
						<code class="code">org.jboss.security.ClientLoginModule</code>
					</div>
					 </td></tr><tr><td> Description </td><td> <div class="para">
						This login module is designed to establish caller identity and credentials when JBoss EAP 6 is acting as a client. It should never be used as part of a security domain used for server authentication.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_clientmoduleoptions"><p class="title"><strong>Table A.4. <code class="code">Client</code> Module Options</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows" summary="Client Module Options"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707334264896" scope="col"> Option </th><th id="idm140707325682224" scope="col"> Type </th><th id="idm140707330975168" scope="col"> Default </th><th id="idm140707324634192" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140707334264896"> <code class="code">multi-threaded</code> </td><td headers="idm140707325682224"> <div class="para">
						<code class="literal">true</code> or <code class="literal">false</code>
					</div>
					 </td><td headers="idm140707330975168"> <div class="para">
						<code class="literal">false</code>
					</div>
					 </td><td headers="idm140707324634192"> <div class="para">
						Set to true if each thread has its own principal and credential storage. Set to false to indicate that all threads in the VM share the same identity and credential.
					</div>
					 </td></tr><tr><td headers="idm140707334264896"> <div class="para">
						<code class="code">password-stacking</code>
					</div>
					 </td><td headers="idm140707325682224"> <div class="para">
						<code class="literal">useFirstPass</code> or <code class="literal">false</code>
					</div>
					 </td><td headers="idm140707330975168"> <div class="para">
						<code class="literal">false</code>
					</div>
					 </td><td headers="idm140707324634192"> <div class="para">
						Set to <code class="literal">useFirstPass</code> to indicate that this login module should look for information stored in the <code class="literal">LoginContext</code> to use as the identity. This option can be used when stacking other login modules with this one.
					</div>
					 </td></tr><tr><td headers="idm140707334264896"> <div class="para">
						<code class="literal">restore-login-identity</code>
					</div>
					 </td><td headers="idm140707325682224"> <div class="para">
						<code class="literal">true</code> or <code class="literal">false</code>
					</div>
					 </td><td headers="idm140707330975168"> <div class="para">
						<code class="literal">false</code>
					</div>
					 </td><td headers="idm140707324634192"> <div class="para">
						Set to true if the identity and credential seen at the start of the <code class="methodname">login()</code> method should be restored after the <code class="methodname">logout()</code> method is invoked.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_remoting"><p class="title"><strong>Table A.5. <code class="code">Remoting</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="Remoting"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><tbody><tr><td> Code </td><td> <div class="para">
						<code class="code">Remoting</code>
					</div>
					 </td></tr><tr><td> Class </td><td> <div class="para">
						<code class="code">org.jboss.as.security.remoting.RemotingLoginModule</code>
					</div>
					 </td></tr><tr><td> Description </td><td> <div class="para">
						This login module is used to check if the request currently being authenticated is a request received over a Remoting connection, and if so the identity that was created during the Remoting authentication process is used and associated with the current request. If the request did not arrive over a Remoting connection this module does nothing and allows the JAAS based login to continue to the next module.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_remotingmoduleoptions"><p class="title"><strong>Table A.6. Remoting Module Options</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows" summary="Remoting Module Options"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707311482880" scope="col"> Option </th><th id="idm140707311482400" scope="col"> Type </th><th id="idm140707325055984" scope="col"> Default </th><th id="idm140707341373952" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140707311482880"> <code class="code">password-stacking</code> </td><td headers="idm140707311482400"> <div class="para">
						<code class="literal">useFirstPass</code> or <code class="literal">false</code>
					</div>
					 </td><td headers="idm140707325055984"> <div class="para">
						<code class="literal">false</code>
					</div>
					 </td><td headers="idm140707341373952"> <div class="para">
						A value of <code class="literal">useFirstPass</code> indicates that this login module should first look to the information stored in the <code class="literal">LoginContext</code> for the identity. This option can be used when stacking other login modules with this one.
					</div>
					 </td></tr><tr><td headers="idm140707311482880"> <div class="para">
						<code class="code">principalClass</code>
					</div>
					 </td><td headers="idm140707311482400"> <div class="para">
						A fully-qualified classname.
					</div>
					 </td><td headers="idm140707325055984"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707341373952"> <div class="para">
						A <code class="code">Principal</code> implementation class which contains a constructor that takes String arguments for the principal name.
					</div>
					 </td></tr><tr><td headers="idm140707311482880"> <div class="para">
						<code class="code">unauthenticatedIdentity</code>
					</div>
					 </td><td headers="idm140707311482400"> <div class="para">
						A principal name.
					</div>
					 </td><td headers="idm140707325055984"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707341373952"> <div class="para">
						Defines the principal name assigned to requests which contain no authentication information. This can allow unprotected servlets to invoke methods on EJBs that do not require a specific role. Such a principal has no associated roles and can only access unsecured EJBs or EJB methods that are associated with the <code class="code">unchecked permission</code> constraint.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_certificate"><p class="title"><strong>Table A.7. <code class="code">Certificate</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="Certificate"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><tbody><tr><td> Code </td><td> <div class="para">
						<code class="code">Certificate</code>
					</div>
					 </td></tr><tr><td> Class </td><td> <div class="para">
						<code class="code">org.jboss.security.auth.spi.BaseCertLoginModule</code>
					</div>
					 </td></tr><tr><td> Description </td><td> <div class="para">
						This login module is designed to authenticate users based on <code class="code">X509 Certificates</code>. A use case for this is <code class="literal">CLIENT-CERT</code> authentication of a web application.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_certificatemoduleoptions"><p class="title"><strong>Table A.8. <code class="code">Certificate</code> Module Options</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows" summary="Certificate Module Options"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707319678096" scope="col"> Option </th><th id="idm140707319677616" scope="col"> Type </th><th id="idm140707315748896" scope="col"> Default </th><th id="idm140707326612976" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140707319678096"> <div class="para">
						<code class="code">securityDomain</code>
					</div>
					 </td><td headers="idm140707319677616"> string </td><td headers="idm140707315748896"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707326612976"> <div class="para">
						Name of the security domain that has the JSSE configuration for the truststore holding the trusted certificates.
					</div>
					 </td></tr><tr><td headers="idm140707319678096"> <div class="para">
						<code class="code">verifier</code>
					</div>
					 </td><td headers="idm140707319677616"> class </td><td headers="idm140707315748896"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707326612976"> <div class="para">
						The class name of the <code class="code">org.jboss.security.auth.certs.X509CertificateVerifier</code> to use for verification of the login certificate.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_certificateroles"><p class="title"><strong>Table A.9. <code class="code">CertificateRoles</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="CertificateRoles"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><tbody><tr><td> Code </td><td> <div class="para">
						<code class="code">CertificateRoles</code>
					</div>
					 </td></tr><tr><td> Class </td><td> <div class="para">
						<code class="code">org.jboss.security.auth.spi.CertRolesLoginModule</code>
					</div>
					 </td></tr><tr><td> Description </td><td> <div class="para">
						This login module extends the Certificate login module to add role mapping capabilities from a properties file. It takes all of the same options as the Certificate login module, and adds the following options.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_certificaterolesmoduleoptions"><p class="title"><strong>Table A.10. <code class="code">CertificateRoles</code> Module Options</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows" summary="CertificateRoles Module Options"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707338077872" scope="col"> Option </th><th id="idm140707321076736" scope="col"> Type </th><th id="idm140707316460624" scope="col"> Default </th><th id="idm140707316460144" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140707338077872"> <div class="para">
						<code class="code">rolesProperties</code>
					</div>
					 </td><td headers="idm140707321076736"> string </td><td headers="idm140707316460624"> <div class="para">
						<code class="literal">roles.properties</code>
					</div>
					 </td><td headers="idm140707316460144"> <div class="para">
						The name of the resource or file containing the roles to assign to each user. The role properties file must be in the format <code class="literal">username=role1,role2</code> where the username is the DN of the certificate, escaping any <code class="literal">=</code> (equals) and space characters. The following example is in the correct format:
					</div>
					 
<pre class="screen">CN\=unit-tests-client,\ OU\=Red\ Hat\ Inc.,\ O\=Red\ Hat\ Inc.,\ ST\=North\ Carolina,\ C\=US</pre>
					 </td></tr><tr><td headers="idm140707338077872"> <div class="para">
						<code class="code">defaultRolesProperties</code>
					</div>
					 </td><td headers="idm140707321076736"> string </td><td headers="idm140707316460624"> <div class="para">
						<code class="literal">defaultRoles.properties</code>
					</div>
					 </td><td headers="idm140707316460144"> <div class="para">
						Name of the resource or file to fall back to if the <code class="code">rolesProperties</code> file cannot be found.
					</div>
					 </td></tr><tr><td headers="idm140707338077872"> <div class="para">
						<code class="code">roleGroupSeparator</code>
					</div>
					 </td><td headers="idm140707321076736"> A single character. </td><td headers="idm140707316460624"> <div class="para">
						<code class="literal">.</code> (a single period)
					</div>
					 </td><td headers="idm140707316460144"> <div class="para">
						Which character to use as the role group separator in the <code class="code">rolesProperties</code> file.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_database"><p class="title"><strong>Table A.11. <code class="code">Database</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="Database"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><tbody><tr><td> Code </td><td> <code class="code">Database</code> </td></tr><tr><td> Class </td><td> <div class="para">
						<code class="code">org.jboss.security.auth.spi.DatabaseServerLoginModule</code>
					</div>
					 </td></tr><tr><td> Description </td><td> <div class="para">
						A JDBC-based login module that supports authentication and role mapping. It is based on two logical tables, with the following definitions.
					</div>
					 <div class="itemizedlist"><ul><li class="listitem"><div class="para">
								<code class="code">Principals: PrincipalID (text), Password (text)</code>
							</div></li><li class="listitem"><div class="para">
								<code class="code">Roles: PrincipalID (text), Role (text), RoleGroup (text)</code>
							</div></li></ul></div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_databasemoduleoptions"><p class="title"><strong>Table A.12. <code class="code">Database</code> Module Options</strong></p><div class="table-contents"><table class="gt-4-cols gt-7-rows" summary="Database Module Options"><colgroup><col width="20%" class="c1"><!--Empty--></col><col width="20%" class="c2"><!--Empty--></col><col width="20%" class="c3"><!--Empty--></col><col width="40%" class="c4"><!--Empty--></col></colgroup><thead><tr><th id="idm140707334283984" scope="col"> Option </th><th id="idm140707317361392" scope="col"> Type </th><th id="idm140707317360912" scope="col"> Default </th><th id="idm140707315341072" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140707334283984"> <div class="para">
						<code class="code">digestCallback</code>
					</div>
					 </td><td headers="idm140707317361392"> A fully-qualified classname </td><td headers="idm140707317360912"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707315341072"> <div class="para">
						The class name of the <code class="classname">DigestCallback</code> implementation that includes pre/post digest content like salts for hashing the input password. Only used if <code class="code">hashAlgorithm</code> has been specified.
					</div>
					 </td></tr><tr><td headers="idm140707334283984"> <div class="para">
						<code class="code">dsJndiName</code>
					</div>
					 </td><td headers="idm140707317361392"> A JNDI resource </td><td headers="idm140707317360912"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707315341072"> <div class="para">
						The name of the JNDI resource storing the authentication information. This option is required.
					</div>
					 </td></tr><tr><td headers="idm140707334283984"> <div class="para">
						<code class="code">hashAlgorithm</code>
					</div>
					 </td><td headers="idm140707317361392"> String </td><td headers="idm140707317360912"> <div class="para">
						Use plain passwords
					</div>
					 </td><td headers="idm140707315341072"> <div class="para">
						The message digest algorithm used to hash passwords. Supported algorithms depend on the Java Security Provider, but the following are supported: <code class="literal">MD5</code>, <code class="literal">SHA-1</code>, and <code class="literal">SHA-256</code>.
					</div>
					 </td></tr><tr><td headers="idm140707334283984"> <div class="para">
						<code class="code">hashCharset</code>
					</div>
					 </td><td headers="idm140707317361392"> String </td><td headers="idm140707317360912"> <div class="para">
						The platform's default encoding
					</div>
					 </td><td headers="idm140707315341072"> <div class="para">
						The name of the charset/encoding to use when converting the password String to a byte array. This includes all supported Java charset names.
					</div>
					 </td></tr><tr><td headers="idm140707334283984"> <div class="para">
						<code class="code">hashEncoding</code>
					</div>
					 </td><td headers="idm140707317361392"> String </td><td headers="idm140707317360912"> <div class="para">
						Base64
					</div>
					 </td><td headers="idm140707315341072"> <div class="para">
						The string encoding format to use.
					</div>
					 </td></tr><tr><td headers="idm140707334283984"> <div class="para">
						<code class="code">ignorePasswordCase</code>
					</div>
					 </td><td headers="idm140707317361392"> boolean </td><td headers="idm140707317360912"> <div class="para">
						false
					</div>
					 </td><td headers="idm140707315341072"> <div class="para">
						A flag indicating if the password comparison should ignore case.
					</div>
					 </td></tr><tr><td headers="idm140707334283984"> <div class="para">
						<code class="code">inputValidator</code>
					</div>
					 </td><td headers="idm140707317361392"> A fully-qualified classname </td><td headers="idm140707317360912"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707315341072"> <div class="para">
						The instance of the InputValidator implementation used to validate the username and password supplied by the client.
					</div>
					 </td></tr><tr><td headers="idm140707334283984"> <div class="para">
						<code class="code">principalsQuery</code>
					</div>
					 </td><td headers="idm140707317361392"> prepared SQL statement </td><td headers="idm140707317360912"> <div class="para">
						<code class="literal">select Password from Principals where PrincipalID=?</code>
					</div>
					 </td><td headers="idm140707315341072"> <div class="para">
						The prepared SQL query to obtain the information about the principal.
					</div>
					 </td></tr><tr><td headers="idm140707334283984"> <div class="para">
						<code class="code">rolesQuery</code>
					</div>
					 </td><td headers="idm140707317361392"> prepared SQL statement </td><td headers="idm140707317360912"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707315341072"> <div class="para">
						The prepared SQL query to obtain the information about the roles. It should be equivalent to <code class="literal">select Role, RoleGroup from Roles where PrincipalID=?</code>, where Role is the role name and the RoleGroup column value should always be either <code class="literal">Roles</code> with a capital <code class="literal">R</code> or <code class="literal">CallerPrincipal</code>.
					</div>
					 </td></tr><tr><td headers="idm140707334283984"> <div class="para">
						<code class="code">storeDigestCallback</code>
					</div>
					 </td><td headers="idm140707317361392"> A fully-qualified classname </td><td headers="idm140707317360912"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707315341072"> <div class="para">
						The class name of the <code class="classname">DigestCallback</code> implementation that includes pre/post digest content like salts for hashing the store/expected password. Only used if <code class="code">hashStorePassword</code> or <code class="code">hashUserPassword</code> is <code class="literal">true</code> and <code class="code">hashAlgorithm</code> has been specified.
					</div>
					 </td></tr><tr><td headers="idm140707334283984"> <div class="para">
						<code class="code">suspendResume</code>
					</div>
					 </td><td headers="idm140707317361392"> boolean </td><td headers="idm140707317360912"> <div class="para">
						true
					</div>
					 </td><td headers="idm140707315341072"> <div class="para">
						Whether any existing JTA transaction should be suspended during database operations.
					</div>
					 </td></tr><tr><td headers="idm140707334283984"> <div class="para">
						<code class="code">throwValidatorError</code>
					</div>
					 </td><td headers="idm140707317361392"> boolean </td><td headers="idm140707317360912"> <div class="para">
						false
					</div>
					 </td><td headers="idm140707315341072"> <div class="para">
						A flag that indicates whether validation errors should be exposed to clients or not
					</div>
					 </td></tr><tr><td headers="idm140707334283984"> <div class="para">
						<code class="code">transactionManagerJndiName</code>
					</div>
					 </td><td headers="idm140707317361392"> JNDI Resource </td><td headers="idm140707317360912"> <div class="para">
						java:/TransactionManager
					</div>
					 </td><td headers="idm140707315341072"> <div class="para">
						The JNDI name of the transaction manager used by the login module.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_databasecertificate"><p class="title"><strong>Table A.13. <code class="code">DatabaseCertificate</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="DatabaseCertificate"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><tbody><tr><td> Code </td><td> <div class="para">
						<code class="code">DatabaseCertificate</code>
					</div>
					 </td></tr><tr><td> Class </td><td> <div class="para">
						<code class="code">org.jboss.security.auth.spi.DatabaseCertLoginModule</code>
					</div>
					 </td></tr><tr><td> Description </td><td> <div class="para">
						This login module extends the Certificate login module to add role mapping capabilities from a database table. It has the same options plus these additional options:
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_databasecertificatemoduleoptions"><p class="title"><strong>Table A.14. <code class="code">DatabaseCertificate</code> Module Options</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows" summary="DatabaseCertificate Module Options"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707330789280" scope="col"> Option </th><th id="idm140707315014320" scope="col"> Type </th><th id="idm140707315013840" scope="col"> Default </th><th id="idm140707315013360" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140707330789280"> <div class="para">
						<code class="code">dsJndiName</code>
					</div>
					 </td><td headers="idm140707315014320"> A JNDI resource </td><td headers="idm140707315013840"> <div class="para">
						<code class="literal"><!--Empty--></code>
					</div>
					 </td><td headers="idm140707315013360"> <div class="para">
						The name of the JNDI resource storing the authentication information. This option is required.
					</div>
					 </td></tr><tr><td headers="idm140707330789280"> <div class="para">
						<code class="code">rolesQuery</code>
					</div>
					 </td><td headers="idm140707315014320"> prepared SQL statement </td><td headers="idm140707315013840"> <div class="para">
						<code class="literal">select Role,RoleGroup from Roles where PrincipalID=?</code>
					</div>
					 </td><td headers="idm140707315013360"> <div class="para">
						SQL prepared statement to be executed in order to map roles. It should be an equivalent to <code class="literal">select Role, RoleGroup from Roles where PrincipalID=?</code>, where Role is the role name and the RoleGroup column value should always be either <code class="literal">Roles</code> with a capital <code class="literal">R</code> or <code class="literal">CallerPrincipal</code>.
					</div>
					 </td></tr><tr><td headers="idm140707330789280"> <div class="para">
						<code class="code">suspendResume</code>
					</div>
					 </td><td headers="idm140707315014320"> <div class="para">
						<code class="literal">true</code> or <code class="literal">false</code>
					</div>
					 </td><td headers="idm140707315013840"> <div class="para">
						<code class="literal">true</code>
					</div>
					 </td><td headers="idm140707315013360"> <div class="para">
						Whether any existing JTA transaction should be suspended during database operations.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_identity"><p class="title"><strong>Table A.15. <code class="code">Identity</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="Identity"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><tbody><tr><td> Code </td><td> <div class="para">
						<code class="code">Identity</code>
					</div>
					 </td></tr><tr><td> Class </td><td> <div class="para">
						<code class="code">org.jboss.security.auth.spi.IdentityLoginModule</code>
					</div>
					 </td></tr><tr><td> Description </td><td> <div class="para">
						Associates the principal specified in the module options with any subject authenticated against the module. The type of Principal class used is <code class="code">org.jboss.security.SimplePrincipal.</code>. If no principal option is specified a principal with the name of <code class="literal">guest</code> is used.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_identitymoduleoptions"><p class="title"><strong>Table A.16. <code class="code">Identity</code> Module Options</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows" summary="Identity Module Options"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707319194256" scope="col"> Option </th><th id="idm140707330426992" scope="col"> Type </th><th id="idm140707330426512" scope="col"> Default </th><th id="idm140707330426032" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140707319194256"> <div class="para">
						<code class="code">principal</code>
					</div>
					 </td><td headers="idm140707330426992"> String </td><td headers="idm140707330426512"> <div class="para">
						<code class="literal">guest</code>
					</div>
					 </td><td headers="idm140707330426032"> <div class="para">
						The name to use for the principal.
					</div>
					 </td></tr><tr><td headers="idm140707319194256"> <div class="para">
						<code class="code">roles</code>
					</div>
					 </td><td headers="idm140707330426992"> comma-separated list of strings </td><td headers="idm140707330426512"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707330426032"> <div class="para">
						A comma-delimited list of roles which will be assigned to the subject.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_ldap"><p class="title"><strong>Table A.17. <code class="code">Ldap</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="Ldap"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><tbody><tr><td> Code </td><td> <div class="para">
						<code class="code">Ldap</code>
					</div>
					 </td></tr><tr><td> Class </td><td> <div class="para">
						<code class="code">org.jboss.security.auth.spi.LdapLoginModule</code>
					</div>
					 </td></tr><tr><td> Description </td><td> <div class="para">
						Authenticates against an LDAP server, when the username and password are stored in an LDAP server that is accessible using a JNDI LDAP provider. Many of the options are not required, because they are determined by the LDAP provider or the environment.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_ldapmoduleoptions"><p class="title"><strong>Table A.18. <code class="code">Ldap</code> Module Options</strong></p><div class="table-contents"><table class="gt-4-cols gt-14-rows" summary="Ldap Module Options"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707313961712" scope="col"> Option </th><th id="idm140707313961232" scope="col"> Type </th><th id="idm140707323059472" scope="col"> Default </th><th id="idm140707323058992" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140707313961712"> <div class="para">
						<code class="code">java.naming.factory.initial</code>
					</div>
					 </td><td headers="idm140707313961232"> class name </td><td headers="idm140707323059472"> <div class="para">
						<code class="literal">com.sun.jndi.ldap.LdapCtxFactory</code>
					</div>
					 </td><td headers="idm140707323058992"> <div class="para">
						<code class="code">InitialContextFactory</code> implementation class name.
					</div>
					 </td></tr><tr><td headers="idm140707313961712"> <div class="para">
						<code class="code">java.naming.provider.url</code>
					</div>
					 </td><td headers="idm140707313961232"> <div class="para">
						<code class="literal">ldap://</code> URL
					</div>
					 </td><td headers="idm140707323059472"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707323058992"> <div class="para">
						URL for the LDAP server.
					</div>
					 </td></tr><tr><td headers="idm140707313961712"> <div class="para">
						<code class="code">java.naming.security.authentication</code>
					</div>
					 </td><td headers="idm140707313961232"> <div class="para">
						<code class="literal">none</code>, <code class="literal">simple</code>, or the name of a SASL mechanism
					</div>
					 </td><td headers="idm140707323059472"> <div class="para">
						<code class="literal">simple</code>
					</div>
					 </td><td headers="idm140707323058992"> <div class="para">
						The security level to use to bind to the LDAP server.
					</div>
					 </td></tr><tr><td headers="idm140707313961712"> <div class="para">
						<code class="code">java.naming.security.protocol</code>
					</div>
					 </td><td headers="idm140707313961232"> transport protocol </td><td headers="idm140707323059472"> <div class="para">
						If unspecified, determined by the provider.
					</div>
					 </td><td headers="idm140707323058992"> <div class="para">
						The transport protocol to use for secure access, such as SSL.
					</div>
					 </td></tr><tr><td headers="idm140707313961712"> <div class="para">
						<code class="code">java.naming.security.principal</code>
					</div>
					 </td><td headers="idm140707313961232"> string </td><td headers="idm140707323059472"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707323058992"> <div class="para">
						The name of the principal for authenticating the caller to the service. This is built from other properties described below.
					</div>
					 </td></tr><tr><td headers="idm140707313961712"> <div class="para">
						<code class="code">java.naming.security.credentials</code>
					</div>
					 </td><td headers="idm140707313961232"> credential type </td><td headers="idm140707323059472"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707323058992"> <div class="para">
						The type of credential used by the authentication scheme. Some examples include hashed password, clear-text password, key, or certificate. If this property is unspecified, the behavior is determined by the service provider.
					</div>
					 </td></tr><tr><td headers="idm140707313961712"> <div class="para">
						<code class="code">principalDNPrefix</code>
					</div>
					 </td><td headers="idm140707313961232"> string </td><td headers="idm140707323059472"> <div class="para">
						<code class="literal"><!--Empty--></code>
					</div>
					 </td><td headers="idm140707323058992"> <div class="para">
						Prefix added to the username to form the user DN. You can prompt the user for a username and build the fully-qualified DN by using the <code class="literal">principalDNPrefix</code> and <code class="literal">principalDNSuffix</code>.
					</div>
					 </td></tr><tr><td headers="idm140707313961712"> <div class="para">
						<code class="code">principalDNSuffix</code>
					</div>
					 </td><td headers="idm140707313961232"> string </td><td headers="idm140707323059472"> <div class="para">
						<code class="literal"><!--Empty--></code>
					</div>
					 </td><td headers="idm140707323058992"> <div class="para">
						Suffix added to the username to form the user DN. You can prompt the user for a username and build the fully-qualified DN by using the <code class="literal">principalDNPrefix</code> and <code class="literal">principalDNSuffix</code>.
					</div>
					 </td></tr><tr><td headers="idm140707313961712"> <div class="para">
						<code class="code">useObjectCredential</code>
					</div>
					 </td><td headers="idm140707313961232"> <div class="para">
						<code class="literal">true</code> or <code class="literal">false</code>
					</div>
					 </td><td headers="idm140707323059472"> <div class="para">
						false
					</div>
					 </td><td headers="idm140707323058992"> <div class="para">
						Whether the credential should be obtained as an opaque Object using the <code class="classname">org.jboss.security.auth.callback.ObjectCallback</code> type of Callback rather than as a <code class="literal">char[]</code> password using a JAAS PasswordCallback. This allows for passing <code class="literal">non-char[]</code> credential information to the LDAP server.
					</div>
					 </td></tr><tr><td headers="idm140707313961712"> <div class="para">
						<code class="code">rolesCtxDN</code>
					</div>
					 </td><td headers="idm140707313961232"> fully-qualified DN </td><td headers="idm140707323059472"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707323058992"> <div class="para">
						The fully-qualified DN for the context to search for user roles.
					</div>
					 </td></tr><tr><td headers="idm140707313961712"> <div class="para">
						<code class="code">userRolesCtxDNAttributeName</code>
					</div>
					 </td><td headers="idm140707313961232"> <div class="para">
						attribute
					</div>
					 </td><td headers="idm140707323059472"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707323058992"> <div class="para">
						The attribute in the user object that contains the DN for the context to search for user roles. This differs from <code class="code">rolesCtxDN</code> in that the context to search for a user's roles may be unique for each user.
					</div>
					 </td></tr><tr><td headers="idm140707313961712"> <div class="para">
						<code class="code">roleAttributeID</code>
					</div>
					 </td><td headers="idm140707313961232"> attribute </td><td headers="idm140707323059472"> <div class="para">
						<code class="literal">roles</code>
					</div>
					 </td><td headers="idm140707323058992"> <div class="para">
						Name of the attribute containing the user roles.
					</div>
					 </td></tr><tr><td headers="idm140707313961712"> <div class="para">
						<code class="code">roleAttributeIsDN</code>
					</div>
					 </td><td headers="idm140707313961232"> <div class="para">
						<code class="literal">true</code> or <code class="literal">false</code>
					</div>
					 </td><td headers="idm140707323059472"> <div class="para">
						<code class="literal">false</code>
					</div>
					 </td><td headers="idm140707323058992"> <div class="para">
						Whether or not the <code class="code">roleAttributeID</code> contains the fully-qualified DN of a role object. If false, the role name is taken from the value of the <code class="code">roleNameAttributeId</code> attribute of the context name. Certain directory schemas, such as Microsoft Active Directory, require this attribute to be set to <code class="literal">true</code>.
					</div>
					 </td></tr><tr><td headers="idm140707313961712"> <div class="para">
						<code class="code">roleNameAttributeID</code>
					</div>
					 </td><td headers="idm140707313961232"> attribute </td><td headers="idm140707323059472"> <div class="para">
						<code class="literal">name</code>
					</div>
					 </td><td headers="idm140707323058992"> <div class="para">
						Name of the attribute within the <code class="code">roleCtxDN</code> context which contains the role name. If the <code class="code">roleAttributeIsDN</code> property is set to <code class="literal">true</code>, this property is used to find the role object's name attribute.
					</div>
					 </td></tr><tr><td headers="idm140707313961712"> <div class="para">
						<code class="code">uidAttributeID</code>
					</div>
					 </td><td headers="idm140707313961232"> attribute </td><td headers="idm140707323059472"> <div class="para">
						<code class="literal">uid</code>
					</div>
					 </td><td headers="idm140707323058992"> <div class="para">
						Name of the attribute in the <code class="code">UserRolesAttributeDN</code> that corresponds to the user ID. This is used to locate the user roles.
					</div>
					 </td></tr><tr><td headers="idm140707313961712"> <div class="para">
						<code class="code">matchOnUserDN</code>
					</div>
					 </td><td headers="idm140707313961232"> <div class="para">
						<code class="literal">true</code> or <code class="literal">false</code>
					</div>
					 </td><td headers="idm140707323059472"> <div class="para">
						<code class="literal">false</code>
					</div>
					 </td><td headers="idm140707323058992"> <div class="para">
						Whether or not the search for user roles should match on the user's fully-distinguished DN or the username only. If <code class="literal">true</code>, the full user DN is used as the match value. If <code class="literal">false</code>, only the username is used as the match value against the <code class="code">uidAttributeName</code> attribute.
					</div>
					 </td></tr><tr><td headers="idm140707313961712"> <div class="para">
						<code class="code">allowEmptyPasswords</code>
					</div>
					 </td><td headers="idm140707313961232"> <div class="para">
						<code class="literal">true</code> or <code class="literal">false</code>
					</div>
					 </td><td headers="idm140707323059472"> <div class="para">
						<code class="literal">false</code>
					</div>
					 </td><td headers="idm140707323058992"> <div class="para">
						Whether to allow empty passwords. Most LDAP servers treat empty passwords as anonymous login attempts. To reject empty passwords, set this to <code class="literal">false</code>.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_ldapextended"><p class="title"><strong>Table A.19. <code class="code">LdapExtended</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="LdapExtended"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><tbody><tr><td> Code </td><td> <div class="para">
						<code class="code">LdapExtended</code>
					</div>
					 </td></tr><tr><td> Class </td><td> <div class="para">
						<code class="code">org.jboss.security.auth.spi.LdapExtLoginModule</code>
					</div>
					 </td></tr><tr><td> Description </td><td> <div class="para">
						An alternate LDAP login module implementation that uses searches to locate the bind user and associated roles. The roles query recursively follows DNs to navigate a hierarchical role structure. It uses the same <code class="literal">java.naming</code> options as the Ldap module, and uses the following options instead of the other options of the Ldap module.
					</div>
					 <div class="para">
						The authentication happens in 2 steps:
					</div>
					 <div class="orderedlist"><ol><li class="listitem"><div class="para">
								An initial bind to the LDAP server is done using the bindDN and <code class="code">bindCredential</code> options. The <code class="code">bindDN</code> is a LDAP user with the ability to search both the baseCtxDN and <code class="code">rolesCtxDN</code> trees for the user and roles. The user DN to authenticate against is queried using the filter specified by the <code class="code">baseFilter</code> attribute.
							</div></li><li class="listitem"><div class="para">
								The resulting user DN is authenticated by binding to the LDAP server using the user DN as the <code class="code">InitialLdapContext</code> environment <code class="code">Context.SECURITY_PRINCIPAL</code>. The <code class="code">Context.SECURITY_CREDENTIALS</code> property is set to the String password obtained by the callback handler.
							</div></li></ol></div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_ldapextendedmoduleoptions"><p class="title"><strong>Table A.20. <code class="code">LdapExtended</code> Module Options</strong></p><div class="table-contents"><table class="gt-4-cols gt-14-rows" summary="LdapExtended Module Options"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707335471024" scope="col"> Option </th><th id="idm140707335470544" scope="col"> Type </th><th id="idm140707322341456" scope="col"> Default </th><th id="idm140707322340976" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140707335471024"> <div class="para">
						<code class="code">baseCtxDN</code>
					</div>
					 </td><td headers="idm140707335470544"> fully-qualified DN </td><td headers="idm140707322341456"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707322340976"> <div class="para">
						The fixed DN of the top-level context to begin the user search.
					</div>
					 </td></tr><tr><td headers="idm140707335471024"> <div class="para">
						<code class="code">bindDN</code>
					</div>
					 </td><td headers="idm140707335470544"> fully-qualified DN </td><td headers="idm140707322341456"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707322340976"> <div class="para">
						The DN used to bind against the LDAP server for the user and roles queries. This DN needs read and search permissions on the <code class="code">baseCtxDN</code> and <code class="code">rolesCtxDN</code> values.
					</div>
					 </td></tr><tr><td headers="idm140707335471024"> <div class="para">
						<code class="code">bindCredential</code>
					</div>
					 </td><td headers="idm140707335470544"> string, optionally encrypted </td><td headers="idm140707322341456"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707322340976"> <div class="para">
						Password stored as plain text for the <code class="code">bindDN</code>, or loaded externally using <code class="code">EXT</code> command. This password can be encrypted using the vault mechanism. You can use the following formats:
					</div>
					 <div class="itemizedlist"><ul><li class="listitem"><div class="para">
								<code class="code">{EXT}...</code> where the <code class="code">...</code> is the required external command. Example: <code class="code">{EXT}cat /mysecretpasswordfile</code>
							</div></li><li class="listitem"><div class="para">
								<code class="code">{EXTC[:expiration_in_millis]}...</code> where the <code class="code">...</code> is the command that will be passed to the <code class="code">Runtime.exec(String)</code> method to execute a platform command. The first line of the command output is used as the password.
							</div><div class="para">
								<code class="code">EXTC</code> variant caches the passwords for <code class="code">expiration_in_millis</code> milliseconds. Default cache expiration is 0 = infinity.
							</div></li><li class="listitem"><div class="para">
								<code class="code">{CLASS}classname[:ctorargs]</code> where the <code class="code">[:ctorargs]</code> is an optional string delimited by the <code class="code">:</code> from the classname that will be passed to the classname <code class="code">ctor</code>. The <code class="code">ctorargs</code> itself is a comma delimited list of strings.
							</div><div class="para">
								The password is obtained from classname by invoking a <code class="code">char[] toCharArray()</code> method if found, otherwise, the <code class="code">String toString()</code> method is used.
							</div></li></ul></div>
					 <div class="para">
						See the following topic to read more about encrypting sensitive strings: <a class="xref" href="#Create_a_Java_Keystore_to_Store_Sensitive_Strings">Section 10.11.2, “Create a Java Keystore to Store Sensitive Strings”</a>
					</div>
					 </td></tr><tr><td headers="idm140707335471024"> <div class="para">
						<code class="code">baseFilter</code>
					</div>
					 </td><td headers="idm140707335470544"> LDAP filter string </td><td headers="idm140707322341456"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707322340976"> <div class="para">
						A search filter used to locate the context of the user to authenticate. The input username or <code class="literal">userDN</code> obtained from the login module callback is substituted into the filter anywhere a <code class="literal">{0}</code> expression is used. A common example for the search filter is <code class="literal">(uid={0})</code>.
					</div>
					 </td></tr><tr><td headers="idm140707335471024"> <div class="para">
						<code class="code">rolesCtxDN</code>
					</div>
					 </td><td headers="idm140707335470544"> fully-qualified DN </td><td headers="idm140707322341456"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707322340976"> <div class="para">
						The fixed DN of the context to search for user roles. This is not the DN where the actual roles are, but the DN where the objects containing the user roles are. For example, in a Microsoft Active Directory server, this is the DN where the user account is.
					</div>
					 </td></tr><tr><td headers="idm140707335471024"> <div class="para">
						<code class="code">roleFilter</code>
					</div>
					 </td><td headers="idm140707335470544"> LDAP filter string </td><td headers="idm140707322341456"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707322340976"> <div class="para">
						A search filter used to locate the roles associated with the authenticated user. The input username or <code class="literal">userDN</code> obtained from the login module callback is substituted into the filter anywhere a <code class="literal">{0}</code> expression is used. The authenticated <code class="literal">userDN</code> is substituted into the filter anywhere a <code class="literal">{1}</code> is used. An example search filter that matches on the input username is <code class="code">(member={0})</code>. An alternative that matches on the authenticated <code class="literal">userDN</code> is <code class="code">(member={1})</code>.
					</div>
					 </td></tr><tr><td headers="idm140707335471024"> <code class="code">roleAttributeIsDN</code> </td><td headers="idm140707335470544"> <div class="para">
						<code class="literal">true</code> or <code class="literal">false</code>
					</div>
					 </td><td headers="idm140707322341456"> <div class="para">
						<code class="literal">false</code>
					</div>
					 </td><td headers="idm140707322340976"> <div class="para">
						Whether or not the <code class="code">roleAttributeID</code> contains the fully-qualified DN of a role object. If false, the role name is taken from the value of the <code class="code">roleNameAttributeId</code> attribute of the context name. Certain directory schemas, such as Microsoft Active Directory, require this attribute to be set to <code class="literal">true</code>.
					</div>
					 </td></tr><tr><td headers="idm140707335471024"> <div class="para">
						<code class="code">defaultRole</code>
					</div>
					 </td><td headers="idm140707335470544"> <div class="para">
						Role name
					</div>
					 </td><td headers="idm140707322341456"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707322340976"> <div class="para">
						A role included for all authenticated users
					</div>
					 </td></tr><tr><td headers="idm140707335471024"> <div class="para">
						<code class="code">parseRoleNameFromDN</code>
					</div>
					 </td><td headers="idm140707335470544"> <div class="para">
						<code class="code">true</code> or <code class="code">false</code>
					</div>
					 </td><td headers="idm140707322341456"> <div class="para">
						<code class="code">false</code>
					</div>
					 </td><td headers="idm140707322340976"> <div class="para">
						A flag indicating if the DN returned by a query contains the roleNameAttributeID. If set to <code class="code">true</code>, the DN is checked for the roleNameATtributeID. If set to <code class="code">false</code>, the DN is not checked for the roleNameAttributeID. This flag can improve the performance of LDAP queries.
					</div>
					 </td></tr><tr><td headers="idm140707335471024"> <div class="para">
						<code class="code">parseUsername</code>
					</div>
					 </td><td headers="idm140707335470544"> <div class="para">
						<code class="code">true</code> or <code class="code">false</code>
					</div>
					 </td><td headers="idm140707322341456"> <div class="para">
						<code class="code">false</code>
					</div>
					 </td><td headers="idm140707322340976"> <div class="para">
						A flag indicating if the DN is to be parsed for the username. If set to <code class="code">true</code>, the DN is parsed for the username. If set to <code class="code">false</code> the DN is not parsed for the username. This option is used together with usernameBeginString and usernameEndString.
					</div>
					 </td></tr><tr><td headers="idm140707335471024"> <div class="para">
						<code class="code">usernameBeginString</code>
					</div>
					 </td><td headers="idm140707335470544"> <div class="para">
						string
					</div>
					 </td><td headers="idm140707322341456"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707322340976"> <div class="para">
						Defines the string which is to be removed from the start of the DN to reveal the username. This option is used together with <code class="code">usernameEndString</code>.
					</div>
					 </td></tr><tr><td headers="idm140707335471024"> <div class="para">
						<code class="code">usernameEndString</code>
					</div>
					 </td><td headers="idm140707335470544"> <div class="para">
						string
					</div>
					 </td><td headers="idm140707322341456"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707322340976"> <div class="para">
						Defines the string which is to be removed from the end of the DN to reveal the username. This option is used together with <code class="code">usernameBeginString</code>.
					</div>
					 </td></tr><tr><td headers="idm140707335471024"> <div class="para">
						<code class="code">roleNameAttributeID</code>
					</div>
					 </td><td headers="idm140707335470544"> attribute </td><td headers="idm140707322341456"> <div class="para">
						<code class="literal">name</code>
					</div>
					 </td><td headers="idm140707322340976"> <div class="para">
						Name of the attribute within the <code class="code">roleCtxDN</code> context which contains the role name. If the <code class="code">roleAttributeIsDN</code> property is set to <code class="literal">true</code>, this property is used to find the role object's name attribute.
					</div>
					 </td></tr><tr><td headers="idm140707335471024"> <div class="para">
						<code class="code">distinguishedNameAttribute</code>
					</div>
					 </td><td headers="idm140707335470544"> attribute </td><td headers="idm140707322341456"> <div class="para">
						<code class="literal">distinguishedName</code>
					</div>
					 </td><td headers="idm140707322340976"> <div class="para">
						The name of the attribute in the user entry that contains the DN of the user. This may be necessary if the DN of the user itself contains special characters (backslash for example) that prevent correct user mapping. If the attribute does not exist, the entry's DN is used.
					</div>
					 </td></tr><tr><td headers="idm140707335471024"> <div class="para">
						<code class="code">roleRecursion</code>
					</div>
					 </td><td headers="idm140707335470544"> integer </td><td headers="idm140707322341456"> <div class="para">
						<code class="literal">0</code>
					</div>
					 </td><td headers="idm140707322340976"> <div class="para">
						The numbers of levels of recursion the role search will go below a matching context. Disable recursion by setting this to <code class="literal">0</code>.
					</div>
					 </td></tr><tr><td headers="idm140707335471024"> <div class="para">
						<code class="code">searchTimeLimit</code>
					</div>
					 </td><td headers="idm140707335470544"> integer </td><td headers="idm140707322341456"> <div class="para">
						<code class="literal">10000</code> (10 seconds)
					</div>
					 </td><td headers="idm140707322340976"> <div class="para">
						The timeout in milliseconds for user or role searches.
					</div>
					 </td></tr><tr><td headers="idm140707335471024"> <div class="para">
						<code class="code">searchScope</code>
					</div>
					 </td><td headers="idm140707335470544"> <div class="para">
						One of: <code class="literal">OBJECT_SCOPE, ONELEVEL_SCOPE, SUBTREE_SCOPE</code>
					</div>
					 </td><td headers="idm140707322341456"> <div class="para">
						<code class="literal">SUBTREE_SCOPE</code>
					</div>
					 </td><td headers="idm140707322340976"> <div class="para">
						The search scope to use.
					</div>
					 </td></tr><tr><td headers="idm140707335471024"> <div class="para">
						<code class="code">allowEmptyPasswords</code>
					</div>
					 </td><td headers="idm140707335470544"> <div class="para">
						<code class="literal">true</code> or <code class="literal">false</code>
					</div>
					 </td><td headers="idm140707322341456"> <div class="para">
						<code class="literal">false</code>
					</div>
					 </td><td headers="idm140707322340976"> <div class="para">
						Whether to allow empty passwords. Most LDAP servers treat empty passwords as anonymous login attempts. To reject empty passwords, set this to false.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_rolemapping"><p class="title"><strong>Table A.21. <code class="code">RoleMapping</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="RoleMapping"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><tbody><tr><td> Code </td><td> <div class="para">
						<code class="code">RoleMapping</code>
					</div>
					 </td></tr><tr><td> Class </td><td> <div class="para">
						<code class="code">org.jboss.security.auth.spi.RoleMappingLoginModule</code>
					</div>
					 </td></tr><tr><td> Description </td><td> <div class="para">
						Maps a role which is the end result of the authentication process to a declarative role. This module must be flagged as <code class="literal">optional</code> when you add it to the security domain.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_rolemappingmoduleoptions"><p class="title"><strong>Table A.22. <code class="code">RoleMapping</code> Module Options</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows" summary="RoleMapping Module Options"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707312319616" scope="col"> Option </th><th id="idm140707312319136" scope="col"> Type </th><th id="idm140707317964896" scope="col"> Default </th><th id="idm140707317964416" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140707312319616"> <div class="para">
						<code class="code">rolesProperties</code>
					</div>
					 </td><td headers="idm140707312319136"> The fully-qualified file path and name of a properties file or resource </td><td headers="idm140707317964896"> <div class="para">
						<code class="literal">none</code>
					</div>
					 </td><td headers="idm140707317964416"> <div class="para">
						The fully-qualified file path and name of a properties file or resource which maps roles to replacement roles. The format is <code class="code">original_role=role1,role2,role3</code>
					</div>
					 </td></tr><tr><td headers="idm140707312319616"> <div class="para">
						<code class="code">replaceRole</code>
					</div>
					 </td><td headers="idm140707312319136"> <div class="para">
						<code class="literal">true</code> or <code class="literal">false</code>
					</div>
					 </td><td headers="idm140707317964896"> <div class="para">
						<code class="literal">false</code>
					</div>
					 </td><td headers="idm140707317964416"> <div class="para">
						Whether to add to the current roles, or replace the current roles with the mapped ones. Replaces if set to <code class="literal">true</code>.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_runas"><p class="title"><strong>Table A.23. <code class="code">RunAs</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="RunAs"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><tbody><tr><td> Code </td><td> <div class="para">
						<code class="code">RunAs</code>
					</div>
					 </td></tr><tr><td> Class </td><td> <div class="para">
						<code class="code">org.jboss.security.auth.spi.RunAsLoginModule</code>
					</div>
					 </td></tr><tr><td> Description </td><td> <div class="para">
						A helper module that pushes a <code class="code">run as</code> role onto the stack for the duration of the login phase of authentication, and pops the <code class="code">run as</code> role off the stack in either the commit or abort phase. This login module provides a role for other login modules that must access secured resources in order to perform their authentication, such as a login module which accesses a secured EJB. <code class="code">RunAsLoginModule</code> must be configured before the login modules that require a <code class="code">run as</code> role to be established.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_runasoptions"><p class="title"><strong>Table A.24. <code class="code">RunAs</code> Options</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows" summary="RunAs Options"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707319855360" scope="col"> Option </th><th id="idm140707319854880" scope="col"> Type </th><th id="idm140707330660752" scope="col"> Default </th><th id="idm140707330660272" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140707319855360"> <div class="para">
						<code class="code">roleName</code>
					</div>
					 </td><td headers="idm140707319854880"> role name </td><td headers="idm140707330660752"> <div class="para">
						<code class="literal">nobody</code>
					</div>
					 </td><td headers="idm140707330660272"> <div class="para">
						The name of the role to use as the <code class="code">run as</code> role during the login phase.
					</div>
					 </td></tr><tr><td headers="idm140707319855360"> <div class="para">
						<code class="code">principalName</code>
					</div>
					 </td><td headers="idm140707319854880"> principal name </td><td headers="idm140707330660752"> <div class="para">
						<code class="literal">nobody</code>
					</div>
					 </td><td headers="idm140707330660272"> <div class="para">
						Name of the principal to use as the <code class="code">run as</code> principal during login phase. If not specified a default of <code class="code">nobody</code> is used.
					</div>
					 </td></tr><tr><td headers="idm140707319855360"> <div class="para">
						<code class="code">principalClass</code>
					</div>
					 </td><td headers="idm140707319854880"> A fully-qualified classname. </td><td headers="idm140707330660752"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707330660272"> <div class="para">
						A <code class="classname">Principal</code> implementation class which contains a constructor that takes String arguments for the principal name.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_simple"><p class="title"><strong>Table A.25. <code class="code">Simple</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="Simple"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><tbody><tr><td> Code </td><td> <div class="para">
						<code class="code">Simple</code>
					</div>
					 </td></tr><tr><td> Class </td><td> <div class="para">
						<code class="code">org.jboss.security.auth.spi.SimpleServerLoginModule</code>
					</div>
					 </td></tr><tr><td> Description </td><td> <div class="para">
						A module for quick setup of security for testing purposes. It implements the following simple algorithm:
					</div>
					 <div class="itemizedlist"><ul><li class="listitem"><div class="para">
								If the password is null, authenticate the user and assign an identity of <code class="literal">guest</code> and a role of <code class="literal">guest</code>.
							</div></li><li class="listitem"><div class="para">
								Otherwise, if the password is equal to the user, assign an identity equal to the username and both <code class="literal">admin</code> and <code class="literal">guest</code> roles.
							</div></li><li class="listitem"><div class="para">
								Otherwise, authentication fails.
							</div></li></ul></div>
					 </td></tr></tbody></table></div></div><div class="para"><div class="title"><code class="code">Simple</code> Module Options</div><p>
			The <code class="literal">Simple</code> module has no options.
		</p></div><div class="table" id="topic4732_configuredidentity"><p class="title"><strong>Table A.26. <code class="code">ConfiguredIdentity</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="ConfiguredIdentity"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><tbody><tr><td> Code </td><td> <div class="para">
						<code class="code">ConfiguredIdentity</code>
					</div>
					 </td></tr><tr><td> Class </td><td> <div class="para">
						<code class="code">org.picketbox.datasource.security.ConfiguredIdentityLoginModule</code>
					</div>
					 </td></tr><tr><td> Description </td><td> <div class="para">
						Associates the principal specified in the module options with any subject authenticated against the module. The type of Principal class used is <code class="code">org.jboss.security.SimplePrincipal</code>.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_configuredidentitymoduleoptions"><p class="title"><strong>Table A.27. <code class="code">ConfiguredIdentity</code> Module Options</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows" summary="ConfiguredIdentity Module Options"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707316513632" scope="col"> Option </th><th id="idm140707316513152" scope="col"> Type </th><th id="idm140707316512672" scope="col"> Default </th><th id="idm140707316512192" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140707316513632"> <div class="para">
						<code class="code">username</code>
					</div>
					 </td><td headers="idm140707316513152"> string </td><td headers="idm140707316512672"> none </td><td headers="idm140707316512192"> The username for authentication. </td></tr><tr><td headers="idm140707316513632"> <div class="para">
						<code class="code">password</code>
					</div>
					 </td><td headers="idm140707316513152"> encrypted string </td><td headers="idm140707316512672"> none </td><td headers="idm140707316512192"> <div class="para">
						The password to use for authentication. To encrypt the password, use the module directly at the command line.
					</div>
					 
<pre class="screen"><code class="prompt">java org.picketbox.datasource.security.SecureIdentityLoginModule <em class="replaceable">password_to_encrypt</em></code></pre>
					 <div class="para">
						Paste the result of this command into the module option's value field.
					</div>
					 </td></tr><tr><td headers="idm140707316513632"> <div class="para">
						<code class="code">principal</code>
					</div>
					 </td><td headers="idm140707316513152"> Name of a principal </td><td headers="idm140707316512672"> <div class="para">
						<code class="literal">none</code>
					</div>
					 </td><td headers="idm140707316512192"> <div class="para">
						The principal which will be associated with any subject authenticated against the module.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_secureidentity"><p class="title"><strong>Table A.28. <code class="code">SecureIdentity</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="SecureIdentity"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><tbody><tr><td> Code </td><td> <div class="para">
						<code class="code">SecureIdentity</code>
					</div>
					 </td></tr><tr><td> Class </td><td> <div class="para">
						<code class="code">org.picketbox.datasource.security.SecureIdentityLoginModule</code>
					</div>
					 </td></tr><tr><td> Description </td><td> <div class="para">
						This module is provided for legacy purposes. It allows you to encrypt a password and then use the encrypted password with a static principal. If your application uses <code class="code">SecureIdentity</code>, consider using a password vault mechanism instead.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_secureidentitymoduleoptions"><p class="title"><strong>Table A.29. <code class="code">SecureIdentity</code> Module Options</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows" summary="SecureIdentity Module Options"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707316429952" scope="col"> Option </th><th id="idm140707311660240" scope="col"> Type </th><th id="idm140707311659760" scope="col"> Default </th><th id="idm140707311659280" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140707316429952"> <div class="para">
						<code class="code">username</code>
					</div>
					 </td><td headers="idm140707311660240"> string </td><td headers="idm140707311659760"> none </td><td headers="idm140707311659280"> The username for authentication. </td></tr><tr><td headers="idm140707316429952"> <div class="para">
						<code class="code">password</code>
					</div>
					 </td><td headers="idm140707311660240"> encrypted string </td><td headers="idm140707311659760"> none </td><td headers="idm140707311659280"> <div class="para">
						The password to use for authentication. To encrypt the password, use the module directly at the command line.
					</div>
					 
<pre class="screen"><code class="prompt">java org.picketbox.datasource.security.SecureIdentityLoginModule <em class="replaceable">password_to_encrypt</em></code></pre>
					 <div class="para">
						Paste the result of this command into the module option's value field.
					</div>
					 </td></tr><tr><td headers="idm140707316429952"> <div class="para">
						<code class="code">managedConnectionFactoryName</code>
					</div>
					 </td><td headers="idm140707311660240"> JCA resource </td><td headers="idm140707311659760"> none </td><td headers="idm140707311659280"> <div class="para">
						The name of the JCA connection factory for your datasource.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_propertiesusers"><p class="title"><strong>Table A.30. <code class="code">PropertiesUsers</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="PropertiesUsers"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><tbody><tr><td> Code </td><td> <div class="para">
						<code class="code">PropertiesUsers</code>
					</div>
					 </td></tr><tr><td> Class </td><td> <div class="para">
						<code class="code">org.jboss.security.auth.spi.PropertiesUsersLoginModule</code>
					</div>
					 </td></tr><tr><td> Description </td><td> <div class="para">
						Uses a properties file to store usernames and passwords for authentication. No authorization (role mapping) is provided. This module is only appropriate for testing.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_simpleusers"><p class="title"><strong>Table A.31. <code class="code">SimpleUsers</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="SimpleUsers"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><tbody><tr><td> Code </td><td> <div class="para">
						<code class="code">SimpleUsers</code>
					</div>
					 </td></tr><tr><td> Class </td><td> <div class="para">
						<code class="code">org.jboss.security.auth.spi.SimpleUsersLoginModule</code>
					</div>
					 </td></tr><tr><td> Description </td><td> <div class="para">
						This login module stores the username and clear-text password using <em class="parameter"><code>module-option</code></em>. <em class="parameter"><code>module-option</code></em>'s <em class="parameter"><code>name</code></em> and <em class="parameter"><code>value</code></em> attributes specify a username and password. It is included for testing only, and is not appropriate for a production environment.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_ldapusers"><p class="title"><strong>Table A.32. <code class="code">LdapUsers</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="LdapUsers"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><tbody><tr><td> Code </td><td> <div class="para">
						<code class="code">LdapUsers</code>
					</div>
					 </td></tr><tr><td> Class </td><td> <div class="para">
						<code class="code">org.jboss.security.auth.spi.LdapUsersLoginModule</code>
					</div>
					 </td></tr><tr><td> Description </td><td> <div class="para">
						The <code class="code">LdapUsers</code> module is superseded by the <code class="code">ExtendedLDAP</code> and <code class="code">AdvancedLdap</code> modules.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_kerberos"><p class="title"><strong>Table A.33. <code class="code">Kerberos</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="Kerberos"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><tbody><tr><td> Code </td><td> <div class="para">
						<code class="code">Kerberos</code>
					</div>
					 </td></tr><tr><td> Class </td><td> <div class="para">
						<code class="code">com.sun.security.auth.module.Krb5LoginModule</code>
					</div>
					 </td></tr><tr><td> Description </td><td> <div class="para">
						Performs Kerberos login authentication, using GSSAPI. This module is part of the security framework from the API provided by Sun Microsystems. Details can be found at <a href="http://docs.oracle.com/javase/7/docs/jre/api/security/jaas/spec/com/sun/security/auth/module/Krb5LoginModule.html" class="mimir-link-warn" title="Mimir does not include content from: docs.oracle.com">http://docs.oracle.com/javase/7/docs/jre/api/security/jaas/spec/com/sun/security/auth/module/Krb5LoginModule.html</a>. This module needs to be paired with another module which handles the authentication and roles mapping.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_kerberosmoduleoptions"><p class="title"><strong>Table A.34. <code class="code">Kerberos</code> Module Options</strong></p><div class="table-contents"><table class="gt-4-cols gt-7-rows" summary="Kerberos Module Options"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707338355456" scope="col"> Option </th><th id="idm140707325424672" scope="col"> Type </th><th id="idm140707325424192" scope="col"> Default </th><th id="idm140707325423712" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140707338355456"> <div class="para">
						<code class="code">storekey</code>
					</div>
					 </td><td headers="idm140707325424672"> <div class="para">
						<code class="literal">true</code> or <code class="literal">false</code>
					</div>
					 </td><td headers="idm140707325424192"> false </td><td headers="idm140707325423712"> <div class="para">
						Whether or not to add the <code class="code">KerberosKey</code> to the subject's private credentials.
					</div>
					 </td></tr><tr><td headers="idm140707338355456"> <div class="para">
						<code class="code">doNotPrompt</code>
					</div>
					 </td><td headers="idm140707325424672"> <div class="para">
						<code class="literal">true</code> or <code class="literal">false</code>
					</div>
					 </td><td headers="idm140707325424192"> false </td><td headers="idm140707325423712"> <div class="para">
						If set to <code class="literal">true</code>, the user is not prompted for the password.
					</div>
					 </td></tr><tr><td headers="idm140707338355456"> <div class="para">
						<code class="code">useTicketCache</code>
					</div>
					 </td><td headers="idm140707325424672"> <div class="para">
						Boolean value of <code class="literal">true</code> or <code class="literal">false</code>
					</div>
					 . </td><td headers="idm140707325424192"> false </td><td headers="idm140707325423712"> <div class="para">
						If <code class="literal">true</code>, the TGT is obtained from the ticket cache. If <code class="literal">false</code>, the ticket cache is not used.
					</div>
					 </td></tr><tr><td headers="idm140707338355456"> <div class="para">
						<code class="code">ticketcache</code>
					</div>
					 </td><td headers="idm140707325424672"> A file or resource representing a Kerberos ticket cache. </td><td headers="idm140707325424192"> <div class="para">
						The default depends on which operating system you use.
					</div>
					 <div class="itemizedlist"><ul><li class="listitem"><div class="para">
								Red Hat Enterprise Linux / Solaris: <code class="filename">/tmp/krb5cc_<em class="replaceable">uid</em></code>, using the numeric UID value of the operating system.
							</div></li><li class="listitem"><div class="para">
								Microsoft Windows Server: uses the Local Security Authority (LSA) API to find the ticketcache.
							</div></li></ul></div>
					 </td><td headers="idm140707325423712"> The location of the ticket cache. </td></tr><tr><td headers="idm140707338355456"> <div class="para">
						<code class="code">useKeyTab</code>
					</div>
					 </td><td headers="idm140707325424672"> <div class="para">
						<code class="literal">true</code> or <code class="literal">false</code>
					</div>
					 </td><td headers="idm140707325424192"> false </td><td headers="idm140707325423712"> Whether to obtain the principal's key from a key table file. </td></tr><tr><td headers="idm140707338355456"> <div class="para">
						<code class="code">keytab</code>
					</div>
					 </td><td headers="idm140707325424672"> A file or resource representing a Kerberos keytab. </td><td headers="idm140707325424192"> <div class="para">
						the location in the operating system's Kerberos configuration file, or <code class="filename">/home/<em class="replaceable">user</em>/krb5.keytab</code>
					</div>
					 </td><td headers="idm140707325423712"> The location of the key table file. </td></tr><tr><td headers="idm140707338355456"> <div class="para">
						<code class="code">principal</code>
					</div>
					 </td><td headers="idm140707325424672"> string </td><td headers="idm140707325424192"> none </td><td headers="idm140707325423712"> <div class="para">
						The name of the principal. This can either be a simple user name or a service name such as <code class="literal">host/testserver.acme.com</code>. Use this instead of obtaining the principal from the key table, or when the key table contains more than one principal.
					</div>
					 </td></tr><tr><td headers="idm140707338355456"> <div class="para">
						<code class="code">useFirstPass</code>
					</div>
					 </td><td headers="idm140707325424672"> <div class="para">
						<code class="literal">true</code> or <code class="literal">false</code>
					</div>
					 </td><td headers="idm140707325424192"> false </td><td headers="idm140707325423712"> <div class="para">
						Whether to retrieve the username and password from the module's shared state, using <code class="code">javax.security.auth.login.name</code> and <code class="code">javax.security.auth.login.password</code> as the keys. If authentication fails, no retry attempt is made.
					</div>
					 </td></tr><tr><td headers="idm140707338355456"> <div class="para">
						<code class="code">tryFirstPass</code>
					</div>
					 </td><td headers="idm140707325424672"> <div class="para">
						<code class="literal">true</code> or <code class="literal">false</code>
					</div>
					 </td><td headers="idm140707325424192"> false </td><td headers="idm140707325423712"> <div class="para">
						Same as <code class="code">useFirstPass</code>, but if authentication fails, the module uses the <code class="code">CallbackHandler</code> to retrieve a new username and password. If the second authentication fails, the failure is reported to the calling application.
					</div>
					 </td></tr><tr><td headers="idm140707338355456"> <div class="para">
						<code class="code">storePass</code>
					</div>
					 </td><td headers="idm140707325424672"> <div class="para">
						<code class="literal">true</code> or <code class="literal">false</code>
					</div>
					 </td><td headers="idm140707325424192"> false </td><td headers="idm140707325423712"> <div class="para">
						Whether to store the username and password in the module's shared state. This does not happen if the keys already exist in the shared state, or if authentication fails.
					</div>
					 </td></tr><tr><td headers="idm140707338355456"> <div class="para">
						<code class="code">clearPass</code>
					</div>
					 </td><td headers="idm140707325424672"> <div class="para">
						<code class="literal">true</code> or <code class="literal">false</code>
					</div>
					 </td><td headers="idm140707325424192"> false </td><td headers="idm140707325423712"> <div class="para">
						Set this to <code class="literal">true</code> to clear the username and password from the shared state after both phases of authentication complete.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_spnego"><p class="title"><strong>Table A.35. <code class="code">SPNEGO</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="SPNEGO"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><tbody><tr><td> Code </td><td> <div class="para">
						<code class="code">SPNEGO</code>
					</div>
					 </td></tr><tr><td> Class </td><td> <div class="para">
						<code class="code">org.jboss.security.negotiation.spnego.SPNEGOLoginModule</code>
					</div>
					 </td></tr><tr><td> Description </td><td> <div class="para">
						Allows <acronym class="acronym">SPNEGO</acronym> authentication to a Microsoft Active Directory server or other environment which supports <acronym class="acronym">SPNEGO</acronym>. <acronym class="acronym">SPNEGO</acronym> can also carry Kerberos credentials. This module needs to be paired with another module which handles authentication and role mapping.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_spnegomoduleoptions"><p class="title"><strong>Table A.36. <code class="code">SPNEGO</code> Module Options</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows" summary="SPNEGO Module Options"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707326111376" scope="col"> Option </th><th id="idm140707326110896" scope="col"> Type </th><th id="idm140707326110416" scope="col"> Default </th><th id="idm140707326109936" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140707326111376"> <div class="para">
						<code class="code">serverSecurityDomain</code>
					</div>
					 </td><td headers="idm140707326110896"> <div class="para">
						<code class="literal">string</code>
					</div>
					 </td><td headers="idm140707326110416"> <div class="para">
						<code class="literal">null</code>.
					</div>
					 </td><td headers="idm140707326109936"> <div class="para">
						Defines the domain that is used to retrieve the identity of the server service through the kerberos login module. This property must be set.
					</div>
					 </td></tr><tr><td headers="idm140707326111376"> <div class="para">
						<code class="code">removeRealmFromPrincipal</code>
					</div>
					 </td><td headers="idm140707326110896"> <div class="para">
						<code class="literal">boolean</code>
					</div>
					 </td><td headers="idm140707326110416"> <div class="para">
						<code class="literal">false</code>
					</div>
					 </td><td headers="idm140707326109936"> <div class="para">
						Specifies that the Kerberos realm should be removed from the principal before further processing.
					</div>
					 </td></tr><tr><td headers="idm140707326111376"> <div class="para">
						<code class="code">usernamePasswordDomain</code>
					</div>
					 </td><td headers="idm140707326110896"> <div class="para">
						<code class="literal">string</code>
					</div>
					 </td><td headers="idm140707326110416"> <div class="para">
						<code class="literal">null</code>
					</div>
					 </td><td headers="idm140707326109936"> <div class="para">
						Specifies another security domain within the configuration that should be used as a failover login when Kerberos fails.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_advancedldap"><p class="title"><strong>Table A.37. <code class="code">AdvancedLdap</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="AdvancedLdap"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><tbody><tr><td> Code </td><td> <code class="code">AdvancedLdap</code> </td></tr><tr><td> Class </td><td> <div class="para">
						<code class="code">org.jboss.security.negotiation.AdvancedLdapLoginModule</code>
					</div>
					 </td></tr><tr><td> Description </td><td> <div class="para">
						A module which provides additional functionality, such as SASL and the use of a JAAS security domain.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_advancedldapmoduleoptions"><p class="title"><strong>Table A.38. <code class="code">AdvancedLdap</code> Module Options</strong></p><div class="table-contents"><table class="gt-4-cols gt-7-rows" summary="AdvancedLdap Module Options"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707321759952" scope="col"> Option </th><th id="idm140707325144160" scope="col"> Type </th><th id="idm140707325143680" scope="col"> Default </th><th id="idm140707325143200" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140707321759952"> <div class="para">
						<code class="code">bindAuthentication</code>
					</div>
					 </td><td headers="idm140707325144160"> <div class="para">
						string
					</div>
					 </td><td headers="idm140707325143680"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707325143200"> <div class="para">
						The type of SASL authentication to use for binding to the directory server.
					</div>
					 </td></tr><tr><td headers="idm140707321759952"> <div class="para">
						<code class="code">java.naming.provider.url</code>
					</div>
					 </td><td headers="idm140707325144160"> <div class="para">
						<code class="literal">string</code>
					</div>
					 </td><td headers="idm140707325143680"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707325143200"> <div class="para">
						The URI of the directory server.
					</div>
					 </td></tr><tr><td headers="idm140707321759952"> <div class="para">
						<code class="code">baseCtxDN</code>
					</div>
					 </td><td headers="idm140707325144160"> <div class="para">
						fully-qualified DN
					</div>
					 </td><td headers="idm140707325143680"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707325143200"> <div class="para">
						The distinguished name to use as the base for searches.
					</div>
					 </td></tr><tr><td headers="idm140707321759952"> <div class="para">
						<code class="code">baseFilter</code>
					</div>
					 </td><td headers="idm140707325144160"> <div class="para">
						String representing a LDAP search filter.
					</div>
					 </td><td headers="idm140707325143680"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707325143200"> <div class="para">
						The filter to use to narrow down search results.
					</div>
					 </td></tr><tr><td headers="idm140707321759952"> <div class="para">
						<code class="code">roleAttributeID</code>
					</div>
					 </td><td headers="idm140707325144160"> <div class="para">
						String value representing an LDAP attribute.
					</div>
					 </td><td headers="idm140707325143680"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707325143200"> <div class="para">
						The LDAP attribute which contains the names of authorization roles.
					</div>
					 </td></tr><tr><td headers="idm140707321759952"> <div class="para">
						<code class="code">roleAttributeIsDN</code>
					</div>
					 </td><td headers="idm140707325144160"> <div class="para">
						<code class="literal">true</code> or <code class="literal">false</code>
					</div>
					 </td><td headers="idm140707325143680"> <div class="para">
						<code class="literal">false</code>
					</div>
					 </td><td headers="idm140707325143200"> <div class="para">
						Whether the role attribute is a Distinguished Name (DN).
					</div>
					 </td></tr><tr><td headers="idm140707321759952"> <div class="para">
						<code class="code">roleNameAttributeID</code>
					</div>
					 </td><td headers="idm140707325144160"> <div class="para">
						String representing an LDAP attribute.
					</div>
					 </td><td headers="idm140707325143680"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707325143200"> <div class="para">
						The attribute contained within the <code class="code">RoleAttributeId</code> which contains the actual role attribute.
					</div>
					 </td></tr><tr><td headers="idm140707321759952"> <div class="para">
						<code class="code">recurseRoles</code>
					</div>
					 </td><td headers="idm140707325144160"> <div class="para">
						<code class="literal">true</code> or <code class="literal">false</code>
					</div>
					 </td><td headers="idm140707325143680"> <div class="para">
						<code class="literal">false</code>
					</div>
					 </td><td headers="idm140707325143200"> <div class="para">
						Whether to recursively search the <code class="code">RoleAttributeId</code> for roles.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_advancedadldap"><p class="title"><strong>Table A.39. <code class="code">AdvancedADLdap</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="AdvancedADLdap"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><tbody><tr><td> Code </td><td> <code class="code">AdvancedADLdap</code> </td></tr><tr><td> Class </td><td> <div class="para">
						<code class="code">org.jboss.security.negotiation.AdvancedADLoginModule</code>
					</div>
					 </td></tr><tr><td> Description </td><td> <div class="para">
						This module extends the <code class="code">AdvancedLdap</code> login module, and adds extra parameters that are relevant to Microsoft Active Directory.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_usersroles"><p class="title"><strong>Table A.40. <code class="code">UsersRoles</code></strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="UsersRoles"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><tbody><tr><td> Code </td><td> <code class="code">UsersRoles</code> </td></tr><tr><td> Class </td><td> <div class="para">
						<code class="code">org.jboss.security.auth.spi.UsersRolesLoginModul</code>
					</div>
					 </td></tr><tr><td> Description </td><td> <div class="para">
						A simple login module that supports multiple users and user roles stored in two different properties files.
					</div>
					 </td></tr></tbody></table></div></div><div class="table" id="topic4732_usersrolesmoduleoptions"><p class="title"><strong>Table A.41. <code class="code">UsersRoles</code> Module Options</strong></p><div class="table-contents"><table class="gt-4-cols gt-7-rows" summary="UsersRoles Module Options"><colgroup><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707337231632" scope="col"> Option </th><th id="idm140707337231152" scope="col"> Type </th><th id="idm140707337230672" scope="col"> Default </th><th id="idm140707337230192" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140707337231632"> <div class="para">
						<code class="code">usersProperties</code>
					</div>
					 </td><td headers="idm140707337231152"> <div class="para">
						Path to a file or resource.
					</div>
					 </td><td headers="idm140707337230672"> <div class="para">
						<code class="filename">users.properties</code>
					</div>
					 </td><td headers="idm140707337230192"> <div class="para">
						The file or resource which contains the user-to-password mappings. The format of the file is <code class="literal"><em class="replaceable">user</em>=<em class="replaceable">hashed-password</em></code>
					</div>
					 </td></tr><tr><td headers="idm140707337231632"> <div class="para">
						<code class="code">rolesProperties</code>
					</div>
					 </td><td headers="idm140707337231152"> <div class="para">
						Path to a file or resource.
					</div>
					 </td><td headers="idm140707337230672"> <div class="para">
						<code class="filename">roles.properties</code>
					</div>
					 </td><td headers="idm140707337230192"> <div class="para">
						The file or resource which contains the user-to-role mappings. The format of the file is <code class="code">username=role1,role2,role3</code>
					</div>
					 </td></tr><tr><td headers="idm140707337231632"> <div class="para">
						<code class="code">password-stacking</code>
					</div>
					 </td><td headers="idm140707337231152"> <div class="para">
						<code class="literal">useFirstPass</code> or <code class="literal">false</code>
					</div>
					 </td><td headers="idm140707337230672"> <div class="para">
						<code class="literal">false</code>
					</div>
					 </td><td headers="idm140707337230192"> <div class="para">
						A value of <code class="literal">useFirstPass</code> indicates that this login module should first look to the information stored in the <code class="code">LoginContext</code> for the identity. This option can be used when stacking other login modules with this one.
					</div>
					 </td></tr><tr><td headers="idm140707337231632"> <div class="para">
						<code class="code">hashAlgorithm</code>
					</div>
					 </td><td headers="idm140707337231152"> <div class="para">
						String representing a password hashing algorithm.
					</div>
					 </td><td headers="idm140707337230672"> <div class="para">
						<code class="literal">none</code>
					</div>
					 </td><td headers="idm140707337230192"> <div class="para">
						The name of the <code class="code">java.security.MessageDigest</code> algorithm to use to hash the password. There is no default so this option must be explicitly set to enable hashing. When <code class="code">hashAlgorithm</code> is specified, the clear text password obtained from the <code class="code">CallbackHandler</code> is hashed before it is passed to <code class="code">UsernamePasswordLoginModule.validatePassword</code> as the <code class="code">inputPassword</code> argument. The password stored in the <code class="filename">users.properties</code> file must be comparably hashed.
					</div>
					 </td></tr><tr><td headers="idm140707337231632"> <div class="para">
						<code class="code">hashEncoding</code>
					</div>
					 </td><td headers="idm140707337231152"> <div class="para">
						<code class="literal">base64</code> or <code class="literal">hex</code>
					</div>
					 </td><td headers="idm140707337230672"> <div class="para">
						<code class="literal">base64</code>
					</div>
					 </td><td headers="idm140707337230192"> <div class="para">
						The string format for the hashed password, if hashAlgorithm is also set.
					</div>
					 </td></tr><tr><td headers="idm140707337231632"> <div class="para">
						<code class="code">hashCharset</code>
					</div>
					 </td><td headers="idm140707337231152"> <div class="para">
						string
					</div>
					 </td><td headers="idm140707337230672"> <div class="para">
						The default encoding set in the container's runtime environment
					</div>
					 </td><td headers="idm140707337230192"> <div class="para">
						The encoding used to convert the clear-text password to a byte array.
					</div>
					 </td></tr><tr><td headers="idm140707337231632"> <div class="para">
						<code class="code">unauthenticatedIdentity</code>
					</div>
					 </td><td headers="idm140707337231152"> <div class="para">
						principal name
					</div>
					 </td><td headers="idm140707337230672"> <div class="para">
						none
					</div>
					 </td><td headers="idm140707337230192"> <div class="para">
						Defines the principal name assigned to requests which contain no authentication information. This can allow unprotected servlets to invoke methods on EJBs that do not require a specific role. Such a principal has no associated roles and can only access unsecured EJBs or EJB methods that are associated with the <code class="literal">unchecked permission</code> constraint.
					</div>
					 </td></tr></tbody></table></div></div><div class="para"><div class="title">Custom Authentication Modules</div><p>
			Authentication modules are implementations of <code class="code">javax.security.auth.spi.LoginModule</code>. Refer to the API documentation for more information about creating a custom authentication module.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4732-638862+%5BSpecified%5D&amp;comment=Title%3A+Included+Authentication+Modules%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4732-638862+07+May+2014+22%3A54+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Included_Authorization_Modules1" lang="en-US"><div class="titlepage"><div><div><h2 class="title">A.2. Included Authorization Modules</h2></div></div></div><div class="para">
		The following modules provide authorization services.
	</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707315010160" scope="col"> Code </th><th id="idm140707330539488" scope="col"> Class </th></tr></thead><tbody><tr><td headers="idm140707315010160"> DenyAll </td><td headers="idm140707330539488"> org.jboss.security.authorization.modules.AllDenyAuthorizationModule </td></tr><tr><td headers="idm140707315010160"> PermitAll </td><td headers="idm140707330539488"> org.jboss.security.authorization.modules.AllPermitAuthorizationModule </td></tr><tr><td headers="idm140707315010160"> Delegating </td><td headers="idm140707330539488"> org.jboss.security.authorization.modules.DelegatingAuthorizationModule </td></tr><tr><td headers="idm140707315010160"> Web </td><td headers="idm140707330539488"> org.jboss.security.authorization.modules.WebAuthorizationModule </td></tr><tr><td headers="idm140707315010160"> JACC </td><td headers="idm140707330539488"> org.jboss.security.authorization.modules.JACCAuthorizationModule </td></tr></tbody></table></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+6877-328380+%5BSpecified%5D&amp;comment=Title%3A+Included+Authorization+Modules%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=6877-328380+05+Nov+2012+13%3A56+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Included_Security_Mapping_Modules" lang="en-US"><div class="titlepage"><div><div><h2 class="title">A.3. Included Security Mapping Modules</h2></div></div></div><div class="para">
		The following security mapping roles are provided in JBoss EAP 6.
	</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707318394064" scope="col"> Code </th><th id="idm140707318393584" scope="col"> Class </th></tr></thead><tbody><tr><td headers="idm140707318394064"> PropertiesRoles </td><td headers="idm140707318393584"> org.jboss.security.mapping.providers.role.PropertiesRolesMappingProvider </td></tr><tr><td headers="idm140707318394064"> SimpleRoles </td><td headers="idm140707318393584"> org.jboss.security.mapping.providers.role.SimpleRolesMappingProvider </td></tr><tr><td headers="idm140707318394064"> DeploymentRoles </td><td headers="idm140707318393584"> org.jboss.security.mapping.providers.DeploymentRolesMappingProvider </td></tr><tr><td headers="idm140707318394064"> DatabaseRoles </td><td headers="idm140707318393584"> org.jboss.security.mapping.providers.role.DatabaseRolesMappingProvider </td></tr><tr><td headers="idm140707318394064"> LdapRoles </td><td headers="idm140707318393584"> org.jboss.security.mapping.providers.role.LdapRolesMappingProvider </td></tr></tbody></table></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+6879-458818+%5BSpecified%5D&amp;comment=Title%3A+Included+Security+Mapping+Modules%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=6879-458818+11+Jun+2013+15%3A51+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="Included_Security_Auditing_Provider_Modules" lang="en-US"><div class="titlepage"><div><div><h2 class="title">A.4. Included Security Auditing Provider Modules</h2></div></div></div><div class="para">
		JBoss EAP 6 provides one security auditing provider.
	</div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col><!--Empty--></col><col><!--Empty--></col></colgroup><thead><tr><th id="idm140707309149520" scope="col"> Code </th><th id="idm140707309149040" scope="col"> Class </th></tr></thead><tbody><tr><td headers="idm140707309149520"> LogAuditProvider </td><td headers="idm140707309149040"> org.jboss.security.audit.providers.LogAuditProvider </td></tr></tbody></table></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+6881-458819+%5BSpecified%5D&amp;comment=Title%3A+Included+Security+Auditing+Provider+Modules%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=6881-458819+11+Jun+2013+15%3A52+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="jboss-webxml_Configuration_Reference" lang="en-US"><div class="titlepage"><div><div><h2 class="title">A.5. jboss-web.xml Configuration Reference</h2></div></div></div><div class="para"><div class="title">Introduction</div><p>
			The <code class="filename">jboss-web.xml</code> is a file within your deployment's <code class="filename">WEB-INF</code> or <code class="filename">META-INF</code> directory. It contains configuration information about features the JBoss Web container adds to the Servlet 3.0 specification. Settings specific to the Servlet 3.0 specification are placed into <code class="filename">web.xml</code> in the same directory.
		</p></div><div class="para">
		The top-level element in the <code class="filename">jboss-web.xml</code> file is the <code class="sgmltag-element">&lt;jboss-web&gt;</code> element.
	</div><div class="para"><div class="title">Mapping Global Resources to WAR Requirements</div><p>
			Many of the available settings map requirements set in the application's <code class="filename">web.xml</code> to local resources. The explanations of the <code class="filename">web.xml</code> settings can be found at <a href="http://docs.oracle.com/cd/E13222_01/wls/docs81/webapp/web_xml.html" class="mimir-link-warn" title="Mimir does not include content from: docs.oracle.com">http://docs.oracle.com/cd/E13222_01/wls/docs81/webapp/web_xml.html</a>.
		</p></div><div class="para">
		For instance, if the <code class="filename">web.xml</code> requires <code class="literal">jdbc/MyDataSource</code>, the <code class="filename">jboss-web.xml</code> may map the global datasource <code class="literal">java:/DefaultDS</code> to fulfill this need. The WAR uses the global datasource to fill its need for <code class="literal">jdbc/MyDataSource</code>.
	</div><div class="table" id="idm140707334218640"><p class="title"><strong>Table A.42. Common Top-Level Attributes</strong></p><div class="table-contents"><table class="lt-4-cols gt-14-rows" summary="Common Top-Level Attributes"><colgroup><col width="50%" align="left" class="c1"><!--Empty--></col><col width="50%" align="left" class="c2"><!--Empty--></col></colgroup><thead><tr><th align="left" id="idm140707320868688" scope="col"> Attribute </th><th align="left" id="idm140707325253680" scope="col"> Description </th></tr></thead><tbody><tr><td align="left" headers="idm140707320868688"> env-entry </td><td align="left" headers="idm140707325253680"> <div class="para">
						A mapping to an <code class="literal">env-entry</code> required by the <code class="filename">web.xml</code>.
					</div>
					 </td></tr><tr><td align="left" headers="idm140707320868688"> ejb-ref </td><td align="left" headers="idm140707325253680"> <div class="para">
						A mapping to an <code class="literal">ejb-ref</code> required by the <code class="filename">web.xml</code>.
					</div>
					 </td></tr><tr><td align="left" headers="idm140707320868688"> ejb-local-ref </td><td align="left" headers="idm140707325253680"> <div class="para">
						A mapping to an <code class="literal">ejb-local-ref</code> required by the <code class="filename">web.xml</code>.
					</div>
					 </td></tr><tr><td align="left" headers="idm140707320868688"> service-ref </td><td align="left" headers="idm140707325253680"> <div class="para">
						A mapping to a <code class="literal">service-ref</code> required by the <code class="filename">web.xml</code>.
					</div>
					 </td></tr><tr><td align="left" headers="idm140707320868688"> resource-ref </td><td align="left" headers="idm140707325253680"> <div class="para">
						A mapping to a <code class="literal">resource-ref</code> required by the <code class="filename">web.xml</code>.
					</div>
					 </td></tr><tr><td align="left" headers="idm140707320868688"> resource-env-ref </td><td align="left" headers="idm140707325253680"> <div class="para">
						A mapping to a <code class="literal">resource-env-ref</code> required by the <code class="filename">web.xml</code>.
					</div>
					 </td></tr><tr><td align="left" headers="idm140707320868688"> message-destination-ref </td><td align="left" headers="idm140707325253680"> <div class="para">
						A mapping to a <code class="literal">message-destination-ref</code> required by the <code class="filename">web.xml</code>.
					</div>
					 </td></tr><tr><td align="left" headers="idm140707320868688"> persistence-context-ref </td><td align="left" headers="idm140707325253680"> <div class="para">
						A mapping to a <code class="literal">persistence-context-ref</code> required by the <code class="filename">web.xml</code>.
					</div>
					 </td></tr><tr><td align="left" headers="idm140707320868688"> persistence-unit-ref </td><td align="left" headers="idm140707325253680"> <div class="para">
						A mapping to a <code class="literal">persistence-unit-ref</code> required by the <code class="filename">web.xml</code>.
					</div>
					 </td></tr><tr><td align="left" headers="idm140707320868688"> post-construct </td><td align="left" headers="idm140707325253680"> <div class="para">
						A mapping to a <code class="literal">post-context</code> required by the <code class="filename">web.xml</code>.
					</div>
					 </td></tr><tr><td align="left" headers="idm140707320868688"> pre-destroy </td><td align="left" headers="idm140707325253680"> <div class="para">
						A mapping to a <code class="literal">pre-destroy</code> required by the <code class="filename">web.xml</code>.
					</div>
					 </td></tr><tr><td align="left" headers="idm140707320868688"> data-source </td><td align="left" headers="idm140707325253680"> <div class="para">
						A mapping to a <code class="literal">data-source</code> required by the <code class="filename">web.xml</code>.
					</div>
					 </td></tr><tr><td align="left" headers="idm140707320868688"> context-root </td><td align="left" headers="idm140707325253680"> The root context of the application. The default value is the name of the deployment without the <code class="filename">.war</code> suffix. </td></tr><tr><td align="left" headers="idm140707320868688"> virtual-host </td><td align="left" headers="idm140707325253680"> The name of the HTTP virtual-host the application accepts requests from. It refers to the contents of the HTTP <code class="literal">Host</code> header. </td></tr><tr><td align="left" headers="idm140707320868688"> annotation </td><td align="left" headers="idm140707325253680"> Describes an annotation used by the application. Refer to <a class="xref" href="#jboss-web-xml-annotation">&lt;annotation&gt;</a> for more information. </td></tr><tr><td align="left" headers="idm140707320868688"> listener </td><td align="left" headers="idm140707325253680"> Describes a listener used by the application. Refer to <a class="xref" href="#jboss-web-xml-listener">&lt;listener&gt;</a> for more information. </td></tr><tr><td align="left" headers="idm140707320868688"> session-config </td><td align="left" headers="idm140707325253680"> This element fills the same function as the <code class="sgmltag-element">&lt;session-config&gt;</code> element of the <code class="filename">web.xml</code> and is included for compatibility only. </td></tr><tr><td align="left" headers="idm140707320868688"> valve </td><td align="left" headers="idm140707325253680"> Describes a valve used by the application. Refer to <a class="xref" href="#jboss-web-xml-valve">&lt;valve&gt;</a> for more information. </td></tr><tr><td align="left" headers="idm140707320868688"> overlay </td><td align="left" headers="idm140707325253680"> The name of an overlay to add to the application. </td></tr><tr><td align="left" headers="idm140707320868688"> security-domain </td><td align="left" headers="idm140707325253680"> The name of the security domain used by the application. The security domain itself is configured in the web-based management console or the management CLI. </td></tr><tr><td align="left" headers="idm140707320868688"> security-role </td><td align="left" headers="idm140707325253680"> This element fills the same function as the <code class="sgmltag-element">&lt;security-role&gt;</code> element of the <code class="filename">web.xml</code> and is included for compatibility only. </td></tr><tr><td align="left" headers="idm140707320868688"> use-jboss-authorization </td><td align="left" headers="idm140707325253680"> If this element is present and contains the case insensitive value "true", the JBoss web authorization stack is used. If it is not present or contains any value that is not "true", then only the authorization mechanisms specified in the Java Enterprise Edition specifications are used. This element is new to JBoss EAP 6. </td></tr><tr><td align="left" headers="idm140707320868688"> disable-audit </td><td align="left" headers="idm140707325253680"> If this empty element is present, web security auditing is disabled. Otherwise, it is enabled. Web security auditing is not part of the Java EE specification. This element is new to JBoss EAP 6. </td></tr><tr><td align="left" headers="idm140707320868688"> disable-cross-context </td><td align="left" headers="idm140707325253680"> If <code class="literal">false</code>, the application is able to call another application context. Defaults to <code class="literal">true</code>. </td></tr></tbody></table></div></div><div class="para">
		The following elements each have child elements.
	</div><div class="para"><div class="title">&lt;annotation&gt;</div><p>
			Describes an annotation used by the application. The following table lists the child elements of an <code class="sgmltag-element">&lt;annotation&gt;</code>.
		</p></div><div class="table" id="idm140707318493104"><p class="title"><strong>Table A.43. Annotation Configuration Elements</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="Annotation Configuration Elements"><colgroup><col width="50%" align="left" class="c1"><!--Empty--></col><col width="50%" align="left" class="c2"><!--Empty--></col></colgroup><thead><tr><th align="left" id="idm140707339906144" scope="col"> Attribute </th><th align="left" id="idm140707324707680" scope="col"> Description </th></tr></thead><tbody><tr><td align="left" headers="idm140707339906144"> class-name </td><td align="left" headers="idm140707324707680"> <div class="para">
						Name of the class of the annotation
					</div>
					 </td></tr><tr><td align="left" headers="idm140707339906144"> servlet-security </td><td align="left" headers="idm140707324707680"> <div class="para">
						The element, such as <code class="literal">@ServletSecurity</code>, which represents servlet security.
					</div>
					 </td></tr><tr><td align="left" headers="idm140707339906144"> run-as </td><td align="left" headers="idm140707324707680"> <div class="para">
						The element, such as <code class="literal">@RunAs</code>, which represents the run-as information.
					</div>
					 </td></tr><tr><td align="left" headers="idm140707339906144"> multi-part </td><td align="left" headers="idm140707324707680"> <div class="para">
						The element, such as <code class="literal">@MultiPart</code>, which represents the multi-part information.
					</div>
					 </td></tr></tbody></table></div></div><div class="para"><div class="title">&lt;listener&gt;</div><p>
			Describes a listener. The following table lists the child eleents of a <code class="sgmltag-element">&lt;listener&gt;</code>.
		</p></div><div class="table" id="idm140707317363248"><p class="title"><strong>Table A.44. Listener Configuration Elements</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="Listener Configuration Elements"><colgroup><col width="50%" align="left" class="c1"><!--Empty--></col><col width="50%" align="left" class="c2"><!--Empty--></col></colgroup><thead><tr><th align="left" id="idm140707320287536" scope="col"> Attribute </th><th align="left" id="idm140707320287056" scope="col"> Description </th></tr></thead><tbody><tr><td align="left" headers="idm140707320287536"> class-name </td><td align="left" headers="idm140707320287056"> <div class="para">
						Name of the class of the listener
					</div>
					 </td></tr><tr><td align="left" headers="idm140707320287536"> listener-type </td><td align="left" headers="idm140707320287056"> <div class="para">
						List of <code class="literal">condition</code> elements, which indicate what kind of listener to add to the Context of the application. Valid choices are:
					</div>
					 <div class="variablelist"><dl class="variablelist"><dt><span class="term">CONTAINER</span></dt><dd><div class="para">
									Adds a ContainerListener to the Context.
								</div></dd><dt><span class="term">LIFECYCLE</span></dt><dd><div class="para">
									Adds a LifecycleListener to the Context.
								</div></dd><dt><span class="term">SERVLET_INSTANCE</span></dt><dd><div class="para">
									Adds an InstanceListener to the Context.
								</div></dd><dt><span class="term">SERVLET_CONTAINER</span></dt><dd><div class="para">
									Adds a WrapperListener to the Context.
								</div></dd><dt><span class="term">SERVLET_LIFECYCLE</span></dt><dd><div class="para">
									Adds a WrapperLifecycle to the Context.
								</div></dd></dl></div>
					 </td></tr><tr><td align="left" headers="idm140707320287536"> module </td><td align="left" headers="idm140707320287056"> <div class="para">
						The name of the module containing the listener class.
					</div>
					 </td></tr><tr><td align="left" headers="idm140707320287536"> param </td><td align="left" headers="idm140707320287056"> <div class="para">
						A parameter. Contains two child elements, <code class="sgmltag-element">&lt;param-name&gt;</code> and <code class="sgmltag-element">&lt;param-value&gt;</code>.
					</div>
					 </td></tr></tbody></table></div></div><div class="para"><div class="title">&lt;valve&gt;</div><p>
			Describes a valve of the application. It contains the same configuration elements as <a class="xref" href="#jboss-web-xml-listener">&lt;listener&gt;</a>.
		</p></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+4928-460029+%5BSpecified%5D&amp;comment=Title%3A+jboss-web.xml+Configuration+Reference%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4928-460029+14+Jun+2013+14%3A45+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div><div xml:lang="en-US" class="section" id="EJB_Security_Parameter_Reference" lang="en-US"><div class="titlepage"><div><div><h2 class="title">A.6. EJB Security Parameter Reference</h2></div></div></div><div class="table" id="table-security-identity"><p class="title"><strong>Table A.45. EJB security parameter elements</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="EJB security parameter elements"><colgroup><col width="50%" align="left" class="c1"><!--Empty--></col><col width="50%" align="left" class="c2"><!--Empty--></col></colgroup><thead><tr><th align="left" id="idm140707339107248" scope="col"> Element </th><th align="left" id="idm140707339106768" scope="col"> Description </th></tr></thead><tbody><tr><td align="left" headers="idm140707339107248"> <div class="para">
						<code class="sgmltag-element">&lt;security-identity&gt;</code>
					</div>
					 </td><td align="left" headers="idm140707339106768"> <div class="para">
						Contains child elements pertaining to the security identity of an EJB.
					</div>
					 </td></tr><tr><td align="left" headers="idm140707339107248"> <div class="para">
						<code class="sgmltag-element">&lt;use-caller-identity /&gt;</code>
					</div>
					 </td><td align="left" headers="idm140707339106768"> <div class="para">
						Indicates that the EJB uses the same security identity as the caller.
					</div>
					 </td></tr><tr><td align="left" headers="idm140707339107248"> <div class="para">
						<code class="sgmltag-element">&lt;run-as&gt;</code>
					</div>
					 </td><td align="left" headers="idm140707339106768"> <div class="para">
						Contains a <code class="sgmltag-element">&lt;role-name&gt;</code> element.
					</div>
					 </td></tr><tr><td align="left" headers="idm140707339107248"> <div class="para">
						<code class="sgmltag-element">&lt;run-as-principal&gt;</code>
					</div>
					 </td><td align="left" headers="idm140707339106768"> <div class="para">
						If present, indicates the principal assigned to outgoing calls. If not present, outgoing calls are assigned to a principal named <code class="literal">anonymous</code>.
					</div>
					 </td></tr><tr><td align="left" headers="idm140707339107248"> <div class="para">
						<code class="sgmltag-element">&lt;role-name&gt;</code>
					</div>
					 </td><td align="left" headers="idm140707339106768"> <div class="para">
						Specifies the role the EJB should run as.
					</div>
					 </td></tr><tr><td align="left" headers="idm140707339107248"> <div class="para">
						<code class="sgmltag-element">&lt;description&gt;</code>
					</div>
					 </td><td align="left" headers="idm140707339106768"> <div class="para">
						Describes the role named in <code class="sgmltag-element">&lt;role-name&gt;</code>
					</div>
					 . </td></tr></tbody></table></div></div><div class="example" id="idm140707321483248"><p class="title"><strong>Example A.1. Security identity examples</strong></p><div class="example-contents"><div class="para">
			This example shows each tag described in <a class="xref" href="#table-security-identity">Table A.45, “EJB security parameter elements”</a>. They can also be used inside a <code class="sgmltag-element">&lt;session&gt;</code>.
		</div><pre class="programlisting language-xml XML XML">
&lt;ejb-jar&gt;
    &lt;enterprise-beans&gt;
        &lt;session&gt;
            &lt;ejb-name&gt;ASessionBean&lt;/ejb-name&gt;
            &lt;security-identity&gt;
                &lt;use-caller-identity/&gt;
            &lt;/security-identity&gt;
        &lt;/session&gt;
        &lt;session&gt;
            &lt;ejb-name&gt;RunAsBean&lt;/ejb-name&gt;
            &lt;security-identity&gt;
                &lt;run-as&gt;
                    &lt;description&gt;A private internal role&lt;/description&gt;
                    &lt;role-name&gt;InternalRole&lt;/role-name&gt;
                &lt;/run-as&gt;
            &lt;/security-identity&gt;
        &lt;/session&gt;
		  &lt;session&gt;
			 &lt;ejb-name&gt;RunAsBean&lt;/ejb-name&gt;
			 &lt;security-identity&gt;
				&lt;run-as-principal&gt;internal&lt;/run-as-principal&gt;
			 &lt;/security-identity&gt;
		  &lt;/session&gt;
    &lt;/enterprise-beans&gt;
&lt;/ejb-jar&gt;
</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22671%2C+Security+Guide-6.2.2-1%0ABuild+Date%3A+07-08-2015+08%3A49%3A21%0ATopic+ID%3A+5053-490505+%5BSpecified%5D&amp;comment=Title%3A+EJB+Security+Parameter+Reference%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5053-490505+02+Aug+2013+16%3A02+en-US+%5BSpecified%5D" class="mimir-link-warn" title="Mimir does not include content from: bugzilla.redhat.com">Report a bug</a>
	</div></div></div><div xml:lang="en-US" class="appendix" id="appe-Revision_History" lang="en-US"><div class="titlepage"><div><div><h1 class="title">Appendix B. Revision History</h1></div></div></div><div class="para"><p><!--Empty--></p>
		<div class="revhistory"><table summary="Revision History"><tr><th align="left" valign="top" colspan="3"><strong>Revision History</strong></th></tr><tr><td align="left">Revision 6.2.2-15</td><td align="left">Wed May 21 2014</td><td align="left"><span class="author"><span class="firstname">Tom</span> <span class="surname">Wells</span></span>, <span class="author"><span class="firstname">Russell</span> <span class="surname">Dickenson</span></span>, <span class="author"><span class="firstname">Lucas</span> <span class="surname">Costi</span></span>, <span class="author"><span class="firstname">Sande</span> <span class="surname">Gilda</span></span></td></tr><tr><td align="left" colspan="3">
					<table border="0" summary="Simple list" class="simplelist"><tr><td> Red Hat JBoss Enterprise Application Platform Common Criteria Certification </td></tr></table>

				</td></tr></table></div>

	</div></div><div><div class="legalnotice"><a id="idm140707314531872"><!--Empty--></a><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"><!--Empty--></span>© 2015 Red Hat, Inc..
	</div><div class="para">
		This document is licensed by Red Hat under the <a href="http://creativecommons.org/licenses/by-sa/3.0/" class="mimir-link-warn" title="Mimir does not include content from: creativecommons.org">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>. If you distribute this document, or a modified version of it, you must provide attribution to Red Hat, Inc. and provide a link to the original. If the document is modified, all Red Hat trademarks must be removed.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat Software Collections is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div></body>

        
        
    </div>
    

</div> 


                            </bdo>
                        </main>
                    </div>
                </main>
            </div>
        
            <!--#include virtual="/includes/footer/index.html" -->
        </div>
    </body>
</html>
