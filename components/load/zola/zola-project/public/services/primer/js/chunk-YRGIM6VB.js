import{a as u}from"./chunk-W6C5CINH.js";import{d as v}from"./chunk-TTPYXTW4.js";v();function S(c){let e=5381,t=c.length;for(;t;)e=e*33^c.charCodeAt(--t);return e>>>0}function m(c,e,t){return t<0&&(t+=1),t>1&&(t-=1),6*t<1?c+(e-c)*6*t:2*t<1?e:3*t<2?c+(e-c)*(2/3-t)*6:c}function M(c,e,t){let s,i,n,g=Math.max(0,Math.min(1,c)),o=Math.max(0,Math.min(1,e)),a=Math.max(0,Math.min(1,t));if(o==0)s=a*255,i=a*255,n=a*255;else{let d,h;a<.5?h=a*(1+o):h=a+o-o*a,d=2*a-h,s=Math.floor(255*m(d,h,g+1/3)),i=Math.floor(255*m(d,h,g)),n=Math.floor(255*m(d,h,g-1/3))}return[s,i,n]}function C(c,e,t){let s,i,n,g=Math.max(0,Math.min(255,c)),o=Math.max(0,Math.min(255,e)),a=Math.max(0,Math.min(255,t)),d=g/255,h=o/255,f=a/255,_=Math.min(Math.min(d,h),f),l=Math.max(Math.max(d,h),f),p=l-_;if(n=(l+_)/2,p===0)s=0,i=0;else{n<.5?i=p/(l+_):i=p/(2-l-_);let x=((l-d)/6+p/2)/p,w=((l-h)/6+p/2)/p,b=((l-f)/6+p/2)/p;d==l?s=b-w:h==l?s=1/3+x-b:f==l&&(s=2/3+w-x),s<0?s+=1:s>1&&(s-=1)}return[s,i,n]}var r=class extends u{static get version(){return"1.12.2"}get html(){return`
<style>:host{display:block;position:relative;width:128px;width:var(--pfe-avatar--size,var(--pfe-avatar--width,128px));height:128px;height:var(--pfe-avatar--size,var(--pfe-avatar--width,128px))}:host canvas{width:100%;height:100%;image-rendering:optimizeSpeed;image-rendering:-moz-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:-o-crisp-edges;image-rendering:-o-pixelated;image-rendering:pixelated;-ms-interpolation-mode:nearest-neighbor}:host([shape=rounded]) canvas,:host([shape=rounded]) img{border-radius:calc(128px / 8 + 1px);border-radius:calc(var(--pfe-avatar--size,var(--pfe-avatar--width,128px))/ 8 + 1px)}:host([shape=circle]) canvas,:host([shape=circle]) img{border-radius:50%}:host([src]) canvas{display:none}:host([src]) img{display:block;width:100%;height:100%;-o-object-fit:cover;object-fit:cover}:host(:not([src])) img{display:none}:host([hidden]){display:none} /*# sourceMappingURL=pfe-avatar.min.css.map */</style>
<canvas></canvas>
<img>`}static get tag(){return"pfe-avatar"}static get properties(){return{name:{title:"Username",type:String,default:"",observer:"_updateWhenConnected"},src:{title:"Avatar image URL",type:String,observer:"_updateWhenConnected"},pattern:{title:"Shape pattern",type:String,default:r.patterns.squares,observer:"_updateWhenConnected"},oldName:{alias:"name",attr:"pfe-name"},oldSrc:{alias:"src",attr:"pfe-src"},oldPattern:{alias:"pattern",attr:"pfe-pattern"}}}get templateUrl(){return"pfe-avatar.html"}get styleUrl(){return"pfe-avatar.scss"}static get events(){return{connected:`${this.tag}:connected`}}static get patterns(){return{triangles:"triangles",squares:"squares"}}static get defaultSize(){return 128}static get defaultColors(){return"#67accf #448087 #709c6b #a35252 #826cbb"}get customColors(){return this.cssVariable("pfe-avatar--colors")}constructor(){super(r);this._initCanvas=this._initCanvas.bind(this)}connectedCallback(){this._initCanvas(),super.connectedCallback(),this.emitEvent(r.events.connected,{bubbles:!1})}_initCanvas(){this._canvas=this.shadowRoot.querySelector("canvas");let e=this.cssVariable("pfe-avatar--width"),t=e&&e.replace(/px$/,"")||r.defaultSize;this._canvas.width=t,this._canvas.height=t,this._squareSize=this._canvas.width/8,this._triangleSize=this._canvas.width/4,this._ctx=this._canvas.getContext("2d")}static _registerColors(){return this.colors=[],(this.customColors||this.defaultColors).split(/\s+/).forEach(t=>{let s;switch(t.length){case 4:if(s=/^#([A-f0-9])([A-f0-9])([A-f0-9])$/.exec(t),s){s.shift();let i=s.map(n=>parseInt(n+n,16));this._registerColor(i)}else this.log(`[pfe-avatar] invalid color ${t}`);break;case 7:if(s=/^#([A-f0-9]{2})([A-f0-9]{2})([A-f0-9]{2})$/.exec(t),s){s.shift();let i=s.map(n=>parseInt(n,16));this._registerColor(i)}else this.log(`[pfe-avatar] invalid color ${t}`)}}),this.colors}static _registerColor(e){r.colors.push({color1:`rgb(${e.join(",")})`,color2:`rgb(${this._adjustColor(e).join(",")})`})}static _adjustColor(e){let t=.1,s=.1,i=C(...e);return i[2]+=i[2]>t?-s:s,M(...i)}_updateWhenConnected(){this.hasAttribute("pfelement")?this.update():this.addEventListener(r.events.connected,()=>this.update())}update(){if(this.src)this.shadowRoot.querySelector("img").src=this.src;else{let e=S(this.name).toString(2),t=e.split("").map(s=>Number(s));this._colorIndex=Math.floor(r.colors.length*parseInt(e,2)/Math.pow(2,32)),this.color1=r.colors[this._colorIndex].color1,this.color2=r.colors[this._colorIndex].color2,this._clear(),this._drawBackground(),this.pattern===r.patterns.squares?this._drawSquarePattern(t):this.pattern===r.patterns.triangles&&this._drawTrianglePattern(t)}}_clear(){this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height)}_drawBackground(){this._ctx.fillStyle=this.color1,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height)}_drawSquarePattern(e){if(this._ctx.fillStyle=this.color2,this._ctx){let t=e.length;for(;t--;)e[t]&&this._drawMirroredSquare(t%4,Math.floor(t/4))}}_drawMirroredSquare(e,t){this._ctx&&(this._drawSquare(e,t),this._drawSquare(7-e,t))}_drawSquare(e,t){this._ctx.fillRect(this._squareSize*e,this._squareSize*t,this._squareSize,this._squareSize)}_drawTrianglePattern(e){if(this._ctx.fillStyle=this.color2,this._ctx){let t=e.length;for(;t--;)if(e[t]){let s=Math.floor(t/2)%2,i=Math.floor(t/4),n=t%4,g=[s,i],o=[s,i],a=[s,i];switch(n){case 0:o[1]++,a[0]++,a[1]++;break;case 1:o[0]++,a[0]++,a[1]++;break;case 2:o[0]++,a[1]++;break;case 3:g[0]++,o[0]++,o[1]++,a[1]++;break}this._drawMirroredTriangle(g,o,a)}}}_drawMirroredTriangle(e,t,s){this._ctx&&(this._drawTriangle(e,t,s),this._drawTriangle([4-e[0],e[1]],[4-t[0],t[1]],[4-s[0],s[1]]))}_drawTriangle(e,t,s){this._ctx.beginPath(),this._ctx.moveTo(...e.map(i=>i*this._triangleSize)),this._ctx.lineTo(...t.map(i=>i*this._triangleSize)),this._ctx.lineTo(...s.map(i=>i*this._triangleSize)),this._ctx.closePath(),this._ctx.fill(),this._ctx.fill()}_drawGradient(){let e=this._ctx.createLinearGradient(0,this._canvas.height,this._canvas.width,0),t=this.color2,s=t,i=t;/^#[A-f0-9]{3}$/.test(t)?(s+="c",i+="0"):/^#[A-f0-9]{6}$/.test(t)&&(s+="cc",i+="00"),e.addColorStop(0,s),e.addColorStop(1,i),e.addColorStop(1,s),this._ctx.fillStyle=e,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height)}};r._registerColors();u.create(r);var y=r;export{y as a};
/*! For license information please see chunk-YRGIM6VB.js.LEGAL.txt */
//# sourceMappingURL=chunk-YRGIM6VB.js.map
