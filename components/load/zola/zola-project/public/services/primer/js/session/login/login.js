var pr=Object.create;var ge=Object.defineProperty;var kr=Object.getOwnPropertyDescriptor;var vr=Object.getOwnPropertyNames;var mr=Object.getPrototypeOf,gr=Object.prototype.hasOwnProperty;var xr=r=>ge(r,"__esModule",{value:!0});var wr=(r,e)=>()=>(r&&(e=r(r=0)),e);var Oe=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var Sr=(r,e,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of vr(e))!gr.call(r,i)&&i!=="default"&&ge(r,i,{get:()=>e[i],enumerable:!(s=kr(e,i))||s.enumerable});return r},Me=r=>Sr(xr(ge(r!=null?pr(mr(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r);var F=wr(()=>{});var Ne=Oe((exports,module)=>{F();(function(){"use strict";var ERROR="input is invalid type",WINDOW=typeof window=="object",root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&typeof self=="object",NODE_JS=!root.JS_SHA256_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;NODE_JS?root=global:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&typeof module=="object"&&module.exports,AMD=typeof define=="function"&&define.amd,ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer!="undefined",HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];(root.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(r){return Object.prototype.toString.call(r)==="[object Array]"}),ARRAY_BUFFER&&(root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(r){return typeof r=="object"&&r.buffer&&r.buffer.constructor===ArrayBuffer});var createOutputMethod=function(r,e){return function(s){return new Sha256(e,!0).update(s)[r]()}},createMethod=function(r){var e=createOutputMethod("hex",r);NODE_JS&&(e=nodeWrap(e,r)),e.create=function(){return new Sha256(r)},e.update=function(p){return e.create().update(p)};for(var s=0;s<OUTPUT_TYPES.length;++s){var i=OUTPUT_TYPES[s];e[i]=createOutputMethod(i,r)}return e},nodeWrap=function(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(r){if(typeof r=="string")return crypto.createHash(algorithm).update(r,"utf8").digest("hex");if(r==null)throw new Error(ERROR);return r.constructor===ArrayBuffer&&(r=new Uint8Array(r)),Array.isArray(r)||ArrayBuffer.isView(r)||r.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(r)).digest("hex"):method(r)};return nodeMethod},createHmacOutputMethod=function(r,e){return function(s,i){return new HmacSha256(s,e,!0).update(i)[r]()}},createHmacMethod=function(r){var e=createHmacOutputMethod("hex",r);e.create=function(p){return new HmacSha256(p,r)},e.update=function(p,n){return e.create(p).update(n)};for(var s=0;s<OUTPUT_TYPES.length;++s){var i=OUTPUT_TYPES[s];e[i]=createHmacOutputMethod(i,r)}return e};function Sha256(r,e){e?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=r}Sha256.prototype.update=function(r){if(!this.finalized){var e,s=typeof r;if(s!=="string"){if(s==="object"){if(r===null)throw new Error(ERROR);if(ARRAY_BUFFER&&r.constructor===ArrayBuffer)r=new Uint8Array(r);else if(!Array.isArray(r)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(r)))throw new Error(ERROR)}else throw new Error(ERROR);e=!0}for(var i,p=0,n,k=r.length,l=this.blocks;p<k;){if(this.hashed&&(this.hashed=!1,l[0]=this.block,l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0),e)for(n=this.start;p<k&&n<64;++p)l[n>>2]|=r[p]<<SHIFT[n++&3];else for(n=this.start;p<k&&n<64;++p)i=r.charCodeAt(p),i<128?l[n>>2]|=i<<SHIFT[n++&3]:i<2048?(l[n>>2]|=(192|i>>6)<<SHIFT[n++&3],l[n>>2]|=(128|i&63)<<SHIFT[n++&3]):i<55296||i>=57344?(l[n>>2]|=(224|i>>12)<<SHIFT[n++&3],l[n>>2]|=(128|i>>6&63)<<SHIFT[n++&3],l[n>>2]|=(128|i&63)<<SHIFT[n++&3]):(i=65536+((i&1023)<<10|r.charCodeAt(++p)&1023),l[n>>2]|=(240|i>>18)<<SHIFT[n++&3],l[n>>2]|=(128|i>>12&63)<<SHIFT[n++&3],l[n>>2]|=(128|i>>6&63)<<SHIFT[n++&3],l[n>>2]|=(128|i&63)<<SHIFT[n++&3]);this.lastByteIndex=n,this.bytes+=n-this.start,n>=64?(this.block=l[16],this.start=n-64,this.hash(),this.hashed=!0):this.start=n}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var r=this.blocks,e=this.lastByteIndex;r[16]=this.block,r[e>>2]|=EXTRA[e&3],this.block=r[16],e>=56&&(this.hashed||this.hash(),r[0]=this.block,r[16]=r[1]=r[2]=r[3]=r[4]=r[5]=r[6]=r[7]=r[8]=r[9]=r[10]=r[11]=r[12]=r[13]=r[14]=r[15]=0),r[14]=this.hBytes<<3|this.bytes>>>29,r[15]=this.bytes<<3,this.hash()}},Sha256.prototype.hash=function(){var r=this.h0,e=this.h1,s=this.h2,i=this.h3,p=this.h4,n=this.h5,k=this.h6,l=this.h7,m=this.blocks,_,R,C,O,S,M,y,B,T,Q,D;for(_=16;_<64;++_)S=m[_-15],R=(S>>>7|S<<25)^(S>>>18|S<<14)^S>>>3,S=m[_-2],C=(S>>>17|S<<15)^(S>>>19|S<<13)^S>>>10,m[_]=m[_-16]+R+m[_-7]+C<<0;for(D=e&s,_=0;_<64;_+=4)this.first?(this.is224?(B=300032,S=m[0]-1413257819,l=S-150054599<<0,i=S+24177077<<0):(B=704751109,S=m[0]-210244248,l=S-1521486534<<0,i=S+143694565<<0),this.first=!1):(R=(r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10),C=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),B=r&e,O=B^r&s^D,y=p&n^~p&k,S=l+C+y+K[_]+m[_],M=R+O,l=i+S<<0,i=S+M<<0),R=(i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10),C=(l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7),T=i&r,O=T^i&e^B,y=l&p^~l&n,S=k+C+y+K[_+1]+m[_+1],M=R+O,k=s+S<<0,s=S+M<<0,R=(s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10),C=(k>>>6|k<<26)^(k>>>11|k<<21)^(k>>>25|k<<7),Q=s&i,O=Q^s&r^T,y=k&l^~k&p,S=n+C+y+K[_+2]+m[_+2],M=R+O,n=e+S<<0,e=S+M<<0,R=(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10),C=(n>>>6|n<<26)^(n>>>11|n<<21)^(n>>>25|n<<7),D=e&s,O=D^e&i^Q,y=n&k^~n&l,S=p+C+y+K[_+3]+m[_+3],M=R+O,p=r+S<<0,r=S+M<<0;this.h0=this.h0+r<<0,this.h1=this.h1+e<<0,this.h2=this.h2+s<<0,this.h3=this.h3+i<<0,this.h4=this.h4+p<<0,this.h5=this.h5+n<<0,this.h6=this.h6+k<<0,this.h7=this.h7+l<<0},Sha256.prototype.hex=function(){this.finalize();var r=this.h0,e=this.h1,s=this.h2,i=this.h3,p=this.h4,n=this.h5,k=this.h6,l=this.h7,m=HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[r&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[e&15]+HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[s&15]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[i&15]+HEX_CHARS[p>>28&15]+HEX_CHARS[p>>24&15]+HEX_CHARS[p>>20&15]+HEX_CHARS[p>>16&15]+HEX_CHARS[p>>12&15]+HEX_CHARS[p>>8&15]+HEX_CHARS[p>>4&15]+HEX_CHARS[p&15]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[n&15]+HEX_CHARS[k>>28&15]+HEX_CHARS[k>>24&15]+HEX_CHARS[k>>20&15]+HEX_CHARS[k>>16&15]+HEX_CHARS[k>>12&15]+HEX_CHARS[k>>8&15]+HEX_CHARS[k>>4&15]+HEX_CHARS[k&15];return this.is224||(m+=HEX_CHARS[l>>28&15]+HEX_CHARS[l>>24&15]+HEX_CHARS[l>>20&15]+HEX_CHARS[l>>16&15]+HEX_CHARS[l>>12&15]+HEX_CHARS[l>>8&15]+HEX_CHARS[l>>4&15]+HEX_CHARS[l&15]),m},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var r=this.h0,e=this.h1,s=this.h2,i=this.h3,p=this.h4,n=this.h5,k=this.h6,l=this.h7,m=[r>>24&255,r>>16&255,r>>8&255,r&255,e>>24&255,e>>16&255,e>>8&255,e&255,s>>24&255,s>>16&255,s>>8&255,s&255,i>>24&255,i>>16&255,i>>8&255,i&255,p>>24&255,p>>16&255,p>>8&255,p&255,n>>24&255,n>>16&255,n>>8&255,n&255,k>>24&255,k>>16&255,k>>8&255,k&255];return this.is224||m.push(l>>24&255,l>>16&255,l>>8&255,l&255),m},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var r=new ArrayBuffer(this.is224?28:32),e=new DataView(r);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),e.setUint32(20,this.h5),e.setUint32(24,this.h6),this.is224||e.setUint32(28,this.h7),r};function HmacSha256(r,e,s){var i,p=typeof r;if(p==="string"){var n=[],k=r.length,l=0,m;for(i=0;i<k;++i)m=r.charCodeAt(i),m<128?n[l++]=m:m<2048?(n[l++]=192|m>>6,n[l++]=128|m&63):m<55296||m>=57344?(n[l++]=224|m>>12,n[l++]=128|m>>6&63,n[l++]=128|m&63):(m=65536+((m&1023)<<10|r.charCodeAt(++i)&1023),n[l++]=240|m>>18,n[l++]=128|m>>12&63,n[l++]=128|m>>6&63,n[l++]=128|m&63);r=n}else if(p==="object"){if(r===null)throw new Error(ERROR);if(ARRAY_BUFFER&&r.constructor===ArrayBuffer)r=new Uint8Array(r);else if(!Array.isArray(r)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(r)))throw new Error(ERROR)}else throw new Error(ERROR);r.length>64&&(r=new Sha256(e,!0).update(r).array());var _=[],R=[];for(i=0;i<64;++i){var C=r[i]||0;_[i]=92^C,R[i]=54^C}Sha256.call(this,e,s),this.update(R),this.oKeyPad=_,this.inner=!0,this.sharedMemory=s}HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var r=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(r),Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),COMMON_JS?module.exports=exports:(root.sha256=exports.sha256,root.sha224=exports.sha224,AMD&&define(function(){return exports}))})()});var je=Oe(te=>{F();"use strict";te.byteLength=Ar;te.toByteArray=Er;te.fromByteArray=Cr;var N=[],U=[],_r=typeof Uint8Array!="undefined"?Uint8Array:Array,xe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(V=0,Xe=xe.length;V<Xe;++V)N[V]=xe[V],U[xe.charCodeAt(V)]=V;var V,Xe;U["-".charCodeAt(0)]=62;U["_".charCodeAt(0)]=63;function Pe(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var s=r.indexOf("=");s===-1&&(s=e);var i=s===e?0:4-s%4;return[s,i]}function Ar(r){var e=Pe(r),s=e[0],i=e[1];return(s+i)*3/4-i}function br(r,e,s){return(e+s)*3/4-s}function Er(r){for(var e,s=Pe(r),i=s[0],p=s[1],n=new _r(br(r,i,p)),k=0,l=p>0?i-4:i,m=0;m<l;m+=4)e=U[r.charCodeAt(m)]<<18|U[r.charCodeAt(m+1)]<<12|U[r.charCodeAt(m+2)]<<6|U[r.charCodeAt(m+3)],n[k++]=e>>16&255,n[k++]=e>>8&255,n[k++]=e&255;return p===2&&(e=U[r.charCodeAt(m)]<<2|U[r.charCodeAt(m+1)]>>4,n[k++]=e&255),p===1&&(e=U[r.charCodeAt(m)]<<10|U[r.charCodeAt(m+1)]<<4|U[r.charCodeAt(m+2)]>>2,n[k++]=e>>8&255,n[k++]=e&255),n}function yr(r){return N[r>>18&63]+N[r>>12&63]+N[r>>6&63]+N[r&63]}function Rr(r,e,s){for(var i,p=[],n=e;n<s;n+=3)i=(r[n]<<16&16711680)+(r[n+1]<<8&65280)+(r[n+2]&255),p.push(yr(i));return p.join("")}function Cr(r){for(var e,s=r.length,i=s%3,p=[],n=16383,k=0,l=s-i;k<l;k+=n)p.push(Rr(r,k,k+n>l?l:k+n));return i===1?(e=r[s-1],p.push(N[e>>2]+N[e<<4&63]+"==")):i===2&&(e=(r[s-2]<<8)+r[s-1],p.push(N[e>>10]+N[e>>4&63]+N[e<<2&63]+"=")),p.join("")}});F();F();F();var Be=Me(Ne()),Ke=Me(je());if(typeof Promise=="undefined")throw Error("Keycloak requires an environment that supports Promises. Make sure that you include the appropriate polyfill.");var De=!1;function Je(){De||(De=!0,console.warn("[KEYCLOAK] Usage of legacy style promise methods such as `.error()` and `.success()` has been deprecated and support will be removed in future versions. Use standard style promise methods such as `.then() and `.catch()` instead."))}function we(r){if(!(this instanceof we))return new we(r);for(var e=this,s,i=[],p,n={enable:!0,callbackList:[],interval:5},k=document.getElementsByTagName("script"),l=0;l<k.length;l++)(k[l].src.indexOf("keycloak.js")!==-1||k[l].src.indexOf("keycloak.min.js")!==-1)&&k[l].src.indexOf("version=")!==-1&&(e.iframeVersion=k[l].src.substring(k[l].src.indexOf("version=")+8).split("&")[0]);var m=!0,_=Le(console.info),R=Le(console.warn);e.init=function(t){e.authenticated=!1,p=dr();var o=["default","cordova","cordova-native"];if(t&&o.indexOf(t.adapter)>-1?s=ke(t.adapter):t&&typeof t.adapter=="object"?s=t.adapter:window.Cordova||window.cordova?s=ke("cordova"):s=ke(),t){if(typeof t.useNonce!="undefined"&&(m=t.useNonce),typeof t.checkLoginIframe!="undefined"&&(n.enable=t.checkLoginIframe),t.checkLoginIframeInterval&&(n.interval=t.checkLoginIframeInterval),t.onLoad==="login-required"&&(e.loginRequired=!0),t.responseMode)if(t.responseMode==="query"||t.responseMode==="fragment")e.responseMode=t.responseMode;else throw"Invalid value for responseMode";if(t.flow){switch(t.flow){case"standard":e.responseType="code";break;case"implicit":e.responseType="id_token token";break;case"hybrid":e.responseType="code id_token token";break;default:throw"Invalid value for flow"}e.flow=t.flow}if(t.timeSkew!=null&&(e.timeSkew=t.timeSkew),t.redirectUri&&(e.redirectUri=t.redirectUri),t.silentCheckSsoRedirectUri&&(e.silentCheckSsoRedirectUri=t.silentCheckSsoRedirectUri),typeof t.silentCheckSsoFallback=="boolean"?e.silentCheckSsoFallback=t.silentCheckSsoFallback:e.silentCheckSsoFallback=!0,t.pkceMethod){if(t.pkceMethod!=="S256")throw"Invalid value for pkceMethod";e.pkceMethod=t.pkceMethod}typeof t.enableLogging=="boolean"?e.enableLogging=t.enableLogging:e.enableLogging=!1}e.responseMode||(e.responseMode="fragment"),e.responseType||(e.responseType="code",e.flow="standard");var u=E(),f=E();f.promise.then(function(){e.onReady&&e.onReady(e.authenticated),u.setSuccess(e.authenticated)}).catch(function(g){u.setError(g)});var c=Q(r);function a(){var g=function(b){b||(x.prompt="none"),e.login(x).then(function(){f.setSuccess()}).catch(function(){f.setError()})},v=function(){var b=document.createElement("iframe"),z=e.createLoginUrl({prompt:"none",redirectUri:e.silentCheckSsoRedirectUri});b.setAttribute("src",z),b.setAttribute("title","keycloak-silent-check-sso"),b.style.display="none",document.body.appendChild(b);var I=function(X){if(!(X.origin!==window.location.origin||b.contentWindow!==X.source)){var hr=J(X.data);T(hr,f),document.body.removeChild(b),window.removeEventListener("message",I)}};window.addEventListener("message",I)},x={};switch(t.onLoad){case"check-sso":n.enable?he().then(function(){re().then(function(b){b?f.setSuccess():e.silentCheckSsoRedirectUri?v():g(!1)}).catch(function(){f.setError()})}):e.silentCheckSsoRedirectUri?v():g(!1);break;case"login-required":g(!0);break;default:throw"Invalid value for onLoad"}}function d(){var g=J(window.location.href);if(g&&window.history.replaceState(window.history.state,null,g.newUrl),g&&g.valid)return he().then(function(){T(g,f)}).catch(function(v){f.setError()});t?t.token&&t.refreshToken?(ee(t.token,t.refreshToken,t.idToken),n.enable?he().then(function(){re().then(function(v){v?(e.onAuthSuccess&&e.onAuthSuccess(),f.setSuccess(),pe()):f.setSuccess()}).catch(function(){f.setError()})}):e.updateToken(-1).then(function(){e.onAuthSuccess&&e.onAuthSuccess(),f.setSuccess()}).catch(function(){e.onAuthError&&e.onAuthError(),t.onLoad?a():f.setError()})):t.onLoad?a():f.setSuccess():f.setSuccess()}function h(){var g=E(),v=function(){(document.readyState==="interactive"||document.readyState==="complete")&&(document.removeEventListener("readystatechange",v),g.setSuccess())};return document.addEventListener("readystatechange",v),v(),g.promise}return c.then(function(){h().then(fr).then(d).catch(function(){u.setError()})}),c.catch(function(){u.setError()}),u.promise},e.login=function(t){return s.login(t)};function C(t){var o=null,u=window.crypto||window.msCrypto;if(u&&u.getRandomValues&&window.Uint8Array)return o=new Uint8Array(t),u.getRandomValues(o),o;o=new Array(t);for(var f=0;f<o.length;f++)o[f]=Math.floor(256*Math.random());return o}function O(t){return S(t,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789")}function S(t,o){for(var u=C(t),f=new Array(t),c=0;c<t;c++)f[c]=o.charCodeAt(u[c]%o.length);return String.fromCharCode.apply(null,f)}function M(t,o){switch(t){case"S256":var u=new Uint8Array(Be.default.arrayBuffer(o)),f=Ke.default.fromByteArray(u).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"");return f;default:throw"Invalid value for pkceMethod"}}e.createLoginUrl=function(t){var o=Te(),u=Te(),f=s.redirectUri(t),c={state:o,nonce:u,redirectUri:encodeURIComponent(f)};t&&t.prompt&&(c.prompt=t.prompt);var a;t&&t.action=="register"?a=e.endpoints.register():a=e.endpoints.authorize();var d;t&&t.scope?t.scope.indexOf("openid")!=-1?d=t.scope:d="openid "+t.scope:d="openid";var h=a+"?client_id="+encodeURIComponent(e.clientId)+"&redirect_uri="+encodeURIComponent(f)+"&state="+encodeURIComponent(o)+"&response_mode="+encodeURIComponent(e.responseMode)+"&response_type="+encodeURIComponent(e.responseType)+"&scope="+encodeURIComponent(d);if(m&&(h=h+"&nonce="+encodeURIComponent(u)),t&&t.prompt&&(h+="&prompt="+encodeURIComponent(t.prompt)),t&&t.maxAge&&(h+="&max_age="+encodeURIComponent(t.maxAge)),t&&t.loginHint&&(h+="&login_hint="+encodeURIComponent(t.loginHint)),t&&t.idpHint&&(h+="&kc_idp_hint="+encodeURIComponent(t.idpHint)),t&&t.action&&t.action!="register"&&(h+="&kc_action="+encodeURIComponent(t.action)),t&&t.locale&&(h+="&ui_locales="+encodeURIComponent(t.locale)),e.pkceMethod){var g=O(96);c.pkceCodeVerifier=g;var v=M(e.pkceMethod,g);h+="&code_challenge="+v,h+="&code_challenge_method="+e.pkceMethod}return p.add(c),h},e.logout=function(t){return s.logout(t)},e.createLogoutUrl=function(t){var o=e.endpoints.logout()+"?post_logout_redirect_uri="+encodeURIComponent(s.redirectUri(t,!1));return o},e.register=function(t){return s.register(t)},e.createRegisterUrl=function(t){return t||(t={}),t.action="register",e.createLoginUrl(t)},e.createAccountUrl=function(t){var o=y(),u=void 0;return typeof o!="undefined"&&(u=o+"/account?referrer="+encodeURIComponent(e.clientId)+"&referrer_uri="+encodeURIComponent(s.redirectUri(t))),u},e.accountManagement=function(){return s.accountManagement()},e.hasRealmRole=function(t){var o=e.realmAccess;return!!o&&o.roles.indexOf(t)>=0},e.hasResourceRole=function(t,o){if(!e.resourceAccess)return!1;var u=e.resourceAccess[o||e.clientId];return!!u&&u.roles.indexOf(t)>=0},e.loadUserProfile=function(){var t=y()+"/account",o=new XMLHttpRequest;o.open("GET",t,!0),o.setRequestHeader("Accept","application/json"),o.setRequestHeader("Authorization","bearer "+e.token);var u=E();return o.onreadystatechange=function(){o.readyState==4&&(o.status==200?(e.profile=JSON.parse(o.responseText),u.setSuccess(e.profile)):u.setError())},o.send(),u.promise},e.loadUserInfo=function(){var t=e.endpoints.userinfo(),o=new XMLHttpRequest;o.open("GET",t,!0),o.setRequestHeader("Accept","application/json"),o.setRequestHeader("Authorization","bearer "+e.token);var u=E();return o.onreadystatechange=function(){o.readyState==4&&(o.status==200?(e.userInfo=JSON.parse(o.responseText),u.setSuccess(e.userInfo)):u.setError())},o.send(),u.promise},e.isTokenExpired=function(t){if(!e.tokenParsed||!e.refreshToken&&e.flow!="implicit")throw"Not authenticated";if(e.timeSkew==null)return _("[KEYCLOAK] Unable to determine if token is expired as timeskew is not set"),!0;var o=e.tokenParsed.exp-Math.ceil(new Date().getTime()/1e3)+e.timeSkew;if(t){if(isNaN(t))throw"Invalid minValidity";o-=t}return o<0},e.updateToken=function(t){var o=E();if(!e.refreshToken)return o.setError(),o.promise;t=t||5;var u=function(){var c=!1;if(t==-1?(c=!0,_("[KEYCLOAK] Refreshing token: forced refresh")):(!e.tokenParsed||e.isTokenExpired(t))&&(c=!0,_("[KEYCLOAK] Refreshing token: token expired")),!c)o.setSuccess(!1);else{var a="grant_type=refresh_token&refresh_token="+e.refreshToken,d=e.endpoints.token();if(i.push(o),i.length==1){var h=new XMLHttpRequest;h.open("POST",d,!0),h.setRequestHeader("Content-type","application/x-www-form-urlencoded"),h.withCredentials=!0,a+="&client_id="+encodeURIComponent(e.clientId);var g=new Date().getTime();h.onreadystatechange=function(){if(h.readyState==4)if(h.status==200){_("[KEYCLOAK] Token refreshed"),g=(g+new Date().getTime())/2;var v=JSON.parse(h.responseText);ee(v.access_token,v.refresh_token,v.id_token,g),e.onAuthRefreshSuccess&&e.onAuthRefreshSuccess();for(var x=i.pop();x!=null;x=i.pop())x.setSuccess(!0)}else{R("[KEYCLOAK] Failed to refresh token"),h.status==400&&e.clearToken(),e.onAuthRefreshError&&e.onAuthRefreshError();for(var x=i.pop();x!=null;x=i.pop())x.setError(!0)}},h.send(a)}}};if(n.enable){var f=re();f.then(function(){u()}).catch(function(){o.setError()})}else u();return o.promise},e.clearToken=function(){e.token&&(ee(null,null,null),e.onAuthLogout&&e.onAuthLogout(),e.loginRequired&&e.login())};function y(){if(typeof e.authServerUrl!="undefined")return e.authServerUrl.charAt(e.authServerUrl.length-1)=="/"?e.authServerUrl+"realms/"+encodeURIComponent(e.realm):e.authServerUrl+"/realms/"+encodeURIComponent(e.realm)}function B(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}function T(t,o){var u=t.code,f=t.error,c=t.prompt,a=new Date().getTime();if(t.kc_action_status&&e.onActionUpdate&&e.onActionUpdate(t.kc_action_status),f){if(c!="none"){var d={error:f,error_description:t.error_description};e.onAuthError&&e.onAuthError(d),o&&o.setError(d)}else o&&o.setSuccess();return}else e.flow!="standard"&&(t.access_token||t.id_token)&&x(t.access_token,null,t.id_token,!0);if(e.flow!="implicit"&&u){var h="code="+u+"&grant_type=authorization_code",g=e.endpoints.token(),v=new XMLHttpRequest;v.open("POST",g,!0),v.setRequestHeader("Content-type","application/x-www-form-urlencoded"),h+="&client_id="+encodeURIComponent(e.clientId),h+="&redirect_uri="+t.redirectUri,t.pkceCodeVerifier&&(h+="&code_verifier="+t.pkceCodeVerifier),v.withCredentials=!0,v.onreadystatechange=function(){if(v.readyState==4)if(v.status==200){var b=JSON.parse(v.responseText);x(b.access_token,b.refresh_token,b.id_token,e.flow==="standard"),pe()}else e.onAuthError&&e.onAuthError(),o&&o.setError()},v.send(h)}function x(b,z,I,X){a=(a+new Date().getTime())/2,ee(b,z,I,a),m&&(e.tokenParsed&&e.tokenParsed.nonce!=t.storedNonce||e.refreshTokenParsed&&e.refreshTokenParsed.nonce!=t.storedNonce||e.idTokenParsed&&e.idTokenParsed.nonce!=t.storedNonce)?(_("[KEYCLOAK] Invalid nonce, clearing token"),e.clearToken(),o&&o.setError()):X&&(e.onAuthSuccess&&e.onAuthSuccess(),o&&o.setSuccess())}}function Q(t){var o=E(),u;r?typeof r=="string"&&(u=r):u="keycloak.json";function f(v){v?e.endpoints={authorize:function(){return v.authorization_endpoint},token:function(){return v.token_endpoint},logout:function(){if(!v.end_session_endpoint)throw"Not supported by the OIDC server";return v.end_session_endpoint},checkSessionIframe:function(){if(!v.check_session_iframe)throw"Not supported by the OIDC server";return v.check_session_iframe},register:function(){throw'Redirection to "Register user" page not supported in standard OIDC mode'},userinfo:function(){if(!v.userinfo_endpoint)throw"Not supported by the OIDC server";return v.userinfo_endpoint}}:e.endpoints={authorize:function(){return y()+"/protocol/openid-connect/auth"},token:function(){return y()+"/protocol/openid-connect/token"},logout:function(){return y()+"/protocol/openid-connect/logout"},checkSessionIframe:function(){var x=y()+"/protocol/openid-connect/login-status-iframe.html";return e.iframeVersion&&(x=x+"?version="+e.iframeVersion),x},thirdPartyCookiesIframe:function(){var x=y()+"/protocol/openid-connect/3p-cookies/step1.html";return e.iframeVersion&&(x=x+"?version="+e.iframeVersion),x},register:function(){return y()+"/protocol/openid-connect/registrations"},userinfo:function(){return y()+"/protocol/openid-connect/userinfo"}}}if(u){var c=new XMLHttpRequest;c.open("GET",u,!0),c.setRequestHeader("Accept","application/json"),c.onreadystatechange=function(){if(c.readyState==4)if(c.status==200||D(c)){var v=JSON.parse(c.responseText);e.authServerUrl=v["auth-server-url"],e.realm=v.realm,e.clientId=v.resource,f(null),o.setSuccess()}else o.setError()},c.send()}else{if(!r.clientId)throw"clientId missing";e.clientId=r.clientId;var a=r.oidcProvider;if(a)if(typeof a=="string"){var g;a.charAt(a.length-1)=="/"?g=a+".well-known/openid-configuration":g=a+"/.well-known/openid-configuration";var c=new XMLHttpRequest;c.open("GET",g,!0),c.setRequestHeader("Accept","application/json"),c.onreadystatechange=function(){if(c.readyState==4)if(c.status==200||D(c)){var x=JSON.parse(c.responseText);f(x),o.setSuccess()}else o.setError()},c.send()}else f(a),o.setSuccess();else{if(!r.url){for(var d=document.getElementsByTagName("script"),h=0;h<d.length;h++)if(d[h].src.match(/.*keycloak\.js/)){r.url=d[h].src.substr(0,d[h].src.indexOf("/js/keycloak.js"));break}}if(!r.realm)throw"realm missing";e.authServerUrl=r.url,e.realm=r.realm,f(null),o.setSuccess()}}return o.promise}function D(t){return t.status==0&&t.responseText&&t.responseURL.startsWith("file:")}function ee(t,o,u,f){if(e.tokenTimeoutHandle&&(clearTimeout(e.tokenTimeoutHandle),e.tokenTimeoutHandle=null),o?(e.refreshToken=o,e.refreshTokenParsed=de(o)):(delete e.refreshToken,delete e.refreshTokenParsed),u?(e.idToken=u,e.idTokenParsed=de(u)):(delete e.idToken,delete e.idTokenParsed),t){if(e.token=t,e.tokenParsed=de(t),e.sessionId=e.tokenParsed.session_state,e.authenticated=!0,e.subject=e.tokenParsed.sub,e.realmAccess=e.tokenParsed.realm_access,e.resourceAccess=e.tokenParsed.resource_access,f&&(e.timeSkew=Math.floor(f/1e3)-e.tokenParsed.iat),e.timeSkew!=null&&(_("[KEYCLOAK] Estimated time difference between browser and server is "+e.timeSkew+" seconds"),e.onTokenExpired)){var c=(e.tokenParsed.exp-new Date().getTime()/1e3+e.timeSkew)*1e3;_("[KEYCLOAK] Token expires in "+Math.round(c/1e3)+" s"),c<=0?e.onTokenExpired():e.tokenTimeoutHandle=setTimeout(e.onTokenExpired,c)}}else delete e.token,delete e.tokenParsed,delete e.subject,delete e.realmAccess,delete e.resourceAccess,e.authenticated=!1}function de(t){switch(t=t.split(".")[1],t=t.replace("/-/g","+"),t=t.replace("/_/g","/"),t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Invalid token"}return t=(t+"===").slice(0,t.length+t.length%4),t=t.replace(/-/g,"+").replace(/_/g,"/"),t=decodeURIComponent(escape(atob(t))),t=JSON.parse(t),t}function Te(){var t="0123456789abcdef",o=S(36,t).split("");o[14]="4",o[19]=t.substr(o[19]&3|8,1),o[8]=o[13]=o[18]=o[23]="-";var u=o.join("");return u}function J(t){var o=lr(t);if(!!o){var u=p.get(o.state);return u&&(o.valid=!0,o.redirectUri=u.redirectUri,o.storedNonce=u.nonce,o.prompt=u.prompt,o.pkceCodeVerifier=u.pkceCodeVerifier),o}}function lr(t){var o;switch(e.flow){case"standard":o=["code","state","session_state","kc_action_status"];break;case"implicit":o=["access_token","token_type","id_token","state","session_state","expires_in","kc_action_status"];break;case"hybrid":o=["access_token","id_token","code","state","session_state","kc_action_status"];break}o.push("error"),o.push("error_description"),o.push("error_uri");var u=t.indexOf("?"),f=t.indexOf("#"),c,a;if(e.responseMode==="query"&&u!==-1?(c=t.substring(0,u),a=Ie(t.substring(u+1,f!==-1?f:t.length),o),a.paramsString!==""&&(c+="?"+a.paramsString),f!==-1&&(c+=t.substring(f))):e.responseMode==="fragment"&&f!==-1&&(c=t.substring(0,f),a=Ie(t.substring(f+1),o),a.paramsString!==""&&(c+="#"+a.paramsString)),a&&a.oauthParams){if(e.flow==="standard"||e.flow==="hybrid"){if((a.oauthParams.code||a.oauthParams.error)&&a.oauthParams.state)return a.oauthParams.newUrl=c,a.oauthParams}else if(e.flow==="implicit"&&(a.oauthParams.access_token||a.oauthParams.error)&&a.oauthParams.state)return a.oauthParams.newUrl=c,a.oauthParams}}function Ie(t,o){for(var u=t.split("&"),f={paramsString:"",oauthParams:{}},c=0;c<u.length;c++){var a=u[c].indexOf("="),d=u[c].slice(0,a);o.indexOf(d)!==-1?f.oauthParams[d]=u[c].slice(a+1):(f.paramsString!==""&&(f.paramsString+="&"),f.paramsString+=u[c])}return f}function E(){var t={setSuccess:function(o){t.resolve(o)},setError:function(o){t.reject(o)}};return t.promise=new Promise(function(o,u){t.resolve=o,t.reject=u}),t.promise.success=function(o){return Je(),this.then(function(f){o(f)}),this},t.promise.error=function(o){return Je(),this.catch(function(f){o(f)}),this},t}function he(){var t=E();if(!n.enable||n.iframe)return t.setSuccess(),t.promise;var o=document.createElement("iframe");n.iframe=o,o.onload=function(){var c=e.endpoints.authorize();c.charAt(0)==="/"?n.iframeOrigin=B():n.iframeOrigin=c.substring(0,c.indexOf("/",8)),t.setSuccess()};var u=e.endpoints.checkSessionIframe();o.setAttribute("src",u),o.setAttribute("title","keycloak-session-iframe"),o.style.display="none",document.body.appendChild(o);var f=function(c){if(!(c.origin!==n.iframeOrigin||n.iframe.contentWindow!==c.source)&&(c.data=="unchanged"||c.data=="changed"||c.data=="error")){c.data!="unchanged"&&e.clearToken();for(var a=n.callbackList.splice(0,n.callbackList.length),d=a.length-1;d>=0;--d){var h=a[d];c.data=="error"?h.setError():h.setSuccess(c.data=="unchanged")}}};return window.addEventListener("message",f,!1),t.promise}function pe(){n.enable&&e.token&&setTimeout(function(){re().then(function(t){t&&pe()})},n.interval*1e3)}function re(){var t=E();if(n.iframe&&n.iframeOrigin){var o=e.clientId+" "+(e.sessionId?e.sessionId:"");n.callbackList.push(t);var u=n.iframeOrigin;n.callbackList.length==1&&n.iframe.contentWindow.postMessage(o,u)}else t.setSuccess();return t.promise}function fr(){var t=E();if(n.enable||e.silentCheckSsoRedirectUri){var o=document.createElement("iframe");o.setAttribute("src",e.endpoints.thirdPartyCookiesIframe()),o.setAttribute("title","keycloak-3p-check-iframe"),o.style.display="none",document.body.appendChild(o);var u=function(f){o.contentWindow===f.source&&(f.data!=="supported"&&f.data!=="unsupported"||(f.data==="unsupported"&&(n.enable=!1,e.silentCheckSsoFallback&&(e.silentCheckSsoRedirectUri=!1),R("[KEYCLOAK] 3rd party cookies aren't supported by this browser. checkLoginIframe and silent check-sso are not available.")),document.body.removeChild(o),window.removeEventListener("message",u),t.setSuccess()))};window.addEventListener("message",u,!1)}else t.setSuccess();return t.promise}function ke(t){if(!t||t=="default")return{login:function(a){return window.location.replace(e.createLoginUrl(a)),E().promise},logout:function(a){return window.location.replace(e.createLogoutUrl(a)),E().promise},register:function(a){return window.location.replace(e.createRegisterUrl(a)),E().promise},accountManagement:function(){var a=e.createAccountUrl();if(typeof a!="undefined")window.location.href=a;else throw"Not supported by the OIDC server";return E().promise},redirectUri:function(a,d){return arguments.length==1&&(d=!0),a&&a.redirectUri?a.redirectUri:e.redirectUri?e.redirectUri:location.href}};if(t=="cordova"){n.enable=!1;var o=function(a,d,h){return window.cordova&&window.cordova.InAppBrowser?window.cordova.InAppBrowser.open(a,d,h):window.open(a,d,h)},u=function(a){return a&&a.cordovaOptions?Object.keys(a.cordovaOptions).reduce(function(d,h){return d[h]=a.cordovaOptions[h],d},{}):{}},f=function(a){return Object.keys(a).reduce(function(d,h){return d.push(h+"="+a[h]),d},[]).join(",")},c=function(a){var d=u(a);return d.location="no",a&&a.prompt=="none"&&(d.hidden="yes"),f(d)};return{login:function(a){var d=E(),h=c(a),g=e.createLoginUrl(a),v=o(g,"_blank",h),x=!1,b=!1,z=function(){b=!0,v.close()};return v.addEventListener("loadstart",function(I){if(I.url.indexOf("http://localhost")==0){var X=J(I.url);T(X,d),z(),x=!0}}),v.addEventListener("loaderror",function(I){if(!x)if(I.url.indexOf("http://localhost")==0){var X=J(I.url);T(X,d),z(),x=!0}else d.setError(),z()}),v.addEventListener("exit",function(I){b||d.setError({reason:"closed_by_user"})}),d.promise},logout:function(a){var d=E(),h=e.createLogoutUrl(a),g=o(h,"_blank","location=no,hidden=yes"),v;return g.addEventListener("loadstart",function(x){x.url.indexOf("http://localhost")==0&&g.close()}),g.addEventListener("loaderror",function(x){x.url.indexOf("http://localhost")==0||(v=!0),g.close()}),g.addEventListener("exit",function(x){v?d.setError():(e.clearToken(),d.setSuccess())}),d.promise},register:function(a){var d=E(),h=e.createRegisterUrl(),g=c(a),v=o(h,"_blank",g);return v.addEventListener("loadstart",function(x){if(x.url.indexOf("http://localhost")==0){v.close();var b=J(x.url);T(b,d)}}),d.promise},accountManagement:function(){var a=e.createAccountUrl();if(typeof a!="undefined"){var d=o(a,"_blank","location=no");d.addEventListener("loadstart",function(h){h.url.indexOf("http://localhost")==0&&d.close()})}else throw"Not supported by the OIDC server"},redirectUri:function(a){return"http://localhost"}}}if(t=="cordova-native")return n.enable=!1,{login:function(a){var d=E(),h=e.createLoginUrl(a);return universalLinks.subscribe("keycloak",function(g){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close();var v=J(g.url);T(v,d)}),window.cordova.plugins.browsertab.openUrl(h),d.promise},logout:function(a){var d=E(),h=e.createLogoutUrl(a);return universalLinks.subscribe("keycloak",function(g){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close(),e.clearToken(),d.setSuccess()}),window.cordova.plugins.browsertab.openUrl(h),d.promise},register:function(a){var d=E(),h=e.createRegisterUrl(a);return universalLinks.subscribe("keycloak",function(g){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close();var v=J(g.url);T(v,d)}),window.cordova.plugins.browsertab.openUrl(h),d.promise},accountManagement:function(){var a=e.createAccountUrl();if(typeof a!="undefined")window.cordova.plugins.browsertab.openUrl(a);else throw"Not supported by the OIDC server"},redirectUri:function(a){return a&&a.redirectUri?a.redirectUri:e.redirectUri?e.redirectUri:"http://localhost"}};throw"invalid adapter type: "+t}var ve=function(){if(!(this instanceof ve))return new ve;localStorage.setItem("kc-test","test"),localStorage.removeItem("kc-test");var t=this;function o(){for(var u=new Date().getTime(),f=0;f<localStorage.length;f++){var c=localStorage.key(f);if(c&&c.indexOf("kc-callback-")==0){var a=localStorage.getItem(c);if(a)try{var d=JSON.parse(a).expires;(!d||d<u)&&localStorage.removeItem(c)}catch(h){localStorage.removeItem(c)}}}}t.get=function(u){if(!!u){var f="kc-callback-"+u,c=localStorage.getItem(f);return c&&(localStorage.removeItem(f),c=JSON.parse(c)),o(),c}},t.add=function(u){o();var f="kc-callback-"+u.state;u.expires=new Date().getTime()+60*60*1e3,localStorage.setItem(f,JSON.stringify(u))}},me=function(){if(!(this instanceof me))return new me;var t=this;t.get=function(c){if(!!c){var a=u("kc-callback-"+c);if(f("kc-callback-"+c,"",o(-100)),a)return JSON.parse(a)}},t.add=function(c){f("kc-callback-"+c.state,JSON.stringify(c),o(60))},t.removeItem=function(c){f(c,"",o(-100))};var o=function(c){var a=new Date;return a.setTime(a.getTime()+c*60*1e3),a},u=function(c){for(var a=c+"=",d=document.cookie.split(";"),h=0;h<d.length;h++){for(var g=d[h];g.charAt(0)==" ";)g=g.substring(1);if(g.indexOf(a)==0)return g.substring(a.length,g.length)}return""},f=function(c,a,d){var h=c+"="+a+"; expires="+d.toUTCString()+"; ";document.cookie=h}};function dr(){try{return new ve}catch(t){}return new me}function Le(t){return function(){e.enableLogging&&t.apply(console,Array.prototype.slice.call(arguments))}}}var ze=we;F();var Se=window.localStorage;function L(r){var e=Se.getItem(r);return e&&JSON.parse(e)}function P(r,e){if(typeof e!="undefined")return Se.setItem(r,JSON.stringify(e))}function Y(r){Se.removeItem(r)}F();function G(r){var e,s;return document.cookie.length>0&&(e=document.cookie.indexOf(r+"="),e!==-1&&(e===0||document.cookie.charAt(e-1)===" "))?(e+=r.length+1,s=document.cookie.indexOf(";",e),s===-1&&(s=document.cookie.length),window.unescape(document.cookie.substring(e,s))):""}var oe="customer-portal",Fr=Pr(),Hr="redhat:employees",j="rh_jwt",ne=oe+"_jwt",Z=oe+"_refresh_token",ae=oe+"_jwt_timeskew",_e=60,Ur=1*58*1e3,Tr=90,Ir="/services/primer/session/scribe/?redirectTo=",Ae="session_refresh_fail_count",be=5,Ve={realm:"redhat-external",clientId:oe,url:Fr},se={responseMode:"fragment",flow:"standard"},$,Lr,ie,Ee,ce,w={initialized:!1},ue={init:[]};function A(){try{L("session_log")===!0&&console.log.apply(console,arguments)}catch(r){}}function Or(r){A("[session.js] initializing"),ut(),$=location.hostname,Lr=location.hostname+(location.port?":"+location.port:""),ie=L(ne)||G(j),Ee=L(Z),Gr(),ce=le(),typeof ce=="number"&&(Ve.timeSkew=ce,se.timeSkew=ce),ie&&ie!=="undefined"&&(se.token=ie),Ee&&(se.refreshToken=Ee),document.cookie=j+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT; domain=.redhat.com; path=/",w.keycloak=ze(Ve),w.keycloak.onAuthSuccess=jr,w.keycloak.onAuthError=Br,w.keycloak.onAuthRefreshSuccess=Kr,w.keycloak.onAuthRefreshError=Dr,w.keycloak.onAuthLogout=Jr,w.keycloak.onTokenExpired=zr,w.keycloak.init(se).success(Mr).error(Xr)}function Mr(r){A("[session.js] initialized (authenticated: "+r+")"),r&&(Fe(),Qe(w.keycloak.token),Ge(w.keycloak.refreshToken),Vr()),We()}function W(r){var e=ue[r.toLowerCase()];if(!!e)for(;e.length;){var s=e.shift();typeof s=="function"&&(A("[session.js] running a "+r+" handler"),s(He))}}function Ye(r,e){A("[session.js] registering a "+r+" handler");var s=ue[r.toLowerCase()];r.toLowerCase()==="init"&&w.initialized?e(He):(s||(ue[r.toLowerCase()]=[]),ue[r.toLowerCase()].push(e))}function Nr(r){Ye("init",r)}function Xr(){A("[session.js] init error"),We(),Re(),ye()}function We(){w.initialized=!0,W("init")}function Pr(){var r=window.portal&&portal.idp_url,e;if(r)e=r.replace("idp","sso").replace(/\/$/,"")+"/auth";else switch(location.hostname){case"access.redhat.com":case"prod.foo.redhat.com":case"rhn.redhat.com":case"hardware.redhat.com":case"www.redhat.com":case"route-customer-portal-prod-prod.apps.ext-waf.spoke.prod.us-west-2.aws.paas.redhat.com":case"route-customer-portal-prod-prod.apps.ext-waf.spoke.prod.us-east-1.aws.paas.redhat.com":case"dxp-docs.ext.us-west.aws.prod.paas.redhat.com":return A("[session.js] ENV: prod"),"https://sso.redhat.com/auth";case"access.stage.redhat.com":case"accessstage.usersys.redhat.com":case"stage.foo.redhat.com":case"www.stage.redhat.com":case"hwcert-web-01.host.stage.cwe.eng.phx2.redhat.com":case"hwcert-web-01.host.stage.cwe.eng.phx.redhat.com":case"dxp-docs-stage.ext.us-east.aws.preprod.paas.redhat.com":return A("[session.js] ENV: stage"),"https://sso.stage.redhat.com/auth";case"access.qa.redhat.com":case"qa.foo.redhat.com":case"accessqa.usersys.redhat.com":case"www.qa.redhat.com":case"dxp-docs-qa.ext.us-east.aws.preprod.paas.redhat.com":return A("[session.js] ENV: qa"),"https://sso.qa.redhat.com/auth";default:return A("[session.js] ENV: dev/ci"),"https://sso.qa.redhat.com/auth"}return e}function jr(){W("AuthSuccess")}function Br(){Re(),ye(),W("AuthError")}function Kr(){W("AuthRefreshSuccess")}function Dr(){W("AuthRefreshError")}function Jr(){tr({skipRedirect:!0}),W("AuthLogout")}function zr(){W("TokenExpired")}function qe(r){var e=r||!sr(),s=r?1/0:Tr;if(e)return A("[session.js] running updateToken"),w.keycloak.updateToken(s).success(Wr).error(Qr);A("[session.js] not updating token because updating failed more than "+be+" times in a row"),ar("gave up on token updates due after "+be+" consecutive failed token updates")}function Vr(){setInterval(Yr,Ur)}function Yr(){qe()}function Wr(r){r?(A("[session.js] updateTokenSuccess: token was refreshed"),Qe(w.keycloak.token),Ge(w.keycloak.refreshToken),Fe(),qr(w.keycloak.timeSkew||0),nr()):A("[session.js] updateTokenSuccess: token not yet due for refresh")}function qr(r){Math.abs(r)<_e?(A("[session.js] caching the timeSkew ("+r+")"),P(ae,r)):A("[session.js] not caching the timeSkew because magnitude too high ("+r+")")}function le(){return L(ae)}function Gr(){Math.abs(le())>_e&&(A("[session.js] deleting cached timeskew, it was "+le()+"s which exceeds the limit of "+_e+"s"),Y(ae))}function Qr(r){A("[session.js] updateTokenFailure"),ct()}function Ge(r){A("[session.js] setting refresh token"),P(Z,r)}function ye(){A("[session.js] removing refresh token"),Y(Z)}function Qe(r){if(r){var e=Math.floor(w.keycloak.tokenParsed.exp-new Date().getTime()/1e3+le());A("[session.js] setting access token with lifetime "+e+" seconds"),P(ne,r),document.cookie=j+"="+r+";path=/;max-age="+e+";domain=."+$+"; SameSite=None; secure;"}}function Re(){A("[session.js] removing access token"),Y(ne),document.cookie=j+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT; domain=."+$+"; path=/;SameSite=None;secure;",document.cookie=j+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT; domain=."+$+"; path=/;secure;",document.cookie=j+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT; domain=."+$+"; path=/;"}function Ze(){var r;return(r=w==null?void 0:w.keycloak)==null?void 0:r.tokenParsed}function Zr(){return w.keycloak.token}function $r(r){return w.keycloak.isTokenExpired(r)}function $e(){var r=Ze(),e={};return r&&(e={user_id:r.user_id,username:r.username,account_id:r.account_id,account_number:r.account_number,email:r.email,firstName:r.firstName,lastName:r.lastName,lang:r.lang,region:r.region,login:r.username,internal:er()}),e}function et(){return w.keycloak.authenticated}function er(){return w.keycloak.hasRealmRole(Hr)}function rt(){for(var r=0;r<arguments.length;++r)if(!w.keycloak.hasRealmRole(arguments[r]))return!1;return!0}function tt(){return w.keycloak.createRegisterUrl()}function ot(r){var e=r||{},s=e.redirectUri||location.href;return e.redirectUri=rr(s),A("[session.js] getLoginUrl's bounceUri is "+e.redirectUri),w.keycloak.createLoginUrl(e)}function rr(r){var e=r||location.href,s=new URL(e),i=s.origin+or()+encodeURIComponent(e);return i}function nt(){return w.keycloak.createLogoutUrl()}function at(){return w.keycloak.createAccountUrl()}function H(r){return function(){if(w.initialized)return r.apply({},arguments);console.warn("[session.js] couldn't call function, session not initialized")}}function st(r){var e=r||{},s=e.redirectUri||location.href;e.redirectUri=rr(s),A("[session.js] login() is redirecting to: "+e.redirectUri),w.keycloak.login(e)}function tr(r){var e=r||{};if(Fe(),Re(),ye(),!e.skipRedirect){var s=window.location.origin+"/logout",i=w.keycloak.createLogoutUrl({redirectUri:e.redirectUri||s});window.location.href=i}}function it(r){w.keycloak.register(r)}function or(){return Ir}function nr(){var r=$e();if(typeof window.Raven!="undefined"&&typeof window.Raven.setUserContext=="function"){var e=G(j),s=L(j);Raven.setUserContext({id:r.user_id,chrome_session_id:G("chrome_session_id"),sessionjs:{rh_sso_session:!!G("rh_sso_session"),jwt:{rh_user_cookie_exists:!!G("rh_user"),rh_jwt_cookie_exists:!!e,rh_jwt_localstorage_exists:!!s,rh_jwt_cookie_matches_localstorage:e===s,refresh_token_localstorage_exists:!!L(Z),user_id:r.user_id,account_id:r.account_id,account_number:r.account_number,internal:r.internal,lang:r.lang}}}),A("[session.js] sent user context to Raven")}}function ar(r,e){nr();var s={...e,tags:{...e.tags||{},chrome_module:"session"},level:"error"};typeof window.Raven!="undefined"&&typeof window.Raven.captureMessage=="function"&&(A("[session.js] sending a problem report to Sentry"),Raven.captureException(r,s||{}))}function Ce(){return L(Ae)||0}function sr(){return Ce()>be}function ct(){try{if(!w.keycloak.isTokenExpired()){var r=Ce();return r+=1,P(Ae,r),r}}catch(e){}}function Fe(){P(Ae,0)}function ut(){r();function r(){var e=L("rh_jwt"),s=L("rh_refresh_token"),i=L("rh_jwt_timeskew");e&&(P(ne,e),Y("rh_jwt")),s&&(P(Z,s),Y("rh_refresh_token")),i&&(P(ae,i),Y("rh_jwt_timeskew"))}}var He={login:H(st),logout:H(tr),register:H(it),hasRole:H(rt),isInternal:H(er),isAuthenticated:H(et),getRegisterUrl:H(tt),getLoginUrl:H(ot),getLogoutUrl:H(nt),getAccountUrl:H(at),getToken:H(Ze),getEncodedToken:H(Zr),isTokenExpired:H($r),getUserInfo:H($e),updateToken:H(qe),on:Ye,onInit:Nr,init:Or,getBouncePath:or,_state:w,getFailCount:Ce,failCountPassed:sr,reportProblem:ar},fe=He;var ir=new URL(location.href),Ue=ir.origin,cr=Ue,ur=decodeURIComponent(ir.searchParams.get("redirectTo"))||Ue,lt=ur.indexOf(Ue)===0;lt&&(cr=ur);fe.onInit(function(){fe.login({redirectUri:cr})});fe.init();
/*! For license information please see login.js.LEGAL.txt */
//# sourceMappingURL=login.js.map
